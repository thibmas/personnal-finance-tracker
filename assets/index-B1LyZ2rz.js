var pf=Object.defineProperty;var mf=(t,r,n)=>r in t?pf(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var Le=(t,r,n)=>mf(t,typeof r!="symbol"?r+"":r,n);function _mergeNamespaces(t,r){for(var n=0;n<r.length;n++){const s=r[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function g(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function w(G,A,q){this.props=G,this.context=A,this.refs=_,this.updater=q||v}w.prototype.isReactComponent={},w.prototype.setState=function(G,A){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,A,"setState")},w.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function b(){}b.prototype=w.prototype;function T(G,A,q){this.props=G,this.context=A,this.refs=_,this.updater=q||v}var k=T.prototype=new b;k.constructor=T,y(k,w.prototype),k.isPureReactComponent=!0;var C=Array.isArray,L=Object.prototype.hasOwnProperty,D={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function U(G,A,q){var P,V={},ee=null,ge=null;if(A!=null)for(P in A.ref!==void 0&&(ge=A.ref),A.key!==void 0&&(ee=""+A.key),A)L.call(A,P)&&!N.hasOwnProperty(P)&&(V[P]=A[P]);var xe=arguments.length-2;if(xe===1)V.children=q;else if(1<xe){for(var de=Array(xe),ve=0;ve<xe;ve++)de[ve]=arguments[ve+2];V.children=de}if(G&&G.defaultProps)for(P in xe=G.defaultProps,xe)V[P]===void 0&&(V[P]=xe[P]);return{$$typeof:t,type:G,key:ee,ref:ge,props:V,_owner:D.current}}function M(G,A){return{$$typeof:t,type:G.type,key:A,ref:G.ref,props:G.props,_owner:G._owner}}function j(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function K(G){var A={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(q){return A[q]})}var I=/\/+/g;function te(G,A){return typeof G=="object"&&G!==null&&G.key!=null?K(""+G.key):A.toString(36)}function _e(G,A,q,P,V){var ee=typeof G;(ee==="undefined"||ee==="boolean")&&(G=null);var ge=!1;if(G===null)ge=!0;else switch(ee){case"string":case"number":ge=!0;break;case"object":switch(G.$$typeof){case t:case r:ge=!0}}if(ge)return ge=G,V=V(ge),G=P===""?"."+te(ge,0):P,C(V)?(q="",G!=null&&(q=G.replace(I,"$&/")+"/"),_e(V,A,q,"",function(ve){return ve})):V!=null&&(j(V)&&(V=M(V,q+(!V.key||ge&&ge.key===V.key?"":(""+V.key).replace(I,"$&/")+"/")+G)),A.push(V)),1;if(ge=0,P=P===""?".":P+":",C(G))for(var xe=0;xe<G.length;xe++){ee=G[xe];var de=P+te(ee,xe);ge+=_e(ee,A,q,de,V)}else if(de=g(G),typeof de=="function")for(G=de.call(G),xe=0;!(ee=G.next()).done;)ee=ee.value,de=P+te(ee,xe++),ge+=_e(ee,A,q,de,V);else if(ee==="object")throw A=String(G),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return ge}function ne(G,A,q){if(G==null)return G;var P=[],V=0;return _e(G,P,"","",function(ee){return A.call(q,ee,V++)}),P}function me(G){if(G._status===-1){var A=G._result;A=A(),A.then(function(q){(G._status===0||G._status===-1)&&(G._status=1,G._result=q)},function(q){(G._status===0||G._status===-1)&&(G._status=2,G._result=q)}),G._status===-1&&(G._status=0,G._result=A)}if(G._status===1)return G._result.default;throw G._result}var le={current:null},he={transition:null},J={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:he,ReactCurrentOwner:D};function fe(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ne,forEach:function(G,A,q){ne(G,function(){A.apply(this,arguments)},q)},count:function(G){var A=0;return ne(G,function(){A++}),A},toArray:function(G){return ne(G,function(A){return A})||[]},only:function(G){if(!j(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},react_production_min.Component=w,react_production_min.Fragment=n,react_production_min.Profiler=a,react_production_min.PureComponent=T,react_production_min.StrictMode=s,react_production_min.Suspense=f,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,react_production_min.act=fe,react_production_min.cloneElement=function(G,A,q){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var P=y({},G.props),V=G.key,ee=G.ref,ge=G._owner;if(A!=null){if(A.ref!==void 0&&(ee=A.ref,ge=D.current),A.key!==void 0&&(V=""+A.key),G.type&&G.type.defaultProps)var xe=G.type.defaultProps;for(de in A)L.call(A,de)&&!N.hasOwnProperty(de)&&(P[de]=A[de]===void 0&&xe!==void 0?xe[de]:A[de])}var de=arguments.length-2;if(de===1)P.children=q;else if(1<de){xe=Array(de);for(var ve=0;ve<de;ve++)xe[ve]=arguments[ve+2];P.children=xe}return{$$typeof:t,type:G.type,key:V,ref:ee,props:P,_owner:ge}},react_production_min.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:i,_context:G},G.Consumer=G},react_production_min.createElement=U,react_production_min.createFactory=function(G){var A=U.bind(null,G);return A.type=G,A},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(G){return{$$typeof:c,render:G}},react_production_min.isValidElement=j,react_production_min.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:me}},react_production_min.memo=function(G,A){return{$$typeof:d,type:G,compare:A===void 0?null:A}},react_production_min.startTransition=function(G){var A=he.transition;he.transition={};try{G()}finally{he.transition=A}},react_production_min.unstable_act=fe,react_production_min.useCallback=function(G,A){return le.current.useCallback(G,A)},react_production_min.useContext=function(G){return le.current.useContext(G)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(G){return le.current.useDeferredValue(G)},react_production_min.useEffect=function(G,A){return le.current.useEffect(G,A)},react_production_min.useId=function(){return le.current.useId()},react_production_min.useImperativeHandle=function(G,A,q){return le.current.useImperativeHandle(G,A,q)},react_production_min.useInsertionEffect=function(G,A){return le.current.useInsertionEffect(G,A)},react_production_min.useLayoutEffect=function(G,A){return le.current.useLayoutEffect(G,A)},react_production_min.useMemo=function(G,A){return le.current.useMemo(G,A)},react_production_min.useReducer=function(G,A,q){return le.current.useReducer(G,A,q)},react_production_min.useRef=function(G){return le.current.useRef(G)},react_production_min.useState=function(G){return le.current.useState(G)},react_production_min.useSyncExternalStore=function(G,A,q){return le.current.useSyncExternalStore(G,A,q)},react_production_min.useTransition=function(){return le.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var t=requireReact(),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,f,d){var h,m={},g=null,v=null;d!==void 0&&(g=""+d),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(v=f.ref);for(h in f)s.call(f,h)&&!i.hasOwnProperty(h)&&(m[h]=f[h]);if(c&&c.defaultProps)for(h in f=c.defaultProps,f)m[h]===void 0&&(m[h]=f[h]);return{$$typeof:r,type:c,key:g,ref:v,props:m,_owner:a.current}}return reactJsxRuntime_production_min.Fragment=n,reactJsxRuntime_production_min.jsx=o,reactJsxRuntime_production_min.jsxs=o,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(t){function r(he,J){var fe=he.length;he.push(J);e:for(;0<fe;){var G=fe-1>>>1,A=he[G];if(0<a(A,J))he[G]=J,he[fe]=A,fe=G;else break e}}function n(he){return he.length===0?null:he[0]}function s(he){if(he.length===0)return null;var J=he[0],fe=he.pop();if(fe!==J){he[0]=fe;e:for(var G=0,A=he.length,q=A>>>1;G<q;){var P=2*(G+1)-1,V=he[P],ee=P+1,ge=he[ee];if(0>a(V,fe))ee<A&&0>a(ge,V)?(he[G]=ge,he[ee]=fe,G=ee):(he[G]=V,he[P]=fe,G=P);else if(ee<A&&0>a(ge,fe))he[G]=ge,he[ee]=fe,G=ee;else break e}}return J}function a(he,J){var fe=he.sortIndex-J.sortIndex;return fe!==0?fe:he.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var f=[],d=[],h=1,m=null,g=3,v=!1,y=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(he){for(var J=n(d);J!==null;){if(J.callback===null)s(d);else if(J.startTime<=he)s(d),J.sortIndex=J.expirationTime,r(f,J);else break;J=n(d)}}function C(he){if(_=!1,k(he),!y)if(n(f)!==null)y=!0,me(L);else{var J=n(d);J!==null&&le(C,J.startTime-he)}}function L(he,J){y=!1,_&&(_=!1,b(U),U=-1),v=!0;var fe=g;try{for(k(J),m=n(f);m!==null&&(!(m.expirationTime>J)||he&&!K());){var G=m.callback;if(typeof G=="function"){m.callback=null,g=m.priorityLevel;var A=G(m.expirationTime<=J);J=t.unstable_now(),typeof A=="function"?m.callback=A:m===n(f)&&s(f),k(J)}else s(f);m=n(f)}if(m!==null)var q=!0;else{var P=n(d);P!==null&&le(C,P.startTime-J),q=!1}return q}finally{m=null,g=fe,v=!1}}var D=!1,N=null,U=-1,M=5,j=-1;function K(){return!(t.unstable_now()-j<M)}function I(){if(N!==null){var he=t.unstable_now();j=he;var J=!0;try{J=N(!0,he)}finally{J?te():(D=!1,N=null)}}else D=!1}var te;if(typeof T=="function")te=function(){T(I)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,ne=_e.port2;_e.port1.onmessage=I,te=function(){ne.postMessage(null)}}else te=function(){w(I,0)};function me(he){N=he,D||(D=!0,te())}function le(he,J){U=w(function(){he(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(he){he.callback=null},t.unstable_continueExecution=function(){y||v||(y=!0,me(L))},t.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<he?Math.floor(1e3/he):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(he){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var fe=g;g=J;try{return he()}finally{g=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(he,J){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var fe=g;g=he;try{return J()}finally{g=fe}},t.unstable_scheduleCallback=function(he,J,fe){var G=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?G+fe:G):fe=G,he){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=fe+A,he={id:h++,callback:J,priorityLevel:he,startTime:fe,expirationTime:A,sortIndex:-1},fe>G?(he.sortIndex=fe,r(d,he),n(f)===null&&he===n(d)&&(_?(b(U),U=-1):_=!0,le(C,fe-G))):(he.sortIndex=A,r(f,he),y||v||(y=!0,me(L))),he},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(he){var J=g;return function(){var fe=g;g=J;try{return he.apply(this,arguments)}finally{g=fe}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var t=requireReact(),r=requireScheduler();function n(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function i(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(a[l]=u,l=0;l<u.length;l++)s.add(u[l])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function g(l){return f.call(m,l)?!0:f.call(h,l)?!1:d.test(l)?m[l]=!0:(h[l]=!0,!1)}function v(l,u,p,x){if(p!==null&&p.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return x?!1:p!==null?!p.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,u,p,x){if(u===null||typeof u>"u"||v(l,u,p,x))return!0;if(x)return!1;if(p!==null)switch(p.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function _(l,u,p,x,E,S,R){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=x,this.attributeNamespace=E,this.mustUseProperty=p,this.propertyName=l,this.type=u,this.sanitizeURL=S,this.removeEmptyString=R}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new _(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];w[u]=new _(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new _(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new _(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new _(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new _(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new _(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new _(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new _(l,5,!1,l.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function T(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(b,T);w[u]=new _(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(b,T);w[u]=new _(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(b,T);w[u]=new _(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new _(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new _(l,1,!1,l.toLowerCase(),null,!0,!0)});function k(l,u,p,x){var E=w.hasOwnProperty(u)?w[u]:null;(E!==null?E.type!==0:x||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(y(u,p,E,x)&&(p=null),x||E===null?g(u)&&(p===null?l.removeAttribute(u):l.setAttribute(u,""+p)):E.mustUseProperty?l[E.propertyName]=p===null?E.type===3?!1:"":p:(u=E.attributeName,x=E.attributeNamespace,p===null?l.removeAttribute(u):(E=E.type,p=E===3||E===4&&p===!0?"":""+p,x?l.setAttributeNS(x,u,p):l.setAttribute(u,p))))}var C=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),D=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),K=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),he=Symbol.iterator;function J(l){return l===null||typeof l!="object"?null:(l=he&&l[he]||l["@@iterator"],typeof l=="function"?l:null)}var fe=Object.assign,G;function A(l){if(G===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);G=u&&u[1]||""}return`
`+G+l}var q=!1;function P(l,u){if(!l||q)return"";q=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(ue){var x=ue}Reflect.construct(l,[],u)}else{try{u.call()}catch(ue){x=ue}l.call(u.prototype)}else{try{throw Error()}catch(ue){x=ue}l()}}catch(ue){if(ue&&x&&typeof ue.stack=="string"){for(var E=ue.stack.split(`
`),S=x.stack.split(`
`),R=E.length-1,X=S.length-1;1<=R&&0<=X&&E[R]!==S[X];)X--;for(;1<=R&&0<=X;R--,X--)if(E[R]!==S[X]){if(R!==1||X!==1)do if(R--,X--,0>X||E[R]!==S[X]){var Q=`
`+E[R].replace(" at new "," at ");return l.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",l.displayName)),Q}while(1<=R&&0<=X);break}}}finally{q=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?A(l):""}function V(l){switch(l.tag){case 5:return A(l.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return l=P(l.type,!1),l;case 11:return l=P(l.type.render,!1),l;case 1:return l=P(l.type,!0),l;default:return""}}function ee(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case N:return"Fragment";case D:return"Portal";case M:return"Profiler";case U:return"StrictMode";case te:return"Suspense";case _e:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case K:return(l.displayName||"Context")+".Consumer";case j:return(l._context.displayName||"Context")+".Provider";case I:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case ne:return u=l.displayName||null,u!==null?u:ee(l.type)||"Memo";case me:u=l._payload,l=l._init;try{return ee(l(u))}catch{}}return null}function ge(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ee(u);case 8:return u===U?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function xe(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function de(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function ve(l){var u=de(l)?"checked":"value",p=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),x=""+l[u];if(!l.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var E=p.get,S=p.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return E.call(this)},set:function(R){x=""+R,S.call(this,R)}}),Object.defineProperty(l,u,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(R){x=""+R},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function je(l){l._valueTracker||(l._valueTracker=ve(l))}function Y(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var p=u.getValue(),x="";return l&&(x=de(l)?l.checked?"true":"false":l.value),l=x,l!==p?(u.setValue(l),!0):!1}function Xe(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function Ve(l,u){var p=u.checked;return fe({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??l._wrapperState.initialChecked})}function Ye(l,u){var p=u.defaultValue==null?"":u.defaultValue,x=u.checked!=null?u.checked:u.defaultChecked;p=xe(u.value!=null?u.value:p),l._wrapperState={initialChecked:x,initialValue:p,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function We(l,u){u=u.checked,u!=null&&k(l,"checked",u,!1)}function Re(l,u){We(l,u);var p=xe(u.value),x=u.type;if(p!=null)x==="number"?(p===0&&l.value===""||l.value!=p)&&(l.value=""+p):l.value!==""+p&&(l.value=""+p);else if(x==="submit"||x==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?yt(l,u.type,p):u.hasOwnProperty("defaultValue")&&yt(l,u.type,xe(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function tt(l,u,p){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var x=u.type;if(!(x!=="submit"&&x!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,p||u===l.value||(l.value=u),l.defaultValue=u}p=l.name,p!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,p!==""&&(l.name=p)}function yt(l,u,p){(u!=="number"||Xe(l.ownerDocument)!==l)&&(p==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+p&&(l.defaultValue=""+p))}var wt=Array.isArray;function Et(l,u,p,x){if(l=l.options,u){u={};for(var E=0;E<p.length;E++)u["$"+p[E]]=!0;for(p=0;p<l.length;p++)E=u.hasOwnProperty("$"+l[p].value),l[p].selected!==E&&(l[p].selected=E),E&&x&&(l[p].defaultSelected=!0)}else{for(p=""+xe(p),u=null,E=0;E<l.length;E++){if(l[E].value===p){l[E].selected=!0,x&&(l[E].defaultSelected=!0);return}u!==null||l[E].disabled||(u=l[E])}u!==null&&(u.selected=!0)}}function lr(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(n(91));return fe({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Gt(l,u){var p=u.value;if(p==null){if(p=u.children,u=u.defaultValue,p!=null){if(u!=null)throw Error(n(92));if(wt(p)){if(1<p.length)throw Error(n(93));p=p[0]}u=p}u==null&&(u=""),p=u}l._wrapperState={initialValue:xe(p)}}function St(l,u){var p=xe(u.value),x=xe(u.defaultValue);p!=null&&(p=""+p,p!==l.value&&(l.value=p),u.defaultValue==null&&l.defaultValue!==p&&(l.defaultValue=p)),x!=null&&(l.defaultValue=""+x)}function zt(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function Kt(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cr(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?Kt(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var ut,jt=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,p,x,E){MSApp.execUnsafeLocalFunction(function(){return l(u,p,x,E)})}:l}(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(ut=ut||document.createElement("div"),ut.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=ut.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function ze(l,u){if(u){var p=l.firstChild;if(p&&p===l.lastChild&&p.nodeType===3){p.nodeValue=u;return}}l.textContent=u}var Ke={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nt=["Webkit","ms","Moz","O"];Object.keys(Ke).forEach(function(l){Nt.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),Ke[u]=Ke[l]})});function at(l,u,p){return u==null||typeof u=="boolean"||u===""?"":p||typeof u!="number"||u===0||Ke.hasOwnProperty(l)&&Ke[l]?(""+u).trim():u+"px"}function rr(l,u){l=l.style;for(var p in u)if(u.hasOwnProperty(p)){var x=p.indexOf("--")===0,E=at(p,u[p],x);p==="float"&&(p="cssFloat"),x?l.setProperty(p,E):l[p]=E}}var ms=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function An(l,u){if(u){if(ms[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(n(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(n(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(n(61))}if(u.style!=null&&typeof u.style!="object")throw Error(n(62))}}function Dn(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=null;function an(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var on=null,vr=null,yr=null;function Wr(l){if(l=es(l)){if(typeof on!="function")throw Error(n(280));var u=l.stateNode;u&&(u=Bs(u),on(l.stateNode,l.type,u))}}function xs(l){vr?yr?yr.push(l):yr=[l]:vr=l}function gs(){if(vr){var l=vr,u=yr;if(yr=vr=null,Wr(l),u)for(l=0;l<u.length;l++)Wr(u[l])}}function _s(l,u){return l(u)}function vs(){}var Pn=!1;function ys(l,u,p){if(Pn)return l(u,p);Pn=!0;try{return _s(l,u,p)}finally{Pn=!1,(vr!==null||yr!==null)&&(vs(),gs())}}function Vr(l,u){var p=l.stateNode;if(p===null)return null;var x=Bs(p);if(x===null)return null;p=x[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(p&&typeof p!="function")throw Error(n(231,u,typeof p));return p}var Ln=!1;if(c)try{var ur={};Object.defineProperty(ur,"passive",{get:function(){Ln=!0}}),window.addEventListener("test",ur,ur),window.removeEventListener("test",ur,ur)}catch{Ln=!1}function ka(l,u,p,x,E,S,R,X,Q){var ue=Array.prototype.slice.call(arguments,3);try{u.apply(p,ue)}catch(we){this.onError(we)}}var Hr=!1,ln=null,F=!1,z=null,O={onError:function(l){Hr=!0,ln=l}};function B(l,u,p,x,E,S,R,X,Q){Hr=!1,ln=null,ka.apply(O,arguments)}function W(l,u,p,x,E,S,R,X,Q){if(B.apply(this,arguments),Hr){if(Hr){var ue=ln;Hr=!1,ln=null}else throw Error(n(198));F||(F=!0,z=ue)}}function H(l){var u=l,p=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(p=u.return),l=u.return;while(l)}return u.tag===3?p:null}function ie(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function pe(l){if(H(l)!==l)throw Error(n(188))}function ae(l){var u=l.alternate;if(!u){if(u=H(l),u===null)throw Error(n(188));return u!==l?null:l}for(var p=l,x=u;;){var E=p.return;if(E===null)break;var S=E.alternate;if(S===null){if(x=E.return,x!==null){p=x;continue}break}if(E.child===S.child){for(S=E.child;S;){if(S===p)return pe(E),l;if(S===x)return pe(E),u;S=S.sibling}throw Error(n(188))}if(p.return!==x.return)p=E,x=S;else{for(var R=!1,X=E.child;X;){if(X===p){R=!0,p=E,x=S;break}if(X===x){R=!0,x=E,p=S;break}X=X.sibling}if(!R){for(X=S.child;X;){if(X===p){R=!0,p=S,x=E;break}if(X===x){R=!0,x=S,p=E;break}X=X.sibling}if(!R)throw Error(n(189))}}if(p.alternate!==x)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?l:u}function oe(l){return l=ae(l),l!==null?ce(l):null}function ce(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=ce(l);if(u!==null)return u;l=l.sibling}return null}var Ee=r.unstable_scheduleCallback,Ce=r.unstable_cancelCallback,Ne=r.unstable_shouldYield,be=r.unstable_requestPaint,ke=r.unstable_now,Ue=r.unstable_getCurrentPriorityLevel,qe=r.unstable_ImmediatePriority,Je=r.unstable_UserBlockingPriority,ot=r.unstable_NormalPriority,Xr=r.unstable_LowPriority,wr=r.unstable_IdlePriority,nr=null,pt=null;function On(l){if(pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(nr,l,void 0,(l.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:Ac,Fc=Math.log,Nc=Math.LN2;function Ac(l){return l>>>=0,l===0?32:31-(Fc(l)/Nc|0)|0}var ws=64,Es=4194304;function jn(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Ss(l,u){var p=l.pendingLanes;if(p===0)return 0;var x=0,E=l.suspendedLanes,S=l.pingedLanes,R=p&268435455;if(R!==0){var X=R&~E;X!==0?x=jn(X):(S&=R,S!==0&&(x=jn(S)))}else R=p&~E,R!==0?x=jn(R):S!==0&&(x=jn(S));if(x===0)return 0;if(u!==0&&u!==x&&(u&E)===0&&(E=x&-x,S=u&-u,E>=S||E===16&&(S&4194240)!==0))return u;if((x&4)!==0&&(x|=p&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=x;0<u;)p=31-lt(u),E=1<<p,x|=l[p],u&=~E;return x}function Dc(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pc(l,u){for(var p=l.suspendedLanes,x=l.pingedLanes,E=l.expirationTimes,S=l.pendingLanes;0<S;){var R=31-lt(S),X=1<<R,Q=E[R];Q===-1?((X&p)===0||(X&x)!==0)&&(E[R]=Dc(X,u)):Q<=u&&(l.expiredLanes|=X),S&=~X}}function ba(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function ao(){var l=ws;return ws<<=1,(ws&4194240)===0&&(ws=64),l}function Ta(l){for(var u=[],p=0;31>p;p++)u.push(l);return u}function In(l,u,p){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-lt(u),l[u]=p}function Lc(l,u){var p=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<p;){var E=31-lt(p),S=1<<E;u[E]=0,x[E]=-1,l[E]=-1,p&=~S}}function Ca(l,u){var p=l.entangledLanes|=u;for(l=l.entanglements;p;){var x=31-lt(p),E=1<<x;E&u|l[x]&u&&(l[x]|=u),p&=~E}}var Ge=0;function io(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var oo,Ra,lo,co,uo,Fa=!1,ks=[],Er=null,Sr=null,kr=null,Mn=new Map,Bn=new Map,br=[],Oc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fo(l,u){switch(l){case"focusin":case"focusout":Er=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":Mn.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bn.delete(u.pointerId)}}function Un(l,u,p,x,E,S){return l===null||l.nativeEvent!==S?(l={blockedOn:u,domEventName:p,eventSystemFlags:x,nativeEvent:S,targetContainers:[E]},u!==null&&(u=es(u),u!==null&&Ra(u)),l):(l.eventSystemFlags|=x,u=l.targetContainers,E!==null&&u.indexOf(E)===-1&&u.push(E),l)}function jc(l,u,p,x,E){switch(u){case"focusin":return Er=Un(Er,l,u,p,x,E),!0;case"dragenter":return Sr=Un(Sr,l,u,p,x,E),!0;case"mouseover":return kr=Un(kr,l,u,p,x,E),!0;case"pointerover":var S=E.pointerId;return Mn.set(S,Un(Mn.get(S)||null,l,u,p,x,E)),!0;case"gotpointercapture":return S=E.pointerId,Bn.set(S,Un(Bn.get(S)||null,l,u,p,x,E)),!0}return!1}function ho(l){var u=$r(l.target);if(u!==null){var p=H(u);if(p!==null){if(u=p.tag,u===13){if(u=ie(p),u!==null){l.blockedOn=u,uo(l.priority,function(){lo(p)});return}}else if(u===3&&p.stateNode.current.memoizedState.isDehydrated){l.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}l.blockedOn=null}function bs(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var p=Aa(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(p===null){p=l.nativeEvent;var x=new p.constructor(p.type,p);sn=x,p.target.dispatchEvent(x),sn=null}else return u=es(p),u!==null&&Ra(u),l.blockedOn=p,!1;u.shift()}return!0}function po(l,u,p){bs(l)&&p.delete(u)}function Ic(){Fa=!1,Er!==null&&bs(Er)&&(Er=null),Sr!==null&&bs(Sr)&&(Sr=null),kr!==null&&bs(kr)&&(kr=null),Mn.forEach(po),Bn.forEach(po)}function zn(l,u){l.blockedOn===u&&(l.blockedOn=null,Fa||(Fa=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ic)))}function Wn(l){function u(E){return zn(E,l)}if(0<ks.length){zn(ks[0],l);for(var p=1;p<ks.length;p++){var x=ks[p];x.blockedOn===l&&(x.blockedOn=null)}}for(Er!==null&&zn(Er,l),Sr!==null&&zn(Sr,l),kr!==null&&zn(kr,l),Mn.forEach(u),Bn.forEach(u),p=0;p<br.length;p++)x=br[p],x.blockedOn===l&&(x.blockedOn=null);for(;0<br.length&&(p=br[0],p.blockedOn===null);)ho(p),p.blockedOn===null&&br.shift()}var cn=C.ReactCurrentBatchConfig,Ts=!0;function Mc(l,u,p,x){var E=Ge,S=cn.transition;cn.transition=null;try{Ge=1,Na(l,u,p,x)}finally{Ge=E,cn.transition=S}}function Bc(l,u,p,x){var E=Ge,S=cn.transition;cn.transition=null;try{Ge=4,Na(l,u,p,x)}finally{Ge=E,cn.transition=S}}function Na(l,u,p,x){if(Ts){var E=Aa(l,u,p,x);if(E===null)Ga(l,u,x,Cs,p),fo(l,x);else if(jc(E,l,u,p,x))x.stopPropagation();else if(fo(l,x),u&4&&-1<Oc.indexOf(l)){for(;E!==null;){var S=es(E);if(S!==null&&oo(S),S=Aa(l,u,p,x),S===null&&Ga(l,u,x,Cs,p),S===E)break;E=S}E!==null&&x.stopPropagation()}else Ga(l,u,x,null,p)}}var Cs=null;function Aa(l,u,p,x){if(Cs=null,l=an(x),l=$r(l),l!==null)if(u=H(l),u===null)l=null;else if(p=u.tag,p===13){if(l=ie(u),l!==null)return l;l=null}else if(p===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return Cs=l,null}function mo(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ue()){case qe:return 1;case Je:return 4;case ot:case Xr:return 16;case wr:return 536870912;default:return 16}default:return 16}}var Tr=null,Da=null,Rs=null;function xo(){if(Rs)return Rs;var l,u=Da,p=u.length,x,E="value"in Tr?Tr.value:Tr.textContent,S=E.length;for(l=0;l<p&&u[l]===E[l];l++);var R=p-l;for(x=1;x<=R&&u[p-x]===E[S-x];x++);return Rs=E.slice(l,1<x?1-x:void 0)}function Fs(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function Ns(){return!0}function go(){return!1}function It(l){function u(p,x,E,S,R){this._reactName=p,this._targetInst=E,this.type=x,this.nativeEvent=S,this.target=R,this.currentTarget=null;for(var X in l)l.hasOwnProperty(X)&&(p=l[X],this[X]=p?p(S):S[X]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Ns:go,this.isPropagationStopped=go,this}return fe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Ns)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Ns)},persist:function(){},isPersistent:Ns}),u}var un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pa=It(un),Vn=fe({},un,{view:0,detail:0}),Uc=It(Vn),La,Oa,Hn,As=fe({},Vn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ia,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Hn&&(Hn&&l.type==="mousemove"?(La=l.screenX-Hn.screenX,Oa=l.screenY-Hn.screenY):Oa=La=0,Hn=l),La)},movementY:function(l){return"movementY"in l?l.movementY:Oa}}),_o=It(As),zc=fe({},As,{dataTransfer:0}),Wc=It(zc),Vc=fe({},Vn,{relatedTarget:0}),ja=It(Vc),Hc=fe({},un,{animationName:0,elapsedTime:0,pseudoElement:0}),Xc=It(Hc),$c=fe({},un,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Yc=It($c),Gc=fe({},un,{data:0}),vo=It(Gc),Kc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qc(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=Jc[l])?!!u[l]:!1}function Ia(){return Qc}var Zc=fe({},Vn,{key:function(l){if(l.key){var u=Kc[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=Fs(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?qc[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ia,charCode:function(l){return l.type==="keypress"?Fs(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Fs(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),eu=It(Zc),tu=fe({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yo=It(tu),ru=fe({},Vn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ia}),nu=It(ru),su=fe({},un,{propertyName:0,elapsedTime:0,pseudoElement:0}),au=It(su),iu=fe({},As,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),ou=It(iu),lu=[9,13,27,32],Ma=c&&"CompositionEvent"in window,Xn=null;c&&"documentMode"in document&&(Xn=document.documentMode);var cu=c&&"TextEvent"in window&&!Xn,wo=c&&(!Ma||Xn&&8<Xn&&11>=Xn),Eo=" ",So=!1;function ko(l,u){switch(l){case"keyup":return lu.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bo(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var fn=!1;function uu(l,u){switch(l){case"compositionend":return bo(u);case"keypress":return u.which!==32?null:(So=!0,Eo);case"textInput":return l=u.data,l===Eo&&So?null:l;default:return null}}function fu(l,u){if(fn)return l==="compositionend"||!Ma&&ko(l,u)?(l=xo(),Rs=Da=Tr=null,fn=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return wo&&u.locale!=="ko"?null:u.data;default:return null}}var du={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function To(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!du[l.type]:u==="textarea"}function Co(l,u,p,x){xs(x),u=js(u,"onChange"),0<u.length&&(p=new Pa("onChange","change",null,p,x),l.push({event:p,listeners:u}))}var $n=null,Yn=null;function hu(l){Xo(l,0)}function Ds(l){var u=xn(l);if(Y(u))return l}function pu(l,u){if(l==="change")return u}var Ro=!1;if(c){var Ba;if(c){var Ua="oninput"in document;if(!Ua){var Fo=document.createElement("div");Fo.setAttribute("oninput","return;"),Ua=typeof Fo.oninput=="function"}Ba=Ua}else Ba=!1;Ro=Ba&&(!document.documentMode||9<document.documentMode)}function No(){$n&&($n.detachEvent("onpropertychange",Ao),Yn=$n=null)}function Ao(l){if(l.propertyName==="value"&&Ds(Yn)){var u=[];Co(u,Yn,l,an(l)),ys(hu,u)}}function mu(l,u,p){l==="focusin"?(No(),$n=u,Yn=p,$n.attachEvent("onpropertychange",Ao)):l==="focusout"&&No()}function xu(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Ds(Yn)}function gu(l,u){if(l==="click")return Ds(u)}function _u(l,u){if(l==="input"||l==="change")return Ds(u)}function vu(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var qt=typeof Object.is=="function"?Object.is:vu;function Gn(l,u){if(qt(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var p=Object.keys(l),x=Object.keys(u);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var E=p[x];if(!f.call(u,E)||!qt(l[E],u[E]))return!1}return!0}function Do(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Po(l,u){var p=Do(l);l=0;for(var x;p;){if(p.nodeType===3){if(x=l+p.textContent.length,l<=u&&x>=u)return{node:p,offset:u-l};l=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Do(p)}}function Lo(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?Lo(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function Oo(){for(var l=window,u=Xe();u instanceof l.HTMLIFrameElement;){try{var p=typeof u.contentWindow.location.href=="string"}catch{p=!1}if(p)l=u.contentWindow;else break;u=Xe(l.document)}return u}function za(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function yu(l){var u=Oo(),p=l.focusedElem,x=l.selectionRange;if(u!==p&&p&&p.ownerDocument&&Lo(p.ownerDocument.documentElement,p)){if(x!==null&&za(p)){if(u=x.start,l=x.end,l===void 0&&(l=u),"selectionStart"in p)p.selectionStart=u,p.selectionEnd=Math.min(l,p.value.length);else if(l=(u=p.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var E=p.textContent.length,S=Math.min(x.start,E);x=x.end===void 0?S:Math.min(x.end,E),!l.extend&&S>x&&(E=x,x=S,S=E),E=Po(p,S);var R=Po(p,x);E&&R&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==R.node||l.focusOffset!==R.offset)&&(u=u.createRange(),u.setStart(E.node,E.offset),l.removeAllRanges(),S>x?(l.addRange(u),l.extend(R.node,R.offset)):(u.setEnd(R.node,R.offset),l.addRange(u)))}}for(u=[],l=p;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<u.length;p++)l=u[p],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var wu=c&&"documentMode"in document&&11>=document.documentMode,dn=null,Wa=null,Kn=null,Va=!1;function jo(l,u,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Va||dn==null||dn!==Xe(x)||(x=dn,"selectionStart"in x&&za(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Kn&&Gn(Kn,x)||(Kn=x,x=js(Wa,"onSelect"),0<x.length&&(u=new Pa("onSelect","select",null,u,p),l.push({event:u,listeners:x}),u.target=dn)))}function Ps(l,u){var p={};return p[l.toLowerCase()]=u.toLowerCase(),p["Webkit"+l]="webkit"+u,p["Moz"+l]="moz"+u,p}var hn={animationend:Ps("Animation","AnimationEnd"),animationiteration:Ps("Animation","AnimationIteration"),animationstart:Ps("Animation","AnimationStart"),transitionend:Ps("Transition","TransitionEnd")},Ha={},Io={};c&&(Io=document.createElement("div").style,"AnimationEvent"in window||(delete hn.animationend.animation,delete hn.animationiteration.animation,delete hn.animationstart.animation),"TransitionEvent"in window||delete hn.transitionend.transition);function Ls(l){if(Ha[l])return Ha[l];if(!hn[l])return l;var u=hn[l],p;for(p in u)if(u.hasOwnProperty(p)&&p in Io)return Ha[l]=u[p];return l}var Mo=Ls("animationend"),Bo=Ls("animationiteration"),Uo=Ls("animationstart"),zo=Ls("transitionend"),Wo=new Map,Vo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(l,u){Wo.set(l,u),i(u,[l])}for(var Xa=0;Xa<Vo.length;Xa++){var $a=Vo[Xa],Eu=$a.toLowerCase(),Su=$a[0].toUpperCase()+$a.slice(1);Cr(Eu,"on"+Su)}Cr(Mo,"onAnimationEnd"),Cr(Bo,"onAnimationIteration"),Cr(Uo,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(zo,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ku=new Set("cancel close invalid load scroll toggle".split(" ").concat(qn));function Ho(l,u,p){var x=l.type||"unknown-event";l.currentTarget=p,W(x,u,void 0,l),l.currentTarget=null}function Xo(l,u){u=(u&4)!==0;for(var p=0;p<l.length;p++){var x=l[p],E=x.event;x=x.listeners;e:{var S=void 0;if(u)for(var R=x.length-1;0<=R;R--){var X=x[R],Q=X.instance,ue=X.currentTarget;if(X=X.listener,Q!==S&&E.isPropagationStopped())break e;Ho(E,X,ue),S=Q}else for(R=0;R<x.length;R++){if(X=x[R],Q=X.instance,ue=X.currentTarget,X=X.listener,Q!==S&&E.isPropagationStopped())break e;Ho(E,X,ue),S=Q}}}if(F)throw l=z,F=!1,z=null,l}function Ze(l,u){var p=u[ei];p===void 0&&(p=u[ei]=new Set);var x=l+"__bubble";p.has(x)||($o(u,l,2,!1),p.add(x))}function Ya(l,u,p){var x=0;u&&(x|=4),$o(p,l,x,u)}var Os="_reactListening"+Math.random().toString(36).slice(2);function Jn(l){if(!l[Os]){l[Os]=!0,s.forEach(function(p){p!=="selectionchange"&&(ku.has(p)||Ya(p,!1,l),Ya(p,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Os]||(u[Os]=!0,Ya("selectionchange",!1,u))}}function $o(l,u,p,x){switch(mo(u)){case 1:var E=Mc;break;case 4:E=Bc;break;default:E=Na}p=E.bind(null,u,p,l),E=void 0,!Ln||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(E=!0),x?E!==void 0?l.addEventListener(u,p,{capture:!0,passive:E}):l.addEventListener(u,p,!0):E!==void 0?l.addEventListener(u,p,{passive:E}):l.addEventListener(u,p,!1)}function Ga(l,u,p,x,E){var S=x;if((u&1)===0&&(u&2)===0&&x!==null)e:for(;;){if(x===null)return;var R=x.tag;if(R===3||R===4){var X=x.stateNode.containerInfo;if(X===E||X.nodeType===8&&X.parentNode===E)break;if(R===4)for(R=x.return;R!==null;){var Q=R.tag;if((Q===3||Q===4)&&(Q=R.stateNode.containerInfo,Q===E||Q.nodeType===8&&Q.parentNode===E))return;R=R.return}for(;X!==null;){if(R=$r(X),R===null)return;if(Q=R.tag,Q===5||Q===6){x=S=R;continue e}X=X.parentNode}}x=x.return}ys(function(){var ue=S,we=an(p),Se=[];e:{var ye=Wo.get(l);if(ye!==void 0){var Fe=Pa,De=l;switch(l){case"keypress":if(Fs(p)===0)break e;case"keydown":case"keyup":Fe=eu;break;case"focusin":De="focus",Fe=ja;break;case"focusout":De="blur",Fe=ja;break;case"beforeblur":case"afterblur":Fe=ja;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=_o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=Wc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=nu;break;case Mo:case Bo:case Uo:Fe=Xc;break;case zo:Fe=au;break;case"scroll":Fe=Uc;break;case"wheel":Fe=ou;break;case"copy":case"cut":case"paste":Fe=Yc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=yo}var Pe=(u&4)!==0,ct=!Pe&&l==="scroll",re=Pe?ye!==null?ye+"Capture":null:ye;Pe=[];for(var Z=ue,se;Z!==null;){se=Z;var Te=se.stateNode;if(se.tag===5&&Te!==null&&(se=Te,re!==null&&(Te=Vr(Z,re),Te!=null&&Pe.push(Qn(Z,Te,se)))),ct)break;Z=Z.return}0<Pe.length&&(ye=new Fe(ye,De,null,p,we),Se.push({event:ye,listeners:Pe}))}}if((u&7)===0){e:{if(ye=l==="mouseover"||l==="pointerover",Fe=l==="mouseout"||l==="pointerout",ye&&p!==sn&&(De=p.relatedTarget||p.fromElement)&&($r(De)||De[fr]))break e;if((Fe||ye)&&(ye=we.window===we?we:(ye=we.ownerDocument)?ye.defaultView||ye.parentWindow:window,Fe?(De=p.relatedTarget||p.toElement,Fe=ue,De=De?$r(De):null,De!==null&&(ct=H(De),De!==ct||De.tag!==5&&De.tag!==6)&&(De=null)):(Fe=null,De=ue),Fe!==De)){if(Pe=_o,Te="onMouseLeave",re="onMouseEnter",Z="mouse",(l==="pointerout"||l==="pointerover")&&(Pe=yo,Te="onPointerLeave",re="onPointerEnter",Z="pointer"),ct=Fe==null?ye:xn(Fe),se=De==null?ye:xn(De),ye=new Pe(Te,Z+"leave",Fe,p,we),ye.target=ct,ye.relatedTarget=se,Te=null,$r(we)===ue&&(Pe=new Pe(re,Z+"enter",De,p,we),Pe.target=se,Pe.relatedTarget=ct,Te=Pe),ct=Te,Fe&&De)t:{for(Pe=Fe,re=De,Z=0,se=Pe;se;se=pn(se))Z++;for(se=0,Te=re;Te;Te=pn(Te))se++;for(;0<Z-se;)Pe=pn(Pe),Z--;for(;0<se-Z;)re=pn(re),se--;for(;Z--;){if(Pe===re||re!==null&&Pe===re.alternate)break t;Pe=pn(Pe),re=pn(re)}Pe=null}else Pe=null;Fe!==null&&Yo(Se,ye,Fe,Pe,!1),De!==null&&ct!==null&&Yo(Se,ct,De,Pe,!0)}}e:{if(ye=ue?xn(ue):window,Fe=ye.nodeName&&ye.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&ye.type==="file")var Oe=pu;else if(To(ye))if(Ro)Oe=_u;else{Oe=xu;var Ie=mu}else(Fe=ye.nodeName)&&Fe.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(Oe=gu);if(Oe&&(Oe=Oe(l,ue))){Co(Se,Oe,p,we);break e}Ie&&Ie(l,ye,ue),l==="focusout"&&(Ie=ye._wrapperState)&&Ie.controlled&&ye.type==="number"&&yt(ye,"number",ye.value)}switch(Ie=ue?xn(ue):window,l){case"focusin":(To(Ie)||Ie.contentEditable==="true")&&(dn=Ie,Wa=ue,Kn=null);break;case"focusout":Kn=Wa=dn=null;break;case"mousedown":Va=!0;break;case"contextmenu":case"mouseup":case"dragend":Va=!1,jo(Se,p,we);break;case"selectionchange":if(wu)break;case"keydown":case"keyup":jo(Se,p,we)}var Me;if(Ma)e:{switch(l){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else fn?ko(l,p)&&(Be="onCompositionEnd"):l==="keydown"&&p.keyCode===229&&(Be="onCompositionStart");Be&&(wo&&p.locale!=="ko"&&(fn||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&fn&&(Me=xo()):(Tr=we,Da="value"in Tr?Tr.value:Tr.textContent,fn=!0)),Ie=js(ue,Be),0<Ie.length&&(Be=new vo(Be,l,null,p,we),Se.push({event:Be,listeners:Ie}),Me?Be.data=Me:(Me=bo(p),Me!==null&&(Be.data=Me)))),(Me=cu?uu(l,p):fu(l,p))&&(ue=js(ue,"onBeforeInput"),0<ue.length&&(we=new vo("onBeforeInput","beforeinput",null,p,we),Se.push({event:we,listeners:ue}),we.data=Me))}Xo(Se,u)})}function Qn(l,u,p){return{instance:l,listener:u,currentTarget:p}}function js(l,u){for(var p=u+"Capture",x=[];l!==null;){var E=l,S=E.stateNode;E.tag===5&&S!==null&&(E=S,S=Vr(l,p),S!=null&&x.unshift(Qn(l,S,E)),S=Vr(l,u),S!=null&&x.push(Qn(l,S,E))),l=l.return}return x}function pn(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Yo(l,u,p,x,E){for(var S=u._reactName,R=[];p!==null&&p!==x;){var X=p,Q=X.alternate,ue=X.stateNode;if(Q!==null&&Q===x)break;X.tag===5&&ue!==null&&(X=ue,E?(Q=Vr(p,S),Q!=null&&R.unshift(Qn(p,Q,X))):E||(Q=Vr(p,S),Q!=null&&R.push(Qn(p,Q,X)))),p=p.return}R.length!==0&&l.push({event:u,listeners:R})}var bu=/\r\n?/g,Tu=/\u0000|\uFFFD/g;function Go(l){return(typeof l=="string"?l:""+l).replace(bu,`
`).replace(Tu,"")}function Is(l,u,p){if(u=Go(u),Go(l)!==u&&p)throw Error(n(425))}function Ms(){}var Ka=null,qa=null;function Ja(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Qa=typeof setTimeout=="function"?setTimeout:void 0,Cu=typeof clearTimeout=="function"?clearTimeout:void 0,Ko=typeof Promise=="function"?Promise:void 0,Ru=typeof queueMicrotask=="function"?queueMicrotask:typeof Ko<"u"?function(l){return Ko.resolve(null).then(l).catch(Fu)}:Qa;function Fu(l){setTimeout(function(){throw l})}function Za(l,u){var p=u,x=0;do{var E=p.nextSibling;if(l.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"){if(x===0){l.removeChild(E),Wn(u);return}x--}else p!=="$"&&p!=="$?"&&p!=="$!"||x++;p=E}while(p);Wn(u)}function Rr(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function qo(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var p=l.data;if(p==="$"||p==="$!"||p==="$?"){if(u===0)return l;u--}else p==="/$"&&u++}l=l.previousSibling}return null}var mn=Math.random().toString(36).slice(2),sr="__reactFiber$"+mn,Zn="__reactProps$"+mn,fr="__reactContainer$"+mn,ei="__reactEvents$"+mn,Nu="__reactListeners$"+mn,Au="__reactHandles$"+mn;function $r(l){var u=l[sr];if(u)return u;for(var p=l.parentNode;p;){if(u=p[fr]||p[sr]){if(p=u.alternate,u.child!==null||p!==null&&p.child!==null)for(l=qo(l);l!==null;){if(p=l[sr])return p;l=qo(l)}return u}l=p,p=l.parentNode}return null}function es(l){return l=l[sr]||l[fr],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function xn(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(n(33))}function Bs(l){return l[Zn]||null}var ti=[],gn=-1;function Fr(l){return{current:l}}function et(l){0>gn||(l.current=ti[gn],ti[gn]=null,gn--)}function Qe(l,u){gn++,ti[gn]=l.current,l.current=u}var Nr={},kt=Fr(Nr),At=Fr(!1),Yr=Nr;function _n(l,u){var p=l.type.contextTypes;if(!p)return Nr;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===u)return x.__reactInternalMemoizedMaskedChildContext;var E={},S;for(S in p)E[S]=u[S];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=E),E}function Dt(l){return l=l.childContextTypes,l!=null}function Us(){et(At),et(kt)}function Jo(l,u,p){if(kt.current!==Nr)throw Error(n(168));Qe(kt,u),Qe(At,p)}function Qo(l,u,p){var x=l.stateNode;if(u=u.childContextTypes,typeof x.getChildContext!="function")return p;x=x.getChildContext();for(var E in x)if(!(E in u))throw Error(n(108,ge(l)||"Unknown",E));return fe({},p,x)}function zs(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Nr,Yr=kt.current,Qe(kt,l),Qe(At,At.current),!0}function Zo(l,u,p){var x=l.stateNode;if(!x)throw Error(n(169));p?(l=Qo(l,u,Yr),x.__reactInternalMemoizedMergedChildContext=l,et(At),et(kt),Qe(kt,l)):et(At),Qe(At,p)}var dr=null,Ws=!1,ri=!1;function el(l){dr===null?dr=[l]:dr.push(l)}function Du(l){Ws=!0,el(l)}function Ar(){if(!ri&&dr!==null){ri=!0;var l=0,u=Ge;try{var p=dr;for(Ge=1;l<p.length;l++){var x=p[l];do x=x(!0);while(x!==null)}dr=null,Ws=!1}catch(E){throw dr!==null&&(dr=dr.slice(l+1)),Ee(qe,Ar),E}finally{Ge=u,ri=!1}}return null}var vn=[],yn=0,Vs=null,Hs=0,Wt=[],Vt=0,Gr=null,hr=1,pr="";function Kr(l,u){vn[yn++]=Hs,vn[yn++]=Vs,Vs=l,Hs=u}function tl(l,u,p){Wt[Vt++]=hr,Wt[Vt++]=pr,Wt[Vt++]=Gr,Gr=l;var x=hr;l=pr;var E=32-lt(x)-1;x&=~(1<<E),p+=1;var S=32-lt(u)+E;if(30<S){var R=E-E%5;S=(x&(1<<R)-1).toString(32),x>>=R,E-=R,hr=1<<32-lt(u)+E|p<<E|x,pr=S+l}else hr=1<<S|p<<E|x,pr=l}function ni(l){l.return!==null&&(Kr(l,1),tl(l,1,0))}function si(l){for(;l===Vs;)Vs=vn[--yn],vn[yn]=null,Hs=vn[--yn],vn[yn]=null;for(;l===Gr;)Gr=Wt[--Vt],Wt[Vt]=null,pr=Wt[--Vt],Wt[Vt]=null,hr=Wt[--Vt],Wt[Vt]=null}var Mt=null,Bt=null,rt=!1,Jt=null;function rl(l,u){var p=Yt(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=l,u=l.deletions,u===null?(l.deletions=[p],l.flags|=16):u.push(p)}function nl(l,u){switch(l.tag){case 5:var p=l.type;return u=u.nodeType!==1||p.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Mt=l,Bt=Rr(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Mt=l,Bt=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(p=Gr!==null?{id:hr,overflow:pr}:null,l.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=Yt(18,null,null,0),p.stateNode=u,p.return=l,l.child=p,Mt=l,Bt=null,!0):!1;default:return!1}}function ai(l){return(l.mode&1)!==0&&(l.flags&128)===0}function ii(l){if(rt){var u=Bt;if(u){var p=u;if(!nl(l,u)){if(ai(l))throw Error(n(418));u=Rr(p.nextSibling);var x=Mt;u&&nl(l,u)?rl(x,p):(l.flags=l.flags&-4097|2,rt=!1,Mt=l)}}else{if(ai(l))throw Error(n(418));l.flags=l.flags&-4097|2,rt=!1,Mt=l}}}function sl(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Mt=l}function Xs(l){if(l!==Mt)return!1;if(!rt)return sl(l),rt=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!Ja(l.type,l.memoizedProps)),u&&(u=Bt)){if(ai(l))throw al(),Error(n(418));for(;u;)rl(l,u),u=Rr(u.nextSibling)}if(sl(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var p=l.data;if(p==="/$"){if(u===0){Bt=Rr(l.nextSibling);break e}u--}else p!=="$"&&p!=="$!"&&p!=="$?"||u++}l=l.nextSibling}Bt=null}}else Bt=Mt?Rr(l.stateNode.nextSibling):null;return!0}function al(){for(var l=Bt;l;)l=Rr(l.nextSibling)}function wn(){Bt=Mt=null,rt=!1}function oi(l){Jt===null?Jt=[l]:Jt.push(l)}var Pu=C.ReactCurrentBatchConfig;function ts(l,u,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(n(309));var x=p.stateNode}if(!x)throw Error(n(147,l));var E=x,S=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===S?u.ref:(u=function(R){var X=E.refs;R===null?delete X[S]:X[S]=R},u._stringRef=S,u)}if(typeof l!="string")throw Error(n(284));if(!p._owner)throw Error(n(290,l))}return l}function $s(l,u){throw l=Object.prototype.toString.call(u),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function il(l){var u=l._init;return u(l._payload)}function ol(l){function u(re,Z){if(l){var se=re.deletions;se===null?(re.deletions=[Z],re.flags|=16):se.push(Z)}}function p(re,Z){if(!l)return null;for(;Z!==null;)u(re,Z),Z=Z.sibling;return null}function x(re,Z){for(re=new Map;Z!==null;)Z.key!==null?re.set(Z.key,Z):re.set(Z.index,Z),Z=Z.sibling;return re}function E(re,Z){return re=Br(re,Z),re.index=0,re.sibling=null,re}function S(re,Z,se){return re.index=se,l?(se=re.alternate,se!==null?(se=se.index,se<Z?(re.flags|=2,Z):se):(re.flags|=2,Z)):(re.flags|=1048576,Z)}function R(re){return l&&re.alternate===null&&(re.flags|=2),re}function X(re,Z,se,Te){return Z===null||Z.tag!==6?(Z=Qi(se,re.mode,Te),Z.return=re,Z):(Z=E(Z,se),Z.return=re,Z)}function Q(re,Z,se,Te){var Oe=se.type;return Oe===N?we(re,Z,se.props.children,Te,se.key):Z!==null&&(Z.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===me&&il(Oe)===Z.type)?(Te=E(Z,se.props),Te.ref=ts(re,Z,se),Te.return=re,Te):(Te=xa(se.type,se.key,se.props,null,re.mode,Te),Te.ref=ts(re,Z,se),Te.return=re,Te)}function ue(re,Z,se,Te){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==se.containerInfo||Z.stateNode.implementation!==se.implementation?(Z=Zi(se,re.mode,Te),Z.return=re,Z):(Z=E(Z,se.children||[]),Z.return=re,Z)}function we(re,Z,se,Te,Oe){return Z===null||Z.tag!==7?(Z=nn(se,re.mode,Te,Oe),Z.return=re,Z):(Z=E(Z,se),Z.return=re,Z)}function Se(re,Z,se){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=Qi(""+Z,re.mode,se),Z.return=re,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case L:return se=xa(Z.type,Z.key,Z.props,null,re.mode,se),se.ref=ts(re,null,Z),se.return=re,se;case D:return Z=Zi(Z,re.mode,se),Z.return=re,Z;case me:var Te=Z._init;return Se(re,Te(Z._payload),se)}if(wt(Z)||J(Z))return Z=nn(Z,re.mode,se,null),Z.return=re,Z;$s(re,Z)}return null}function ye(re,Z,se,Te){var Oe=Z!==null?Z.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Oe!==null?null:X(re,Z,""+se,Te);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case L:return se.key===Oe?Q(re,Z,se,Te):null;case D:return se.key===Oe?ue(re,Z,se,Te):null;case me:return Oe=se._init,ye(re,Z,Oe(se._payload),Te)}if(wt(se)||J(se))return Oe!==null?null:we(re,Z,se,Te,null);$s(re,se)}return null}function Fe(re,Z,se,Te,Oe){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return re=re.get(se)||null,X(Z,re,""+Te,Oe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case L:return re=re.get(Te.key===null?se:Te.key)||null,Q(Z,re,Te,Oe);case D:return re=re.get(Te.key===null?se:Te.key)||null,ue(Z,re,Te,Oe);case me:var Ie=Te._init;return Fe(re,Z,se,Ie(Te._payload),Oe)}if(wt(Te)||J(Te))return re=re.get(se)||null,we(Z,re,Te,Oe,null);$s(Z,Te)}return null}function De(re,Z,se,Te){for(var Oe=null,Ie=null,Me=Z,Be=Z=0,gt=null;Me!==null&&Be<se.length;Be++){Me.index>Be?(gt=Me,Me=null):gt=Me.sibling;var $e=ye(re,Me,se[Be],Te);if($e===null){Me===null&&(Me=gt);break}l&&Me&&$e.alternate===null&&u(re,Me),Z=S($e,Z,Be),Ie===null?Oe=$e:Ie.sibling=$e,Ie=$e,Me=gt}if(Be===se.length)return p(re,Me),rt&&Kr(re,Be),Oe;if(Me===null){for(;Be<se.length;Be++)Me=Se(re,se[Be],Te),Me!==null&&(Z=S(Me,Z,Be),Ie===null?Oe=Me:Ie.sibling=Me,Ie=Me);return rt&&Kr(re,Be),Oe}for(Me=x(re,Me);Be<se.length;Be++)gt=Fe(Me,re,Be,se[Be],Te),gt!==null&&(l&&gt.alternate!==null&&Me.delete(gt.key===null?Be:gt.key),Z=S(gt,Z,Be),Ie===null?Oe=gt:Ie.sibling=gt,Ie=gt);return l&&Me.forEach(function(Ur){return u(re,Ur)}),rt&&Kr(re,Be),Oe}function Pe(re,Z,se,Te){var Oe=J(se);if(typeof Oe!="function")throw Error(n(150));if(se=Oe.call(se),se==null)throw Error(n(151));for(var Ie=Oe=null,Me=Z,Be=Z=0,gt=null,$e=se.next();Me!==null&&!$e.done;Be++,$e=se.next()){Me.index>Be?(gt=Me,Me=null):gt=Me.sibling;var Ur=ye(re,Me,$e.value,Te);if(Ur===null){Me===null&&(Me=gt);break}l&&Me&&Ur.alternate===null&&u(re,Me),Z=S(Ur,Z,Be),Ie===null?Oe=Ur:Ie.sibling=Ur,Ie=Ur,Me=gt}if($e.done)return p(re,Me),rt&&Kr(re,Be),Oe;if(Me===null){for(;!$e.done;Be++,$e=se.next())$e=Se(re,$e.value,Te),$e!==null&&(Z=S($e,Z,Be),Ie===null?Oe=$e:Ie.sibling=$e,Ie=$e);return rt&&Kr(re,Be),Oe}for(Me=x(re,Me);!$e.done;Be++,$e=se.next())$e=Fe(Me,re,Be,$e.value,Te),$e!==null&&(l&&$e.alternate!==null&&Me.delete($e.key===null?Be:$e.key),Z=S($e,Z,Be),Ie===null?Oe=$e:Ie.sibling=$e,Ie=$e);return l&&Me.forEach(function(hf){return u(re,hf)}),rt&&Kr(re,Be),Oe}function ct(re,Z,se,Te){if(typeof se=="object"&&se!==null&&se.type===N&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case L:e:{for(var Oe=se.key,Ie=Z;Ie!==null;){if(Ie.key===Oe){if(Oe=se.type,Oe===N){if(Ie.tag===7){p(re,Ie.sibling),Z=E(Ie,se.props.children),Z.return=re,re=Z;break e}}else if(Ie.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===me&&il(Oe)===Ie.type){p(re,Ie.sibling),Z=E(Ie,se.props),Z.ref=ts(re,Ie,se),Z.return=re,re=Z;break e}p(re,Ie);break}else u(re,Ie);Ie=Ie.sibling}se.type===N?(Z=nn(se.props.children,re.mode,Te,se.key),Z.return=re,re=Z):(Te=xa(se.type,se.key,se.props,null,re.mode,Te),Te.ref=ts(re,Z,se),Te.return=re,re=Te)}return R(re);case D:e:{for(Ie=se.key;Z!==null;){if(Z.key===Ie)if(Z.tag===4&&Z.stateNode.containerInfo===se.containerInfo&&Z.stateNode.implementation===se.implementation){p(re,Z.sibling),Z=E(Z,se.children||[]),Z.return=re,re=Z;break e}else{p(re,Z);break}else u(re,Z);Z=Z.sibling}Z=Zi(se,re.mode,Te),Z.return=re,re=Z}return R(re);case me:return Ie=se._init,ct(re,Z,Ie(se._payload),Te)}if(wt(se))return De(re,Z,se,Te);if(J(se))return Pe(re,Z,se,Te);$s(re,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Z!==null&&Z.tag===6?(p(re,Z.sibling),Z=E(Z,se),Z.return=re,re=Z):(p(re,Z),Z=Qi(se,re.mode,Te),Z.return=re,re=Z),R(re)):p(re,Z)}return ct}var En=ol(!0),ll=ol(!1),Ys=Fr(null),Gs=null,Sn=null,li=null;function ci(){li=Sn=Gs=null}function ui(l){var u=Ys.current;et(Ys),l._currentValue=u}function fi(l,u,p){for(;l!==null;){var x=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),l===p)break;l=l.return}}function kn(l,u){Gs=l,li=Sn=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(Pt=!0),l.firstContext=null)}function Ht(l){var u=l._currentValue;if(li!==l)if(l={context:l,memoizedValue:u,next:null},Sn===null){if(Gs===null)throw Error(n(308));Sn=l,Gs.dependencies={lanes:0,firstContext:l}}else Sn=Sn.next=l;return u}var qr=null;function di(l){qr===null?qr=[l]:qr.push(l)}function cl(l,u,p,x){var E=u.interleaved;return E===null?(p.next=p,di(u)):(p.next=E.next,E.next=p),u.interleaved=p,mr(l,x)}function mr(l,u){l.lanes|=u;var p=l.alternate;for(p!==null&&(p.lanes|=u),p=l,l=l.return;l!==null;)l.childLanes|=u,p=l.alternate,p!==null&&(p.childLanes|=u),p=l,l=l.return;return p.tag===3?p.stateNode:null}var Dr=!1;function hi(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ul(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function xr(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function Pr(l,u,p){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(He&2)!==0){var E=x.pending;return E===null?u.next=u:(u.next=E.next,E.next=u),x.pending=u,mr(l,p)}return E=x.interleaved,E===null?(u.next=u,di(x)):(u.next=E.next,E.next=u),x.interleaved=u,mr(l,p)}function Ks(l,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var x=u.lanes;x&=l.pendingLanes,p|=x,u.lanes=p,Ca(l,p)}}function fl(l,u){var p=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var E=null,S=null;if(p=p.firstBaseUpdate,p!==null){do{var R={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};S===null?E=S=R:S=S.next=R,p=p.next}while(p!==null);S===null?E=S=u:S=S.next=u}else E=S=u;p={baseState:x.baseState,firstBaseUpdate:E,lastBaseUpdate:S,shared:x.shared,effects:x.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=u:l.next=u,p.lastBaseUpdate=u}function qs(l,u,p,x){var E=l.updateQueue;Dr=!1;var S=E.firstBaseUpdate,R=E.lastBaseUpdate,X=E.shared.pending;if(X!==null){E.shared.pending=null;var Q=X,ue=Q.next;Q.next=null,R===null?S=ue:R.next=ue,R=Q;var we=l.alternate;we!==null&&(we=we.updateQueue,X=we.lastBaseUpdate,X!==R&&(X===null?we.firstBaseUpdate=ue:X.next=ue,we.lastBaseUpdate=Q))}if(S!==null){var Se=E.baseState;R=0,we=ue=Q=null,X=S;do{var ye=X.lane,Fe=X.eventTime;if((x&ye)===ye){we!==null&&(we=we.next={eventTime:Fe,lane:0,tag:X.tag,payload:X.payload,callback:X.callback,next:null});e:{var De=l,Pe=X;switch(ye=u,Fe=p,Pe.tag){case 1:if(De=Pe.payload,typeof De=="function"){Se=De.call(Fe,Se,ye);break e}Se=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Pe.payload,ye=typeof De=="function"?De.call(Fe,Se,ye):De,ye==null)break e;Se=fe({},Se,ye);break e;case 2:Dr=!0}}X.callback!==null&&X.lane!==0&&(l.flags|=64,ye=E.effects,ye===null?E.effects=[X]:ye.push(X))}else Fe={eventTime:Fe,lane:ye,tag:X.tag,payload:X.payload,callback:X.callback,next:null},we===null?(ue=we=Fe,Q=Se):we=we.next=Fe,R|=ye;if(X=X.next,X===null){if(X=E.shared.pending,X===null)break;ye=X,X=ye.next,ye.next=null,E.lastBaseUpdate=ye,E.shared.pending=null}}while(!0);if(we===null&&(Q=Se),E.baseState=Q,E.firstBaseUpdate=ue,E.lastBaseUpdate=we,u=E.shared.interleaved,u!==null){E=u;do R|=E.lane,E=E.next;while(E!==u)}else S===null&&(E.shared.lanes=0);Zr|=R,l.lanes=R,l.memoizedState=Se}}function dl(l,u,p){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var x=l[u],E=x.callback;if(E!==null){if(x.callback=null,x=p,typeof E!="function")throw Error(n(191,E));E.call(x)}}}var rs={},ar=Fr(rs),ns=Fr(rs),ss=Fr(rs);function Jr(l){if(l===rs)throw Error(n(174));return l}function pi(l,u){switch(Qe(ss,u),Qe(ns,l),Qe(ar,rs),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:cr(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=cr(u,l)}et(ar),Qe(ar,u)}function bn(){et(ar),et(ns),et(ss)}function hl(l){Jr(ss.current);var u=Jr(ar.current),p=cr(u,l.type);u!==p&&(Qe(ns,l),Qe(ar,p))}function mi(l){ns.current===l&&(et(ar),et(ns))}var nt=Fr(0);function Js(l){for(var u=l;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var xi=[];function gi(){for(var l=0;l<xi.length;l++)xi[l]._workInProgressVersionPrimary=null;xi.length=0}var Qs=C.ReactCurrentDispatcher,_i=C.ReactCurrentBatchConfig,Qr=0,st=null,dt=null,mt=null,Zs=!1,as=!1,is=0,Lu=0;function bt(){throw Error(n(321))}function vi(l,u){if(u===null)return!1;for(var p=0;p<u.length&&p<l.length;p++)if(!qt(l[p],u[p]))return!1;return!0}function yi(l,u,p,x,E,S){if(Qr=S,st=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Qs.current=l===null||l.memoizedState===null?Mu:Bu,l=p(x,E),as){S=0;do{if(as=!1,is=0,25<=S)throw Error(n(301));S+=1,mt=dt=null,u.updateQueue=null,Qs.current=Uu,l=p(x,E)}while(as)}if(Qs.current=ra,u=dt!==null&&dt.next!==null,Qr=0,mt=dt=st=null,Zs=!1,u)throw Error(n(300));return l}function wi(){var l=is!==0;return is=0,l}function ir(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?st.memoizedState=mt=l:mt=mt.next=l,mt}function Xt(){if(dt===null){var l=st.alternate;l=l!==null?l.memoizedState:null}else l=dt.next;var u=mt===null?st.memoizedState:mt.next;if(u!==null)mt=u,dt=l;else{if(l===null)throw Error(n(310));dt=l,l={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},mt===null?st.memoizedState=mt=l:mt=mt.next=l}return mt}function os(l,u){return typeof u=="function"?u(l):u}function Ei(l){var u=Xt(),p=u.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=l;var x=dt,E=x.baseQueue,S=p.pending;if(S!==null){if(E!==null){var R=E.next;E.next=S.next,S.next=R}x.baseQueue=E=S,p.pending=null}if(E!==null){S=E.next,x=x.baseState;var X=R=null,Q=null,ue=S;do{var we=ue.lane;if((Qr&we)===we)Q!==null&&(Q=Q.next={lane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),x=ue.hasEagerState?ue.eagerState:l(x,ue.action);else{var Se={lane:we,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null};Q===null?(X=Q=Se,R=x):Q=Q.next=Se,st.lanes|=we,Zr|=we}ue=ue.next}while(ue!==null&&ue!==S);Q===null?R=x:Q.next=X,qt(x,u.memoizedState)||(Pt=!0),u.memoizedState=x,u.baseState=R,u.baseQueue=Q,p.lastRenderedState=x}if(l=p.interleaved,l!==null){E=l;do S=E.lane,st.lanes|=S,Zr|=S,E=E.next;while(E!==l)}else E===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function Si(l){var u=Xt(),p=u.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=l;var x=p.dispatch,E=p.pending,S=u.memoizedState;if(E!==null){p.pending=null;var R=E=E.next;do S=l(S,R.action),R=R.next;while(R!==E);qt(S,u.memoizedState)||(Pt=!0),u.memoizedState=S,u.baseQueue===null&&(u.baseState=S),p.lastRenderedState=S}return[S,x]}function pl(){}function ml(l,u){var p=st,x=Xt(),E=u(),S=!qt(x.memoizedState,E);if(S&&(x.memoizedState=E,Pt=!0),x=x.queue,ki(_l.bind(null,p,x,l),[l]),x.getSnapshot!==u||S||mt!==null&&mt.memoizedState.tag&1){if(p.flags|=2048,ls(9,gl.bind(null,p,x,E,u),void 0,null),xt===null)throw Error(n(349));(Qr&30)!==0||xl(p,u,E)}return E}function xl(l,u,p){l.flags|=16384,l={getSnapshot:u,value:p},u=st.updateQueue,u===null?(u={lastEffect:null,stores:null},st.updateQueue=u,u.stores=[l]):(p=u.stores,p===null?u.stores=[l]:p.push(l))}function gl(l,u,p,x){u.value=p,u.getSnapshot=x,vl(u)&&yl(l)}function _l(l,u,p){return p(function(){vl(u)&&yl(l)})}function vl(l){var u=l.getSnapshot;l=l.value;try{var p=u();return!qt(l,p)}catch{return!0}}function yl(l){var u=mr(l,1);u!==null&&tr(u,l,1,-1)}function wl(l){var u=ir();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:l},u.queue=l,l=l.dispatch=Iu.bind(null,st,l),[u.memoizedState,l]}function ls(l,u,p,x){return l={tag:l,create:u,destroy:p,deps:x,next:null},u=st.updateQueue,u===null?(u={lastEffect:null,stores:null},st.updateQueue=u,u.lastEffect=l.next=l):(p=u.lastEffect,p===null?u.lastEffect=l.next=l:(x=p.next,p.next=l,l.next=x,u.lastEffect=l)),l}function El(){return Xt().memoizedState}function ea(l,u,p,x){var E=ir();st.flags|=l,E.memoizedState=ls(1|u,p,void 0,x===void 0?null:x)}function ta(l,u,p,x){var E=Xt();x=x===void 0?null:x;var S=void 0;if(dt!==null){var R=dt.memoizedState;if(S=R.destroy,x!==null&&vi(x,R.deps)){E.memoizedState=ls(u,p,S,x);return}}st.flags|=l,E.memoizedState=ls(1|u,p,S,x)}function Sl(l,u){return ea(8390656,8,l,u)}function ki(l,u){return ta(2048,8,l,u)}function kl(l,u){return ta(4,2,l,u)}function bl(l,u){return ta(4,4,l,u)}function Tl(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function Cl(l,u,p){return p=p!=null?p.concat([l]):null,ta(4,4,Tl.bind(null,u,l),p)}function bi(){}function Rl(l,u){var p=Xt();u=u===void 0?null:u;var x=p.memoizedState;return x!==null&&u!==null&&vi(u,x[1])?x[0]:(p.memoizedState=[l,u],l)}function Fl(l,u){var p=Xt();u=u===void 0?null:u;var x=p.memoizedState;return x!==null&&u!==null&&vi(u,x[1])?x[0]:(l=l(),p.memoizedState=[l,u],l)}function Nl(l,u,p){return(Qr&21)===0?(l.baseState&&(l.baseState=!1,Pt=!0),l.memoizedState=p):(qt(p,u)||(p=ao(),st.lanes|=p,Zr|=p,l.baseState=!0),u)}function Ou(l,u){var p=Ge;Ge=p!==0&&4>p?p:4,l(!0);var x=_i.transition;_i.transition={};try{l(!1),u()}finally{Ge=p,_i.transition=x}}function Al(){return Xt().memoizedState}function ju(l,u,p){var x=Ir(l);if(p={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null},Dl(l))Pl(u,p);else if(p=cl(l,u,p,x),p!==null){var E=Ft();tr(p,l,x,E),Ll(p,u,x)}}function Iu(l,u,p){var x=Ir(l),E={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null};if(Dl(l))Pl(u,E);else{var S=l.alternate;if(l.lanes===0&&(S===null||S.lanes===0)&&(S=u.lastRenderedReducer,S!==null))try{var R=u.lastRenderedState,X=S(R,p);if(E.hasEagerState=!0,E.eagerState=X,qt(X,R)){var Q=u.interleaved;Q===null?(E.next=E,di(u)):(E.next=Q.next,Q.next=E),u.interleaved=E;return}}catch{}finally{}p=cl(l,u,E,x),p!==null&&(E=Ft(),tr(p,l,x,E),Ll(p,u,x))}}function Dl(l){var u=l.alternate;return l===st||u!==null&&u===st}function Pl(l,u){as=Zs=!0;var p=l.pending;p===null?u.next=u:(u.next=p.next,p.next=u),l.pending=u}function Ll(l,u,p){if((p&4194240)!==0){var x=u.lanes;x&=l.pendingLanes,p|=x,u.lanes=p,Ca(l,p)}}var ra={readContext:Ht,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useInsertionEffect:bt,useLayoutEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useMutableSource:bt,useSyncExternalStore:bt,useId:bt,unstable_isNewReconciler:!1},Mu={readContext:Ht,useCallback:function(l,u){return ir().memoizedState=[l,u===void 0?null:u],l},useContext:Ht,useEffect:Sl,useImperativeHandle:function(l,u,p){return p=p!=null?p.concat([l]):null,ea(4194308,4,Tl.bind(null,u,l),p)},useLayoutEffect:function(l,u){return ea(4194308,4,l,u)},useInsertionEffect:function(l,u){return ea(4,2,l,u)},useMemo:function(l,u){var p=ir();return u=u===void 0?null:u,l=l(),p.memoizedState=[l,u],l},useReducer:function(l,u,p){var x=ir();return u=p!==void 0?p(u):u,x.memoizedState=x.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},x.queue=l,l=l.dispatch=ju.bind(null,st,l),[x.memoizedState,l]},useRef:function(l){var u=ir();return l={current:l},u.memoizedState=l},useState:wl,useDebugValue:bi,useDeferredValue:function(l){return ir().memoizedState=l},useTransition:function(){var l=wl(!1),u=l[0];return l=Ou.bind(null,l[1]),ir().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,p){var x=st,E=ir();if(rt){if(p===void 0)throw Error(n(407));p=p()}else{if(p=u(),xt===null)throw Error(n(349));(Qr&30)!==0||xl(x,u,p)}E.memoizedState=p;var S={value:p,getSnapshot:u};return E.queue=S,Sl(_l.bind(null,x,S,l),[l]),x.flags|=2048,ls(9,gl.bind(null,x,S,p,u),void 0,null),p},useId:function(){var l=ir(),u=xt.identifierPrefix;if(rt){var p=pr,x=hr;p=(x&~(1<<32-lt(x)-1)).toString(32)+p,u=":"+u+"R"+p,p=is++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=Lu++,u=":"+u+"r"+p.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},Bu={readContext:Ht,useCallback:Rl,useContext:Ht,useEffect:ki,useImperativeHandle:Cl,useInsertionEffect:kl,useLayoutEffect:bl,useMemo:Fl,useReducer:Ei,useRef:El,useState:function(){return Ei(os)},useDebugValue:bi,useDeferredValue:function(l){var u=Xt();return Nl(u,dt.memoizedState,l)},useTransition:function(){var l=Ei(os)[0],u=Xt().memoizedState;return[l,u]},useMutableSource:pl,useSyncExternalStore:ml,useId:Al,unstable_isNewReconciler:!1},Uu={readContext:Ht,useCallback:Rl,useContext:Ht,useEffect:ki,useImperativeHandle:Cl,useInsertionEffect:kl,useLayoutEffect:bl,useMemo:Fl,useReducer:Si,useRef:El,useState:function(){return Si(os)},useDebugValue:bi,useDeferredValue:function(l){var u=Xt();return dt===null?u.memoizedState=l:Nl(u,dt.memoizedState,l)},useTransition:function(){var l=Si(os)[0],u=Xt().memoizedState;return[l,u]},useMutableSource:pl,useSyncExternalStore:ml,useId:Al,unstable_isNewReconciler:!1};function Qt(l,u){if(l&&l.defaultProps){u=fe({},u),l=l.defaultProps;for(var p in l)u[p]===void 0&&(u[p]=l[p]);return u}return u}function Ti(l,u,p,x){u=l.memoizedState,p=p(x,u),p=p==null?u:fe({},u,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var na={isMounted:function(l){return(l=l._reactInternals)?H(l)===l:!1},enqueueSetState:function(l,u,p){l=l._reactInternals;var x=Ft(),E=Ir(l),S=xr(x,E);S.payload=u,p!=null&&(S.callback=p),u=Pr(l,S,E),u!==null&&(tr(u,l,E,x),Ks(u,l,E))},enqueueReplaceState:function(l,u,p){l=l._reactInternals;var x=Ft(),E=Ir(l),S=xr(x,E);S.tag=1,S.payload=u,p!=null&&(S.callback=p),u=Pr(l,S,E),u!==null&&(tr(u,l,E,x),Ks(u,l,E))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var p=Ft(),x=Ir(l),E=xr(p,x);E.tag=2,u!=null&&(E.callback=u),u=Pr(l,E,x),u!==null&&(tr(u,l,x,p),Ks(u,l,x))}};function Ol(l,u,p,x,E,S,R){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,S,R):u.prototype&&u.prototype.isPureReactComponent?!Gn(p,x)||!Gn(E,S):!0}function jl(l,u,p){var x=!1,E=Nr,S=u.contextType;return typeof S=="object"&&S!==null?S=Ht(S):(E=Dt(u)?Yr:kt.current,x=u.contextTypes,S=(x=x!=null)?_n(l,E):Nr),u=new u(p,S),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=na,l.stateNode=u,u._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=S),u}function Il(l,u,p,x){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,x),u.state!==l&&na.enqueueReplaceState(u,u.state,null)}function Ci(l,u,p,x){var E=l.stateNode;E.props=p,E.state=l.memoizedState,E.refs={},hi(l);var S=u.contextType;typeof S=="object"&&S!==null?E.context=Ht(S):(S=Dt(u)?Yr:kt.current,E.context=_n(l,S)),E.state=l.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Ti(l,u,S,p),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&na.enqueueReplaceState(E,E.state,null),qs(l,p,E,x),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function Tn(l,u){try{var p="",x=u;do p+=V(x),x=x.return;while(x);var E=p}catch(S){E=`
Error generating stack: `+S.message+`
`+S.stack}return{value:l,source:u,stack:E,digest:null}}function Ri(l,u,p){return{value:l,source:null,stack:p??null,digest:u??null}}function Fi(l,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var zu=typeof WeakMap=="function"?WeakMap:Map;function Ml(l,u,p){p=xr(-1,p),p.tag=3,p.payload={element:null};var x=u.value;return p.callback=function(){ua||(ua=!0,Hi=x),Fi(l,u)},p}function Bl(l,u,p){p=xr(-1,p),p.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var E=u.value;p.payload=function(){return x(E)},p.callback=function(){Fi(l,u)}}var S=l.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(p.callback=function(){Fi(l,u),typeof x!="function"&&(Or===null?Or=new Set([this]):Or.add(this));var R=u.stack;this.componentDidCatch(u.value,{componentStack:R!==null?R:""})}),p}function Ul(l,u,p){var x=l.pingCache;if(x===null){x=l.pingCache=new zu;var E=new Set;x.set(u,E)}else E=x.get(u),E===void 0&&(E=new Set,x.set(u,E));E.has(p)||(E.add(p),l=tf.bind(null,l,u,p),u.then(l,l))}function zl(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function Wl(l,u,p,x,E){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=xr(-1,1),u.tag=2,Pr(p,u,1))),p.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var Wu=C.ReactCurrentOwner,Pt=!1;function Rt(l,u,p,x){u.child=l===null?ll(u,null,p,x):En(u,l.child,p,x)}function Vl(l,u,p,x,E){p=p.render;var S=u.ref;return kn(u,E),x=yi(l,u,p,x,S,E),p=wi(),l!==null&&!Pt?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,gr(l,u,E)):(rt&&p&&ni(u),u.flags|=1,Rt(l,u,x,E),u.child)}function Hl(l,u,p,x,E){if(l===null){var S=p.type;return typeof S=="function"&&!Ji(S)&&S.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=S,Xl(l,u,S,x,E)):(l=xa(p.type,null,x,u,u.mode,E),l.ref=u.ref,l.return=u,u.child=l)}if(S=l.child,(l.lanes&E)===0){var R=S.memoizedProps;if(p=p.compare,p=p!==null?p:Gn,p(R,x)&&l.ref===u.ref)return gr(l,u,E)}return u.flags|=1,l=Br(S,x),l.ref=u.ref,l.return=u,u.child=l}function Xl(l,u,p,x,E){if(l!==null){var S=l.memoizedProps;if(Gn(S,x)&&l.ref===u.ref)if(Pt=!1,u.pendingProps=x=S,(l.lanes&E)!==0)(l.flags&131072)!==0&&(Pt=!0);else return u.lanes=l.lanes,gr(l,u,E)}return Ni(l,u,p,x,E)}function $l(l,u,p){var x=u.pendingProps,E=x.children,S=l!==null?l.memoizedState:null;if(x.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Rn,Ut),Ut|=p;else{if((p&1073741824)===0)return l=S!==null?S.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Qe(Rn,Ut),Ut|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=S!==null?S.baseLanes:p,Qe(Rn,Ut),Ut|=x}else S!==null?(x=S.baseLanes|p,u.memoizedState=null):x=p,Qe(Rn,Ut),Ut|=x;return Rt(l,u,E,p),u.child}function Yl(l,u){var p=u.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function Ni(l,u,p,x,E){var S=Dt(p)?Yr:kt.current;return S=_n(u,S),kn(u,E),p=yi(l,u,p,x,S,E),x=wi(),l!==null&&!Pt?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,gr(l,u,E)):(rt&&x&&ni(u),u.flags|=1,Rt(l,u,p,E),u.child)}function Gl(l,u,p,x,E){if(Dt(p)){var S=!0;zs(u)}else S=!1;if(kn(u,E),u.stateNode===null)aa(l,u),jl(u,p,x),Ci(u,p,x,E),x=!0;else if(l===null){var R=u.stateNode,X=u.memoizedProps;R.props=X;var Q=R.context,ue=p.contextType;typeof ue=="object"&&ue!==null?ue=Ht(ue):(ue=Dt(p)?Yr:kt.current,ue=_n(u,ue));var we=p.getDerivedStateFromProps,Se=typeof we=="function"||typeof R.getSnapshotBeforeUpdate=="function";Se||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(X!==x||Q!==ue)&&Il(u,R,x,ue),Dr=!1;var ye=u.memoizedState;R.state=ye,qs(u,x,R,E),Q=u.memoizedState,X!==x||ye!==Q||At.current||Dr?(typeof we=="function"&&(Ti(u,p,we,x),Q=u.memoizedState),(X=Dr||Ol(u,p,X,x,ye,Q,ue))?(Se||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(u.flags|=4194308)):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=Q),R.props=x,R.state=Q,R.context=ue,x=X):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{R=u.stateNode,ul(l,u),X=u.memoizedProps,ue=u.type===u.elementType?X:Qt(u.type,X),R.props=ue,Se=u.pendingProps,ye=R.context,Q=p.contextType,typeof Q=="object"&&Q!==null?Q=Ht(Q):(Q=Dt(p)?Yr:kt.current,Q=_n(u,Q));var Fe=p.getDerivedStateFromProps;(we=typeof Fe=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(X!==Se||ye!==Q)&&Il(u,R,x,Q),Dr=!1,ye=u.memoizedState,R.state=ye,qs(u,x,R,E);var De=u.memoizedState;X!==Se||ye!==De||At.current||Dr?(typeof Fe=="function"&&(Ti(u,p,Fe,x),De=u.memoizedState),(ue=Dr||Ol(u,p,ue,x,ye,De,Q)||!1)?(we||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(x,De,Q),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(x,De,Q)),typeof R.componentDidUpdate=="function"&&(u.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof R.componentDidUpdate!="function"||X===l.memoizedProps&&ye===l.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&ye===l.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=De),R.props=x,R.state=De,R.context=Q,x=ue):(typeof R.componentDidUpdate!="function"||X===l.memoizedProps&&ye===l.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&ye===l.memoizedState||(u.flags|=1024),x=!1)}return Ai(l,u,p,x,S,E)}function Ai(l,u,p,x,E,S){Yl(l,u);var R=(u.flags&128)!==0;if(!x&&!R)return E&&Zo(u,p,!1),gr(l,u,S);x=u.stateNode,Wu.current=u;var X=R&&typeof p.getDerivedStateFromError!="function"?null:x.render();return u.flags|=1,l!==null&&R?(u.child=En(u,l.child,null,S),u.child=En(u,null,X,S)):Rt(l,u,X,S),u.memoizedState=x.state,E&&Zo(u,p,!0),u.child}function Kl(l){var u=l.stateNode;u.pendingContext?Jo(l,u.pendingContext,u.pendingContext!==u.context):u.context&&Jo(l,u.context,!1),pi(l,u.containerInfo)}function ql(l,u,p,x,E){return wn(),oi(E),u.flags|=256,Rt(l,u,p,x),u.child}var Di={dehydrated:null,treeContext:null,retryLane:0};function Pi(l){return{baseLanes:l,cachePool:null,transitions:null}}function Jl(l,u,p){var x=u.pendingProps,E=nt.current,S=!1,R=(u.flags&128)!==0,X;if((X=R)||(X=l!==null&&l.memoizedState===null?!1:(E&2)!==0),X?(S=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Qe(nt,E&1),l===null)return ii(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(R=x.children,l=x.fallback,S?(x=u.mode,S=u.child,R={mode:"hidden",children:R},(x&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=R):S=ga(R,x,0,null),l=nn(l,x,p,null),S.return=u,l.return=u,S.sibling=l,u.child=S,u.child.memoizedState=Pi(p),u.memoizedState=Di,l):Li(u,R));if(E=l.memoizedState,E!==null&&(X=E.dehydrated,X!==null))return Vu(l,u,R,x,X,E,p);if(S){S=x.fallback,R=u.mode,E=l.child,X=E.sibling;var Q={mode:"hidden",children:x.children};return(R&1)===0&&u.child!==E?(x=u.child,x.childLanes=0,x.pendingProps=Q,u.deletions=null):(x=Br(E,Q),x.subtreeFlags=E.subtreeFlags&14680064),X!==null?S=Br(X,S):(S=nn(S,R,p,null),S.flags|=2),S.return=u,x.return=u,x.sibling=S,u.child=x,x=S,S=u.child,R=l.child.memoizedState,R=R===null?Pi(p):{baseLanes:R.baseLanes|p,cachePool:null,transitions:R.transitions},S.memoizedState=R,S.childLanes=l.childLanes&~p,u.memoizedState=Di,x}return S=l.child,l=S.sibling,x=Br(S,{mode:"visible",children:x.children}),(u.mode&1)===0&&(x.lanes=p),x.return=u,x.sibling=null,l!==null&&(p=u.deletions,p===null?(u.deletions=[l],u.flags|=16):p.push(l)),u.child=x,u.memoizedState=null,x}function Li(l,u){return u=ga({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function sa(l,u,p,x){return x!==null&&oi(x),En(u,l.child,null,p),l=Li(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Vu(l,u,p,x,E,S,R){if(p)return u.flags&256?(u.flags&=-257,x=Ri(Error(n(422))),sa(l,u,R,x)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(S=x.fallback,E=u.mode,x=ga({mode:"visible",children:x.children},E,0,null),S=nn(S,E,R,null),S.flags|=2,x.return=u,S.return=u,x.sibling=S,u.child=x,(u.mode&1)!==0&&En(u,l.child,null,R),u.child.memoizedState=Pi(R),u.memoizedState=Di,S);if((u.mode&1)===0)return sa(l,u,R,null);if(E.data==="$!"){if(x=E.nextSibling&&E.nextSibling.dataset,x)var X=x.dgst;return x=X,S=Error(n(419)),x=Ri(S,x,void 0),sa(l,u,R,x)}if(X=(R&l.childLanes)!==0,Pt||X){if(x=xt,x!==null){switch(R&-R){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(x.suspendedLanes|R))!==0?0:E,E!==0&&E!==S.retryLane&&(S.retryLane=E,mr(l,E),tr(x,l,E,-1))}return qi(),x=Ri(Error(n(421))),sa(l,u,R,x)}return E.data==="$?"?(u.flags|=128,u.child=l.child,u=rf.bind(null,l),E._reactRetry=u,null):(l=S.treeContext,Bt=Rr(E.nextSibling),Mt=u,rt=!0,Jt=null,l!==null&&(Wt[Vt++]=hr,Wt[Vt++]=pr,Wt[Vt++]=Gr,hr=l.id,pr=l.overflow,Gr=u),u=Li(u,x.children),u.flags|=4096,u)}function Ql(l,u,p){l.lanes|=u;var x=l.alternate;x!==null&&(x.lanes|=u),fi(l.return,u,p)}function Oi(l,u,p,x,E){var S=l.memoizedState;S===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:E}:(S.isBackwards=u,S.rendering=null,S.renderingStartTime=0,S.last=x,S.tail=p,S.tailMode=E)}function Zl(l,u,p){var x=u.pendingProps,E=x.revealOrder,S=x.tail;if(Rt(l,u,x.children,p),x=nt.current,(x&2)!==0)x=x&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Ql(l,p,u);else if(l.tag===19)Ql(l,p,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(Qe(nt,x),(u.mode&1)===0)u.memoizedState=null;else switch(E){case"forwards":for(p=u.child,E=null;p!==null;)l=p.alternate,l!==null&&Js(l)===null&&(E=p),p=p.sibling;p=E,p===null?(E=u.child,u.child=null):(E=p.sibling,p.sibling=null),Oi(u,!1,E,p,S);break;case"backwards":for(p=null,E=u.child,u.child=null;E!==null;){if(l=E.alternate,l!==null&&Js(l)===null){u.child=E;break}l=E.sibling,E.sibling=p,p=E,E=l}Oi(u,!0,p,null,S);break;case"together":Oi(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function aa(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function gr(l,u,p){if(l!==null&&(u.dependencies=l.dependencies),Zr|=u.lanes,(p&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(n(153));if(u.child!==null){for(l=u.child,p=Br(l,l.pendingProps),u.child=p,p.return=u;l.sibling!==null;)l=l.sibling,p=p.sibling=Br(l,l.pendingProps),p.return=u;p.sibling=null}return u.child}function Hu(l,u,p){switch(u.tag){case 3:Kl(u),wn();break;case 5:hl(u);break;case 1:Dt(u.type)&&zs(u);break;case 4:pi(u,u.stateNode.containerInfo);break;case 10:var x=u.type._context,E=u.memoizedProps.value;Qe(Ys,x._currentValue),x._currentValue=E;break;case 13:if(x=u.memoizedState,x!==null)return x.dehydrated!==null?(Qe(nt,nt.current&1),u.flags|=128,null):(p&u.child.childLanes)!==0?Jl(l,u,p):(Qe(nt,nt.current&1),l=gr(l,u,p),l!==null?l.sibling:null);Qe(nt,nt.current&1);break;case 19:if(x=(p&u.childLanes)!==0,(l.flags&128)!==0){if(x)return Zl(l,u,p);u.flags|=128}if(E=u.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Qe(nt,nt.current),x)break;return null;case 22:case 23:return u.lanes=0,$l(l,u,p)}return gr(l,u,p)}var ec,ji,tc,rc;ec=function(l,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)l.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},ji=function(){},tc=function(l,u,p,x){var E=l.memoizedProps;if(E!==x){l=u.stateNode,Jr(ar.current);var S=null;switch(p){case"input":E=Ve(l,E),x=Ve(l,x),S=[];break;case"select":E=fe({},E,{value:void 0}),x=fe({},x,{value:void 0}),S=[];break;case"textarea":E=lr(l,E),x=lr(l,x),S=[];break;default:typeof E.onClick!="function"&&typeof x.onClick=="function"&&(l.onclick=Ms)}An(p,x);var R;p=null;for(ue in E)if(!x.hasOwnProperty(ue)&&E.hasOwnProperty(ue)&&E[ue]!=null)if(ue==="style"){var X=E[ue];for(R in X)X.hasOwnProperty(R)&&(p||(p={}),p[R]="")}else ue!=="dangerouslySetInnerHTML"&&ue!=="children"&&ue!=="suppressContentEditableWarning"&&ue!=="suppressHydrationWarning"&&ue!=="autoFocus"&&(a.hasOwnProperty(ue)?S||(S=[]):(S=S||[]).push(ue,null));for(ue in x){var Q=x[ue];if(X=E!=null?E[ue]:void 0,x.hasOwnProperty(ue)&&Q!==X&&(Q!=null||X!=null))if(ue==="style")if(X){for(R in X)!X.hasOwnProperty(R)||Q&&Q.hasOwnProperty(R)||(p||(p={}),p[R]="");for(R in Q)Q.hasOwnProperty(R)&&X[R]!==Q[R]&&(p||(p={}),p[R]=Q[R])}else p||(S||(S=[]),S.push(ue,p)),p=Q;else ue==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,X=X?X.__html:void 0,Q!=null&&X!==Q&&(S=S||[]).push(ue,Q)):ue==="children"?typeof Q!="string"&&typeof Q!="number"||(S=S||[]).push(ue,""+Q):ue!=="suppressContentEditableWarning"&&ue!=="suppressHydrationWarning"&&(a.hasOwnProperty(ue)?(Q!=null&&ue==="onScroll"&&Ze("scroll",l),S||X===Q||(S=[])):(S=S||[]).push(ue,Q))}p&&(S=S||[]).push("style",p);var ue=S;(u.updateQueue=ue)&&(u.flags|=4)}},rc=function(l,u,p,x){p!==x&&(u.flags|=4)};function cs(l,u){if(!rt)switch(l.tailMode){case"hidden":u=l.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function Tt(l){var u=l.alternate!==null&&l.alternate.child===l.child,p=0,x=0;if(u)for(var E=l.child;E!==null;)p|=E.lanes|E.childLanes,x|=E.subtreeFlags&14680064,x|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)p|=E.lanes|E.childLanes,x|=E.subtreeFlags,x|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=x,l.childLanes=p,u}function Xu(l,u,p){var x=u.pendingProps;switch(si(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(u),null;case 1:return Dt(u.type)&&Us(),Tt(u),null;case 3:return x=u.stateNode,bn(),et(At),et(kt),gi(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(l===null||l.child===null)&&(Xs(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Jt!==null&&(Yi(Jt),Jt=null))),ji(l,u),Tt(u),null;case 5:mi(u);var E=Jr(ss.current);if(p=u.type,l!==null&&u.stateNode!=null)tc(l,u,p,x,E),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!x){if(u.stateNode===null)throw Error(n(166));return Tt(u),null}if(l=Jr(ar.current),Xs(u)){x=u.stateNode,p=u.type;var S=u.memoizedProps;switch(x[sr]=u,x[Zn]=S,l=(u.mode&1)!==0,p){case"dialog":Ze("cancel",x),Ze("close",x);break;case"iframe":case"object":case"embed":Ze("load",x);break;case"video":case"audio":for(E=0;E<qn.length;E++)Ze(qn[E],x);break;case"source":Ze("error",x);break;case"img":case"image":case"link":Ze("error",x),Ze("load",x);break;case"details":Ze("toggle",x);break;case"input":Ye(x,S),Ze("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!S.multiple},Ze("invalid",x);break;case"textarea":Gt(x,S),Ze("invalid",x)}An(p,S),E=null;for(var R in S)if(S.hasOwnProperty(R)){var X=S[R];R==="children"?typeof X=="string"?x.textContent!==X&&(S.suppressHydrationWarning!==!0&&Is(x.textContent,X,l),E=["children",X]):typeof X=="number"&&x.textContent!==""+X&&(S.suppressHydrationWarning!==!0&&Is(x.textContent,X,l),E=["children",""+X]):a.hasOwnProperty(R)&&X!=null&&R==="onScroll"&&Ze("scroll",x)}switch(p){case"input":je(x),tt(x,S,!0);break;case"textarea":je(x),zt(x);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(x.onclick=Ms)}x=E,u.updateQueue=x,x!==null&&(u.flags|=4)}else{R=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Kt(p)),l==="http://www.w3.org/1999/xhtml"?p==="script"?(l=R.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof x.is=="string"?l=R.createElement(p,{is:x.is}):(l=R.createElement(p),p==="select"&&(R=l,x.multiple?R.multiple=!0:x.size&&(R.size=x.size))):l=R.createElementNS(l,p),l[sr]=u,l[Zn]=x,ec(l,u,!1,!1),u.stateNode=l;e:{switch(R=Dn(p,x),p){case"dialog":Ze("cancel",l),Ze("close",l),E=x;break;case"iframe":case"object":case"embed":Ze("load",l),E=x;break;case"video":case"audio":for(E=0;E<qn.length;E++)Ze(qn[E],l);E=x;break;case"source":Ze("error",l),E=x;break;case"img":case"image":case"link":Ze("error",l),Ze("load",l),E=x;break;case"details":Ze("toggle",l),E=x;break;case"input":Ye(l,x),E=Ve(l,x),Ze("invalid",l);break;case"option":E=x;break;case"select":l._wrapperState={wasMultiple:!!x.multiple},E=fe({},x,{value:void 0}),Ze("invalid",l);break;case"textarea":Gt(l,x),E=lr(l,x),Ze("invalid",l);break;default:E=x}An(p,E),X=E;for(S in X)if(X.hasOwnProperty(S)){var Q=X[S];S==="style"?rr(l,Q):S==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&jt(l,Q)):S==="children"?typeof Q=="string"?(p!=="textarea"||Q!=="")&&ze(l,Q):typeof Q=="number"&&ze(l,""+Q):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(a.hasOwnProperty(S)?Q!=null&&S==="onScroll"&&Ze("scroll",l):Q!=null&&k(l,S,Q,R))}switch(p){case"input":je(l),tt(l,x,!1);break;case"textarea":je(l),zt(l);break;case"option":x.value!=null&&l.setAttribute("value",""+xe(x.value));break;case"select":l.multiple=!!x.multiple,S=x.value,S!=null?Et(l,!!x.multiple,S,!1):x.defaultValue!=null&&Et(l,!!x.multiple,x.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=Ms)}switch(p){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Tt(u),null;case 6:if(l&&u.stateNode!=null)rc(l,u,l.memoizedProps,x);else{if(typeof x!="string"&&u.stateNode===null)throw Error(n(166));if(p=Jr(ss.current),Jr(ar.current),Xs(u)){if(x=u.stateNode,p=u.memoizedProps,x[sr]=u,(S=x.nodeValue!==p)&&(l=Mt,l!==null))switch(l.tag){case 3:Is(x.nodeValue,p,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Is(x.nodeValue,p,(l.mode&1)!==0)}S&&(u.flags|=4)}else x=(p.nodeType===9?p:p.ownerDocument).createTextNode(x),x[sr]=u,u.stateNode=x}return Tt(u),null;case 13:if(et(nt),x=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(rt&&Bt!==null&&(u.mode&1)!==0&&(u.flags&128)===0)al(),wn(),u.flags|=98560,S=!1;else if(S=Xs(u),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[sr]=u}else wn(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Tt(u),S=!1}else Jt!==null&&(Yi(Jt),Jt=null),S=!0;if(!S)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=p,u):(x=x!==null,x!==(l!==null&&l.memoizedState!==null)&&x&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(nt.current&1)!==0?ht===0&&(ht=3):qi())),u.updateQueue!==null&&(u.flags|=4),Tt(u),null);case 4:return bn(),ji(l,u),l===null&&Jn(u.stateNode.containerInfo),Tt(u),null;case 10:return ui(u.type._context),Tt(u),null;case 17:return Dt(u.type)&&Us(),Tt(u),null;case 19:if(et(nt),S=u.memoizedState,S===null)return Tt(u),null;if(x=(u.flags&128)!==0,R=S.rendering,R===null)if(x)cs(S,!1);else{if(ht!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(R=Js(l),R!==null){for(u.flags|=128,cs(S,!1),x=R.updateQueue,x!==null&&(u.updateQueue=x,u.flags|=4),u.subtreeFlags=0,x=p,p=u.child;p!==null;)S=p,l=x,S.flags&=14680066,R=S.alternate,R===null?(S.childLanes=0,S.lanes=l,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=R.childLanes,S.lanes=R.lanes,S.child=R.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=R.memoizedProps,S.memoizedState=R.memoizedState,S.updateQueue=R.updateQueue,S.type=R.type,l=R.dependencies,S.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),p=p.sibling;return Qe(nt,nt.current&1|2),u.child}l=l.sibling}S.tail!==null&&ke()>Fn&&(u.flags|=128,x=!0,cs(S,!1),u.lanes=4194304)}else{if(!x)if(l=Js(R),l!==null){if(u.flags|=128,x=!0,p=l.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),cs(S,!0),S.tail===null&&S.tailMode==="hidden"&&!R.alternate&&!rt)return Tt(u),null}else 2*ke()-S.renderingStartTime>Fn&&p!==1073741824&&(u.flags|=128,x=!0,cs(S,!1),u.lanes=4194304);S.isBackwards?(R.sibling=u.child,u.child=R):(p=S.last,p!==null?p.sibling=R:u.child=R,S.last=R)}return S.tail!==null?(u=S.tail,S.rendering=u,S.tail=u.sibling,S.renderingStartTime=ke(),u.sibling=null,p=nt.current,Qe(nt,x?p&1|2:p&1),u):(Tt(u),null);case 22:case 23:return Ki(),x=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==x&&(u.flags|=8192),x&&(u.mode&1)!==0?(Ut&1073741824)!==0&&(Tt(u),u.subtreeFlags&6&&(u.flags|=8192)):Tt(u),null;case 24:return null;case 25:return null}throw Error(n(156,u.tag))}function $u(l,u){switch(si(u),u.tag){case 1:return Dt(u.type)&&Us(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return bn(),et(At),et(kt),gi(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return mi(u),null;case 13:if(et(nt),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(n(340));wn()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return et(nt),null;case 4:return bn(),null;case 10:return ui(u.type._context),null;case 22:case 23:return Ki(),null;case 24:return null;default:return null}}var ia=!1,Ct=!1,Yu=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Cn(l,u){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(x){it(l,u,x)}else p.current=null}function Ii(l,u,p){try{p()}catch(x){it(l,u,x)}}var nc=!1;function Gu(l,u){if(Ka=Ts,l=Oo(),za(l)){if("selectionStart"in l)var p={start:l.selectionStart,end:l.selectionEnd};else e:{p=(p=l.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var E=x.anchorOffset,S=x.focusNode;x=x.focusOffset;try{p.nodeType,S.nodeType}catch{p=null;break e}var R=0,X=-1,Q=-1,ue=0,we=0,Se=l,ye=null;t:for(;;){for(var Fe;Se!==p||E!==0&&Se.nodeType!==3||(X=R+E),Se!==S||x!==0&&Se.nodeType!==3||(Q=R+x),Se.nodeType===3&&(R+=Se.nodeValue.length),(Fe=Se.firstChild)!==null;)ye=Se,Se=Fe;for(;;){if(Se===l)break t;if(ye===p&&++ue===E&&(X=R),ye===S&&++we===x&&(Q=R),(Fe=Se.nextSibling)!==null)break;Se=ye,ye=Se.parentNode}Se=Fe}p=X===-1||Q===-1?null:{start:X,end:Q}}else p=null}p=p||{start:0,end:0}}else p=null;for(qa={focusedElem:l,selectionRange:p},Ts=!1,Ae=u;Ae!==null;)if(u=Ae,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ae=l;else for(;Ae!==null;){u=Ae;try{var De=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(De!==null){var Pe=De.memoizedProps,ct=De.memoizedState,re=u.stateNode,Z=re.getSnapshotBeforeUpdate(u.elementType===u.type?Pe:Qt(u.type,Pe),ct);re.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var se=u.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Te){it(u,u.return,Te)}if(l=u.sibling,l!==null){l.return=u.return,Ae=l;break}Ae=u.return}return De=nc,nc=!1,De}function us(l,u,p){var x=u.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var E=x=x.next;do{if((E.tag&l)===l){var S=E.destroy;E.destroy=void 0,S!==void 0&&Ii(u,p,S)}E=E.next}while(E!==x)}}function oa(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&l)===l){var x=p.create;p.destroy=x()}p=p.next}while(p!==u)}}function Mi(l){var u=l.ref;if(u!==null){var p=l.stateNode;switch(l.tag){case 5:l=p;break;default:l=p}typeof u=="function"?u(l):u.current=l}}function sc(l){var u=l.alternate;u!==null&&(l.alternate=null,sc(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[sr],delete u[Zn],delete u[ei],delete u[Nu],delete u[Au])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function ac(l){return l.tag===5||l.tag===3||l.tag===4}function ic(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||ac(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Bi(l,u,p){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?p.nodeType===8?p.parentNode.insertBefore(l,u):p.insertBefore(l,u):(p.nodeType===8?(u=p.parentNode,u.insertBefore(l,p)):(u=p,u.appendChild(l)),p=p._reactRootContainer,p!=null||u.onclick!==null||(u.onclick=Ms));else if(x!==4&&(l=l.child,l!==null))for(Bi(l,u,p),l=l.sibling;l!==null;)Bi(l,u,p),l=l.sibling}function Ui(l,u,p){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?p.insertBefore(l,u):p.appendChild(l);else if(x!==4&&(l=l.child,l!==null))for(Ui(l,u,p),l=l.sibling;l!==null;)Ui(l,u,p),l=l.sibling}var _t=null,Zt=!1;function Lr(l,u,p){for(p=p.child;p!==null;)oc(l,u,p),p=p.sibling}function oc(l,u,p){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(nr,p)}catch{}switch(p.tag){case 5:Ct||Cn(p,u);case 6:var x=_t,E=Zt;_t=null,Lr(l,u,p),_t=x,Zt=E,_t!==null&&(Zt?(l=_t,p=p.stateNode,l.nodeType===8?l.parentNode.removeChild(p):l.removeChild(p)):_t.removeChild(p.stateNode));break;case 18:_t!==null&&(Zt?(l=_t,p=p.stateNode,l.nodeType===8?Za(l.parentNode,p):l.nodeType===1&&Za(l,p),Wn(l)):Za(_t,p.stateNode));break;case 4:x=_t,E=Zt,_t=p.stateNode.containerInfo,Zt=!0,Lr(l,u,p),_t=x,Zt=E;break;case 0:case 11:case 14:case 15:if(!Ct&&(x=p.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){E=x=x.next;do{var S=E,R=S.destroy;S=S.tag,R!==void 0&&((S&2)!==0||(S&4)!==0)&&Ii(p,u,R),E=E.next}while(E!==x)}Lr(l,u,p);break;case 1:if(!Ct&&(Cn(p,u),x=p.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=p.memoizedProps,x.state=p.memoizedState,x.componentWillUnmount()}catch(X){it(p,u,X)}Lr(l,u,p);break;case 21:Lr(l,u,p);break;case 22:p.mode&1?(Ct=(x=Ct)||p.memoizedState!==null,Lr(l,u,p),Ct=x):Lr(l,u,p);break;default:Lr(l,u,p)}}function lc(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new Yu),u.forEach(function(x){var E=nf.bind(null,l,x);p.has(x)||(p.add(x),x.then(E,E))})}}function er(l,u){var p=u.deletions;if(p!==null)for(var x=0;x<p.length;x++){var E=p[x];try{var S=l,R=u,X=R;e:for(;X!==null;){switch(X.tag){case 5:_t=X.stateNode,Zt=!1;break e;case 3:_t=X.stateNode.containerInfo,Zt=!0;break e;case 4:_t=X.stateNode.containerInfo,Zt=!0;break e}X=X.return}if(_t===null)throw Error(n(160));oc(S,R,E),_t=null,Zt=!1;var Q=E.alternate;Q!==null&&(Q.return=null),E.return=null}catch(ue){it(E,u,ue)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)cc(u,l),u=u.sibling}function cc(l,u){var p=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(er(u,l),or(l),x&4){try{us(3,l,l.return),oa(3,l)}catch(Pe){it(l,l.return,Pe)}try{us(5,l,l.return)}catch(Pe){it(l,l.return,Pe)}}break;case 1:er(u,l),or(l),x&512&&p!==null&&Cn(p,p.return);break;case 5:if(er(u,l),or(l),x&512&&p!==null&&Cn(p,p.return),l.flags&32){var E=l.stateNode;try{ze(E,"")}catch(Pe){it(l,l.return,Pe)}}if(x&4&&(E=l.stateNode,E!=null)){var S=l.memoizedProps,R=p!==null?p.memoizedProps:S,X=l.type,Q=l.updateQueue;if(l.updateQueue=null,Q!==null)try{X==="input"&&S.type==="radio"&&S.name!=null&&We(E,S),Dn(X,R);var ue=Dn(X,S);for(R=0;R<Q.length;R+=2){var we=Q[R],Se=Q[R+1];we==="style"?rr(E,Se):we==="dangerouslySetInnerHTML"?jt(E,Se):we==="children"?ze(E,Se):k(E,we,Se,ue)}switch(X){case"input":Re(E,S);break;case"textarea":St(E,S);break;case"select":var ye=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!S.multiple;var Fe=S.value;Fe!=null?Et(E,!!S.multiple,Fe,!1):ye!==!!S.multiple&&(S.defaultValue!=null?Et(E,!!S.multiple,S.defaultValue,!0):Et(E,!!S.multiple,S.multiple?[]:"",!1))}E[Zn]=S}catch(Pe){it(l,l.return,Pe)}}break;case 6:if(er(u,l),or(l),x&4){if(l.stateNode===null)throw Error(n(162));E=l.stateNode,S=l.memoizedProps;try{E.nodeValue=S}catch(Pe){it(l,l.return,Pe)}}break;case 3:if(er(u,l),or(l),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Wn(u.containerInfo)}catch(Pe){it(l,l.return,Pe)}break;case 4:er(u,l),or(l);break;case 13:er(u,l),or(l),E=l.child,E.flags&8192&&(S=E.memoizedState!==null,E.stateNode.isHidden=S,!S||E.alternate!==null&&E.alternate.memoizedState!==null||(Vi=ke())),x&4&&lc(l);break;case 22:if(we=p!==null&&p.memoizedState!==null,l.mode&1?(Ct=(ue=Ct)||we,er(u,l),Ct=ue):er(u,l),or(l),x&8192){if(ue=l.memoizedState!==null,(l.stateNode.isHidden=ue)&&!we&&(l.mode&1)!==0)for(Ae=l,we=l.child;we!==null;){for(Se=Ae=we;Ae!==null;){switch(ye=Ae,Fe=ye.child,ye.tag){case 0:case 11:case 14:case 15:us(4,ye,ye.return);break;case 1:Cn(ye,ye.return);var De=ye.stateNode;if(typeof De.componentWillUnmount=="function"){x=ye,p=ye.return;try{u=x,De.props=u.memoizedProps,De.state=u.memoizedState,De.componentWillUnmount()}catch(Pe){it(x,p,Pe)}}break;case 5:Cn(ye,ye.return);break;case 22:if(ye.memoizedState!==null){dc(Se);continue}}Fe!==null?(Fe.return=ye,Ae=Fe):dc(Se)}we=we.sibling}e:for(we=null,Se=l;;){if(Se.tag===5){if(we===null){we=Se;try{E=Se.stateNode,ue?(S=E.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(X=Se.stateNode,Q=Se.memoizedProps.style,R=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,X.style.display=at("display",R))}catch(Pe){it(l,l.return,Pe)}}}else if(Se.tag===6){if(we===null)try{Se.stateNode.nodeValue=ue?"":Se.memoizedProps}catch(Pe){it(l,l.return,Pe)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===l)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===l)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===l)break e;we===Se&&(we=null),Se=Se.return}we===Se&&(we=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:er(u,l),or(l),x&4&&lc(l);break;case 21:break;default:er(u,l),or(l)}}function or(l){var u=l.flags;if(u&2){try{e:{for(var p=l.return;p!==null;){if(ac(p)){var x=p;break e}p=p.return}throw Error(n(160))}switch(x.tag){case 5:var E=x.stateNode;x.flags&32&&(ze(E,""),x.flags&=-33);var S=ic(l);Ui(l,S,E);break;case 3:case 4:var R=x.stateNode.containerInfo,X=ic(l);Bi(l,X,R);break;default:throw Error(n(161))}}catch(Q){it(l,l.return,Q)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function Ku(l,u,p){Ae=l,uc(l)}function uc(l,u,p){for(var x=(l.mode&1)!==0;Ae!==null;){var E=Ae,S=E.child;if(E.tag===22&&x){var R=E.memoizedState!==null||ia;if(!R){var X=E.alternate,Q=X!==null&&X.memoizedState!==null||Ct;X=ia;var ue=Ct;if(ia=R,(Ct=Q)&&!ue)for(Ae=E;Ae!==null;)R=Ae,Q=R.child,R.tag===22&&R.memoizedState!==null?hc(E):Q!==null?(Q.return=R,Ae=Q):hc(E);for(;S!==null;)Ae=S,uc(S),S=S.sibling;Ae=E,ia=X,Ct=ue}fc(l)}else(E.subtreeFlags&8772)!==0&&S!==null?(S.return=E,Ae=S):fc(l)}}function fc(l){for(;Ae!==null;){var u=Ae;if((u.flags&8772)!==0){var p=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Ct||oa(5,u);break;case 1:var x=u.stateNode;if(u.flags&4&&!Ct)if(p===null)x.componentDidMount();else{var E=u.elementType===u.type?p.memoizedProps:Qt(u.type,p.memoizedProps);x.componentDidUpdate(E,p.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var S=u.updateQueue;S!==null&&dl(u,S,x);break;case 3:var R=u.updateQueue;if(R!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=u.child.stateNode;break;case 1:p=u.child.stateNode}dl(u,R,p)}break;case 5:var X=u.stateNode;if(p===null&&u.flags&4){p=X;var Q=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&p.focus();break;case"img":Q.src&&(p.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var ue=u.alternate;if(ue!==null){var we=ue.memoizedState;if(we!==null){var Se=we.dehydrated;Se!==null&&Wn(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Ct||u.flags&512&&Mi(u)}catch(ye){it(u,u.return,ye)}}if(u===l){Ae=null;break}if(p=u.sibling,p!==null){p.return=u.return,Ae=p;break}Ae=u.return}}function dc(l){for(;Ae!==null;){var u=Ae;if(u===l){Ae=null;break}var p=u.sibling;if(p!==null){p.return=u.return,Ae=p;break}Ae=u.return}}function hc(l){for(;Ae!==null;){var u=Ae;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{oa(4,u)}catch(Q){it(u,p,Q)}break;case 1:var x=u.stateNode;if(typeof x.componentDidMount=="function"){var E=u.return;try{x.componentDidMount()}catch(Q){it(u,E,Q)}}var S=u.return;try{Mi(u)}catch(Q){it(u,S,Q)}break;case 5:var R=u.return;try{Mi(u)}catch(Q){it(u,R,Q)}}}catch(Q){it(u,u.return,Q)}if(u===l){Ae=null;break}var X=u.sibling;if(X!==null){X.return=u.return,Ae=X;break}Ae=u.return}}var qu=Math.ceil,la=C.ReactCurrentDispatcher,zi=C.ReactCurrentOwner,$t=C.ReactCurrentBatchConfig,He=0,xt=null,ft=null,vt=0,Ut=0,Rn=Fr(0),ht=0,fs=null,Zr=0,ca=0,Wi=0,ds=null,Lt=null,Vi=0,Fn=1/0,_r=null,ua=!1,Hi=null,Or=null,fa=!1,jr=null,da=0,hs=0,Xi=null,ha=-1,pa=0;function Ft(){return(He&6)!==0?ke():ha!==-1?ha:ha=ke()}function Ir(l){return(l.mode&1)===0?1:(He&2)!==0&&vt!==0?vt&-vt:Pu.transition!==null?(pa===0&&(pa=ao()),pa):(l=Ge,l!==0||(l=window.event,l=l===void 0?16:mo(l.type)),l)}function tr(l,u,p,x){if(50<hs)throw hs=0,Xi=null,Error(n(185));In(l,p,x),((He&2)===0||l!==xt)&&(l===xt&&((He&2)===0&&(ca|=p),ht===4&&Mr(l,vt)),Ot(l,x),p===1&&He===0&&(u.mode&1)===0&&(Fn=ke()+500,Ws&&Ar()))}function Ot(l,u){var p=l.callbackNode;Pc(l,u);var x=Ss(l,l===xt?vt:0);if(x===0)p!==null&&Ce(p),l.callbackNode=null,l.callbackPriority=0;else if(u=x&-x,l.callbackPriority!==u){if(p!=null&&Ce(p),u===1)l.tag===0?Du(mc.bind(null,l)):el(mc.bind(null,l)),Ru(function(){(He&6)===0&&Ar()}),p=null;else{switch(io(x)){case 1:p=qe;break;case 4:p=Je;break;case 16:p=ot;break;case 536870912:p=wr;break;default:p=ot}p=Sc(p,pc.bind(null,l))}l.callbackPriority=u,l.callbackNode=p}}function pc(l,u){if(ha=-1,pa=0,(He&6)!==0)throw Error(n(327));var p=l.callbackNode;if(Nn()&&l.callbackNode!==p)return null;var x=Ss(l,l===xt?vt:0);if(x===0)return null;if((x&30)!==0||(x&l.expiredLanes)!==0||u)u=ma(l,x);else{u=x;var E=He;He|=2;var S=gc();(xt!==l||vt!==u)&&(_r=null,Fn=ke()+500,tn(l,u));do try{Zu();break}catch(X){xc(l,X)}while(!0);ci(),la.current=S,He=E,ft!==null?u=0:(xt=null,vt=0,u=ht)}if(u!==0){if(u===2&&(E=ba(l),E!==0&&(x=E,u=$i(l,E))),u===1)throw p=fs,tn(l,0),Mr(l,x),Ot(l,ke()),p;if(u===6)Mr(l,x);else{if(E=l.current.alternate,(x&30)===0&&!Ju(E)&&(u=ma(l,x),u===2&&(S=ba(l),S!==0&&(x=S,u=$i(l,S))),u===1))throw p=fs,tn(l,0),Mr(l,x),Ot(l,ke()),p;switch(l.finishedWork=E,l.finishedLanes=x,u){case 0:case 1:throw Error(n(345));case 2:rn(l,Lt,_r);break;case 3:if(Mr(l,x),(x&130023424)===x&&(u=Vi+500-ke(),10<u)){if(Ss(l,0)!==0)break;if(E=l.suspendedLanes,(E&x)!==x){Ft(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=Qa(rn.bind(null,l,Lt,_r),u);break}rn(l,Lt,_r);break;case 4:if(Mr(l,x),(x&4194240)===x)break;for(u=l.eventTimes,E=-1;0<x;){var R=31-lt(x);S=1<<R,R=u[R],R>E&&(E=R),x&=~S}if(x=E,x=ke()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*qu(x/1960))-x,10<x){l.timeoutHandle=Qa(rn.bind(null,l,Lt,_r),x);break}rn(l,Lt,_r);break;case 5:rn(l,Lt,_r);break;default:throw Error(n(329))}}}return Ot(l,ke()),l.callbackNode===p?pc.bind(null,l):null}function $i(l,u){var p=ds;return l.current.memoizedState.isDehydrated&&(tn(l,u).flags|=256),l=ma(l,u),l!==2&&(u=Lt,Lt=p,u!==null&&Yi(u)),l}function Yi(l){Lt===null?Lt=l:Lt.push.apply(Lt,l)}function Ju(l){for(var u=l;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var x=0;x<p.length;x++){var E=p[x],S=E.getSnapshot;E=E.value;try{if(!qt(S(),E))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Mr(l,u){for(u&=~Wi,u&=~ca,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var p=31-lt(u),x=1<<p;l[p]=-1,u&=~x}}function mc(l){if((He&6)!==0)throw Error(n(327));Nn();var u=Ss(l,0);if((u&1)===0)return Ot(l,ke()),null;var p=ma(l,u);if(l.tag!==0&&p===2){var x=ba(l);x!==0&&(u=x,p=$i(l,x))}if(p===1)throw p=fs,tn(l,0),Mr(l,u),Ot(l,ke()),p;if(p===6)throw Error(n(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,rn(l,Lt,_r),Ot(l,ke()),null}function Gi(l,u){var p=He;He|=1;try{return l(u)}finally{He=p,He===0&&(Fn=ke()+500,Ws&&Ar())}}function en(l){jr!==null&&jr.tag===0&&(He&6)===0&&Nn();var u=He;He|=1;var p=$t.transition,x=Ge;try{if($t.transition=null,Ge=1,l)return l()}finally{Ge=x,$t.transition=p,He=u,(He&6)===0&&Ar()}}function Ki(){Ut=Rn.current,et(Rn)}function tn(l,u){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==-1&&(l.timeoutHandle=-1,Cu(p)),ft!==null)for(p=ft.return;p!==null;){var x=p;switch(si(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Us();break;case 3:bn(),et(At),et(kt),gi();break;case 5:mi(x);break;case 4:bn();break;case 13:et(nt);break;case 19:et(nt);break;case 10:ui(x.type._context);break;case 22:case 23:Ki()}p=p.return}if(xt=l,ft=l=Br(l.current,null),vt=Ut=u,ht=0,fs=null,Wi=ca=Zr=0,Lt=ds=null,qr!==null){for(u=0;u<qr.length;u++)if(p=qr[u],x=p.interleaved,x!==null){p.interleaved=null;var E=x.next,S=p.pending;if(S!==null){var R=S.next;S.next=E,x.next=R}p.pending=x}qr=null}return l}function xc(l,u){do{var p=ft;try{if(ci(),Qs.current=ra,Zs){for(var x=st.memoizedState;x!==null;){var E=x.queue;E!==null&&(E.pending=null),x=x.next}Zs=!1}if(Qr=0,mt=dt=st=null,as=!1,is=0,zi.current=null,p===null||p.return===null){ht=1,fs=u,ft=null;break}e:{var S=l,R=p.return,X=p,Q=u;if(u=vt,X.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ue=Q,we=X,Se=we.tag;if((we.mode&1)===0&&(Se===0||Se===11||Se===15)){var ye=we.alternate;ye?(we.updateQueue=ye.updateQueue,we.memoizedState=ye.memoizedState,we.lanes=ye.lanes):(we.updateQueue=null,we.memoizedState=null)}var Fe=zl(R);if(Fe!==null){Fe.flags&=-257,Wl(Fe,R,X,S,u),Fe.mode&1&&Ul(S,ue,u),u=Fe,Q=ue;var De=u.updateQueue;if(De===null){var Pe=new Set;Pe.add(Q),u.updateQueue=Pe}else De.add(Q);break e}else{if((u&1)===0){Ul(S,ue,u),qi();break e}Q=Error(n(426))}}else if(rt&&X.mode&1){var ct=zl(R);if(ct!==null){(ct.flags&65536)===0&&(ct.flags|=256),Wl(ct,R,X,S,u),oi(Tn(Q,X));break e}}S=Q=Tn(Q,X),ht!==4&&(ht=2),ds===null?ds=[S]:ds.push(S),S=R;do{switch(S.tag){case 3:S.flags|=65536,u&=-u,S.lanes|=u;var re=Ml(S,Q,u);fl(S,re);break e;case 1:X=Q;var Z=S.type,se=S.stateNode;if((S.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(Or===null||!Or.has(se)))){S.flags|=65536,u&=-u,S.lanes|=u;var Te=Bl(S,X,u);fl(S,Te);break e}}S=S.return}while(S!==null)}vc(p)}catch(Oe){u=Oe,ft===p&&p!==null&&(ft=p=p.return);continue}break}while(!0)}function gc(){var l=la.current;return la.current=ra,l===null?ra:l}function qi(){(ht===0||ht===3||ht===2)&&(ht=4),xt===null||(Zr&268435455)===0&&(ca&268435455)===0||Mr(xt,vt)}function ma(l,u){var p=He;He|=2;var x=gc();(xt!==l||vt!==u)&&(_r=null,tn(l,u));do try{Qu();break}catch(E){xc(l,E)}while(!0);if(ci(),He=p,la.current=x,ft!==null)throw Error(n(261));return xt=null,vt=0,ht}function Qu(){for(;ft!==null;)_c(ft)}function Zu(){for(;ft!==null&&!Ne();)_c(ft)}function _c(l){var u=Ec(l.alternate,l,Ut);l.memoizedProps=l.pendingProps,u===null?vc(l):ft=u,zi.current=null}function vc(l){var u=l;do{var p=u.alternate;if(l=u.return,(u.flags&32768)===0){if(p=Xu(p,u,Ut),p!==null){ft=p;return}}else{if(p=$u(p,u),p!==null){p.flags&=32767,ft=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{ht=6,ft=null;return}}if(u=u.sibling,u!==null){ft=u;return}ft=u=l}while(u!==null);ht===0&&(ht=5)}function rn(l,u,p){var x=Ge,E=$t.transition;try{$t.transition=null,Ge=1,ef(l,u,p,x)}finally{$t.transition=E,Ge=x}return null}function ef(l,u,p,x){do Nn();while(jr!==null);if((He&6)!==0)throw Error(n(327));p=l.finishedWork;var E=l.finishedLanes;if(p===null)return null;if(l.finishedWork=null,l.finishedLanes=0,p===l.current)throw Error(n(177));l.callbackNode=null,l.callbackPriority=0;var S=p.lanes|p.childLanes;if(Lc(l,S),l===xt&&(ft=xt=null,vt=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||fa||(fa=!0,Sc(ot,function(){return Nn(),null})),S=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||S){S=$t.transition,$t.transition=null;var R=Ge;Ge=1;var X=He;He|=4,zi.current=null,Gu(l,p),cc(p,l),yu(qa),Ts=!!Ka,qa=Ka=null,l.current=p,Ku(p),be(),He=X,Ge=R,$t.transition=S}else l.current=p;if(fa&&(fa=!1,jr=l,da=E),S=l.pendingLanes,S===0&&(Or=null),On(p.stateNode),Ot(l,ke()),u!==null)for(x=l.onRecoverableError,p=0;p<u.length;p++)E=u[p],x(E.value,{componentStack:E.stack,digest:E.digest});if(ua)throw ua=!1,l=Hi,Hi=null,l;return(da&1)!==0&&l.tag!==0&&Nn(),S=l.pendingLanes,(S&1)!==0?l===Xi?hs++:(hs=0,Xi=l):hs=0,Ar(),null}function Nn(){if(jr!==null){var l=io(da),u=$t.transition,p=Ge;try{if($t.transition=null,Ge=16>l?16:l,jr===null)var x=!1;else{if(l=jr,jr=null,da=0,(He&6)!==0)throw Error(n(331));var E=He;for(He|=4,Ae=l.current;Ae!==null;){var S=Ae,R=S.child;if((Ae.flags&16)!==0){var X=S.deletions;if(X!==null){for(var Q=0;Q<X.length;Q++){var ue=X[Q];for(Ae=ue;Ae!==null;){var we=Ae;switch(we.tag){case 0:case 11:case 15:us(8,we,S)}var Se=we.child;if(Se!==null)Se.return=we,Ae=Se;else for(;Ae!==null;){we=Ae;var ye=we.sibling,Fe=we.return;if(sc(we),we===ue){Ae=null;break}if(ye!==null){ye.return=Fe,Ae=ye;break}Ae=Fe}}}var De=S.alternate;if(De!==null){var Pe=De.child;if(Pe!==null){De.child=null;do{var ct=Pe.sibling;Pe.sibling=null,Pe=ct}while(Pe!==null)}}Ae=S}}if((S.subtreeFlags&2064)!==0&&R!==null)R.return=S,Ae=R;else e:for(;Ae!==null;){if(S=Ae,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:us(9,S,S.return)}var re=S.sibling;if(re!==null){re.return=S.return,Ae=re;break e}Ae=S.return}}var Z=l.current;for(Ae=Z;Ae!==null;){R=Ae;var se=R.child;if((R.subtreeFlags&2064)!==0&&se!==null)se.return=R,Ae=se;else e:for(R=Z;Ae!==null;){if(X=Ae,(X.flags&2048)!==0)try{switch(X.tag){case 0:case 11:case 15:oa(9,X)}}catch(Oe){it(X,X.return,Oe)}if(X===R){Ae=null;break e}var Te=X.sibling;if(Te!==null){Te.return=X.return,Ae=Te;break e}Ae=X.return}}if(He=E,Ar(),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(nr,l)}catch{}x=!0}return x}finally{Ge=p,$t.transition=u}}return!1}function yc(l,u,p){u=Tn(p,u),u=Ml(l,u,1),l=Pr(l,u,1),u=Ft(),l!==null&&(In(l,1,u),Ot(l,u))}function it(l,u,p){if(l.tag===3)yc(l,l,p);else for(;u!==null;){if(u.tag===3){yc(u,l,p);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Or===null||!Or.has(x))){l=Tn(p,l),l=Bl(u,l,1),u=Pr(u,l,1),l=Ft(),u!==null&&(In(u,1,l),Ot(u,l));break}}u=u.return}}function tf(l,u,p){var x=l.pingCache;x!==null&&x.delete(u),u=Ft(),l.pingedLanes|=l.suspendedLanes&p,xt===l&&(vt&p)===p&&(ht===4||ht===3&&(vt&130023424)===vt&&500>ke()-Vi?tn(l,0):Wi|=p),Ot(l,u)}function wc(l,u){u===0&&((l.mode&1)===0?u=1:(u=Es,Es<<=1,(Es&130023424)===0&&(Es=4194304)));var p=Ft();l=mr(l,u),l!==null&&(In(l,u,p),Ot(l,p))}function rf(l){var u=l.memoizedState,p=0;u!==null&&(p=u.retryLane),wc(l,p)}function nf(l,u){var p=0;switch(l.tag){case 13:var x=l.stateNode,E=l.memoizedState;E!==null&&(p=E.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(n(314))}x!==null&&x.delete(u),wc(l,p)}var Ec;Ec=function(l,u,p){if(l!==null)if(l.memoizedProps!==u.pendingProps||At.current)Pt=!0;else{if((l.lanes&p)===0&&(u.flags&128)===0)return Pt=!1,Hu(l,u,p);Pt=(l.flags&131072)!==0}else Pt=!1,rt&&(u.flags&1048576)!==0&&tl(u,Hs,u.index);switch(u.lanes=0,u.tag){case 2:var x=u.type;aa(l,u),l=u.pendingProps;var E=_n(u,kt.current);kn(u,p),E=yi(null,u,x,l,E,p);var S=wi();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Dt(x)?(S=!0,zs(u)):S=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,hi(u),E.updater=na,u.stateNode=E,E._reactInternals=u,Ci(u,x,l,p),u=Ai(null,u,x,!0,S,p)):(u.tag=0,rt&&S&&ni(u),Rt(null,u,E,p),u=u.child),u;case 16:x=u.elementType;e:{switch(aa(l,u),l=u.pendingProps,E=x._init,x=E(x._payload),u.type=x,E=u.tag=af(x),l=Qt(x,l),E){case 0:u=Ni(null,u,x,l,p);break e;case 1:u=Gl(null,u,x,l,p);break e;case 11:u=Vl(null,u,x,l,p);break e;case 14:u=Hl(null,u,x,Qt(x.type,l),p);break e}throw Error(n(306,x,""))}return u;case 0:return x=u.type,E=u.pendingProps,E=u.elementType===x?E:Qt(x,E),Ni(l,u,x,E,p);case 1:return x=u.type,E=u.pendingProps,E=u.elementType===x?E:Qt(x,E),Gl(l,u,x,E,p);case 3:e:{if(Kl(u),l===null)throw Error(n(387));x=u.pendingProps,S=u.memoizedState,E=S.element,ul(l,u),qs(u,x,null,p);var R=u.memoizedState;if(x=R.element,S.isDehydrated)if(S={element:x,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},u.updateQueue.baseState=S,u.memoizedState=S,u.flags&256){E=Tn(Error(n(423)),u),u=ql(l,u,x,p,E);break e}else if(x!==E){E=Tn(Error(n(424)),u),u=ql(l,u,x,p,E);break e}else for(Bt=Rr(u.stateNode.containerInfo.firstChild),Mt=u,rt=!0,Jt=null,p=ll(u,null,x,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(wn(),x===E){u=gr(l,u,p);break e}Rt(l,u,x,p)}u=u.child}return u;case 5:return hl(u),l===null&&ii(u),x=u.type,E=u.pendingProps,S=l!==null?l.memoizedProps:null,R=E.children,Ja(x,E)?R=null:S!==null&&Ja(x,S)&&(u.flags|=32),Yl(l,u),Rt(l,u,R,p),u.child;case 6:return l===null&&ii(u),null;case 13:return Jl(l,u,p);case 4:return pi(u,u.stateNode.containerInfo),x=u.pendingProps,l===null?u.child=En(u,null,x,p):Rt(l,u,x,p),u.child;case 11:return x=u.type,E=u.pendingProps,E=u.elementType===x?E:Qt(x,E),Vl(l,u,x,E,p);case 7:return Rt(l,u,u.pendingProps,p),u.child;case 8:return Rt(l,u,u.pendingProps.children,p),u.child;case 12:return Rt(l,u,u.pendingProps.children,p),u.child;case 10:e:{if(x=u.type._context,E=u.pendingProps,S=u.memoizedProps,R=E.value,Qe(Ys,x._currentValue),x._currentValue=R,S!==null)if(qt(S.value,R)){if(S.children===E.children&&!At.current){u=gr(l,u,p);break e}}else for(S=u.child,S!==null&&(S.return=u);S!==null;){var X=S.dependencies;if(X!==null){R=S.child;for(var Q=X.firstContext;Q!==null;){if(Q.context===x){if(S.tag===1){Q=xr(-1,p&-p),Q.tag=2;var ue=S.updateQueue;if(ue!==null){ue=ue.shared;var we=ue.pending;we===null?Q.next=Q:(Q.next=we.next,we.next=Q),ue.pending=Q}}S.lanes|=p,Q=S.alternate,Q!==null&&(Q.lanes|=p),fi(S.return,p,u),X.lanes|=p;break}Q=Q.next}}else if(S.tag===10)R=S.type===u.type?null:S.child;else if(S.tag===18){if(R=S.return,R===null)throw Error(n(341));R.lanes|=p,X=R.alternate,X!==null&&(X.lanes|=p),fi(R,p,u),R=S.sibling}else R=S.child;if(R!==null)R.return=S;else for(R=S;R!==null;){if(R===u){R=null;break}if(S=R.sibling,S!==null){S.return=R.return,R=S;break}R=R.return}S=R}Rt(l,u,E.children,p),u=u.child}return u;case 9:return E=u.type,x=u.pendingProps.children,kn(u,p),E=Ht(E),x=x(E),u.flags|=1,Rt(l,u,x,p),u.child;case 14:return x=u.type,E=Qt(x,u.pendingProps),E=Qt(x.type,E),Hl(l,u,x,E,p);case 15:return Xl(l,u,u.type,u.pendingProps,p);case 17:return x=u.type,E=u.pendingProps,E=u.elementType===x?E:Qt(x,E),aa(l,u),u.tag=1,Dt(x)?(l=!0,zs(u)):l=!1,kn(u,p),jl(u,x,E),Ci(u,x,E,p),Ai(null,u,x,!0,l,p);case 19:return Zl(l,u,p);case 22:return $l(l,u,p)}throw Error(n(156,u.tag))};function Sc(l,u){return Ee(l,u)}function sf(l,u,p,x){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(l,u,p,x){return new sf(l,u,p,x)}function Ji(l){return l=l.prototype,!(!l||!l.isReactComponent)}function af(l){if(typeof l=="function")return Ji(l)?1:0;if(l!=null){if(l=l.$$typeof,l===I)return 11;if(l===ne)return 14}return 2}function Br(l,u){var p=l.alternate;return p===null?(p=Yt(l.tag,u,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=u,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,u=l.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function xa(l,u,p,x,E,S){var R=2;if(x=l,typeof l=="function")Ji(l)&&(R=1);else if(typeof l=="string")R=5;else e:switch(l){case N:return nn(p.children,E,S,u);case U:R=8,E|=8;break;case M:return l=Yt(12,p,u,E|2),l.elementType=M,l.lanes=S,l;case te:return l=Yt(13,p,u,E),l.elementType=te,l.lanes=S,l;case _e:return l=Yt(19,p,u,E),l.elementType=_e,l.lanes=S,l;case le:return ga(p,E,S,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case j:R=10;break e;case K:R=9;break e;case I:R=11;break e;case ne:R=14;break e;case me:R=16,x=null;break e}throw Error(n(130,l==null?l:typeof l,""))}return u=Yt(R,p,u,E),u.elementType=l,u.type=x,u.lanes=S,u}function nn(l,u,p,x){return l=Yt(7,l,x,u),l.lanes=p,l}function ga(l,u,p,x){return l=Yt(22,l,x,u),l.elementType=le,l.lanes=p,l.stateNode={isHidden:!1},l}function Qi(l,u,p){return l=Yt(6,l,null,u),l.lanes=p,l}function Zi(l,u,p){return u=Yt(4,l.children!==null?l.children:[],l.key,u),u.lanes=p,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function of(l,u,p,x,E){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ta(0),this.expirationTimes=Ta(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ta(0),this.identifierPrefix=x,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function eo(l,u,p,x,E,S,R,X,Q){return l=new of(l,u,p,X,Q),u===1?(u=1,S===!0&&(u|=8)):u=0,S=Yt(3,null,null,u),l.current=S,S.stateNode=l,S.memoizedState={element:x,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},hi(S),l}function lf(l,u,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:x==null?null:""+x,children:l,containerInfo:u,implementation:p}}function kc(l){if(!l)return Nr;l=l._reactInternals;e:{if(H(l)!==l||l.tag!==1)throw Error(n(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Dt(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(n(171))}if(l.tag===1){var p=l.type;if(Dt(p))return Qo(l,p,u)}return u}function bc(l,u,p,x,E,S,R,X,Q){return l=eo(p,x,!0,l,E,S,R,X,Q),l.context=kc(null),p=l.current,x=Ft(),E=Ir(p),S=xr(x,E),S.callback=u??null,Pr(p,S,E),l.current.lanes=E,In(l,E,x),Ot(l,x),l}function _a(l,u,p,x){var E=u.current,S=Ft(),R=Ir(E);return p=kc(p),u.context===null?u.context=p:u.pendingContext=p,u=xr(S,R),u.payload={element:l},x=x===void 0?null:x,x!==null&&(u.callback=x),l=Pr(E,u,R),l!==null&&(tr(l,E,R,S),Ks(l,E,R)),R}function va(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function Tc(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<u?p:u}}function ro(l,u){Tc(l,u),(l=l.alternate)&&Tc(l,u)}function cf(){return null}var Cc=typeof reportError=="function"?reportError:function(l){console.error(l)};function no(l){this._internalRoot=l}ya.prototype.render=no.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(n(409));_a(l,u,null,null)},ya.prototype.unmount=no.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;en(function(){_a(null,l,null,null)}),u[fr]=null}};function ya(l){this._internalRoot=l}ya.prototype.unstable_scheduleHydration=function(l){if(l){var u=co();l={blockedOn:null,target:l,priority:u};for(var p=0;p<br.length&&u!==0&&u<br[p].priority;p++);br.splice(p,0,l),p===0&&ho(l)}};function so(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function wa(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function Rc(){}function uf(l,u,p,x,E){if(E){if(typeof x=="function"){var S=x;x=function(){var ue=va(R);S.call(ue)}}var R=bc(u,x,l,0,null,!1,!1,"",Rc);return l._reactRootContainer=R,l[fr]=R.current,Jn(l.nodeType===8?l.parentNode:l),en(),R}for(;E=l.lastChild;)l.removeChild(E);if(typeof x=="function"){var X=x;x=function(){var ue=va(Q);X.call(ue)}}var Q=eo(l,0,!1,null,null,!1,!1,"",Rc);return l._reactRootContainer=Q,l[fr]=Q.current,Jn(l.nodeType===8?l.parentNode:l),en(function(){_a(u,Q,p,x)}),Q}function Ea(l,u,p,x,E){var S=p._reactRootContainer;if(S){var R=S;if(typeof E=="function"){var X=E;E=function(){var Q=va(R);X.call(Q)}}_a(u,R,l,E)}else R=uf(p,u,l,E,x);return va(R)}oo=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var p=jn(u.pendingLanes);p!==0&&(Ca(u,p|1),Ot(u,ke()),(He&6)===0&&(Fn=ke()+500,Ar()))}break;case 13:en(function(){var x=mr(l,1);if(x!==null){var E=Ft();tr(x,l,1,E)}}),ro(l,1)}},Ra=function(l){if(l.tag===13){var u=mr(l,134217728);if(u!==null){var p=Ft();tr(u,l,134217728,p)}ro(l,134217728)}},lo=function(l){if(l.tag===13){var u=Ir(l),p=mr(l,u);if(p!==null){var x=Ft();tr(p,l,u,x)}ro(l,u)}},co=function(){return Ge},uo=function(l,u){var p=Ge;try{return Ge=l,u()}finally{Ge=p}},on=function(l,u,p){switch(u){case"input":if(Re(l,p),u=p.name,p.type==="radio"&&u!=null){for(p=l;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<p.length;u++){var x=p[u];if(x!==l&&x.form===l.form){var E=Bs(x);if(!E)throw Error(n(90));Y(x),Re(x,E)}}}break;case"textarea":St(l,p);break;case"select":u=p.value,u!=null&&Et(l,!!p.multiple,u,!1)}},_s=Gi,vs=en;var ff={usingClientEntryPoint:!1,Events:[es,xn,Bs,xs,gs,Gi]},ps={findFiberByHostInstance:$r,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},df={bundleType:ps.bundleType,version:ps.version,rendererPackageName:ps.rendererPackageName,rendererConfig:ps.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=oe(l),l===null?null:l.stateNode},findFiberByHostInstance:ps.findFiberByHostInstance||cf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sa.isDisabled&&Sa.supportsFiber)try{nr=Sa.inject(df),pt=Sa}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ff,reactDom_production_min.createPortal=function(l,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!so(u))throw Error(n(200));return lf(l,u,null,p)},reactDom_production_min.createRoot=function(l,u){if(!so(l))throw Error(n(299));var p=!1,x="",E=Cc;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),u=eo(l,1,!1,null,null,p,!1,x,E),l[fr]=u.current,Jn(l.nodeType===8?l.parentNode:l),new no(u)},reactDom_production_min.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=oe(u),l=l===null?null:l.stateNode,l},reactDom_production_min.flushSync=function(l){return en(l)},reactDom_production_min.hydrate=function(l,u,p){if(!wa(u))throw Error(n(200));return Ea(null,l,u,!0,p)},reactDom_production_min.hydrateRoot=function(l,u,p){if(!so(l))throw Error(n(405));var x=p!=null&&p.hydratedSources||null,E=!1,S="",R=Cc;if(p!=null&&(p.unstable_strictMode===!0&&(E=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onRecoverableError!==void 0&&(R=p.onRecoverableError)),u=bc(u,null,l,1,p??null,E,!1,S,R),l[fr]=u.current,Jn(l),x)for(l=0;l<x.length;l++)p=x[l],E=p._getVersion,E=E(p._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[p,E]:u.mutableSourceEagerHydrationData.push(p,E);return new ya(u)},reactDom_production_min.render=function(l,u,p){if(!wa(u))throw Error(n(200));return Ea(null,l,u,!1,p)},reactDom_production_min.unmountComponentAtNode=function(l){if(!wa(l))throw Error(n(40));return l._reactRootContainer?(en(function(){Ea(null,null,l,!1,function(){l._reactRootContainer=null,l[fr]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Gi,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(l,u,p,x){if(!wa(p))throw Error(n(200));if(l==null||l._reactInternals===void 0)throw Error(n(38));return Ea(l,u,p,!1,x)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var t=requireReactDom();return client.createRoot=t.createRoot,client.hydrateRoot=t.hydrateRoot,client}var clientExports=requireClient();requireReactDom();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},_extends$2.apply(this,arguments)}var Action;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(t){t===void 0&&(t={});function r(s,a){let{pathname:i,search:o,hash:c}=s.location;return createLocation("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(r,n,null,t)}function invariant(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function warning(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(t,r){return{usr:t.state,key:t.key,idx:r}}function createLocation(t,r,n,s){return n===void 0&&(n=null),_extends$2({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof r=="string"?parsePath(r):r,{state:n,key:r&&r.key||s||createKey()})}function createPath(t){let{pathname:r="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(r+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(r+=s.charAt(0)==="#"?s:"#"+s),r}function parsePath(t){let r={};if(t){let n=t.indexOf("#");n>=0&&(r.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(r.search=t.substr(s),t=t.substr(0,s)),t&&(r.pathname=t)}return r}function getUrlBasedHistory(t,r,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,c=Action.Pop,f=null,d=h();d==null&&(d=0,o.replaceState(_extends$2({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function m(){c=Action.Pop;let w=h(),b=w==null?null:w-d;d=w,f&&f({action:c,location:_.location,delta:b})}function g(w,b){c=Action.Push;let T=createLocation(_.location,w,b);d=h()+1;let k=getHistoryState(T,d),C=_.createHref(T);try{o.pushState(k,"",C)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(C)}i&&f&&f({action:c,location:_.location,delta:1})}function v(w,b){c=Action.Replace;let T=createLocation(_.location,w,b);d=h();let k=getHistoryState(T,d),C=_.createHref(T);o.replaceState(k,"",C),i&&f&&f({action:c,location:_.location,delta:0})}function y(w){let b=a.location.origin!=="null"?a.location.origin:a.location.href,T=typeof w=="string"?w:createPath(w);return T=T.replace(/ $/,"%20"),invariant(b,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,b)}let _={get action(){return c},get location(){return t(a,o)},listen(w){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,m),f=w,()=>{a.removeEventListener(PopStateEventType,m),f=null}},createHref(w){return r(a,w)},createURL:y,encodeLocation(w){let b=y(w);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:g,replace:v,go(w){return o.go(w)}};return _}var ResultType;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ResultType||(ResultType={}));function matchRoutes(t,r,n){return n===void 0&&(n="/"),matchRoutesImpl(t,r,n)}function matchRoutesImpl(t,r,n,s){let a=typeof r=="string"?parsePath(r):r,i=stripBasename(a.pathname||"/",n);if(i==null)return null;let o=flattenRoutes(t);rankRouteBranches(o);let c=null;for(let f=0;c==null&&f<o.length;++f){let d=decodePath(i);c=matchRouteBranch(o[f],d)}return c}function flattenRoutes(t,r,n,s){r===void 0&&(r=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(i,o,c)=>{let f={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};f.relativePath.startsWith("/")&&(invariant(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let d=joinPaths([s,f.relativePath]),h=n.concat(f);i.children&&i.children.length>0&&(invariant(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),flattenRoutes(i.children,r,h,d)),!(i.path==null&&!i.index)&&r.push({path:d,score:computeScore(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let f of explodeOptionalSegments(i.path))a(i,o,f)}),r}function explodeOptionalSegments(t){let r=t.split("/");if(r.length===0)return[];let[n,...s]=r,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let o=explodeOptionalSegments(s.join("/")),c=[];return c.push(...o.map(f=>f===""?i:[i,f].join("/"))),a&&c.push(...o),c.map(f=>t.startsWith("/")&&f===""?"/":f)}function rankRouteBranches(t){t.sort((r,n)=>r.score!==n.score?n.score-r.score:compareIndexes(r.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=t=>t==="*";function computeScore(t,r){let n=t.split("/"),s=n.length;return n.some(isSplat)&&(s+=splatPenalty),r&&(s+=indexRouteValue),n.filter(a=>!isSplat(a)).reduce((a,i)=>a+(paramRe.test(i)?dynamicSegmentValue:i===""?emptySegmentValue:staticSegmentValue),s)}function compareIndexes(t,r){return t.length===r.length&&t.slice(0,-1).every((s,a)=>s===r[a])?t[t.length-1]-r[r.length-1]:0}function matchRouteBranch(t,r,n){let{routesMeta:s}=t,a={},i="/",o=[];for(let c=0;c<s.length;++c){let f=s[c],d=c===s.length-1,h=i==="/"?r:r.slice(i.length)||"/",m=matchPath({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},h),g=f.route;if(!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:joinPaths([i,m.pathname]),pathnameBase:normalizePathname(joinPaths([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=joinPaths([i,m.pathnameBase]))}return o}function matchPath(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=compilePath(t.path,t.caseSensitive,t.end),a=r.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:s.reduce((d,h,m)=>{let{paramName:g,isOptional:v}=h;if(g==="*"){let _=c[m]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const y=c[m];return v&&!y?d[g]=void 0:d[g]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function compilePath(t,r,n){r===void 0&&(r=!1),n===void 0&&(n=!0),warning(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,f)=>(s.push({paramName:c,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),s]}function decodePath(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),t}}function stripBasename(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let n=r.endsWith("/")?r.length-1:r.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function resolvePath(t,r){r===void 0&&(r="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?parsePath(t):t;return{pathname:n?n.startsWith("/")?n:resolvePathname(n,r):r,search:normalizeSearch(s),hash:normalizeHash(a)}}function resolvePathname(t,r){let n=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function getInvalidPathError(t,r,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(t){return t.filter((r,n)=>n===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(t,r){let n=getPathContributingMatches(t);return r?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function resolveTo(t,r,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=parsePath(t):(a=_extends$2({},t),invariant(!a.pathname||!a.pathname.includes("?"),getInvalidPathError("?","pathname","search",a)),invariant(!a.pathname||!a.pathname.includes("#"),getInvalidPathError("#","pathname","hash",a)),invariant(!a.search||!a.search.includes("#"),getInvalidPathError("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=n;else{let m=r.length-1;if(!s&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;a.pathname=g.join("/")}c=m>=0?r[m]:"/"}let f=resolvePath(a,c),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(d||h)&&(f.pathname+="/"),f}const joinPaths=t=>t.join("/").replace(/\/\/+/g,"/"),normalizePathname=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,normalizeHash=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function isRouteErrorResponse(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(t,r){let{relative:n}=r===void 0?{}:r;useInRouterContext()||invariant(!1);let{basename:s,navigator:a}=reactExports.useContext(NavigationContext),{hash:i,pathname:o,search:c}=useResolvedPath(t,{relative:n}),f=o;return s!=="/"&&(f=o==="/"?s:joinPaths([s,o])),a.createHref({pathname:f,search:c,hash:i})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(t){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(t)}function useNavigate(){let{isDataRoute:t}=reactExports.useContext(RouteContext);return t?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let t=reactExports.useContext(DataRouterContext),{basename:r,future:n,navigator:s}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),o=JSON.stringify(getResolveToMatches(a,n.v7_relativeSplatPath)),c=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{c.current=!0}),reactExports.useCallback(function(d,h){if(h===void 0&&(h={}),!c.current)return;if(typeof d=="number"){s.go(d);return}let m=resolveTo(d,JSON.parse(o),i,h.relative==="path");t==null&&r!=="/"&&(m.pathname=m.pathname==="/"?r:joinPaths([r,m.pathname])),(h.replace?s.replace:s.push)(m,h.state,h)},[r,s,o,i,t])}const OutletContext=reactExports.createContext(null);function useOutlet(t){let r=reactExports.useContext(RouteContext).outlet;return r&&reactExports.createElement(OutletContext.Provider,{value:t},r)}function useParams(){let{matches:t}=reactExports.useContext(RouteContext),r=t[t.length-1];return r?r.params:{}}function useResolvedPath(t,r){let{relative:n}=r===void 0?{}:r,{future:s}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),o=JSON.stringify(getResolveToMatches(a,s.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function useRoutes(t,r){return useRoutesImpl(t,r)}function useRoutesImpl(t,r,n,s){useInRouterContext()||invariant(!1);let{navigator:a,static:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),c=o[o.length-1],f=c?c.params:{};c&&c.pathname;let d=c?c.pathnameBase:"/";c&&c.route;let h=useLocation(),m;if(r){var g;let b=typeof r=="string"?parsePath(r):r;d==="/"||(g=b.pathname)!=null&&g.startsWith(d)||invariant(!1),m=b}else m=h;let v=m.pathname||"/",y=v;if(d!=="/"){let b=d.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(b.length).join("/")}let _=matchRoutes(t,{pathname:y}),w=_renderMatches(_&&_.map(b=>Object.assign({},b,{params:Object.assign({},f,b.params),pathname:joinPaths([d,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:joinPaths([d,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,n,s);return r&&w?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Action.Pop}},w):w}function DefaultErrorComponent(){let t=useRouteError(),r=isRouteErrorResponse(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),n?reactExports.createElement("pre",{style:a},n):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,n){return n.location!==r.location||n.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:n.error,location:n.location,revalidation:r.revalidation||n.revalidation}}componentDidCatch(r,n){console.error("React Router caught the following error during render",r,n)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(t){let{routeContext:r,match:n,children:s}=t,a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),reactExports.createElement(RouteContext.Provider,{value:r},s)}function _renderMatches(t,r,n,s){var a;if(r===void 0&&(r=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&r.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(a=n)==null?void 0:a.errors;if(c!=null){let h=o.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);h>=0||invariant(!1),o=o.slice(0,Math.min(o.length,h+1))}let f=!1,d=-1;if(n&&s&&s.v7_partialHydration)for(let h=0;h<o.length;h++){let m=o[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=h),m.route.id){let{loaderData:g,errors:v}=n,y=m.route.loader&&g[m.route.id]===void 0&&(!v||v[m.route.id]===void 0);if(m.route.lazy||y){f=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,m,g)=>{let v,y=!1,_=null,w=null;n&&(v=c&&m.route.id?c[m.route.id]:void 0,_=m.route.errorElement||defaultErrorElement,f&&(d<0&&g===0?(warningOnce("route-fallback"),y=!0,w=null):d===g&&(y=!0,w=m.route.hydrateFallbackElement||null)));let b=r.concat(o.slice(0,g+1)),T=()=>{let k;return v?k=_:y?k=w:m.route.Component?k=reactExports.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=h,reactExports.createElement(RenderedRoute,{match:m,routeContext:{outlet:h,matches:b,isDataRoute:n!=null},children:k})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?reactExports.createElement(RenderErrorBoundary,{location:n.location,revalidation:n.revalidation,component:_,error:v,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}var DataRouterHook$1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(DataRouterHook$1||{}),DataRouterStateHook$1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(DataRouterStateHook$1||{});function useDataRouterContext$1(t){let r=reactExports.useContext(DataRouterContext);return r||invariant(!1),r}function useDataRouterState(t){let r=reactExports.useContext(DataRouterStateContext);return r||invariant(!1),r}function useRouteContext(t){let r=reactExports.useContext(RouteContext);return r||invariant(!1),r}function useCurrentRouteId(t){let r=useRouteContext(),n=r.matches[r.matches.length-1];return n.route.id||invariant(!1),n.route.id}function useRouteError(){var t;let r=reactExports.useContext(RouteErrorContext),n=useDataRouterState(),s=useCurrentRouteId();return r!==void 0?r:(t=n.errors)==null?void 0:t[s]}function useNavigateStable(){let{router:t}=useDataRouterContext$1(DataRouterHook$1.UseNavigateStable),r=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),n=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{n.current=!0}),reactExports.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,_extends$1({fromRouteId:r},i)))},[t,r])}const alreadyWarned$1={};function warningOnce(t,r,n){alreadyWarned$1[t]||(alreadyWarned$1[t]=!0)}function logV6DeprecationWarnings(t,r){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Navigate(t){let{to:r,replace:n,state:s,relative:a}=t;useInRouterContext()||invariant(!1);let{future:i,static:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),{pathname:f}=useLocation(),d=useNavigate(),h=resolveTo(r,getResolveToMatches(c,i.v7_relativeSplatPath),f,a==="path"),m=JSON.stringify(h);return reactExports.useEffect(()=>d(JSON.parse(m),{replace:n,state:s,relative:a}),[d,m,a,n,s]),null}function Outlet(t){return useOutlet(t.context)}function Route(t){invariant(!1)}function Router(t){let{basename:r="/",children:n=null,location:s,navigationType:a=Action.Pop,navigator:i,static:o=!1,future:c}=t;useInRouterContext()&&invariant(!1);let f=r.replace(/^\/*/,"/"),d=reactExports.useMemo(()=>({basename:f,navigator:i,static:o,future:_extends$1({v7_relativeSplatPath:!1},c)}),[f,c,i,o]);typeof s=="string"&&(s=parsePath(s));let{pathname:h="/",search:m="",hash:g="",state:v=null,key:y="default"}=s,_=reactExports.useMemo(()=>{let w=stripBasename(h,f);return w==null?null:{location:{pathname:w,search:m,hash:g,state:v,key:y},navigationType:a}},[f,h,m,g,v,y,a]);return _==null?null:reactExports.createElement(NavigationContext.Provider,{value:d},reactExports.createElement(LocationContext.Provider,{children:n,value:_}))}function Routes(t){let{children:r,location:n}=t;return useRoutes(createRoutesFromChildren(r),n)}new Promise(()=>{});function createRoutesFromChildren(t,r){r===void 0&&(r=[]);let n=[];return reactExports.Children.forEach(t,(s,a)=>{if(!reactExports.isValidElement(s))return;let i=[...r,a];if(s.type===reactExports.Fragment){n.push.apply(n,createRoutesFromChildren(s.props.children,i));return}s.type!==Route&&invariant(!1),!s.props.index||!s.props.children||invariant(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=createRoutesFromChildren(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(t,r){if(t==null)return{};var n={},s=Object.keys(t),a,i;for(i=0;i<s.length;i++)a=s[i],!(r.indexOf(a)>=0)&&(n[a]=t[a]);return n}function isModifiedEvent(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function shouldProcessLinkClick(t,r){return t.button===0&&(!r||r==="_self")&&!isModifiedEvent(t)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_excluded2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(t){let{basename:r,children:n,future:s,window:a}=t,i=reactExports.useRef();i.current==null&&(i.current=createBrowserHistory({window:a,v5Compat:!0}));let o=i.current,[c,f]=reactExports.useState({action:o.action,location:o.location}),{v7_startTransition:d}=s||{},h=reactExports.useCallback(m=>{d&&startTransitionImpl?startTransitionImpl(()=>f(m)):f(m)},[f,d]);return reactExports.useLayoutEffect(()=>o.listen(h),[o,h]),reactExports.useEffect(()=>logV6DeprecationWarnings(s),[s]),reactExports.createElement(Router,{basename:r,children:n,location:c.location,navigationType:c.action,navigator:o,future:s})}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(r,n){let{onClick:s,relative:a,reloadDocument:i,replace:o,state:c,target:f,to:d,preventScrollReset:h,viewTransition:m}=r,g=_objectWithoutPropertiesLoose(r,_excluded),{basename:v}=reactExports.useContext(NavigationContext),y,_=!1;if(typeof d=="string"&&ABSOLUTE_URL_REGEX.test(d)&&(y=d,isBrowser))try{let k=new URL(window.location.href),C=d.startsWith("//")?new URL(k.protocol+d):new URL(d),L=stripBasename(C.pathname,v);C.origin===k.origin&&L!=null?d=L+C.search+C.hash:_=!0}catch{}let w=useHref(d,{relative:a}),b=useLinkClickHandler(d,{replace:o,state:c,target:f,preventScrollReset:h,relative:a,viewTransition:m});function T(k){s&&s(k),k.defaultPrevented||b(k)}return reactExports.createElement("a",_extends({},g,{href:y||w,onClick:_||i?s:T,ref:n,target:f}))}),NavLink=reactExports.forwardRef(function(r,n){let{"aria-current":s="page",caseSensitive:a=!1,className:i="",end:o=!1,style:c,to:f,viewTransition:d,children:h}=r,m=_objectWithoutPropertiesLoose(r,_excluded2),g=useResolvedPath(f,{relative:m.relative}),v=useLocation(),y=reactExports.useContext(DataRouterStateContext),{navigator:_,basename:w}=reactExports.useContext(NavigationContext),b=y!=null&&useViewTransitionState(g)&&d===!0,T=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,k=v.pathname,C=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;a||(k=k.toLowerCase(),C=C?C.toLowerCase():null,T=T.toLowerCase()),C&&w&&(C=stripBasename(C,w)||C);const L=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let D=k===T||!o&&k.startsWith(T)&&k.charAt(L)==="/",N=C!=null&&(C===T||!o&&C.startsWith(T)&&C.charAt(T.length)==="/"),U={isActive:D,isPending:N,isTransitioning:b},M=D?s:void 0,j;typeof i=="function"?j=i(U):j=[i,D?"active":null,N?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let K=typeof c=="function"?c(U):c;return reactExports.createElement(Link,_extends({},m,{"aria-current":M,className:j,ref:n,style:K,to:f,viewTransition:d}),typeof h=="function"?h(U):h)});var DataRouterHook;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useDataRouterContext(t){let r=reactExports.useContext(DataRouterContext);return r||invariant(!1),r}function useLinkClickHandler(t,r){let{target:n,replace:s,state:a,preventScrollReset:i,relative:o,viewTransition:c}=r===void 0?{}:r,f=useNavigate(),d=useLocation(),h=useResolvedPath(t,{relative:o});return reactExports.useCallback(m=>{if(shouldProcessLinkClick(m,n)){m.preventDefault();let g=s!==void 0?s:createPath(d)===createPath(h);f(t,{replace:g,state:a,preventScrollReset:i,relative:o,viewTransition:c})}},[d,f,h,s,a,n,t,i,o,c])}function useViewTransitionState(t,r){r===void 0&&(r={});let n=reactExports.useContext(ViewTransitionContext);n==null&&invariant(!1);let{basename:s}=useDataRouterContext(DataRouterHook.useViewTransitionState),a=useResolvedPath(t,{relative:r.relative});if(!n.isTransitioning)return!1;let i=stripBasename(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=stripBasename(n.nextLocation.pathname,s)||n.nextLocation.pathname;return matchPath(a.pathname,o)!=null||matchPath(a.pathname,i)!=null}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(t,r)=>{const n=reactExports.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:f,...d},h)=>reactExports.createElement("svg",{ref:h,...defaultAttributes,width:a,height:a,stroke:s,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${toKebabCase(t)}`,c].join(" "),...d},[...r.map(([m,g])=>reactExports.createElement(m,g)),...Array.isArray(f)?f:[f]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowLeft=createLucideIcon("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowRight=createLucideIcon("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart2=createLucideIcon("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle2=createLucideIcon("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle=createLucideIcon("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ClipboardList=createLucideIcon("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Copy=createLucideIcon("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DollarSign=createLucideIcon("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileDown=createLucideIcon("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileUp=createLucideIcon("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Home=createLucideIcon("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Moon=createLucideIcon("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PiggyBank=createLucideIcon("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Scale$1=createLucideIcon("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Search=createLucideIcon("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SquarePen=createLucideIcon("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sun=createLucideIcon("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tag=createLucideIcon("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trash=createLucideIcon("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TrendingDown=createLucideIcon("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TrendingUp=createLucideIcon("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wallet=createLucideIcon("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),NavBar$1=()=>{const r=useLocation().pathname.split("/")[1],n=a=>r===a,s=[{name:"Home",path:"",icon:Home},{name:"Expenses",path:"expenses",icon:Wallet},{name:"Income",path:"income",icon:PiggyBank},{name:"Budgets",path:"budgets",icon:BarChart2},{name:"Settings",path:"settings",icon:Settings}];return jsxRuntimeExports.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 shadow-lg z-10",children:jsxRuntimeExports.jsx("div",{className:"flex justify-around items-center h-16",children:s.map(a=>jsxRuntimeExports.jsxs(NavLink,{to:`/${a.path}`,className:`flex flex-col items-center justify-center w-full py-1 transition-all ${n(a.path)?"text-primary-600 dark:text-primary-400 scale-110":"text-gray-500 dark:text-gray-400"}`,children:[jsxRuntimeExports.jsx(a.icon,{size:20,className:`mb-1 ${n(a.path)?"animate-pulse-slow":""}`}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:a.name})]},a.name))})})};let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let t=0;t<256;++t)byteToHex.push((t+256).toString(16).slice(1));function unsafeStringify(t,r=0){return byteToHex[t[r+0]]+byteToHex[t[r+1]]+byteToHex[t[r+2]]+byteToHex[t[r+3]]+"-"+byteToHex[t[r+4]]+byteToHex[t[r+5]]+"-"+byteToHex[t[r+6]]+byteToHex[t[r+7]]+"-"+byteToHex[t[r+8]]+byteToHex[t[r+9]]+"-"+byteToHex[t[r+10]]+byteToHex[t[r+11]]+byteToHex[t[r+12]]+byteToHex[t[r+13]]+byteToHex[t[r+14]]+byteToHex[t[r+15]]}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(t,r,n){if(native.randomUUID&&!t)return native.randomUUID();t=t||{};const s=t.random||(t.rng||rng)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,unsafeStringify(s)}const STORAGE_KEY="finance_tracker_data",defaultCategories=[{id:"1",name:"Food",type:"expense",color:"#EF4444"},{id:"2",name:"Transport",type:"expense",color:"#F59E0B"},{id:"3",name:"Housing",type:"expense",color:"#10B981"},{id:"4",name:"Entertainment",type:"expense",color:"#6366F1"},{id:"5",name:"Healthcare",type:"expense",color:"#EC4899"},{id:"6",name:"Shopping",type:"expense",color:"#8B5CF6"},{id:"7",name:"Utilities",type:"expense",color:"#14B8A6"},{id:"8",name:"Other Expense",type:"expense",color:"#6B7280"},{id:"9",name:"Salary",type:"income",color:"#22C55E"},{id:"10",name:"Freelance",type:"income",color:"#3B82F6"},{id:"11",name:"Gifts",type:"income",color:"#D946EF"},{id:"12",name:"Other Income",type:"income",color:"#64748B"}],defaultSettings={currency:"USD",firstDayOfMonth:1,theme:"system"},initialData={transactions:[],budgets:[],categories:defaultCategories,settings:defaultSettings},loadData=()=>{try{const t=localStorage.getItem(STORAGE_KEY);return t?JSON.parse(t):initialData}catch(t){return console.error("Error loading data from localStorage:",t),initialData}},saveData=t=>{try{localStorage.setItem(STORAGE_KEY,JSON.stringify(t))}catch(r){console.error("Error saving data to localStorage:",r)}},exportData=()=>{try{const t=loadData(),r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(r),s=document.createElement("a"),a=new Date().toISOString().split("T")[0];s.href=n,s.download=`finance_tracker_backup_${a}.json`,s.click(),URL.revokeObjectURL(n)}catch(t){console.error("Error exporting data:",t)}},importData=t=>new Promise((r,n)=>{const s=new FileReader;s.onload=a=>{var i;try{if((i=a.target)!=null&&i.result){const o=JSON.parse(a.target.result);saveData(o),r(o)}}catch{n(new Error("Invalid file format"))}},s.onerror=()=>{n(new Error("Error reading file"))},s.readAsText(t)}),exportCSV=t=>{try{const r=loadData();let n="",s="";t==="transactions"?(n=`ID,Type,Amount,Date,Category,Description,Notes
`,r.transactions.forEach(c=>{n+=`${c.id},${c.type},${c.amount},${c.date},${c.category},${c.description},${c.notes||""}
`}),s=`transactions_${new Date().toISOString().split("T")[0]}.csv`):t==="budgets"&&(n=`ID,Category,Amount,Period,Start Date,Notes
`,r.budgets.forEach(c=>{n+=`${c.id},${c.category},${c.amount},${c.period},${c.startDate},${c.notes||""}
`}),s=`budgets_${new Date().toISOString().split("T")[0]}.csv`);const a=new Blob([n],{type:"text/csv"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=s,o.click(),URL.revokeObjectURL(i)}catch(r){console.error("Error exporting CSV:",r)}};function toDate(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function constructFrom(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}const millisecondsInWeek=6048e5,millisecondsInDay=864e5,millisecondsInMinute=6e4,millisecondsInHour=36e5;let defaultOptions$1={};function getDefaultOptions(){return defaultOptions$1}function startOfWeek(t,r){var c,f,d,h;const n=getDefaultOptions(),s=(r==null?void 0:r.weekStartsOn)??((f=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=toDate(t),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function startOfISOWeek(t){return startOfWeek(t,{weekStartsOn:1})}function getISOWeekYear(t){const r=toDate(t),n=r.getFullYear(),s=constructFrom(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=startOfISOWeek(s),i=constructFrom(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=startOfISOWeek(i);return r.getTime()>=a.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function startOfDay(t){const r=toDate(t);return r.setHours(0,0,0,0),r}function getTimezoneOffsetInMilliseconds(t){const r=toDate(t),n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return n.setUTCFullYear(r.getFullYear()),+t-+n}function differenceInCalendarDays(t,r){const n=startOfDay(t),s=startOfDay(r),a=+n-getTimezoneOffsetInMilliseconds(n),i=+s-getTimezoneOffsetInMilliseconds(s);return Math.round((a-i)/millisecondsInDay)}function startOfISOWeekYear(t){const r=getISOWeekYear(t),n=constructFrom(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),startOfISOWeek(n)}function isDate(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function isValid(t){if(!isDate(t)&&typeof t!="number")return!1;const r=toDate(t);return!isNaN(Number(r))}function startOfMonth(t){const r=toDate(t);return r.setDate(1),r.setHours(0,0,0,0),r}function startOfYear(t){const r=toDate(t),n=constructFrom(t,0);return n.setFullYear(r.getFullYear(),0,1),n.setHours(0,0,0,0),n}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(t,r,n)=>{let s;const a=formatDistanceLocale[t];return typeof a=="string"?s=a:r===1?s=a.one:s=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function buildFormatLongFn(t){return(r={})=>{const n=r.width?String(r.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(t,r,n,s)=>formatRelativeLocale[t];function buildLocalizeFn(t){return(r,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let a;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=n!=null&&n.width?String(n.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(r):r;return a[i]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(t,r)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:t=>t-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(t){return(r,n={})=>{const s=n.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=r.match(a);if(!i)return null;const o=i[0],c=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],f=Array.isArray(c)?findIndex(c,m=>m.test(o)):findKey(c,m=>m.test(o));let d;d=t.valueCallback?t.valueCallback(f):f,d=n.valueCallback?n.valueCallback(d):d;const h=r.slice(o.length);return{value:d,rest:h}}}function findKey(t,r){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r(t[n]))return n}function findIndex(t,r){for(let n=0;n<t.length;n++)if(r(t[n]))return n}function buildMatchPatternFn(t){return(r,n={})=>{const s=r.match(t.matchPattern);if(!s)return null;const a=s[0],i=r.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const c=r.slice(a.length);return{value:o,rest:c}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:t=>parseInt(t,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:t=>t+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(t){const r=toDate(t);return differenceInCalendarDays(r,startOfYear(r))+1}function getISOWeek(t){const r=toDate(t),n=+startOfISOWeek(r)-+startOfISOWeekYear(r);return Math.round(n/millisecondsInWeek)+1}function getWeekYear(t,r){var h,m,g,v;const n=toDate(t),s=n.getFullYear(),a=getDefaultOptions(),i=(r==null?void 0:r.firstWeekContainsDate)??((m=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(g=a.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,o=constructFrom(t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const c=startOfWeek(o,r),f=constructFrom(t,0);f.setFullYear(s,0,i),f.setHours(0,0,0,0);const d=startOfWeek(f,r);return n.getTime()>=c.getTime()?s+1:n.getTime()>=d.getTime()?s:s-1}function startOfWeekYear(t,r){var c,f,d,h;const n=getDefaultOptions(),s=(r==null?void 0:r.firstWeekContainsDate)??((f=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=getWeekYear(t,r),i=constructFrom(t,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),startOfWeek(i,r)}function getWeek(t,r){const n=toDate(t),s=+startOfWeek(n,r)-+startOfWeekYear(n,r);return Math.round(s/millisecondsInWeek)+1}function addLeadingZeros(t,r){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(r,"0");return n+s}const lightFormatters={y(t,r){const n=t.getFullYear(),s=n>0?n:1-n;return addLeadingZeros(r==="yy"?s%100:s,r.length)},M(t,r){const n=t.getMonth();return r==="M"?String(n+1):addLeadingZeros(n+1,2)},d(t,r){return addLeadingZeros(t.getDate(),r.length)},a(t,r){const n=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,r){return addLeadingZeros(t.getHours()%12||12,r.length)},H(t,r){return addLeadingZeros(t.getHours(),r.length)},m(t,r){return addLeadingZeros(t.getMinutes(),r.length)},s(t,r){return addLeadingZeros(t.getSeconds(),r.length)},S(t,r){const n=r.length,s=t.getMilliseconds(),a=Math.trunc(s*Math.pow(10,n-3));return addLeadingZeros(a,r.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters$1={G:function(t,r,n){const s=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){const s=t.getFullYear(),a=s>0?s:1-s;return n.ordinalNumber(a,{unit:"year"})}return lightFormatters.y(t,r)},Y:function(t,r,n,s){const a=getWeekYear(t,s),i=a>0?a:1-a;if(r==="YY"){const o=i%100;return addLeadingZeros(o,2)}return r==="Yo"?n.ordinalNumber(i,{unit:"year"}):addLeadingZeros(i,r.length)},R:function(t,r){const n=getISOWeekYear(t);return addLeadingZeros(n,r.length)},u:function(t,r){const n=t.getFullYear();return addLeadingZeros(n,r.length)},Q:function(t,r,n){const s=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(s);case"QQ":return addLeadingZeros(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,r,n){const s=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(s);case"qq":return addLeadingZeros(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,r,n){const s=t.getMonth();switch(r){case"M":case"MM":return lightFormatters.M(t,r);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,r,n){const s=t.getMonth();switch(r){case"L":return String(s+1);case"LL":return addLeadingZeros(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,r,n,s){const a=getWeek(t,s);return r==="wo"?n.ordinalNumber(a,{unit:"week"}):addLeadingZeros(a,r.length)},I:function(t,r,n){const s=getISOWeek(t);return r==="Io"?n.ordinalNumber(s,{unit:"week"}):addLeadingZeros(s,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):lightFormatters.d(t,r)},D:function(t,r,n){const s=getDayOfYear(t);return r==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):addLeadingZeros(s,r.length)},E:function(t,r,n){const s=t.getDay();switch(r){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,r,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return addLeadingZeros(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return addLeadingZeros(i,r.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,n){const s=t.getDay(),a=s===0?7:s;switch(r){case"i":return String(a);case"ii":return addLeadingZeros(a,r.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,r,n){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,n){const s=t.getHours();let a;switch(s===12?a=dayPeriodEnum.noon:s===0?a=dayPeriodEnum.midnight:a=s/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,n){const s=t.getHours();let a;switch(s>=17?a=dayPeriodEnum.evening:s>=12?a=dayPeriodEnum.afternoon:s>=4?a=dayPeriodEnum.morning:a=dayPeriodEnum.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return lightFormatters.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):lightFormatters.H(t,r)},K:function(t,r,n){const s=t.getHours()%12;return r==="Ko"?n.ordinalNumber(s,{unit:"hour"}):addLeadingZeros(s,r.length)},k:function(t,r,n){let s=t.getHours();return s===0&&(s=24),r==="ko"?n.ordinalNumber(s,{unit:"hour"}):addLeadingZeros(s,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):lightFormatters.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):lightFormatters.s(t,r)},S:function(t,r){return lightFormatters.S(t,r)},X:function(t,r,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return formatTimezoneWithOptionalMinutes(s);case"XXXX":case"XX":return formatTimezone(s);case"XXXXX":case"XXX":default:return formatTimezone(s,":")}},x:function(t,r,n){const s=t.getTimezoneOffset();switch(r){case"x":return formatTimezoneWithOptionalMinutes(s);case"xxxx":case"xx":return formatTimezone(s);case"xxxxx":case"xxx":default:return formatTimezone(s,":")}},O:function(t,r,n){const s=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(s,":");case"OOOO":default:return"GMT"+formatTimezone(s,":")}},z:function(t,r,n){const s=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(s,":");case"zzzz":default:return"GMT"+formatTimezone(s,":")}},t:function(t,r,n){const s=Math.trunc(t.getTime()/1e3);return addLeadingZeros(s,r.length)},T:function(t,r,n){const s=t.getTime();return addLeadingZeros(s,r.length)}};function formatTimezoneShort(t,r=""){const n=t>0?"-":"+",s=Math.abs(t),a=Math.trunc(s/60),i=s%60;return i===0?n+String(a):n+String(a)+r+addLeadingZeros(i,2)}function formatTimezoneWithOptionalMinutes(t,r){return t%60===0?(t>0?"-":"+")+addLeadingZeros(Math.abs(t)/60,2):formatTimezone(t,r)}function formatTimezone(t,r=""){const n=t>0?"-":"+",s=Math.abs(t),a=addLeadingZeros(Math.trunc(s/60),2),i=addLeadingZeros(s%60,2);return n+a+r+i}const dateLongFormatter=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},timeLongFormatter=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},dateTimeLongFormatter=(t,r)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],a=n[2];if(!a)return dateLongFormatter(t,r);let i;switch(s){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",dateLongFormatter(s,r)).replace("{{time}}",timeLongFormatter(a,r))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(t){return dayOfYearTokenRE.test(t)}function isProtectedWeekYearToken(t){return weekYearTokenRE.test(t)}function warnOrThrowProtectedError(t,r,n){const s=message(t,r,n);if(console.warn(s),throwTokens.includes(t))throw new RangeError(s)}function message(t,r,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(t,r,n){var h,m,g,v;const s=getDefaultOptions(),a=s.locale??enUS,i=s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,o=s.weekStartsOn??((v=(g=s.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,c=toDate(t);if(!isValid(c))throw new RangeError("Invalid time value");let f=r.match(longFormattingTokensRegExp).map(y=>{const _=y[0];if(_==="p"||_==="P"){const w=longFormatters[_];return w(y,a.formatLong)}return y}).join("").match(formattingTokensRegExp).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const _=y[0];if(_==="'")return{isToken:!1,value:cleanEscapedString(y)};if(formatters$1[_])return{isToken:!0,value:y};if(_.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return f.map(y=>{if(!y.isToken)return y.value;const _=y.value;(isProtectedWeekYearToken(_)||isProtectedDayOfYearToken(_))&&warnOrThrowProtectedError(_,r,String(t));const w=formatters$1[_[0]];return w(c,_,a.localize,d)}).join("")}function cleanEscapedString(t){const r=t.match(escapedStringRegExp);return r?r[1].replace(doubleQuoteRegExp,"'"):t}function parseISO(t,r){const s=splitDateString(t);let a;if(s.date){const f=parseYear(s.date,2);a=parseDate$1(f.restDateString,f.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,c;if(s.time&&(o=parseTime(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(c=parseTimezone(s.timezone),isNaN(c))return new Date(NaN)}else{const f=new Date(i+o),d=new Date(0);return d.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),d.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),d}return new Date(i+o+c)}const patterns={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dateRegex=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,timeRegex=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,timezoneRegex=/^([+-])(\d{2})(?::?(\d{2}))?$/;function splitDateString(t){const r={},n=t.split(patterns.dateTimeDelimiter);let s;if(n.length>2)return r;if(/:/.test(n[0])?s=n[0]:(r.date=n[0],s=n[1],patterns.timeZoneDelimiter.test(r.date)&&(r.date=t.split(patterns.timeZoneDelimiter)[0],s=t.substr(r.date.length,t.length))),s){const a=patterns.timezone.exec(s);a?(r.time=s.replace(a[1],""),r.timezone=a[1]):r.time=s}return r}function parseYear(t,r){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((s[1]||s[2]).length)}}function parseDate$1(t,r){if(r===null)return new Date(NaN);const n=t.match(dateRegex);if(!n)return new Date(NaN);const s=!!n[4],a=parseDateUnit(n[1]),i=parseDateUnit(n[2])-1,o=parseDateUnit(n[3]),c=parseDateUnit(n[4]),f=parseDateUnit(n[5])-1;if(s)return validateWeekDate(r,c,f)?dayOfISOWeekYear(r,c,f):new Date(NaN);{const d=new Date(0);return!validateDate(r,i,o)||!validateDayOfYearDate(r,a)?new Date(NaN):(d.setUTCFullYear(r,i,Math.max(a,o)),d)}}function parseDateUnit(t){return t?parseInt(t):1}function parseTime(t){const r=t.match(timeRegex);if(!r)return NaN;const n=parseTimeUnit(r[1]),s=parseTimeUnit(r[2]),a=parseTimeUnit(r[3]);return validateTime(n,s,a)?n*millisecondsInHour+s*millisecondsInMinute+a*1e3:NaN}function parseTimeUnit(t){return t&&parseFloat(t.replace(",","."))||0}function parseTimezone(t){if(t==="Z")return 0;const r=t.match(timezoneRegex);if(!r)return 0;const n=r[1]==="+"?-1:1,s=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return validateTimezone(s,a)?n*(s*millisecondsInHour+a*millisecondsInMinute):NaN}function dayOfISOWeekYear(t,r,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const a=s.getUTCDay()||7,i=(r-1)*7+n+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const daysInMonths=[31,null,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex(t){return t%400===0||t%4===0&&t%100!==0}function validateDate(t,r,n){return r>=0&&r<=11&&n>=1&&n<=(daysInMonths[r]||(isLeapYearIndex(t)?29:28))}function validateDayOfYearDate(t,r){return r>=1&&r<=(isLeapYearIndex(t)?366:365)}function validateWeekDate(t,r,n){return r>=1&&r<=53&&n>=0&&n<=6}function validateTime(t,r,n){return t===24?r===0&&n===0:n>=0&&n<60&&r>=0&&r<60&&t>=0&&t<25}function validateTimezone(t,r){return r>=0&&r<=59}const DataContext=reactExports.createContext(void 0),DataProvider=({children:t})=>{const[r,n]=reactExports.useState(loadData());reactExports.useEffect(()=>{saveData(r)},[r]),reactExports.useEffect(()=>{const k=startOfMonth(new Date),C=format(k,"yyyy-MM");r.budgets.some(D=>!D.isTemplate&&format(new Date(D.startDate),"yyyy-MM")===C)||w()},[]);const s=T=>{const k={...T,id:v4()};n(C=>({...C,transactions:[...C.transactions,k]}))},a=T=>{n(k=>({...k,transactions:k.transactions.map(C=>C.id===T.id?T:C)}))},i=T=>{n(k=>({...k,transactions:k.transactions.filter(C=>C.id!==T)}))},o=T=>{const k={...T,id:v4()};n(C=>({...C,budgets:[...C.budgets,k]}))},c=T=>{n(k=>({...k,budgets:k.budgets.map(C=>C.id===T.id?T:C)}))},f=T=>{n(k=>({...k,budgets:k.budgets.filter(C=>C.id!==T)}))},d=T=>{const k={...T,id:v4()};n(C=>({...C,categories:[...C.categories,k]}))},h=T=>{n(k=>({...k,categories:k.categories.map(C=>C.id===T.id?T:C)}))},m=T=>{n(k=>({...k,categories:k.categories.filter(C=>C.id!==T)}))},g=T=>{n(k=>({...k,settings:T}))},v=()=>{n(loadData())},y=T=>{n(T)},_=()=>r.budgets.filter(T=>T.isTemplate),w=()=>{const T=_(),C=startOfMonth(new Date),L=T.map(D=>({...D,id:v4(),isTemplate:!1,startDate:C.toISOString().split("T")[0]}));n(D=>({...D,budgets:[...D.budgets,...L]}))},b={transactions:r.transactions,budgets:r.budgets,categories:r.categories,settings:r.settings,addTransaction:s,updateTransaction:a,deleteTransaction:i,addBudget:o,updateBudget:c,deleteBudget:f,addCategory:d,updateCategory:h,deleteCategory:m,updateSettings:g,resetData:v,importData:y,getPlannedBudgets:_,applyPlannedBudgets:w};return jsxRuntimeExports.jsx(DataContext.Provider,{value:b,children:t})},useData=()=>{const t=reactExports.useContext(DataContext);if(t===void 0)throw new Error("useData must be used within a DataProvider");return t},ThemeContext=reactExports.createContext(void 0),ThemeProvider=({children:t})=>{const[r,n]=reactExports.useState("light"),{settings:s}=useData();reactExports.useEffect(()=>{const o=c=>{n(c),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(c)};if(s.theme==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches;o(c?"dark":"light");const f=window.matchMedia("(prefers-color-scheme: dark)"),d=h=>{o(h.matches?"dark":"light")};return f.addEventListener("change",d),()=>f.removeEventListener("change",d)}else o(s.theme)},[s.theme]);const i={theme:r,toggleTheme:()=>{const o=r==="dark"?"light":"dark";n(o),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(o)}};return jsxRuntimeExports.jsx(ThemeContext.Provider,{value:i,children:t})},useTheme=()=>{const t=reactExports.useContext(ThemeContext);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},Layout=()=>{const{theme:t}=useTheme();return jsxRuntimeExports.jsxs("div",{className:t,children:[jsxRuntimeExports.jsx("main",{className:"min-h-screen pb-16",children:jsxRuntimeExports.jsx(Outlet,{})}),jsxRuntimeExports.jsx(NavBar$1,{})]})},warn=(t,r,n,s)=>{var i,o,c,f;const a=[n,{code:r,...s||{}}];if((o=(i=t==null?void 0:t.services)==null?void 0:i.logger)!=null&&o.forward)return t.services.logger.forward(a,"warn","react-i18next::",!0);isString$1(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),(f=(c=t==null?void 0:t.services)==null?void 0:c.logger)!=null&&f.warn?t.services.logger.warn(...a):console!=null&&console.warn&&console.warn(...a)},alreadyWarned={},warnOnce=(t,r,n,s)=>{isString$1(n)&&alreadyWarned[n]||(isString$1(n)&&(alreadyWarned[n]=new Date),warn(t,r,n,s))},loadedClb=(t,r)=>()=>{if(t.isInitialized)r();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),r()};t.on("initialized",n)}},loadNamespaces=(t,r,n)=>{t.loadNamespaces(r,loadedClb(t,n))},loadLanguages=(t,r,n,s)=>{if(isString$1(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(r)>-1)return loadNamespaces(t,n,s);n.forEach(a=>{t.options.ns.indexOf(a)<0&&t.options.ns.push(a)}),t.loadLanguages(r,loadedClb(t,s))},hasLoadedNamespace=(t,r,n={})=>!r.languages||!r.languages.length?(warnOnce(r,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:r.languages}),!0):r.hasLoadedNamespace(t,{lng:n.lng,precheck:(s,a)=>{var i;if(((i=n.bindI18n)==null?void 0:i.indexOf("languageChanging"))>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!a(s.isLanguageChangingTo,t))return!1}}),isString$1=t=>typeof t=="string",isObject$1=t=>typeof t=="object"&&t!==null,matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=t=>htmlEntities[t],unescape=t=>t.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape};const setDefaults=(t={})=>{defaultOptions={...defaultOptions,...t}},getDefaults=()=>defaultOptions;let i18nInstance;const setI18n=t=>{i18nInstance=t},getI18n=()=>i18nInstance,initReactI18next={type:"3rdParty",init(t){setDefaults(t.options.react),setI18n(t)}},I18nContext=reactExports.createContext();class ReportNamespaces{constructor(){this.usedNamespaces={}}addUsedNamespaces(r){r.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const usePrevious=(t,r)=>{const n=reactExports.useRef();return reactExports.useEffect(()=>{n.current=t},[t,r]),n.current},alwaysNewT=(t,r,n,s)=>t.getFixedT(r,n,s),useMemoizedT=(t,r,n,s)=>reactExports.useCallback(alwaysNewT(t,r,n,s),[t,r,n,s]),useTranslation=(t,r={})=>{var C,L,D,N;const{i18n:n}=r,{i18n:s,defaultNS:a}=reactExports.useContext(I18nContext)||{},i=n||s||getI18n();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new ReportNamespaces),!i){warnOnce(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const U=(j,K)=>isString$1(K)?K:isObject$1(K)&&isString$1(K.defaultValue)?K.defaultValue:Array.isArray(j)?j[j.length-1]:j,M=[U,{},!1];return M.t=U,M.i18n={},M.ready=!1,M}(C=i.options.react)!=null&&C.wait&&warnOnce(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...getDefaults(),...i.options.react,...r},{useSuspense:c,keyPrefix:f}=o;let d=a||((L=i.options)==null?void 0:L.defaultNS);d=isString$1(d)?[d]:d||["translation"],(N=(D=i.reportNamespaces).addUsedNamespaces)==null||N.call(D,d);const h=(i.isInitialized||i.initializedStoreOnce)&&d.every(U=>hasLoadedNamespace(U,i,o)),m=useMemoizedT(i,r.lng||null,o.nsMode==="fallback"?d:d[0],f),g=()=>m,v=()=>alwaysNewT(i,r.lng||null,o.nsMode==="fallback"?d:d[0],f),[y,_]=reactExports.useState(g);let w=d.join();r.lng&&(w=`${r.lng}${w}`);const b=usePrevious(w),T=reactExports.useRef(!0);reactExports.useEffect(()=>{const{bindI18n:U,bindI18nStore:M}=o;T.current=!0,!h&&!c&&(r.lng?loadLanguages(i,r.lng,d,()=>{T.current&&_(v)}):loadNamespaces(i,d,()=>{T.current&&_(v)})),h&&b&&b!==w&&T.current&&_(v);const j=()=>{T.current&&_(v)};return U&&(i==null||i.on(U,j)),M&&(i==null||i.store.on(M,j)),()=>{T.current=!1,i&&(U==null||U.split(" ").forEach(K=>i.off(K,j))),M&&i&&M.split(" ").forEach(K=>i.store.off(K,j))}},[i,w]),reactExports.useEffect(()=>{T.current&&h&&_(g)},[i,f,h]);const k=[y,i,h];if(k.t=y,k.i18n=i,k.ready=h,h||!h&&!c)return k;throw new Promise(U=>{r.lng?loadLanguages(i,r.lng,d,()=>U()):loadNamespaces(i,d,()=>U())})},formatCurrency=(t,r="EUR",n="fr-FR")=>new Intl.NumberFormat(n,{style:"currency",currency:r}).format(t),formatDate=t=>{try{return format(parseISO(t),"MMM d, yyyy")}catch{return console.error("Invalid date format:",t),t}},getTransactionsTotalByType=(t,r)=>t.filter(n=>n.type===r).reduce((n,s)=>n+s.amount,0),getNetBalance=t=>{const r=getTransactionsTotalByType(t,"income"),n=getTransactionsTotalByType(t,"expense");return r-n};function getStartOfCurrentPeriod$1(t){const r=new Date,n=r.getFullYear(),s=r.getMonth();return r.getDate()<t?new Date(n,s-1,t):new Date(n,s,t)}const BalanceCard=({transactions:t,currency:r,startOfMonthDay:n})=>{if(!t||!Array.isArray(t))return null;const s=getStartOfCurrentPeriod$1(n),a=t.filter(f=>new Date(f.date)>=s),i=getTransactionsTotalByType(a,"income"),o=getTransactionsTotalByType(a,"expense"),c=getNetBalance(a);return jsxRuntimeExports.jsxs("div",{className:"card relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-primary-100 dark:bg-primary-900/20 rounded-bl-full opacity-50"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Balance"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center mt-1",children:[jsxRuntimeExports.jsx(DollarSign,{size:28,className:`mr-2 ${c>=0?"text-success-500":"text-error-500"}`}),jsxRuntimeExports.jsx("span",{className:`text-3xl font-bold ${c>=0?"text-success-500":"text-error-500"}`,children:formatCurrency(c,r)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"rounded-full bg-primary-100 dark:bg-primary-900/30 p-2 mr-3",children:jsxRuntimeExports.jsx(TrendingUp,{size:18,className:"text-primary-600 dark:text-primary-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Income"}),jsxRuntimeExports.jsx("p",{className:"font-semibold",children:formatCurrency(i,r)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"rounded-full bg-accent-100 dark:bg-accent-900/30 p-2 mr-3",children:jsxRuntimeExports.jsx(TrendingDown,{size:18,className:"text-accent-600 dark:text-accent-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Expenses"}),jsxRuntimeExports.jsx("p",{className:"font-semibold",children:formatCurrency(o,r)})]})]})]})]})]})},TransactionList=({transactions:t,limit:r})=>{const{categories:n,settings:s}=useData(),a=r?t.slice(0,r):t;return jsxRuntimeExports.jsx("div",{className:"card p-0 divide-y divide-gray-100 dark:divide-gray-800",children:a.length>0?a.map(i=>{const o=n.find(f=>f.name===i.category),c=i.type==="expense";return jsxRuntimeExports.jsxs(Link,{to:`/${i.type}s/${i.id}`,className:"flex items-center p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center mr-3",style:{backgroundColor:(o==null?void 0:o.color)+"30"},children:jsxRuntimeExports.jsx("span",{className:"text-lg font-bold",style:{color:o==null?void 0:o.color},children:i.category.charAt(0)})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:i.description}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i.category," • ",formatDate(i.date)]})]}),jsxRuntimeExports.jsxs("div",{className:`font-semibold ${c?"text-red-500 dark:text-red-400":"text-green-500 dark:text-green-400"}`,children:[c?"−":"+",formatCurrency(i.amount,s.currency)]})]},i.id)}):jsxRuntimeExports.jsx("div",{className:"p-6 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No transactions found"})})})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function round(t){return t+.5|0}const lim=(t,r,n)=>Math.max(Math.min(t,n),r);function p2b(t){return lim(round(t*2.55),0,255)}function n2b(t){return lim(round(t*255),0,255)}function b2n(t){return lim(round(t/2.55)/100,0,1)}function n2p(t){return lim(round(t*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=t=>hex[t&15],h2=t=>hex[(t&240)>>4]+hex[t&15],eq=t=>(t&240)>>4===(t&15),isShort=t=>eq(t.r)&&eq(t.g)&&eq(t.b)&&eq(t.a);function hexParse(t){var r=t.length,n;return t[0]==="#"&&(r===4||r===5?n={r:255&map$1[t[1]]*17,g:255&map$1[t[2]]*17,b:255&map$1[t[3]]*17,a:r===5?map$1[t[4]]*17:255}:(r===7||r===9)&&(n={r:map$1[t[1]]<<4|map$1[t[2]],g:map$1[t[3]]<<4|map$1[t[4]],b:map$1[t[5]]<<4|map$1[t[6]],a:r===9?map$1[t[7]]<<4|map$1[t[8]]:255})),n}const alpha=(t,r)=>t<255?r(t):"";function hexString(t){var r=isShort(t)?h1:h2;return t?"#"+r(t.r)+r(t.g)+r(t.b)+alpha(t.a,r):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(t,r,n){const s=r*Math.min(n,1-n),a=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[a(0),a(8),a(4)]}function hsv2rgbn(t,r,n){const s=(a,i=(a+t/60)%6)=>n-n*r*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function hwb2rgbn(t,r,n){const s=hsl2rgbn(t,1,.5);let a;for(r+n>1&&(a=1/(r+n),r*=a,n*=a),a=0;a<3;a++)s[a]*=1-r-n,s[a]+=r;return s}function hueValue(t,r,n,s,a){return t===a?(r-n)/s+(r<n?6:0):r===a?(n-t)/s+2:(t-r)/s+4}function rgb2hsl(t){const n=t.r/255,s=t.g/255,a=t.b/255,i=Math.max(n,s,a),o=Math.min(n,s,a),c=(i+o)/2;let f,d,h;return i!==o&&(h=i-o,d=c>.5?h/(2-i-o):h/(i+o),f=hueValue(n,s,a,h,i),f=f*60+.5),[f|0,d||0,c]}function calln(t,r,n,s){return(Array.isArray(r)?t(r[0],r[1],r[2]):t(r,n,s)).map(n2b)}function hsl2rgb(t,r,n){return calln(hsl2rgbn,t,r,n)}function hwb2rgb(t,r,n){return calln(hwb2rgbn,t,r,n)}function hsv2rgb(t,r,n){return calln(hsv2rgbn,t,r,n)}function hue(t){return(t%360+360)%360}function hueParse(t){const r=HUE_RE.exec(t);let n=255,s;if(!r)return;r[5]!==s&&(n=r[6]?p2b(+r[5]):n2b(+r[5]));const a=hue(+r[2]),i=+r[3]/100,o=+r[4]/100;return r[1]==="hwb"?s=hwb2rgb(a,i,o):r[1]==="hsv"?s=hsv2rgb(a,i,o):s=hsl2rgb(a,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function rotate(t,r){var n=rgb2hsl(t);n[0]=hue(n[0]+r),n=hsl2rgb(n),t.r=n[0],t.g=n[1],t.b=n[2]}function hslString(t){if(!t)return;const r=rgb2hsl(t),n=r[0],s=n2p(r[1]),a=n2p(r[2]);return t.a<255?`hsla(${n}, ${s}%, ${a}%, ${b2n(t.a)})`:`hsl(${n}, ${s}%, ${a}%)`}const map={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const t={},r=Object.keys(names$1),n=Object.keys(map);let s,a,i,o,c;for(s=0;s<r.length;s++){for(o=c=r[s],a=0;a<n.length;a++)i=n[a],c=c.replace(i,map[i]);i=parseInt(names$1[o],16),t[c]=[i>>16&255,i>>8&255,i&255]}return t}let names;function nameParse(t){names||(names=unpack(),names.transparent=[0,0,0,0]);const r=names[t.toLowerCase()];return r&&{r:r[0],g:r[1],b:r[2],a:r.length===4?r[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(t){const r=RGB_RE.exec(t);let n=255,s,a,i;if(r){if(r[7]!==s){const o=+r[7];n=r[8]?p2b(o):lim(o*255,0,255)}return s=+r[1],a=+r[3],i=+r[5],s=255&(r[2]?p2b(s):lim(s,0,255)),a=255&(r[4]?p2b(a):lim(a,0,255)),i=255&(r[6]?p2b(i):lim(i,0,255)),{r:s,g:a,b:i,a:n}}}function rgbString(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${b2n(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const to=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,from=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function interpolate$1(t,r,n){const s=from(b2n(t.r)),a=from(b2n(t.g)),i=from(b2n(t.b));return{r:n2b(to(s+n*(from(b2n(r.r))-s))),g:n2b(to(a+n*(from(b2n(r.g))-a))),b:n2b(to(i+n*(from(b2n(r.b))-i))),a:t.a+n*(r.a-t.a)}}function modHSL(t,r,n){if(t){let s=rgb2hsl(t);s[r]=Math.max(0,Math.min(s[r]+s[r]*n,r===0?360:1)),s=hsl2rgb(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function clone$1(t,r){return t&&Object.assign(r||{},t)}function fromObject(t){var r={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(r={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(r.a=n2b(t[3]))):(r=clone$1(t,{r:0,g:0,b:0,a:1}),r.a=n2b(r.a)),r}function functionParse(t){return t.charAt(0)==="r"?rgbParse(t):hueParse(t)}class Color{constructor(r){if(r instanceof Color)return r;const n=typeof r;let s;n==="object"?s=fromObject(r):n==="string"&&(s=hexParse(r)||nameParse(r)||functionParse(r)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var r=clone$1(this._rgb);return r&&(r.a=b2n(r.a)),r}set rgb(r){this._rgb=fromObject(r)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(r,n){if(r){const s=this.rgb,a=r.rgb;let i;const o=n===i?.5:n,c=2*o-1,f=s.a-a.a,d=((c*f===-1?c:(c+f)/(1+c*f))+1)/2;i=1-d,s.r=255&d*s.r+i*a.r+.5,s.g=255&d*s.g+i*a.g+.5,s.b=255&d*s.b+i*a.b+.5,s.a=o*s.a+(1-o)*a.a,this.rgb=s}return this}interpolate(r,n){return r&&(this._rgb=interpolate$1(this._rgb,r._rgb,n)),this}clone(){return new Color(this.rgb)}alpha(r){return this._rgb.a=n2b(r),this}clearer(r){const n=this._rgb;return n.a*=1-r,this}greyscale(){const r=this._rgb,n=round(r.r*.3+r.g*.59+r.b*.11);return r.r=r.g=r.b=n,this}opaquer(r){const n=this._rgb;return n.a*=1+r,this}negate(){const r=this._rgb;return r.r=255-r.r,r.g=255-r.g,r.b=255-r.b,this}lighten(r){return modHSL(this._rgb,2,r),this}darken(r){return modHSL(this._rgb,2,-r),this}saturate(r){return modHSL(this._rgb,1,r),this}desaturate(r){return modHSL(this._rgb,1,-r),this}rotate(r){return rotate(this._rgb,r),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function noop$1(){}const uid=(()=>{let t=0;return()=>t++})();function isNullOrUndef(t){return t==null}function isArray(t){if(Array.isArray&&Array.isArray(t))return!0;const r=Object.prototype.toString.call(t);return r.slice(0,7)==="[object"&&r.slice(-6)==="Array]"}function isObject(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function isNumberFinite(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function finiteOrDefault(t,r){return isNumberFinite(t)?t:r}function valueOrDefault(t,r){return typeof t>"u"?r:t}const toPercentage=(t,r)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/r,toDimension=(t,r)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*r:+t;function callback(t,r,n){if(t&&typeof t.call=="function")return t.apply(n,r)}function each(t,r,n,s){let a,i,o;if(isArray(t))for(i=t.length,a=0;a<i;a++)r.call(n,t[a],a);else if(isObject(t))for(o=Object.keys(t),i=o.length,a=0;a<i;a++)r.call(n,t[o[a]],o[a])}function _elementsEqual(t,r){let n,s,a,i;if(!t||!r||t.length!==r.length)return!1;for(n=0,s=t.length;n<s;++n)if(a=t[n],i=r[n],a.datasetIndex!==i.datasetIndex||a.index!==i.index)return!1;return!0}function clone(t){if(isArray(t))return t.map(clone);if(isObject(t)){const r=Object.create(null),n=Object.keys(t),s=n.length;let a=0;for(;a<s;++a)r[n[a]]=clone(t[n[a]]);return r}return t}function isValidKey(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function _merger(t,r,n,s){if(!isValidKey(t))return;const a=r[t],i=n[t];isObject(a)&&isObject(i)?merge(a,i,s):r[t]=clone(i)}function merge(t,r,n){const s=isArray(r)?r:[r],a=s.length;if(!isObject(t))return t;n=n||{};const i=n.merger||_merger;let o;for(let c=0;c<a;++c){if(o=s[c],!isObject(o))continue;const f=Object.keys(o);for(let d=0,h=f.length;d<h;++d)i(f[d],t,o,n)}return t}function mergeIf(t,r){return merge(t,r,{merger:_mergerIf})}function _mergerIf(t,r,n){if(!isValidKey(t))return;const s=r[t],a=n[t];isObject(s)&&isObject(a)?mergeIf(s,a):Object.prototype.hasOwnProperty.call(r,t)||(r[t]=clone(a))}const keyResolvers={"":t=>t,x:t=>t.x,y:t=>t.y};function _splitKey(t){const r=t.split("."),n=[];let s="";for(const a of r)s+=a,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function _getKeyResolver(t){const r=_splitKey(t);return n=>{for(const s of r){if(s==="")break;n=n&&n[s]}return n}}function resolveObjectKey(t,r){return(keyResolvers[r]||(keyResolvers[r]=_getKeyResolver(r)))(t)}function _capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}const defined=t=>typeof t<"u",isFunction=t=>typeof t=="function",setsEqual=(t,r)=>{if(t.size!==r.size)return!1;for(const n of t)if(!r.has(n))return!1;return!0};function _isClickEvent(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(t,r,n){return Math.abs(t-r)<n}function niceNum(t){const r=Math.round(t);t=almostEquals(t,r,t/1e3)?r:t;const n=Math.pow(10,Math.floor(log10(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function _factorize(t){const r=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(r.push(s),r.push(t/s));return n===(n|0)&&r.push(n),r.sort((a,i)=>a-i).pop(),r}function isNonPrimitive(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function isNumber(t){return!isNonPrimitive(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function almostWhole(t,r){const n=Math.round(t);return n-r<=t&&n+r>=t}function _setMinAndMaxByKey(t,r,n){let s,a,i;for(s=0,a=t.length;s<a;s++)i=t[s][n],isNaN(i)||(r.min=Math.min(r.min,i),r.max=Math.max(r.max,i))}function toRadians(t){return t*(PI/180)}function toDegrees(t){return t*(180/PI)}function _decimalPlaces(t){if(!isNumberFinite(t))return;let r=1,n=0;for(;Math.round(t*r)/r!==t;)r*=10,n++;return n}function getAngleFromPoint(t,r){const n=r.x-t.x,s=r.y-t.y,a=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*PI&&(i+=TAU),{angle:i,distance:a}}function distanceBetweenPoints(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))}function _angleDiff(t,r){return(t-r+PITAU)%TAU-PI}function _normalizeAngle(t){return(t%TAU+TAU)%TAU}function _angleBetween(t,r,n,s){const a=_normalizeAngle(t),i=_normalizeAngle(r),o=_normalizeAngle(n),c=_normalizeAngle(i-a),f=_normalizeAngle(o-a),d=_normalizeAngle(a-i),h=_normalizeAngle(a-o);return a===i||a===o||s&&i===o||c>f&&d<h}function _limitValue(t,r,n){return Math.max(r,Math.min(n,t))}function _int16Range(t){return _limitValue(t,-32768,32767)}function _isBetween(t,r,n,s=1e-6){return t>=Math.min(r,n)-s&&t<=Math.max(r,n)+s}function _lookup(t,r,n){n=n||(o=>t[o]<r);let s=t.length-1,a=0,i;for(;s-a>1;)i=a+s>>1,n(i)?a=i:s=i;return{lo:a,hi:s}}const _lookupByKey=(t,r,n,s)=>_lookup(t,n,s?a=>{const i=t[a][r];return i<n||i===n&&t[a+1][r]===n}:a=>t[a][r]<n),_rlookupByKey=(t,r,n)=>_lookup(t,n,s=>t[s][r]>=n);function _filterBetween(t,r,n){let s=0,a=t.length;for(;s<a&&t[s]<r;)s++;for(;a>s&&t[a-1]>n;)a--;return s>0||a<t.length?t.slice(s,a):t}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(t,r){if(t._chartjs){t._chartjs.listeners.push(r);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),arrayEvents.forEach(n=>{const s="_onData"+_capitalize(n),a=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=a.apply(this,i);return t._chartjs.listeners.forEach(c=>{typeof c[s]=="function"&&c[s](...i)}),o}})})}function unlistenArrayEvents(t,r){const n=t._chartjs;if(!n)return;const s=n.listeners,a=s.indexOf(r);a!==-1&&s.splice(a,1),!(s.length>0)&&(arrayEvents.forEach(i=>{delete t[i]}),delete t._chartjs)}function _arrayUnique(t){const r=new Set(t);return r.size===t.length?t:Array.from(r)}const requestAnimFrame=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function throttled(t,r){let n=[],s=!1;return function(...a){n=a,s||(s=!0,requestAnimFrame.call(window,()=>{s=!1,t.apply(r,n)}))}}function debounce(t,r){let n;return function(...s){return r?(clearTimeout(n),n=setTimeout(t,r,s)):t.apply(this,s),r}}const _toLeftRightCenter=t=>t==="start"?"left":t==="end"?"right":"center",_alignStartEnd=(t,r,n)=>t==="start"?r:t==="end"?n:(r+n)/2,_textX=(t,r,n,s)=>t===(s?"left":"right")?n:t==="center"?(r+n)/2:r;function _getStartAndCountOfVisiblePoints(t,r,n){const s=r.length;let a=0,i=s;if(t._sorted){const{iScale:o,vScale:c,_parsed:f}=t,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,h=o.axis,{min:m,max:g,minDefined:v,maxDefined:y}=o.getUserBounds();if(v){if(a=Math.min(_lookupByKey(f,h,m).lo,n?s:_lookupByKey(r,h,o.getPixelForValue(m)).lo),d){const _=f.slice(0,a+1).reverse().findIndex(w=>!isNullOrUndef(w[c.axis]));a-=Math.max(0,_)}a=_limitValue(a,0,s-1)}if(y){let _=Math.max(_lookupByKey(f,o.axis,g,!0).hi+1,n?0:_lookupByKey(r,h,o.getPixelForValue(g),!0).hi+1);if(d){const w=f.slice(_-1).findIndex(b=>!isNullOrUndef(b[c.axis]));_+=Math.max(0,w)}i=_limitValue(_,a,s)-a}else i=s-a}return{start:a,count:i}}function _scaleRangesChanged(t){const{xScale:r,yScale:n,_scaleRanges:s}=t,a={xmin:r.min,xmax:r.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=a,!0;const i=s.xmin!==r.min||s.xmax!==r.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,a),i}const atEdge=t=>t===0||t===1,elasticIn=(t,r,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-r)*TAU/n)),elasticOut=(t,r,n)=>Math.pow(2,-10*t)*Math.sin((t-r)*TAU/n)+1,effects={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*HALF_PI)+1,easeOutSine:t=>Math.sin(t*HALF_PI),easeInOutSine:t=>-.5*(Math.cos(PI*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>atEdge(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>atEdge(t)?t:elasticIn(t,.075,.3),easeOutElastic:t=>atEdge(t)?t:elasticOut(t,.075,.3),easeInOutElastic(t){return atEdge(t)?t:t<.5?.5*elasticIn(t*2,.1125,.45):.5+.5*elasticOut(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let r=1.70158;return(t/=.5)<1?.5*(t*t*(((r*=1.525)+1)*t-r)):.5*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)},easeInBounce:t=>1-effects.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?effects.easeInBounce(t*2)*.5:effects.easeOutBounce(t*2-1)*.5+.5};function isPatternOrGradient(t){if(t&&typeof t=="object"){const r=t.toString();return r==="[object CanvasPattern]"||r==="[object CanvasGradient]"}return!1}function color(t){return isPatternOrGradient(t)?t:new Color(t)}function getHoverColor(t){return isPatternOrGradient(t)?t:new Color(t).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:r=>r!=="onProgress"&&r!=="onComplete"&&r!=="fn"}),t.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:r=>r|0}}}})}function applyLayoutsDefaults(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(t,r){r=r||{};const n=t+JSON.stringify(r);let s=intlCache.get(n);return s||(s=new Intl.NumberFormat(t,r),intlCache.set(n,s)),s}function formatNumber(t,r,n){return getNumberFormat(r,n).format(t)}const formatters={values(t){return isArray(t)?t:""+t},numeric(t,r,n){if(t===0)return"0";const s=this.chart.options.locale;let a,i=t;if(n.length>1){const d=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(d<1e-4||d>1e15)&&(a="scientific"),i=calculateDelta(t,n)}const o=log10(Math.abs(i)),c=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),f={notation:a,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(f,this.options.ticks.format),formatNumber(t,s,f)}};function calculateDelta(t,r){let n=r.length>3?r[2].value-r[1].value:r[1].value-r[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Ticks={formatters};function applyScaleDefaults(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(r,n)=>n.lineWidth,tickColor:(r,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:r=>!r.startsWith("before")&&!r.startsWith("after")&&r!=="callback"&&r!=="parser",_indexable:r=>r!=="borderDash"&&r!=="tickBorderDash"&&r!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:r=>r!=="backdropPadding"&&r!=="callback",_indexable:r=>r!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(t,r){if(!r)return t;const n=r.split(".");for(let s=0,a=n.length;s<a;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function set(t,r,n){return typeof r=="string"?merge(getScope$1(t,r),n):merge(getScope$1(t,""),r)}class Defaults{constructor(r,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,a)=>getHoverColor(a.backgroundColor),this.hoverBorderColor=(s,a)=>getHoverColor(a.borderColor),this.hoverColor=(s,a)=>getHoverColor(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(r),this.apply(n)}set(r,n){return set(this,r,n)}get(r){return getScope$1(this,r)}describe(r,n){return set(descriptors,r,n)}override(r,n){return set(overrides,r,n)}route(r,n,s,a){const i=getScope$1(this,r),o=getScope$1(this,s),c="_"+n;Object.defineProperties(i,{[c]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[c],d=o[a];return isObject(f)?Object.assign({},d,f):valueOrDefault(f,d)},set(f){this[c]=f}}})}apply(r){r.forEach(n=>n(this))}}var defaults=new Defaults({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(t){return!t||isNullOrUndef(t.size)||isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function _measureText(t,r,n,s,a){let i=r[a];return i||(i=r[a]=t.measureText(a).width,n.push(a)),i>s&&(s=i),s}function _alignPixel(t,r,n){const s=t.currentDevicePixelRatio,a=n!==0?Math.max(n/2,.5):0;return Math.round((r-a)*s)/s+a}function clearCanvas(t,r){!r&&!t||(r=r||t.getContext("2d"),r.save(),r.resetTransform(),r.clearRect(0,0,t.width,t.height),r.restore())}function drawPoint(t,r,n,s){drawPointLegend(t,r,n,s,null)}function drawPointLegend(t,r,n,s,a){let i,o,c,f,d,h,m,g;const v=r.pointStyle,y=r.rotation,_=r.radius;let w=(y||0)*RAD_PER_DEG;if(v&&typeof v=="object"&&(i=v.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(w),t.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),t.restore();return}if(!(isNaN(_)||_<=0)){switch(t.beginPath(),v){default:a?t.ellipse(n,s,a/2,_,0,0,TAU):t.arc(n,s,_,0,TAU),t.closePath();break;case"triangle":h=a?a/2:_,t.moveTo(n+Math.sin(w)*h,s-Math.cos(w)*_),w+=TWO_THIRDS_PI,t.lineTo(n+Math.sin(w)*h,s-Math.cos(w)*_),w+=TWO_THIRDS_PI,t.lineTo(n+Math.sin(w)*h,s-Math.cos(w)*_),t.closePath();break;case"rectRounded":d=_*.516,f=_-d,o=Math.cos(w+QUARTER_PI)*f,m=Math.cos(w+QUARTER_PI)*(a?a/2-d:f),c=Math.sin(w+QUARTER_PI)*f,g=Math.sin(w+QUARTER_PI)*(a?a/2-d:f),t.arc(n-m,s-c,d,w-PI,w-HALF_PI),t.arc(n+g,s-o,d,w-HALF_PI,w),t.arc(n+m,s+c,d,w,w+HALF_PI),t.arc(n-g,s+o,d,w+HALF_PI,w+PI),t.closePath();break;case"rect":if(!y){f=Math.SQRT1_2*_,h=a?a/2:f,t.rect(n-h,s-f,2*h,2*f);break}w+=QUARTER_PI;case"rectRot":m=Math.cos(w)*(a?a/2:_),o=Math.cos(w)*_,c=Math.sin(w)*_,g=Math.sin(w)*(a?a/2:_),t.moveTo(n-m,s-c),t.lineTo(n+g,s-o),t.lineTo(n+m,s+c),t.lineTo(n-g,s+o),t.closePath();break;case"crossRot":w+=QUARTER_PI;case"cross":m=Math.cos(w)*(a?a/2:_),o=Math.cos(w)*_,c=Math.sin(w)*_,g=Math.sin(w)*(a?a/2:_),t.moveTo(n-m,s-c),t.lineTo(n+m,s+c),t.moveTo(n+g,s-o),t.lineTo(n-g,s+o);break;case"star":m=Math.cos(w)*(a?a/2:_),o=Math.cos(w)*_,c=Math.sin(w)*_,g=Math.sin(w)*(a?a/2:_),t.moveTo(n-m,s-c),t.lineTo(n+m,s+c),t.moveTo(n+g,s-o),t.lineTo(n-g,s+o),w+=QUARTER_PI,m=Math.cos(w)*(a?a/2:_),o=Math.cos(w)*_,c=Math.sin(w)*_,g=Math.sin(w)*(a?a/2:_),t.moveTo(n-m,s-c),t.lineTo(n+m,s+c),t.moveTo(n+g,s-o),t.lineTo(n-g,s+o);break;case"line":o=a?a/2:Math.cos(w)*_,c=Math.sin(w)*_,t.moveTo(n-o,s-c),t.lineTo(n+o,s+c);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(w)*(a?a/2:_),s+Math.sin(w)*_);break;case!1:t.closePath();break}t.fill(),r.borderWidth>0&&t.stroke()}}function _isPointInArea(t,r,n){return n=n||.5,!r||t&&t.x>r.left-n&&t.x<r.right+n&&t.y>r.top-n&&t.y<r.bottom+n}function clipArea(t,r){t.save(),t.beginPath(),t.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),t.clip()}function unclipArea(t){t.restore()}function _steppedLineTo(t,r,n,s,a){if(!r)return t.lineTo(n.x,n.y);if(a==="middle"){const i=(r.x+n.x)/2;t.lineTo(i,r.y),t.lineTo(i,n.y)}else a==="after"!=!!s?t.lineTo(r.x,n.y):t.lineTo(n.x,r.y);t.lineTo(n.x,n.y)}function _bezierCurveTo(t,r,n,s){if(!r)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?r.cp1x:r.cp2x,s?r.cp1y:r.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function setRenderOpts(t,r){r.translation&&t.translate(r.translation[0],r.translation[1]),isNullOrUndef(r.rotation)||t.rotate(r.rotation),r.color&&(t.fillStyle=r.color),r.textAlign&&(t.textAlign=r.textAlign),r.textBaseline&&(t.textBaseline=r.textBaseline)}function decorateText(t,r,n,s,a){if(a.strikethrough||a.underline){const i=t.measureText(s),o=r-i.actualBoundingBoxLeft,c=r+i.actualBoundingBoxRight,f=n-i.actualBoundingBoxAscent,d=n+i.actualBoundingBoxDescent,h=a.strikethrough?(f+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=a.decorationWidth||2,t.moveTo(o,h),t.lineTo(c,h),t.stroke()}}function drawBackdrop(t,r){const n=t.fillStyle;t.fillStyle=r.color,t.fillRect(r.left,r.top,r.width,r.height),t.fillStyle=n}function renderText(t,r,n,s,a,i={}){const o=isArray(r)?r:[r],c=i.strokeWidth>0&&i.strokeColor!=="";let f,d;for(t.save(),t.font=a.string,setRenderOpts(t,i),f=0;f<o.length;++f)d=o[f],i.backdrop&&drawBackdrop(t,i.backdrop),c&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),isNullOrUndef(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(d,n,s,i.maxWidth)),t.fillText(d,n,s,i.maxWidth),decorateText(t,n,s,d,i),s+=Number(a.lineHeight);t.restore()}function addRoundedRectPath(t,r){const{x:n,y:s,w:a,h:i,radius:o}=r;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*PI,PI,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,PI,HALF_PI,!0),t.lineTo(n+a-o.bottomRight,s+i),t.arc(n+a-o.bottomRight,s+i-o.bottomRight,o.bottomRight,HALF_PI,0,!0),t.lineTo(n+a,s+o.topRight),t.arc(n+a-o.topRight,s+o.topRight,o.topRight,0,-HALF_PI,!0),t.lineTo(n+o.topLeft,s)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(t,r){const n=(""+t).match(LINE_HEIGHT);if(!n||n[1]==="normal")return r*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return r*t}const numberOrZero=t=>+t||0;function _readValueToProps(t,r){const n={},s=isObject(r),a=s?Object.keys(r):r,i=isObject(t)?s?o=>valueOrDefault(t[o],t[r[o]]):o=>t[o]:()=>t;for(const o of a)n[o]=numberOrZero(i(o));return n}function toTRBL(t){return _readValueToProps(t,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(t){return _readValueToProps(t,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(t){const r=toTRBL(t);return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function toFont(t,r){t=t||{},r=r||defaults.font;let n=valueOrDefault(t.size,r.size);typeof n=="string"&&(n=parseInt(n,10));let s=valueOrDefault(t.style,r.style);s&&!(""+s).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const a={family:valueOrDefault(t.family,r.family),lineHeight:toLineHeight(valueOrDefault(t.lineHeight,r.lineHeight),n),size:n,style:s,weight:valueOrDefault(t.weight,r.weight),string:""};return a.string=toFontString(a),a}function resolve(t,r,n,s){let a,i,o;for(a=0,i=t.length;a<i;++a)if(o=t[a],o!==void 0&&o!==void 0)return o}function _addGrace(t,r,n){const{min:s,max:a}=t,i=toDimension(r,(a-s)/2),o=(c,f)=>n&&c===0?0:c+f;return{min:o(s,-Math.abs(i)),max:o(a,i)}}function createContext(t,r){return Object.assign(Object.create(t),r)}function _createResolver(t,r=[""],n,s,a=()=>t[0]){const i=n||t;typeof s>"u"&&(s=_resolve("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:a,override:c=>_createResolver([c,...t],r,i,s)};return new Proxy(o,{deleteProperty(c,f){return delete c[f],delete c._keys,delete t[0][f],!0},get(c,f){return _cached(c,f,()=>_resolveWithPrefixes(f,r,t,c))},getOwnPropertyDescriptor(c,f){return Reflect.getOwnPropertyDescriptor(c._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(c,f){return getKeysFromAllScopes(c).includes(f)},ownKeys(c){return getKeysFromAllScopes(c)},set(c,f,d){const h=c._storage||(c._storage=a());return c[f]=h[f]=d,delete c._keys,!0}})}function _attachContext(t,r,n,s){const a={_cacheable:!1,_proxy:t,_context:r,_subProxy:n,_stack:new Set,_descriptors:_descriptors(t,s),setContext:i=>_attachContext(t,i,n,s),override:i=>_attachContext(t.override(i),r,n,s)};return new Proxy(a,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,c){return _cached(i,o,()=>_resolveWithContext(i,o,c))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,c){return t[o]=c,delete i[o],!0}})}function _descriptors(t,r={scriptable:!0,indexable:!0}){const{_scriptable:n=r.scriptable,_indexable:s=r.indexable,_allKeys:a=r.allKeys}=t;return{allKeys:a,scriptable:n,indexable:s,isScriptable:isFunction(n)?n:()=>n,isIndexable:isFunction(s)?s:()=>s}}const readKey=(t,r)=>t?t+_capitalize(r):r,needsSubResolver=(t,r)=>isObject(r)&&t!=="adapters"&&(Object.getPrototypeOf(r)===null||r.constructor===Object);function _cached(t,r,n){if(Object.prototype.hasOwnProperty.call(t,r)||r==="constructor")return t[r];const s=n();return t[r]=s,s}function _resolveWithContext(t,r,n){const{_proxy:s,_context:a,_subProxy:i,_descriptors:o}=t;let c=s[r];return isFunction(c)&&o.isScriptable(r)&&(c=_resolveScriptable(r,c,t,n)),isArray(c)&&c.length&&(c=_resolveArray(r,c,t,o.isIndexable)),needsSubResolver(r,c)&&(c=_attachContext(c,a,i&&i[r],o)),c}function _resolveScriptable(t,r,n,s){const{_proxy:a,_context:i,_subProxy:o,_stack:c}=n;if(c.has(t))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+t);c.add(t);let f=r(i,o||s);return c.delete(t),needsSubResolver(t,f)&&(f=createSubResolver(a._scopes,a,t,f)),f}function _resolveArray(t,r,n,s){const{_proxy:a,_context:i,_subProxy:o,_descriptors:c}=n;if(typeof i.index<"u"&&s(t))return r[i.index%r.length];if(isObject(r[0])){const f=r,d=a._scopes.filter(h=>h!==f);r=[];for(const h of f){const m=createSubResolver(d,a,t,h);r.push(_attachContext(m,i,o&&o[t],c))}}return r}function resolveFallback(t,r,n){return isFunction(t)?t(r,n):t}const getScope=(t,r)=>t===!0?r:typeof t=="string"?resolveObjectKey(r,t):void 0;function addScopes(t,r,n,s,a){for(const i of r){const o=getScope(n,i);if(o){t.add(o);const c=resolveFallback(o._fallback,n,a);if(typeof c<"u"&&c!==n&&c!==s)return c}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function createSubResolver(t,r,n,s){const a=r._rootScopes,i=resolveFallback(r._fallback,n,s),o=[...t,...a],c=new Set;c.add(s);let f=addScopesFromKey(c,o,n,i||n,s);return f===null||typeof i<"u"&&i!==n&&(f=addScopesFromKey(c,o,i,f,s),f===null)?!1:_createResolver(Array.from(c),[""],a,i,()=>subGetTarget(r,n,s))}function addScopesFromKey(t,r,n,s,a){for(;n;)n=addScopes(t,r,n,s,a);return n}function subGetTarget(t,r,n){const s=t._getTarget();r in s||(s[r]={});const a=s[r];return isArray(a)&&isObject(n)?n:a||{}}function _resolveWithPrefixes(t,r,n,s){let a;for(const i of r)if(a=_resolve(readKey(i,t),n),typeof a<"u")return needsSubResolver(t,a)?createSubResolver(n,s,t,a):a}function _resolve(t,r){for(const n of r){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function getKeysFromAllScopes(t){let r=t._keys;return r||(r=t._keys=resolveKeysFromAllScopes(t._scopes)),r}function resolveKeysFromAllScopes(t){const r=new Set;for(const n of t)for(const s of Object.keys(n).filter(a=>!a.startsWith("_")))r.add(s);return Array.from(r)}const EPSILON=Number.EPSILON||1e-14,getPoint=(t,r)=>r<t.length&&!t[r].skip&&t[r],getValueAxis=t=>t==="x"?"y":"x";function splineCurve(t,r,n,s){const a=t.skip?r:t,i=r,o=n.skip?r:n,c=distanceBetweenPoints(i,a),f=distanceBetweenPoints(o,i);let d=c/(c+f),h=f/(c+f);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const m=s*d,g=s*h;return{previous:{x:i.x-m*(o.x-a.x),y:i.y-m*(o.y-a.y)},next:{x:i.x+g*(o.x-a.x),y:i.y+g*(o.y-a.y)}}}function monotoneAdjust(t,r,n){const s=t.length;let a,i,o,c,f,d=getPoint(t,0);for(let h=0;h<s-1;++h)if(f=d,d=getPoint(t,h+1),!(!f||!d)){if(almostEquals(r[h],0,EPSILON)){n[h]=n[h+1]=0;continue}a=n[h]/r[h],i=n[h+1]/r[h],c=Math.pow(a,2)+Math.pow(i,2),!(c<=9)&&(o=3/Math.sqrt(c),n[h]=a*o*r[h],n[h+1]=i*o*r[h])}}function monotoneCompute(t,r,n="x"){const s=getValueAxis(n),a=t.length;let i,o,c,f=getPoint(t,0);for(let d=0;d<a;++d){if(o=c,c=f,f=getPoint(t,d+1),!c)continue;const h=c[n],m=c[s];o&&(i=(h-o[n])/3,c[`cp1${n}`]=h-i,c[`cp1${s}`]=m-i*r[d]),f&&(i=(f[n]-h)/3,c[`cp2${n}`]=h+i,c[`cp2${s}`]=m+i*r[d])}}function splineCurveMonotone(t,r="x"){const n=getValueAxis(r),s=t.length,a=Array(s).fill(0),i=Array(s);let o,c,f,d=getPoint(t,0);for(o=0;o<s;++o)if(c=f,f=d,d=getPoint(t,o+1),!!f){if(d){const h=d[r]-f[r];a[o]=h!==0?(d[n]-f[n])/h:0}i[o]=c?d?sign(a[o-1])!==sign(a[o])?0:(a[o-1]+a[o])/2:a[o-1]:a[o]}monotoneAdjust(t,a,i),monotoneCompute(t,i,r)}function capControlPoint(t,r,n){return Math.max(Math.min(t,n),r)}function capBezierPoints(t,r){let n,s,a,i,o,c=_isPointInArea(t[0],r);for(n=0,s=t.length;n<s;++n)o=i,i=c,c=n<s-1&&_isPointInArea(t[n+1],r),i&&(a=t[n],o&&(a.cp1x=capControlPoint(a.cp1x,r.left,r.right),a.cp1y=capControlPoint(a.cp1y,r.top,r.bottom)),c&&(a.cp2x=capControlPoint(a.cp2x,r.left,r.right),a.cp2y=capControlPoint(a.cp2y,r.top,r.bottom)))}function _updateBezierControlPoints(t,r,n,s,a){let i,o,c,f;if(r.spanGaps&&(t=t.filter(d=>!d.skip)),r.cubicInterpolationMode==="monotone")splineCurveMonotone(t,a);else{let d=s?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)c=t[i],f=splineCurve(d,c,t[Math.min(i+1,o-(s?0:1))%o],r.tension),c.cp1x=f.previous.x,c.cp1y=f.previous.y,c.cp2x=f.next.x,c.cp2y=f.next.y,d=c}r.capBezierPoints&&capBezierPoints(t,n)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(t){let r=t.parentNode;return r&&r.toString()==="[object ShadowRoot]"&&(r=r.host),r}function parseMaxStyle(t,r,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*r.parentNode[n])):s=t,s}const getComputedStyle$1=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function getStyle(t,r){return getComputedStyle$1(t).getPropertyValue(r)}const positions=["top","right","bottom","left"];function getPositionedStyle(t,r,n){const s={};n=n?"-"+n:"";for(let a=0;a<4;a++){const i=positions[a];s[i]=parseFloat(t[r+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const useOffsetPos=(t,r,n)=>(t>0||r>0)&&(!n||!n.shadowRoot);function getCanvasPosition(t,r){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:a,offsetY:i}=s;let o=!1,c,f;if(useOffsetPos(a,i,t.target))c=a,f=i;else{const d=r.getBoundingClientRect();c=s.clientX-d.left,f=s.clientY-d.top,o=!0}return{x:c,y:f,box:o}}function getRelativePosition(t,r){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=r,a=getComputedStyle$1(n),i=a.boxSizing==="border-box",o=getPositionedStyle(a,"padding"),c=getPositionedStyle(a,"border","width"),{x:f,y:d,box:h}=getCanvasPosition(t,n),m=o.left+(h&&c.left),g=o.top+(h&&c.top);let{width:v,height:y}=r;return i&&(v-=o.width+c.width,y-=o.height+c.height),{x:Math.round((f-m)/v*n.width/s),y:Math.round((d-g)/y*n.height/s)}}function getContainerSize(t,r,n){let s,a;if(r===void 0||n===void 0){const i=t&&_getParentNode(t);if(!i)r=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),c=getComputedStyle$1(i),f=getPositionedStyle(c,"border","width"),d=getPositionedStyle(c,"padding");r=o.width-d.width-f.width,n=o.height-d.height-f.height,s=parseMaxStyle(c.maxWidth,i,"clientWidth"),a=parseMaxStyle(c.maxHeight,i,"clientHeight")}}return{width:r,height:n,maxWidth:s||INFINITY,maxHeight:a||INFINITY}}const round1=t=>Math.round(t*10)/10;function getMaximumSize(t,r,n,s){const a=getComputedStyle$1(t),i=getPositionedStyle(a,"margin"),o=parseMaxStyle(a.maxWidth,t,"clientWidth")||INFINITY,c=parseMaxStyle(a.maxHeight,t,"clientHeight")||INFINITY,f=getContainerSize(t,r,n);let{width:d,height:h}=f;if(a.boxSizing==="content-box"){const g=getPositionedStyle(a,"border","width"),v=getPositionedStyle(a,"padding");d-=v.width+g.width,h-=v.height+g.height}return d=Math.max(0,d-i.width),h=Math.max(0,s?d/s:h-i.height),d=round1(Math.min(d,o,f.maxWidth)),h=round1(Math.min(h,c,f.maxHeight)),d&&!h&&(h=round1(d/2)),(r!==void 0||n!==void 0)&&s&&f.height&&h>f.height&&(h=f.height,d=round1(Math.floor(h*s))),{width:d,height:h}}function retinaScale(t,r,n){const s=r||1,a=Math.floor(t.height*s),i=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==a||o.width!==i?(t.currentDevicePixelRatio=s,o.height=a,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const supportsEventListenerOptions=function(){let t=!1;try{const r={get passive(){return t=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,r),window.removeEventListener("test",null,r))}catch{}return t}();function readUsedSize(t,r){const n=getStyle(t,r),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function _pointInLine(t,r,n,s){return{x:t.x+n*(r.x-t.x),y:t.y+n*(r.y-t.y)}}function _steppedInterpolation(t,r,n,s){return{x:t.x+n*(r.x-t.x),y:s==="middle"?n<.5?t.y:r.y:s==="after"?n<1?t.y:r.y:n>0?r.y:t.y}}function _bezierInterpolation(t,r,n,s){const a={x:t.cp2x,y:t.cp2y},i={x:r.cp1x,y:r.cp1y},o=_pointInLine(t,a,n),c=_pointInLine(a,i,n),f=_pointInLine(i,r,n),d=_pointInLine(o,c,n),h=_pointInLine(c,f,n);return _pointInLine(d,h,n)}const getRightToLeftAdapter=function(t,r){return{x(n){return t+t+r-n},setWidth(n){r=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},getLeftToRightAdapter=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,r){return t+r},leftForLtr(t,r){return t}}};function getRtlAdapter(t,r,n){return t?getRightToLeftAdapter(r,n):getLeftToRightAdapter()}function overrideTextDirection(t,r){let n,s;(r==="ltr"||r==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",r,"important"),t.prevTextDirection=s)}function restoreTextDirection(t,r){r!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",r[0],r[1]))}function propertyFn(t){return t==="angle"?{between:_angleBetween,compare:_angleDiff,normalize:_normalizeAngle}:{between:_isBetween,compare:(r,n)=>r-n,normalize:r=>r}}function normalizeSegment({start:t,end:r,count:n,loop:s,style:a}){return{start:t%n,end:r%n,loop:s&&(r-t+1)%n===0,style:a}}function getSegment(t,r,n){const{property:s,start:a,end:i}=n,{between:o,normalize:c}=propertyFn(s),f=r.length;let{start:d,end:h,loop:m}=t,g,v;if(m){for(d+=f,h+=f,g=0,v=f;g<v&&o(c(r[d%f][s]),a,i);++g)d--,h--;d%=f,h%=f}return h<d&&(h+=f),{start:d,end:h,loop:m,style:t.style}}function _boundSegment(t,r,n){if(!n)return[t];const{property:s,start:a,end:i}=n,o=r.length,{compare:c,between:f,normalize:d}=propertyFn(s),{start:h,end:m,loop:g,style:v}=getSegment(t,r,n),y=[];let _=!1,w=null,b,T,k;const C=()=>f(a,k,b)&&c(a,k)!==0,L=()=>c(i,b)===0||f(i,k,b),D=()=>_||C(),N=()=>!_||L();for(let U=h,M=h;U<=m;++U)T=r[U%o],!T.skip&&(b=d(T[s]),b!==k&&(_=f(b,a,i),w===null&&D()&&(w=c(b,a)===0?U:M),w!==null&&N()&&(y.push(normalizeSegment({start:w,end:U,loop:g,count:o,style:v})),w=null),M=U,k=b));return w!==null&&y.push(normalizeSegment({start:w,end:m,loop:g,count:o,style:v})),y}function _boundSegments(t,r){const n=[],s=t.segments;for(let a=0;a<s.length;a++){const i=_boundSegment(s[a],t.points,r);i.length&&n.push(...i)}return n}function findStartAndEnd(t,r,n,s){let a=0,i=r-1;if(n&&!s)for(;a<r&&!t[a].skip;)a++;for(;a<r&&t[a].skip;)a++;for(a%=r,n&&(i+=a);i>a&&t[i%r].skip;)i--;return i%=r,{start:a,end:i}}function solidSegments(t,r,n,s){const a=t.length,i=[];let o=r,c=t[r],f;for(f=r+1;f<=n;++f){const d=t[f%a];d.skip||d.stop?c.skip||(s=!1,i.push({start:r%a,end:(f-1)%a,loop:s}),r=o=d.stop?f:null):(o=f,c.skip&&(r=f)),c=d}return o!==null&&i.push({start:r%a,end:o%a,loop:s}),i}function _computeSegments(t,r){const n=t.points,s=t.options.spanGaps,a=n.length;if(!a)return[];const i=!!t._loop,{start:o,end:c}=findStartAndEnd(n,a,i,s);if(s===!0)return splitByStyles(t,[{start:o,end:c,loop:i}],n,r);const f=c<o?c+a:c,d=!!t._fullLoop&&o===0&&c===a-1;return splitByStyles(t,solidSegments(n,o,f,d),n,r)}function splitByStyles(t,r,n,s){return!s||!s.setContext||!n?r:doSplitByStyles(t,r,n,s)}function doSplitByStyles(t,r,n,s){const a=t._chart.getContext(),i=readStyle(t.options),{_datasetIndex:o,options:{spanGaps:c}}=t,f=n.length,d=[];let h=i,m=r[0].start,g=m;function v(y,_,w,b){const T=c?-1:1;if(y!==_){for(y+=f;n[y%f].skip;)y-=T;for(;n[_%f].skip;)_+=T;y%f!==_%f&&(d.push({start:y%f,end:_%f,loop:w,style:b}),h=b,m=_%f)}}for(const y of r){m=c?m:y.start;let _=n[m%f],w;for(g=m+1;g<=y.end;g++){const b=n[g%f];w=readStyle(s.setContext(createContext(a,{type:"segment",p0:_,p1:b,p0DataIndex:(g-1)%f,p1DataIndex:g%f,datasetIndex:o}))),styleChanged(w,h)&&v(m,g-1,y.loop,h),_=b,h=w}m<g-1&&v(m,g-1,y.loop,h)}return d}function readStyle(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function styleChanged(t,r){if(!r)return!1;const n=[],s=function(a,i){return isPatternOrGradient(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,s)!==JSON.stringify(r,s)}function getSizeForArea(t,r,n){return t.options.clip?t[n]:r[n]}function getDatasetArea(t,r){const{xScale:n,yScale:s}=t;return n&&s?{left:getSizeForArea(n,r,"left"),right:getSizeForArea(n,r,"right"),top:getSizeForArea(s,r,"top"),bottom:getSizeForArea(s,r,"bottom")}:r}function getDatasetClipArea(t,r){const n=r._clip;if(n.disabled)return!1;const s=getDatasetArea(r,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(r,n,s,a){const i=n.listeners[a],o=n.duration;i.forEach(c=>c({chart:r,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(r=Date.now()){let n=0;this._charts.forEach((s,a)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,c=!1,f;for(;o>=0;--o)f=i[o],f._active?(f._total>s.duration&&(s.duration=f._total),f.tick(r),c=!0):(i[o]=i[i.length-1],i.pop());c&&(a.draw(),this._notify(a,s,r,"progress")),i.length||(s.running=!1,this._notify(a,s,r,"complete"),s.initial=!1),n+=i.length}),this._lastDate=r,n===0&&(this._running=!1)}_getAnims(r){const n=this._charts;let s=n.get(r);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(r,s)),s}listen(r,n,s){this._getAnims(r).listeners[n].push(s)}add(r,n){!n||!n.length||this._getAnims(r).items.push(...n)}has(r){return this._getAnims(r).items.length>0}start(r){const n=this._charts.get(r);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,a)=>Math.max(s,a._duration),0),this._refresh())}running(r){if(!this._running)return!1;const n=this._charts.get(r);return!(!n||!n.running||!n.items.length)}stop(r){const n=this._charts.get(r);if(!n||!n.items.length)return;const s=n.items;let a=s.length-1;for(;a>=0;--a)s[a].cancel();n.items=[],this._notify(r,n,Date.now(),"complete")}remove(r){return this._charts.delete(r)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(t,r,n){return n>.5?r:t},color(t,r,n){const s=color(t||transparent),a=s.valid&&color(r||transparent);return a&&a.valid?a.mix(s,n).hexString():r},number(t,r,n){return t+(r-t)*n}};class Animation{constructor(r,n,s,a){const i=n[s];a=resolve([r.to,a,i,r.from]);const o=resolve([r.from,i,a]);this._active=!0,this._fn=r.fn||interpolators[r.type||typeof o],this._easing=effects[r.easing]||effects.linear,this._start=Math.floor(Date.now()+(r.delay||0)),this._duration=this._total=Math.floor(r.duration),this._loop=!!r.loop,this._target=n,this._prop=s,this._from=o,this._to=a,this._promises=void 0}active(){return this._active}update(r,n,s){if(this._active){this._notify(!1);const a=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,r.duration)),this._total+=i,this._loop=!!r.loop,this._to=resolve([r.to,n,a,r.from]),this._from=resolve([r.from,a,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(r){const n=r-this._start,s=this._duration,a=this._prop,i=this._from,o=this._loop,c=this._to;let f;if(this._active=i!==c&&(o||n<s),!this._active){this._target[a]=c,this._notify(!0);return}if(n<0){this._target[a]=i;return}f=n/s%2,f=o&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[a]=this._fn(i,c,f)}wait(){const r=this._promises||(this._promises=[]);return new Promise((n,s)=>{r.push({res:n,rej:s})})}_notify(r){const n=r?"res":"rej",s=this._promises||[];for(let a=0;a<s.length;a++)s[a][n]()}}class Animations{constructor(r,n){this._chart=r,this._properties=new Map,this.configure(n)}configure(r){if(!isObject(r))return;const n=Object.keys(defaults.animation),s=this._properties;Object.getOwnPropertyNames(r).forEach(a=>{const i=r[a];if(!isObject(i))return;const o={};for(const c of n)o[c]=i[c];(isArray(i.properties)&&i.properties||[a]).forEach(c=>{(c===a||!s.has(c))&&s.set(c,o)})})}_animateOptions(r,n){const s=n.options,a=resolveTargetOptions(r,s);if(!a)return[];const i=this._createAnimations(a,s);return s.$shared&&awaitAll(r.options.$animations,s).then(()=>{r.options=s},()=>{}),i}_createAnimations(r,n){const s=this._properties,a=[],i=r.$animations||(r.$animations={}),o=Object.keys(n),c=Date.now();let f;for(f=o.length-1;f>=0;--f){const d=o[f];if(d.charAt(0)==="$")continue;if(d==="options"){a.push(...this._animateOptions(r,n));continue}const h=n[d];let m=i[d];const g=s.get(d);if(m)if(g&&m.active()){m.update(g,h,c);continue}else m.cancel();if(!g||!g.duration){r[d]=h;continue}i[d]=m=new Animation(g,r,d,h),a.push(m)}return a}update(r,n){if(this._properties.size===0){Object.assign(r,n);return}const s=this._createAnimations(r,n);if(s.length)return animator.add(this._chart,s),!0}}function awaitAll(t,r){const n=[],s=Object.keys(r);for(let a=0;a<s.length;a++){const i=t[s[a]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function resolveTargetOptions(t,r){if(!r)return;let n=t.options;if(!n){t.options=r;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function scaleClip(t,r){const n=t&&t.options||{},s=n.reverse,a=n.min===void 0?r:0,i=n.max===void 0?r:0;return{start:s?i:a,end:s?a:i}}function defaultClip(t,r,n){if(n===!1)return!1;const s=scaleClip(t,n),a=scaleClip(r,n);return{top:a.end,right:s.end,bottom:a.start,left:s.start}}function toClip(t){let r,n,s,a;return isObject(t)?(r=t.top,n=t.right,s=t.bottom,a=t.left):r=n=s=a=t,{top:r,right:n,bottom:s,left:a,disabled:t===!1}}function getSortedDatasetIndices(t,r){const n=[],s=t._getSortedDatasetMetas(r);let a,i;for(a=0,i=s.length;a<i;++a)n.push(s[a].index);return n}function applyStack(t,r,n,s={}){const a=t.keys,i=s.mode==="single";let o,c,f,d;if(r===null)return;let h=!1;for(o=0,c=a.length;o<c;++o){if(f=+a[o],f===n){if(h=!0,s.all)continue;break}d=t.values[f],isNumberFinite(d)&&(i||r===0||sign(r)===sign(d))&&(r+=d)}return!h&&!s.all?0:r}function convertObjectDataToArray(t,r){const{iScale:n,vScale:s}=r,a=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),c=new Array(o.length);let f,d,h;for(f=0,d=o.length;f<d;++f)h=o[f],c[f]={[a]:h,[i]:t[h]};return c}function isStacked(t,r){const n=t&&t.options.stacked;return n||n===void 0&&r.stack!==void 0}function getStackKey(t,r,n){return`${t.id}.${r.id}.${n.stack||n.type}`}function getUserBounds(t){const{min:r,max:n,minDefined:s,maxDefined:a}=t.getUserBounds();return{min:s?r:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}function getOrCreateStack(t,r,n){const s=t[r]||(t[r]={});return s[n]||(s[n]={})}function getLastIndexInStack(t,r,n,s){for(const a of r.getMatchingVisibleMetas(s).reverse()){const i=t[a.index];if(n&&i>0||!n&&i<0)return a.index}return null}function updateStacks(t,r){const{chart:n,_cachedMeta:s}=t,a=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:c}=s,f=i.axis,d=o.axis,h=getStackKey(i,o,s),m=r.length;let g;for(let v=0;v<m;++v){const y=r[v],{[f]:_,[d]:w}=y,b=y._stacks||(y._stacks={});g=b[d]=getOrCreateStack(a,h,_),g[c]=w,g._top=getLastIndexInStack(g,o,!0,s.type),g._bottom=getLastIndexInStack(g,o,!1,s.type);const T=g._visualValues||(g._visualValues={});T[c]=w}}function getFirstScaleId(t,r){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===r).shift()}function createDatasetContext(t,r){return createContext(t,{active:!1,dataset:void 0,datasetIndex:r,index:r,mode:"default",type:"dataset"})}function createDataContext(t,r,n){return createContext(t,{active:!1,dataIndex:r,parsed:void 0,raw:void 0,element:n,index:r,mode:"default",type:"data"})}function clearStacks(t,r){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){r=r||t._parsed;for(const a of r){const i=a._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const isDirectUpdateMode=t=>t==="reset"||t==="none",cloneIfNotShared=(t,r)=>r?t:Object.assign({},t),createStack=(t,r,n)=>t&&!r.hidden&&r._stacked&&{keys:getSortedDatasetIndices(n,!0),values:null};class DatasetController{constructor(r,n){this.chart=r,this._ctx=r.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const r=this._cachedMeta;this.configure(),this.linkScales(),r._stacked=isStacked(r.vScale,r),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(r){this.index!==r&&clearStacks(this._cachedMeta),this.index=r}linkScales(){const r=this.chart,n=this._cachedMeta,s=this.getDataset(),a=(m,g,v,y)=>m==="x"?g:m==="r"?y:v,i=n.xAxisID=valueOrDefault(s.xAxisID,getFirstScaleId(r,"x")),o=n.yAxisID=valueOrDefault(s.yAxisID,getFirstScaleId(r,"y")),c=n.rAxisID=valueOrDefault(s.rAxisID,getFirstScaleId(r,"r")),f=n.indexAxis,d=n.iAxisID=a(f,i,o,c),h=n.vAxisID=a(f,o,i,c);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(c),n.iScale=this.getScaleForId(d),n.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(r){return this.chart.scales[r]}_getOtherScale(r){const n=this._cachedMeta;return r===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const r=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),r._stacked&&clearStacks(r)}_dataCheck(){const r=this.getDataset(),n=r.data||(r.data=[]),s=this._data;if(isObject(n)){const a=this._cachedMeta;this._data=convertObjectDataToArray(n,a)}else if(s!==n){if(s){unlistenArrayEvents(s,this);const a=this._cachedMeta;clearStacks(a),a._parsed=[]}n&&Object.isExtensible(n)&&listenArrayEvents(n,this),this._syncList=[],this._data=n}}addElements(){const r=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(r.dataset=new this.datasetElementType)}buildOrUpdateElements(r){const n=this._cachedMeta,s=this.getDataset();let a=!1;this._dataCheck();const i=n._stacked;n._stacked=isStacked(n.vScale,n),n.stack!==s.stack&&(a=!0,clearStacks(n),n.stack=s.stack),this._resyncElements(r),(a||i!==n._stacked)&&(updateStacks(this,n._parsed),n._stacked=isStacked(n.vScale,n))}configure(){const r=this.chart.config,n=r.datasetScopeKeys(this._type),s=r.getOptionScopes(this.getDataset(),n,!0);this.options=r.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(r,n){const{_cachedMeta:s,_data:a}=this,{iScale:i,_stacked:o}=s,c=i.axis;let f=r===0&&n===a.length?!0:s._sorted,d=r>0&&s._parsed[r-1],h,m,g;if(this._parsing===!1)s._parsed=a,s._sorted=!0,g=a;else{isArray(a[r])?g=this.parseArrayData(s,a,r,n):isObject(a[r])?g=this.parseObjectData(s,a,r,n):g=this.parsePrimitiveData(s,a,r,n);const v=()=>m[c]===null||d&&m[c]<d[c];for(h=0;h<n;++h)s._parsed[h+r]=m=g[h],f&&(v()&&(f=!1),d=m);s._sorted=f}o&&updateStacks(this,g)}parsePrimitiveData(r,n,s,a){const{iScale:i,vScale:o}=r,c=i.axis,f=o.axis,d=i.getLabels(),h=i===o,m=new Array(a);let g,v,y;for(g=0,v=a;g<v;++g)y=g+s,m[g]={[c]:h||i.parse(d[y],y),[f]:o.parse(n[y],y)};return m}parseArrayData(r,n,s,a){const{xScale:i,yScale:o}=r,c=new Array(a);let f,d,h,m;for(f=0,d=a;f<d;++f)h=f+s,m=n[h],c[f]={x:i.parse(m[0],h),y:o.parse(m[1],h)};return c}parseObjectData(r,n,s,a){const{xScale:i,yScale:o}=r,{xAxisKey:c="x",yAxisKey:f="y"}=this._parsing,d=new Array(a);let h,m,g,v;for(h=0,m=a;h<m;++h)g=h+s,v=n[g],d[h]={x:i.parse(resolveObjectKey(v,c),g),y:o.parse(resolveObjectKey(v,f),g)};return d}getParsed(r){return this._cachedMeta._parsed[r]}getDataElement(r){return this._cachedMeta.data[r]}applyStack(r,n,s){const a=this.chart,i=this._cachedMeta,o=n[r.axis],c={keys:getSortedDatasetIndices(a,!0),values:n._stacks[r.axis]._visualValues};return applyStack(c,o,i.index,{mode:s})}updateRangeFromParsed(r,n,s,a){const i=s[n.axis];let o=i===null?NaN:i;const c=a&&s._stacks[n.axis];a&&c&&(a.values=c,o=applyStack(a,i,this._cachedMeta.index)),r.min=Math.min(r.min,o),r.max=Math.max(r.max,o)}getMinMax(r,n){const s=this._cachedMeta,a=s._parsed,i=s._sorted&&r===s.iScale,o=a.length,c=this._getOtherScale(r),f=createStack(n,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:m}=getUserBounds(c);let g,v;function y(){v=a[g];const _=v[c.axis];return!isNumberFinite(v[r.axis])||h>_||m<_}for(g=0;g<o&&!(!y()&&(this.updateRangeFromParsed(d,r,v,f),i));++g);if(i){for(g=o-1;g>=0;--g)if(!y()){this.updateRangeFromParsed(d,r,v,f);break}}return d}getAllParsedValues(r){const n=this._cachedMeta._parsed,s=[];let a,i,o;for(a=0,i=n.length;a<i;++a)o=n[a][r.axis],isNumberFinite(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(r){const n=this._cachedMeta,s=n.iScale,a=n.vScale,i=this.getParsed(r);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:a?""+a.getLabelForValue(i[a.axis]):""}}_update(r){const n=this._cachedMeta;this.update(r||"default"),n._clip=toClip(valueOrDefault(this.options.clip,defaultClip(n.xScale,n.yScale,this.getMaxOverflow())))}update(r){}draw(){const r=this._ctx,n=this.chart,s=this._cachedMeta,a=s.data||[],i=n.chartArea,o=[],c=this._drawStart||0,f=this._drawCount||a.length-c,d=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(r,i,c,f),h=c;h<c+f;++h){const m=a[h];m.hidden||(m.active&&d?o.push(m):m.draw(r,i))}for(h=0;h<o.length;++h)o[h].draw(r,i)}getStyle(r,n){const s=n?"active":"default";return r===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(r||0,s)}getContext(r,n,s){const a=this.getDataset();let i;if(r>=0&&r<this._cachedMeta.data.length){const o=this._cachedMeta.data[r];i=o.$context||(o.$context=createDataContext(this.getContext(),r,o)),i.parsed=this.getParsed(r),i.raw=a.data[r],i.index=i.dataIndex=r}else i=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),i.dataset=a,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(r){return this._resolveElementOptions(this.datasetElementType.id,r)}resolveDataElementOptions(r,n){return this._resolveElementOptions(this.dataElementType.id,n,r)}_resolveElementOptions(r,n="default",s){const a=n==="active",i=this._cachedDataOpts,o=r+"-"+n,c=i[o],f=this.enableOptionSharing&&defined(s);if(c)return cloneIfNotShared(c,f);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,r),m=a?[`${r}Hover`,"hover",r,""]:[r,""],g=d.getOptionScopes(this.getDataset(),h),v=Object.keys(defaults.elements[r]),y=()=>this.getContext(s,a,n),_=d.resolveNamedOptions(g,v,y,m);return _.$shared&&(_.$shared=f,i[o]=Object.freeze(cloneIfNotShared(_,f))),_}_resolveAnimations(r,n,s){const a=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,c=i[o];if(c)return c;let f;if(a.options.animation!==!1){const h=this.chart.config,m=h.datasetAnimationScopeKeys(this._type,n),g=h.getOptionScopes(this.getDataset(),m);f=h.createResolver(g,this.getContext(r,s,n))}const d=new Animations(a,f&&f.animations);return f&&f._cacheable&&(i[o]=Object.freeze(d)),d}getSharedOptions(r){if(r.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},r))}includeOptions(r,n){return!n||isDirectUpdateMode(r)||this.chart._animationsDisabled}_getSharedOptions(r,n){const s=this.resolveDataElementOptions(r,n),a=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==a;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(r,n,s,a){isDirectUpdateMode(a)?Object.assign(r,s):this._resolveAnimations(n,a).update(r,s)}updateSharedOptions(r,n,s){r&&!isDirectUpdateMode(n)&&this._resolveAnimations(void 0,n).update(r,s)}_setStyle(r,n,s,a){r.active=a;const i=this.getStyle(n,a);this._resolveAnimations(n,s,a).update(r,{options:!a&&this.getSharedOptions(i)||i})}removeHoverStyle(r,n,s){this._setStyle(r,s,"active",!1)}setHoverStyle(r,n,s){this._setStyle(r,s,"active",!0)}_removeDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!1)}_setDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!0)}_resyncElements(r){const n=this._data,s=this._cachedMeta.data;for(const[c,f,d]of this._syncList)this[c](f,d);this._syncList=[];const a=s.length,i=n.length,o=Math.min(i,a);o&&this.parse(0,o),i>a?this._insertElements(a,i-a,r):i<a&&this._removeElements(i,a-i)}_insertElements(r,n,s=!0){const a=this._cachedMeta,i=a.data,o=r+n;let c;const f=d=>{for(d.length+=n,c=d.length-1;c>=o;c--)d[c]=d[c-n]};for(f(i),c=r;c<o;++c)i[c]=new this.dataElementType;this._parsing&&f(a._parsed),this.parse(r,n),s&&this.updateElements(i,r,n,"reset")}updateElements(r,n,s,a){}_removeElements(r,n){const s=this._cachedMeta;if(this._parsing){const a=s._parsed.splice(r,n);s._stacked&&clearStacks(s,a)}s.data.splice(r,n)}_sync(r){if(this._parsing)this._syncList.push(r);else{const[n,s,a]=r;this[n](s,a)}this.chart._dataChanges.push([this.index,...r])}_onDataPush(){const r=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-r,r])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(r,n){n&&this._sync(["_removeElements",r,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",r,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Le(DatasetController,"defaults",{}),Le(DatasetController,"datasetElementType",null),Le(DatasetController,"dataElementType",null);function getAllScaleValues(t,r){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(r);let s=[];for(let a=0,i=n.length;a<i;a++)s=s.concat(n[a].controller.getAllParsedValues(t));t._cache.$bar=_arrayUnique(s.sort((a,i)=>a-i))}return t._cache.$bar}function computeMinSampleSize(t){const r=t.iScale,n=getAllScaleValues(r,t.type);let s=r._length,a,i,o,c;const f=()=>{o===32767||o===-32768||(defined(c)&&(s=Math.min(s,Math.abs(o-c)||s)),c=o)};for(a=0,i=n.length;a<i;++a)o=r.getPixelForValue(n[a]),f();for(c=void 0,a=0,i=r.ticks.length;a<i;++a)o=r.getPixelForTick(a),f();return s}function computeFitCategoryTraits(t,r,n,s){const a=n.barThickness;let i,o;return isNullOrUndef(a)?(i=r.min*n.categoryPercentage,o=n.barPercentage):(i=a*s,o=1),{chunk:i/s,ratio:o,start:r.pixels[t]-i/2}}function computeFlexCategoryTraits(t,r,n,s){const a=r.pixels,i=a[t];let o=t>0?a[t-1]:null,c=t<a.length-1?a[t+1]:null;const f=n.categoryPercentage;o===null&&(o=i-(c===null?r.end-r.start:c-i)),c===null&&(c=i+i-o);const d=i-(i-Math.min(o,c))/2*f;return{chunk:Math.abs(c-o)/2*f/s,ratio:n.barPercentage,start:d}}function parseFloatBar(t,r,n,s){const a=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(a,i),c=Math.max(a,i);let f=o,d=c;Math.abs(o)>Math.abs(c)&&(f=c,d=o),r[n.axis]=d,r._custom={barStart:f,barEnd:d,start:a,end:i,min:o,max:c}}function parseValue(t,r,n,s){return isArray(t)?parseFloatBar(t,r,n,s):r[n.axis]=n.parse(t,s),r}function parseArrayOrPrimitive(t,r,n,s){const a=t.iScale,i=t.vScale,o=a.getLabels(),c=a===i,f=[];let d,h,m,g;for(d=n,h=n+s;d<h;++d)g=r[d],m={},m[a.axis]=c||a.parse(o[d],d),f.push(parseValue(g,m,i,d));return f}function isFloatBar(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function barSign(t,r,n){return t!==0?sign(t):(r.isHorizontal()?1:-1)*(r.min>=n?1:-1)}function borderProps(t){let r,n,s,a,i;return t.horizontal?(r=t.base>t.x,n="left",s="right"):(r=t.base<t.y,n="bottom",s="top"),r?(a="end",i="start"):(a="start",i="end"),{start:n,end:s,reverse:r,top:a,bottom:i}}function setBorderSkipped(t,r,n,s){let a=r.borderSkipped;const i={};if(!a){t.borderSkipped=i;return}if(a===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:c,reverse:f,top:d,bottom:h}=borderProps(t);a==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?a=d:(n._bottom||0)===s?a=h:(i[parseEdge(h,o,c,f)]=!0,a=d)),i[parseEdge(a,o,c,f)]=!0,t.borderSkipped=i}function parseEdge(t,r,n,s){return s?(t=swap(t,r,n),t=startEnd(t,n,r)):t=startEnd(t,r,n),t}function swap(t,r,n){return t===r?n:t===n?r:t}function startEnd(t,r,n){return t==="start"?r:t==="end"?n:t}function setInflateAmount(t,{inflateAmount:r},n){t.inflateAmount=r==="auto"?n===1?.33:0:r}class BarController extends DatasetController{parsePrimitiveData(r,n,s,a){return parseArrayOrPrimitive(r,n,s,a)}parseArrayData(r,n,s,a){return parseArrayOrPrimitive(r,n,s,a)}parseObjectData(r,n,s,a){const{iScale:i,vScale:o}=r,{xAxisKey:c="x",yAxisKey:f="y"}=this._parsing,d=i.axis==="x"?c:f,h=o.axis==="x"?c:f,m=[];let g,v,y,_;for(g=s,v=s+a;g<v;++g)_=n[g],y={},y[i.axis]=i.parse(resolveObjectKey(_,d),g),m.push(parseValue(resolveObjectKey(_,h),y,o,g));return m}updateRangeFromParsed(r,n,s,a){super.updateRangeFromParsed(r,n,s,a);const i=s._custom;i&&n===this._cachedMeta.vScale&&(r.min=Math.min(r.min,i.min),r.max=Math.max(r.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(r){const n=this._cachedMeta,{iScale:s,vScale:a}=n,i=this.getParsed(r),o=i._custom,c=isFloatBar(o)?"["+o.start+", "+o.end+"]":""+a.getLabelForValue(i[a.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const r=this._cachedMeta;r.stack=this.getDataset().stack}update(r){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,r)}updateElements(r,n,s,a){const i=a==="reset",{index:o,_cachedMeta:{vScale:c}}=this,f=c.getBasePixel(),d=c.isHorizontal(),h=this._getRuler(),{sharedOptions:m,includeOptions:g}=this._getSharedOptions(n,a);for(let v=n;v<n+s;v++){const y=this.getParsed(v),_=i||isNullOrUndef(y[c.axis])?{base:f,head:f}:this._calculateBarValuePixels(v),w=this._calculateBarIndexPixels(v,h),b=(y._stacks||{})[c.axis],T={horizontal:d,base:_.base,enableBorderRadius:!b||isFloatBar(y._custom)||o===b._top||o===b._bottom,x:d?_.head:w.center,y:d?w.center:_.head,height:d?w.size:Math.abs(_.size),width:d?Math.abs(_.size):w.size};g&&(T.options=m||this.resolveDataElementOptions(v,r[v].active?"active":a));const k=T.options||r[v].options;setBorderSkipped(T,k,b,o),setInflateAmount(T,k,h.ratio),this.updateElement(r[v],v,T,a)}}_getStacks(r,n){const{iScale:s}=this._cachedMeta,a=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),i=s.options.stacked,o=[],c=this._cachedMeta.controller.getParsed(n),f=c&&c[s.axis],d=h=>{const m=h._parsed.find(v=>v[s.axis]===f),g=m&&m[h.vScale.axis];if(isNullOrUndef(g)||isNaN(g))return!0};for(const h of a)if(!(n!==void 0&&d(h))&&((i===!1||o.indexOf(h.stack)===-1||i===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===r))break;return o.length||o.push(void 0),o}_getStackCount(r){return this._getStacks(void 0,r).length}_getStackIndex(r,n,s){const a=this._getStacks(r,s),i=n!==void 0?a.indexOf(n):-1;return i===-1?a.length-1:i}_getRuler(){const r=this.options,n=this._cachedMeta,s=n.iScale,a=[];let i,o;for(i=0,o=n.data.length;i<o;++i)a.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const c=r.barThickness;return{min:c||computeMinSampleSize(n),pixels:a,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:r.grouped,ratio:c?1:r.categoryPercentage*r.barPercentage}}_calculateBarValuePixels(r){const{_cachedMeta:{vScale:n,_stacked:s,index:a},options:{base:i,minBarLength:o}}=this,c=i||0,f=this.getParsed(r),d=f._custom,h=isFloatBar(d);let m=f[n.axis],g=0,v=s?this.applyStack(n,f,s):m,y,_;v!==m&&(g=v-m,v=m),h&&(m=d.barStart,v=d.barEnd-d.barStart,m!==0&&sign(m)!==sign(d.barEnd)&&(g=0),g+=m);const w=!isNullOrUndef(i)&&!h?i:g;let b=n.getPixelForValue(w);if(this.chart.getDataVisibility(r)?y=n.getPixelForValue(g+v):y=b,_=y-b,Math.abs(_)<o){_=barSign(_,n,c)*o,m===c&&(b-=_/2);const T=n.getPixelForDecimal(0),k=n.getPixelForDecimal(1),C=Math.min(T,k),L=Math.max(T,k);b=Math.max(Math.min(b,L),C),y=b+_,s&&!h&&(f._stacks[n.axis]._visualValues[a]=n.getValueForPixel(y)-n.getValueForPixel(b))}if(b===n.getPixelForValue(c)){const T=sign(_)*n.getLineWidthForValue(c)/2;b+=T,_-=T}return{size:_,base:b,head:y,center:y+_/2}}_calculateBarIndexPixels(r,n){const s=n.scale,a=this.options,i=a.skipNull,o=valueOrDefault(a.maxBarThickness,1/0);let c,f;if(n.grouped){const d=i?this._getStackCount(r):n.stackCount,h=a.barThickness==="flex"?computeFlexCategoryTraits(r,n,a,d):computeFitCategoryTraits(r,n,a,d),m=this._getStackIndex(this.index,this._cachedMeta.stack,i?r:void 0);c=h.start+h.chunk*m+h.chunk/2,f=Math.min(o,h.chunk*h.ratio)}else c=s.getPixelForValue(this.getParsed(r)[s.axis],r),f=Math.min(o,n.min*n.ratio);return{base:c-f/2,head:c+f/2,center:c,size:f}}draw(){const r=this._cachedMeta,n=r.vScale,s=r.data,a=s.length;let i=0;for(;i<a;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}Le(BarController,"id","bar"),Le(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Le(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function getRatioAndOffset(t,r,n){let s=1,a=1,i=0,o=0;if(r<TAU){const c=t,f=c+r,d=Math.cos(c),h=Math.sin(c),m=Math.cos(f),g=Math.sin(f),v=(k,C,L)=>_angleBetween(k,c,f,!0)?1:Math.max(C,C*n,L,L*n),y=(k,C,L)=>_angleBetween(k,c,f,!0)?-1:Math.min(C,C*n,L,L*n),_=v(0,d,m),w=v(HALF_PI,h,g),b=y(PI,d,m),T=y(PI+HALF_PI,h,g);s=(_-b)/2,a=(w-T)/2,i=-(_+b)/2,o=-(w+T)/2}return{ratioX:s,ratioY:a,offsetX:i,offsetY:o}}class DoughnutController extends DatasetController{constructor(r,n){super(r,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(r,n){const s=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=s;else{let i=f=>+s[f];if(isObject(s[r])){const{key:f="value"}=this._parsing;i=d=>+resolveObjectKey(s[d],f)}let o,c;for(o=r,c=r+n;o<c;++o)a._parsed[o]=i(o)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let r=TAU,n=-TAU;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const a=this.chart.getDatasetMeta(s).controller,i=a._getRotation(),o=a._getCircumference();r=Math.min(r,i),n=Math.max(n,i+o)}return{rotation:r,circumference:n-r}}update(r){const n=this.chart,{chartArea:s}=n,a=this._cachedMeta,i=a.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,c=Math.max((Math.min(s.width,s.height)-o)/2,0),f=Math.min(toPercentage(this.options.cutout,c),1),d=this._getRingWeight(this.index),{circumference:h,rotation:m}=this._getRotationExtents(),{ratioX:g,ratioY:v,offsetX:y,offsetY:_}=getRatioAndOffset(m,h,f),w=(s.width-o)/g,b=(s.height-o)/v,T=Math.max(Math.min(w,b)/2,0),k=toDimension(this.options.radius,T),C=Math.max(k*f,0),L=(k-C)/this._getVisibleDatasetWeightTotal();this.offsetX=y*k,this.offsetY=_*k,a.total=this.calculateTotal(),this.outerRadius=k-L*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-L*d,0),this.updateElements(i,0,i.length,r)}_circumference(r,n){const s=this.options,a=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(r)||a._parsed[r]===null||a.data[r].hidden?0:this.calculateCircumference(a._parsed[r]*i/TAU)}updateElements(r,n,s,a){const i=a==="reset",o=this.chart,c=o.chartArea,d=o.options.animation,h=(c.left+c.right)/2,m=(c.top+c.bottom)/2,g=i&&d.animateScale,v=g?0:this.innerRadius,y=g?0:this.outerRadius,{sharedOptions:_,includeOptions:w}=this._getSharedOptions(n,a);let b=this._getRotation(),T;for(T=0;T<n;++T)b+=this._circumference(T,i);for(T=n;T<n+s;++T){const k=this._circumference(T,i),C=r[T],L={x:h+this.offsetX,y:m+this.offsetY,startAngle:b,endAngle:b+k,circumference:k,outerRadius:y,innerRadius:v};w&&(L.options=_||this.resolveDataElementOptions(T,C.active?"active":a)),b+=k,this.updateElement(C,T,L,a)}}calculateTotal(){const r=this._cachedMeta,n=r.data;let s=0,a;for(a=0;a<n.length;a++){const i=r._parsed[a];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(a)&&!n[a].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(r){const n=this._cachedMeta.total;return n>0&&!isNaN(r)?TAU*(Math.abs(r)/n):0}getLabelAndValue(r){const n=this._cachedMeta,s=this.chart,a=s.data.labels||[],i=formatNumber(n._parsed[r],s.options.locale);return{label:a[r]||"",value:i}}getMaxBorderWidth(r){let n=0;const s=this.chart;let a,i,o,c,f;if(!r){for(a=0,i=s.data.datasets.length;a<i;++a)if(s.isDatasetVisible(a)){o=s.getDatasetMeta(a),r=o.data,c=o.controller;break}}if(!r)return 0;for(a=0,i=r.length;a<i;++a)f=c.resolveDataElementOptions(a),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(r){let n=0;for(let s=0,a=r.length;s<a;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(r){let n=0;for(let s=0;s<r;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(r){return Math.max(valueOrDefault(this.chart.data.datasets[r].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Le(DoughnutController,"id","doughnut"),Le(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Le(DoughnutController,"descriptors",{_scriptable:r=>r!=="spacing",_indexable:r=>r!=="spacing"&&!r.startsWith("borderDash")&&!r.startsWith("hoverBorderDash")}),Le(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(r){const n=r.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:a}}=r.legend.options;return n.labels.map((i,o)=>{const f=r.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:a,lineWidth:f.borderWidth,pointStyle:s,hidden:!r.getDataVisibility(o),index:o}})}return[]}},onClick(r,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class LineController extends DatasetController{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(r){const n=this._cachedMeta,{dataset:s,data:a=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:c,count:f}=_getStartAndCountOfVisiblePoints(n,a,o);this._drawStart=c,this._drawCount=f,_scaleRangesChanged(n)&&(c=0,f=a.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=a;const d=this.resolveDatasetElementOptions(r);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:d},r),this.updateElements(a,c,f,r)}updateElements(r,n,s,a){const i=a==="reset",{iScale:o,vScale:c,_stacked:f,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:m}=this._getSharedOptions(n,a),g=o.axis,v=c.axis,{spanGaps:y,segment:_}=this.options,w=isNumber(y)?y:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||i||a==="none",T=n+s,k=r.length;let C=n>0&&this.getParsed(n-1);for(let L=0;L<k;++L){const D=r[L],N=b?D:{};if(L<n||L>=T){N.skip=!0;continue}const U=this.getParsed(L),M=isNullOrUndef(U[v]),j=N[g]=o.getPixelForValue(U[g],L),K=N[v]=i||M?c.getBasePixel():c.getPixelForValue(f?this.applyStack(c,U,f):U[v],L);N.skip=isNaN(j)||isNaN(K)||M,N.stop=L>0&&Math.abs(U[g]-C[g])>w,_&&(N.parsed=U,N.raw=d.data[L]),m&&(N.options=h||this.resolveDataElementOptions(L,D.active?"active":a)),b||this.updateElement(D,L,N,a),C=U}}getMaxOverflow(){const r=this._cachedMeta,n=r.dataset,s=n.options&&n.options.borderWidth||0,a=r.data||[];if(!a.length)return s;const i=a[0].size(this.resolveDataElementOptions(0)),o=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,i,o)/2}draw(){const r=this._cachedMeta;r.dataset.updateControlPoints(this.chart.chartArea,r.iScale.axis),super.draw()}}Le(LineController,"id","line"),Le(LineController,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Le(LineController,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(r){Le(this,"options");this.options=r||{}}static override(r){Object.assign(DateAdapterBase.prototype,r)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(t,r,n,s){const{controller:a,data:i,_sorted:o}=t,c=a._cachedMeta.iScale,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(c&&r===c.axis&&r!=="r"&&o&&i.length){const d=c._reversePixels?_rlookupByKey:_lookupByKey;if(s){if(a._sharedOptions){const h=i[0],m=typeof h.getRange=="function"&&h.getRange(r);if(m){const g=d(i,r,n-m),v=d(i,r,n+m);return{lo:g.lo,hi:v.hi}}}}else{const h=d(i,r,n);if(f){const{vScale:m}=a._cachedMeta,{_parsed:g}=t,v=g.slice(0,h.lo+1).reverse().findIndex(_=>!isNullOrUndef(_[m.axis]));h.lo-=Math.max(0,v);const y=g.slice(h.hi).findIndex(_=>!isNullOrUndef(_[m.axis]));h.hi+=Math.max(0,y)}return h}}return{lo:0,hi:i.length-1}}function evaluateInteractionItems(t,r,n,s,a){const i=t.getSortedVisibleDatasetMetas(),o=n[r];for(let c=0,f=i.length;c<f;++c){const{index:d,data:h}=i[c],{lo:m,hi:g}=binarySearch(i[c],r,o,a);for(let v=m;v<=g;++v){const y=h[v];y.skip||s(y,d,v)}}}function getDistanceMetricForAxis(t){const r=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,a){const i=r?Math.abs(s.x-a.x):0,o=n?Math.abs(s.y-a.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function getIntersectItems(t,r,n,s,a){const i=[];return!a&&!t.isPointInArea(r)||evaluateInteractionItems(t,n,r,function(c,f,d){!a&&!_isPointInArea(c,t.chartArea,0)||c.inRange(r.x,r.y,s)&&i.push({element:c,datasetIndex:f,index:d})},!0),i}function getNearestRadialItems(t,r,n,s){let a=[];function i(o,c,f){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:m}=getAngleFromPoint(o,{x:r.x,y:r.y});_angleBetween(m,d,h)&&a.push({element:o,datasetIndex:c,index:f})}return evaluateInteractionItems(t,n,r,i),a}function getNearestCartesianItems(t,r,n,s,a,i){let o=[];const c=getDistanceMetricForAxis(n);let f=Number.POSITIVE_INFINITY;function d(h,m,g){const v=h.inRange(r.x,r.y,a);if(s&&!v)return;const y=h.getCenterPoint(a);if(!(!!i||t.isPointInArea(y))&&!v)return;const w=c(r,y);w<f?(o=[{element:h,datasetIndex:m,index:g}],f=w):w===f&&o.push({element:h,datasetIndex:m,index:g})}return evaluateInteractionItems(t,n,r,d),o}function getNearestItems(t,r,n,s,a,i){return!i&&!t.isPointInArea(r)?[]:n==="r"&&!s?getNearestRadialItems(t,r,n,a):getNearestCartesianItems(t,r,n,s,a,i)}function getAxisItems(t,r,n,s,a){const i=[],o=n==="x"?"inXRange":"inYRange";let c=!1;return evaluateInteractionItems(t,n,r,(f,d,h)=>{f[o]&&f[o](r[n],a)&&(i.push({element:f,datasetIndex:d,index:h}),c=c||f.inRange(r.x,r.y,a))}),s&&!c?[]:i}var Interaction={modes:{index(t,r,n,s){const a=getRelativePosition(r,t),i=n.axis||"x",o=n.includeInvisible||!1,c=n.intersect?getIntersectItems(t,a,i,s,o):getNearestItems(t,a,i,!1,s,o),f=[];return c.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const h=c[0].index,m=d.data[h];m&&!m.skip&&f.push({element:m,datasetIndex:d.index,index:h})}),f):[]},dataset(t,r,n,s){const a=getRelativePosition(r,t),i=n.axis||"xy",o=n.includeInvisible||!1;let c=n.intersect?getIntersectItems(t,a,i,s,o):getNearestItems(t,a,i,!1,s,o);if(c.length>0){const f=c[0].datasetIndex,d=t.getDatasetMeta(f).data;c=[];for(let h=0;h<d.length;++h)c.push({element:d[h],datasetIndex:f,index:h})}return c},point(t,r,n,s){const a=getRelativePosition(r,t),i=n.axis||"xy",o=n.includeInvisible||!1;return getIntersectItems(t,a,i,s,o)},nearest(t,r,n,s){const a=getRelativePosition(r,t),i=n.axis||"xy",o=n.includeInvisible||!1;return getNearestItems(t,a,i,n.intersect,s,o)},x(t,r,n,s){const a=getRelativePosition(r,t);return getAxisItems(t,a,"x",n.intersect,s)},y(t,r,n,s){const a=getRelativePosition(r,t);return getAxisItems(t,a,"y",n.intersect,s)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(t,r){return t.filter(n=>n.pos===r)}function filterDynamicPositionByAxis(t,r){return t.filter(n=>STATIC_POSITIONS.indexOf(n.pos)===-1&&n.box.axis===r)}function sortByWeight(t,r){return t.sort((n,s)=>{const a=r?s:n,i=r?n:s;return a.weight===i.weight?a.index-i.index:a.weight-i.weight})}function wrapBoxes(t){const r=[];let n,s,a,i,o,c;for(n=0,s=(t||[]).length;n<s;++n)a=t[n],{position:i,options:{stack:o,stackWeight:c=1}}=a,r.push({index:n,box:a,pos:i,horizontal:a.isHorizontal(),weight:a.weight,stack:o&&i+o,stackWeight:c});return r}function buildStacks(t){const r={};for(const n of t){const{stack:s,pos:a,stackWeight:i}=n;if(!s||!STATIC_POSITIONS.includes(a))continue;const o=r[s]||(r[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return r}function setLayoutDims(t,r){const n=buildStacks(t),{vBoxMaxWidth:s,hBoxMaxHeight:a}=r;let i,o,c;for(i=0,o=t.length;i<o;++i){c=t[i];const{fullSize:f}=c.box,d=n[c.stack],h=d&&c.stackWeight/d.weight;c.horizontal?(c.width=h?h*s:f&&r.availableWidth,c.height=a):(c.width=s,c.height=h?h*a:f&&r.availableHeight)}return n}function buildLayoutBoxes(t){const r=wrapBoxes(t),n=sortByWeight(r.filter(d=>d.box.fullSize),!0),s=sortByWeight(filterByPosition(r,"left"),!0),a=sortByWeight(filterByPosition(r,"right")),i=sortByWeight(filterByPosition(r,"top"),!0),o=sortByWeight(filterByPosition(r,"bottom")),c=filterDynamicPositionByAxis(r,"x"),f=filterDynamicPositionByAxis(r,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:a.concat(f).concat(o).concat(c),chartArea:filterByPosition(r,"chartArea"),vertical:s.concat(a).concat(f),horizontal:i.concat(o).concat(c)}}function getCombinedMax(t,r,n,s){return Math.max(t[n],r[n])+Math.max(t[s],r[s])}function updateMaxPadding(t,r){t.top=Math.max(t.top,r.top),t.left=Math.max(t.left,r.left),t.bottom=Math.max(t.bottom,r.bottom),t.right=Math.max(t.right,r.right)}function updateDims(t,r,n,s){const{pos:a,box:i}=n,o=t.maxPadding;if(!isObject(a)){n.size&&(t[a]-=n.size);const m=s[n.stack]||{size:0,count:1};m.size=Math.max(m.size,n.horizontal?i.height:i.width),n.size=m.size/m.count,t[a]+=n.size}i.getPadding&&updateMaxPadding(o,i.getPadding());const c=Math.max(0,r.outerWidth-getCombinedMax(o,t,"left","right")),f=Math.max(0,r.outerHeight-getCombinedMax(o,t,"top","bottom")),d=c!==t.w,h=f!==t.h;return t.w=c,t.h=f,n.horizontal?{same:d,other:h}:{same:h,other:d}}function handleMaxPadding(t){const r=t.maxPadding;function n(s){const a=Math.max(r[s]-t[s],0);return t[s]+=a,a}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function getMargins(t,r){const n=r.maxPadding;function s(a){const i={left:0,top:0,right:0,bottom:0};return a.forEach(o=>{i[o]=Math.max(r[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function fitBoxes(t,r,n,s){const a=[];let i,o,c,f,d,h;for(i=0,o=t.length,d=0;i<o;++i){c=t[i],f=c.box,f.update(c.width||r.w,c.height||r.h,getMargins(c.horizontal,r));const{same:m,other:g}=updateDims(r,n,c,s);d|=m&&a.length,h=h||g,f.fullSize||a.push(c)}return d&&fitBoxes(a,r,n,s)||h}function setBoxDims(t,r,n,s,a){t.top=n,t.left=r,t.right=r+s,t.bottom=n+a,t.width=s,t.height=a}function placeBoxes(t,r,n,s){const a=n.padding;let{x:i,y:o}=r;for(const c of t){const f=c.box,d=s[c.stack]||{placed:0,weight:1},h=c.stackWeight/d.weight||1;if(c.horizontal){const m=r.w*h,g=d.size||f.height;defined(d.start)&&(o=d.start),f.fullSize?setBoxDims(f,a.left,o,n.outerWidth-a.right-a.left,g):setBoxDims(f,r.left+d.placed,o,m,g),d.start=o,d.placed+=m,o=f.bottom}else{const m=r.h*h,g=d.size||f.width;defined(d.start)&&(i=d.start),f.fullSize?setBoxDims(f,i,a.top,g,n.outerHeight-a.bottom-a.top):setBoxDims(f,i,r.top+d.placed,g,m),d.start=i,d.placed+=m,i=f.right}}r.x=i,r.y=o}var layouts={addBox(t,r){t.boxes||(t.boxes=[]),r.fullSize=r.fullSize||!1,r.position=r.position||"top",r.weight=r.weight||0,r._layers=r._layers||function(){return[{z:0,draw(n){r.draw(n)}}]},t.boxes.push(r)},removeBox(t,r){const n=t.boxes?t.boxes.indexOf(r):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,r,n){r.fullSize=n.fullSize,r.position=n.position,r.weight=n.weight},update(t,r,n,s){if(!t)return;const a=toPadding(t.options.layout.padding),i=Math.max(r-a.width,0),o=Math.max(n-a.height,0),c=buildLayoutBoxes(t.boxes),f=c.vertical,d=c.horizontal;each(t.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const h=f.reduce((_,w)=>w.box.options&&w.box.options.display===!1?_:_+1,0)||1,m=Object.freeze({outerWidth:r,outerHeight:n,padding:a,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/h,hBoxMaxHeight:o/2}),g=Object.assign({},a);updateMaxPadding(g,toPadding(s));const v=Object.assign({maxPadding:g,w:i,h:o,x:a.left,y:a.top},a),y=setLayoutDims(f.concat(d),m);fitBoxes(c.fullSize,v,m,y),fitBoxes(f,v,m,y),fitBoxes(d,v,m,y)&&fitBoxes(f,v,m,y),handleMaxPadding(v),placeBoxes(c.leftAndTop,v,m,y),v.x+=v.w,v.y+=v.h,placeBoxes(c.rightAndBottom,v,m,y),t.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},each(c.chartArea,_=>{const w=_.box;Object.assign(w,t.chartArea),w.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(r,n){}releaseContext(r){return!1}addEventListener(r,n,s){}removeEventListener(r,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(r,n,s,a){return n=Math.max(0,n||r.width),s=s||r.height,{width:n,height:Math.max(0,a?Math.floor(n/a):s)}}isAttached(r){return!0}updateConfig(r){}}class BasicPlatform extends BasePlatform{acquireContext(r){return r&&r.getContext&&r.getContext("2d")||null}updateConfig(r){r.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=t=>t===null||t==="";function initCanvas(t,r){const n=t.style,s=t.getAttribute("height"),a=t.getAttribute("width");if(t[EXPANDO_KEY]={initial:{height:s,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",isNullOrEmpty(a)){const i=readUsedSize(t,"width");i!==void 0&&(t.width=i)}if(isNullOrEmpty(s))if(t.style.height==="")t.height=t.width/(r||2);else{const i=readUsedSize(t,"height");i!==void 0&&(t.height=i)}return t}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(t,r,n){t&&t.addEventListener(r,n,eventListenerOptions)}function removeListener(t,r,n){t&&t.canvas&&t.canvas.removeEventListener(r,n,eventListenerOptions)}function fromNativeEvent(t,r){const n=EVENT_TYPES[t.type]||t.type,{x:s,y:a}=getRelativePosition(t,r);return{type:n,chart:r,native:t,x:s!==void 0?s:null,y:a!==void 0?a:null}}function nodeListContains(t,r){for(const n of t)if(n===r||n.contains(r))return!0}function createAttachObserver(t,r,n){const s=t.canvas,a=new MutationObserver(i=>{let o=!1;for(const c of i)o=o||nodeListContains(c.addedNodes,s),o=o&&!nodeListContains(c.removedNodes,s);o&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}function createDetachObserver(t,r,n){const s=t.canvas,a=new MutationObserver(i=>{let o=!1;for(const c of i)o=o||nodeListContains(c.removedNodes,s),o=o&&!nodeListContains(c.addedNodes,s);o&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const t=window.devicePixelRatio;t!==oldDevicePixelRatio&&(oldDevicePixelRatio=t,drpListeningCharts.forEach((r,n)=>{n.currentDevicePixelRatio!==t&&r()}))}function listenDevicePixelRatioChanges(t,r){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(t,r)}function unlistenDevicePixelRatioChanges(t){drpListeningCharts.delete(t),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(t,r,n){const s=t.canvas,a=s&&_getParentNode(s);if(!a)return;const i=throttled((c,f)=>{const d=a.clientWidth;n(c,f),d<a.clientWidth&&n()},window),o=new ResizeObserver(c=>{const f=c[0],d=f.contentRect.width,h=f.contentRect.height;d===0&&h===0||i(d,h)});return o.observe(a),listenDevicePixelRatioChanges(t,i),o}function releaseObserver(t,r,n){n&&n.disconnect(),r==="resize"&&unlistenDevicePixelRatioChanges(t)}function createProxyAndListen(t,r,n){const s=t.canvas,a=throttled(i=>{t.ctx!==null&&n(fromNativeEvent(i,t))},t);return addListener(s,r,a),a}class DomPlatform extends BasePlatform{acquireContext(r,n){const s=r&&r.getContext&&r.getContext("2d");return s&&s.canvas===r?(initCanvas(r,n),s):null}releaseContext(r){const n=r.canvas;if(!n[EXPANDO_KEY])return!1;const s=n[EXPANDO_KEY].initial;["height","width"].forEach(i=>{const o=s[i];isNullOrUndef(o)?n.removeAttribute(i):n.setAttribute(i,o)});const a=s.style||{};return Object.keys(a).forEach(i=>{n.style[i]=a[i]}),n.width=n.width,delete n[EXPANDO_KEY],!0}addEventListener(r,n,s){this.removeEventListener(r,n);const a=r.$proxies||(r.$proxies={}),o={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[n]||createProxyAndListen;a[n]=o(r,n,s)}removeEventListener(r,n){const s=r.$proxies||(r.$proxies={}),a=s[n];if(!a)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[n]||removeListener)(r,n,a),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(r,n,s,a){return getMaximumSize(r,n,s,a)}isAttached(r){const n=r&&_getParentNode(r);return!!(n&&n.isConnected)}}function _detectPlatform(t){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){Le(this,"x");Le(this,"y");Le(this,"active",!1);Le(this,"options");Le(this,"$animations")}tooltipPosition(r){const{x:n,y:s}=this.getProps(["x","y"],r);return{x:n,y:s}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(r,n){const s=this.$animations;if(!n||!s)return this;const a={};return r.forEach(i=>{a[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),a}}Le(Element,"defaults",{}),Le(Element,"defaultRoutes");function autoSkip(t,r){const n=t.options.ticks,s=determineMaxTicks(t),a=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?getMajorIndices(r):[],o=i.length,c=i[0],f=i[o-1],d=[];if(o>a)return skipMajors(r,d,i,o/a),d;const h=calculateSpacing(i,r,a);if(o>0){let m,g;const v=o>1?Math.round((f-c)/(o-1)):null;for(skip(r,d,h,isNullOrUndef(v)?0:c-v,c),m=0,g=o-1;m<g;m++)skip(r,d,h,i[m],i[m+1]);return skip(r,d,h,f,isNullOrUndef(v)?r.length:f+v),d}return skip(r,d,h),d}function determineMaxTicks(t){const r=t.options.offset,n=t._tickSize(),s=t._length/n+(r?0:1),a=t._maxLength/n;return Math.floor(Math.min(s,a))}function calculateSpacing(t,r,n){const s=getEvenSpacing(t),a=r.length/n;if(!s)return Math.max(a,1);const i=_factorize(s);for(let o=0,c=i.length-1;o<c;o++){const f=i[o];if(f>a)return f}return Math.max(a,1)}function getMajorIndices(t){const r=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&r.push(n);return r}function skipMajors(t,r,n,s){let a=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(r.push(t[o]),a++,i=n[a*s])}function skip(t,r,n,s,a){const i=valueOrDefault(s,0),o=Math.min(valueOrDefault(a,t.length),t.length);let c=0,f,d,h;for(n=Math.ceil(n),a&&(f=a-s,n=f/Math.floor(f/n)),h=i;h<0;)c++,h=Math.round(i+c*n);for(d=Math.max(i,0);d<o;d++)d===h&&(r.push(t[d]),c++,h=Math.round(i+c*n))}function getEvenSpacing(t){const r=t.length;let n,s;if(r<2)return!1;for(s=t[0],n=1;n<r;++n)if(t[n]-t[n-1]!==s)return!1;return s}const reverseAlign=t=>t==="left"?"right":t==="right"?"left":t,offsetFromEdge=(t,r,n)=>r==="top"||r==="left"?t[r]+n:t[r]-n,getTicksLimit=(t,r)=>Math.min(r||t,t);function sample(t,r){const n=[],s=t.length/r,a=t.length;let i=0;for(;i<a;i+=s)n.push(t[Math.floor(i)]);return n}function getPixelForGridLine(t,r,n){const s=t.ticks.length,a=Math.min(r,s-1),i=t._startPixel,o=t._endPixel,c=1e-6;let f=t.getPixelForTick(a),d;if(!(n&&(s===1?d=Math.max(f-i,o-f):r===0?d=(t.getPixelForTick(1)-f)/2:d=(f-t.getPixelForTick(a-1))/2,f+=a<r?d:-d,f<i-c||f>o+c)))return f}function garbageCollect(t,r){each(t,n=>{const s=n.gc,a=s.length/2;let i;if(a>r){for(i=0;i<a;++i)delete n.data[s[i]];s.splice(0,a)}})}function getTickMarkLength(t){return t.drawTicks?t.tickLength:0}function getTitleHeight(t,r){if(!t.display)return 0;const n=toFont(t.font,r),s=toPadding(t.padding);return(isArray(t.text)?t.text.length:1)*n.lineHeight+s.height}function createScaleContext(t,r){return createContext(t,{scale:r,type:"scale"})}function createTickContext(t,r,n){return createContext(t,{tick:n,index:r,type:"tick"})}function titleAlign(t,r,n){let s=_toLeftRightCenter(t);return(n&&r!=="right"||!n&&r==="right")&&(s=reverseAlign(s)),s}function titleArgs(t,r,n,s){const{top:a,left:i,bottom:o,right:c,chart:f}=t,{chartArea:d,scales:h}=f;let m=0,g,v,y;const _=o-a,w=c-i;if(t.isHorizontal()){if(v=_alignStartEnd(s,i,c),isObject(n)){const b=Object.keys(n)[0],T=n[b];y=h[b].getPixelForValue(T)+_-r}else n==="center"?y=(d.bottom+d.top)/2+_-r:y=offsetFromEdge(t,n,r);g=c-i}else{if(isObject(n)){const b=Object.keys(n)[0],T=n[b];v=h[b].getPixelForValue(T)-w+r}else n==="center"?v=(d.left+d.right)/2-w+r:v=offsetFromEdge(t,n,r);y=_alignStartEnd(s,o,a),m=n==="left"?-HALF_PI:HALF_PI}return{titleX:v,titleY:y,maxWidth:g,rotation:m}}class Scale extends Element{constructor(r){super(),this.id=r.id,this.type=r.type,this.options=void 0,this.ctx=r.ctx,this.chart=r.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(r){this.options=r.setContext(this.getContext()),this.axis=r.axis,this._userMin=this.parse(r.min),this._userMax=this.parse(r.max),this._suggestedMin=this.parse(r.suggestedMin),this._suggestedMax=this.parse(r.suggestedMax)}parse(r,n){return r}getUserBounds(){let{_userMin:r,_userMax:n,_suggestedMin:s,_suggestedMax:a}=this;return r=finiteOrDefault(r,Number.POSITIVE_INFINITY),n=finiteOrDefault(n,Number.NEGATIVE_INFINITY),s=finiteOrDefault(s,Number.POSITIVE_INFINITY),a=finiteOrDefault(a,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(r,s),max:finiteOrDefault(n,a),minDefined:isNumberFinite(r),maxDefined:isNumberFinite(n)}}getMinMax(r){let{min:n,max:s,minDefined:a,maxDefined:i}=this.getUserBounds(),o;if(a&&i)return{min:n,max:s};const c=this.getMatchingVisibleMetas();for(let f=0,d=c.length;f<d;++f)o=c[f].controller.getMinMax(this,r),a||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=a&&n>s?n:s,{min:finiteOrDefault(n,finiteOrDefault(s,n)),max:finiteOrDefault(s,finiteOrDefault(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const r=this.chart.data;return this.options.labels||(this.isHorizontal()?r.xLabels:r.yLabels)||r.labels||[]}getLabelItems(r=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(r))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(r,n,s){const{beginAtZero:a,grace:i,ticks:o}=this.options,c=o.sampleSize;this.beforeUpdate(),this.maxWidth=r,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,i,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=c<this.ticks.length;this._convertTicksToLabels(f?sample(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let r=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,r=!r),this._startPixel=n,this._endPixel=s,this._reversePixels=r,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(r){this.chart.notifyPlugins(r,this.getContext()),callback(this.options[r],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(r){const n=this.options.ticks;let s,a,i;for(s=0,a=r.length;s<a;s++)i=r[s],i.label=callback(n.callback,[i.value,s,r],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const r=this.options,n=r.ticks,s=getTicksLimit(this.ticks.length,r.ticks.maxTicksLimit),a=n.minRotation||0,i=n.maxRotation;let o=a,c,f,d;if(!this._isVisible()||!n.display||a>=i||s<=1||!this.isHorizontal()){this.labelRotation=a;return}const h=this._getLabelSizes(),m=h.widest.width,g=h.highest.height,v=_limitValue(this.chart.width-m,0,this.maxWidth);c=r.offset?this.maxWidth/s:v/(s-1),m+6>c&&(c=v/(s-(r.offset?.5:1)),f=this.maxHeight-getTickMarkLength(r.grid)-n.padding-getTitleHeight(r.title,this.chart.options.font),d=Math.sqrt(m*m+g*g),o=toDegrees(Math.min(Math.asin(_limitValue((h.highest.height+6)/c,-1,1)),Math.asin(_limitValue(f/d,-1,1))-Math.asin(_limitValue(g/d,-1,1)))),o=Math.max(a,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const r={width:0,height:0},{chart:n,options:{ticks:s,title:a,grid:i}}=this,o=this._isVisible(),c=this.isHorizontal();if(o){const f=getTitleHeight(a,n.options.font);if(c?(r.width=this.maxWidth,r.height=getTickMarkLength(i)+f):(r.height=this.maxHeight,r.width=getTickMarkLength(i)+f),s.display&&this.ticks.length){const{first:d,last:h,widest:m,highest:g}=this._getLabelSizes(),v=s.padding*2,y=toRadians(this.labelRotation),_=Math.cos(y),w=Math.sin(y);if(c){const b=s.mirror?0:w*m.width+_*g.height;r.height=Math.min(this.maxHeight,r.height+b+v)}else{const b=s.mirror?0:_*m.width+w*g.height;r.width=Math.min(this.maxWidth,r.width+b+v)}this._calculatePadding(d,h,w,_)}}this._handleMargins(),c?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=r.height):(this.width=r.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(r,n,s,a){const{ticks:{align:i,padding:o},position:c}=this.options,f=this.labelRotation!==0,d=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,v=0;f?d?(g=a*r.width,v=s*n.height):(g=s*r.height,v=a*n.width):i==="start"?v=n.width:i==="end"?g=r.width:i!=="inner"&&(g=r.width/2,v=n.width/2),this.paddingLeft=Math.max((g-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((v-m+o)*this.width/(this.width-m),0)}else{let h=n.height/2,m=r.height/2;i==="start"?(h=0,m=r.height):i==="end"&&(h=n.height,m=0),this.paddingTop=h+o,this.paddingBottom=m+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:r,position:n}=this.options;return n==="top"||n==="bottom"||r==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(r){this.beforeTickToLabelConversion(),this.generateTickLabels(r);let n,s;for(n=0,s=r.length;n<s;n++)isNullOrUndef(r[n].label)&&(r.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let r=this._labelSizes;if(!r){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=sample(s,n)),this._labelSizes=r=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return r}_computeLabelSizes(r,n,s){const{ctx:a,_longestTextCache:i}=this,o=[],c=[],f=Math.floor(n/getTicksLimit(n,s));let d=0,h=0,m,g,v,y,_,w,b,T,k,C,L;for(m=0;m<n;m+=f){if(y=r[m].label,_=this._resolveTickFontOptions(m),a.font=w=_.string,b=i[w]=i[w]||{data:{},gc:[]},T=_.lineHeight,k=C=0,!isNullOrUndef(y)&&!isArray(y))k=_measureText(a,b.data,b.gc,k,y),C=T;else if(isArray(y))for(g=0,v=y.length;g<v;++g)L=y[g],!isNullOrUndef(L)&&!isArray(L)&&(k=_measureText(a,b.data,b.gc,k,L),C+=T);o.push(k),c.push(C),d=Math.max(k,d),h=Math.max(C,h)}garbageCollect(i,n);const D=o.indexOf(d),N=c.indexOf(h),U=M=>({width:o[M]||0,height:c[M]||0});return{first:U(0),last:U(n-1),widest:U(D),highest:U(N),widths:o,heights:c}}getLabelForValue(r){return r}getPixelForValue(r,n){return NaN}getValueForPixel(r){}getPixelForTick(r){const n=this.ticks;return r<0||r>n.length-1?null:this.getPixelForValue(n[r].value)}getPixelForDecimal(r){this._reversePixels&&(r=1-r);const n=this._startPixel+r*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,n,0):n)}getDecimalForPixel(r){const n=(r-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:r,max:n}=this;return r<0&&n<0?n:r>0&&n>0?r:0}getContext(r){const n=this.ticks||[];if(r>=0&&r<n.length){const s=n[r];return s.$context||(s.$context=createTickContext(this.getContext(),r,s))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const r=this.options.ticks,n=toRadians(this.labelRotation),s=Math.abs(Math.cos(n)),a=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=r.autoSkipPadding||0,c=i?i.widest.width+o:0,f=i?i.highest.height+o:0;return this.isHorizontal()?f*s>c*a?c/s:f/a:f*a<c*s?f/s:c/a}_isVisible(){const r=this.options.display;return r!=="auto"?!!r:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(r){const n=this.axis,s=this.chart,a=this.options,{grid:i,position:o,border:c}=a,f=i.offset,d=this.isHorizontal(),m=this.ticks.length+(f?1:0),g=getTickMarkLength(i),v=[],y=c.setContext(this.getContext()),_=y.display?y.width:0,w=_/2,b=function(me){return _alignPixel(s,me,_)};let T,k,C,L,D,N,U,M,j,K,I,te;if(o==="top")T=b(this.bottom),N=this.bottom-g,M=T-w,K=b(r.top)+w,te=r.bottom;else if(o==="bottom")T=b(this.top),K=r.top,te=b(r.bottom)-w,N=T+w,M=this.top+g;else if(o==="left")T=b(this.right),D=this.right-g,U=T-w,j=b(r.left)+w,I=r.right;else if(o==="right")T=b(this.left),j=r.left,I=b(r.right)-w,D=T+w,U=this.left+g;else if(n==="x"){if(o==="center")T=b((r.top+r.bottom)/2+.5);else if(isObject(o)){const me=Object.keys(o)[0],le=o[me];T=b(this.chart.scales[me].getPixelForValue(le))}K=r.top,te=r.bottom,N=T+w,M=N+g}else if(n==="y"){if(o==="center")T=b((r.left+r.right)/2);else if(isObject(o)){const me=Object.keys(o)[0],le=o[me];T=b(this.chart.scales[me].getPixelForValue(le))}D=T-w,U=D-g,j=r.left,I=r.right}const _e=valueOrDefault(a.ticks.maxTicksLimit,m),ne=Math.max(1,Math.ceil(m/_e));for(k=0;k<m;k+=ne){const me=this.getContext(k),le=i.setContext(me),he=c.setContext(me),J=le.lineWidth,fe=le.color,G=he.dash||[],A=he.dashOffset,q=le.tickWidth,P=le.tickColor,V=le.tickBorderDash||[],ee=le.tickBorderDashOffset;C=getPixelForGridLine(this,k,f),C!==void 0&&(L=_alignPixel(s,C,J),d?D=U=j=I=L:N=M=K=te=L,v.push({tx1:D,ty1:N,tx2:U,ty2:M,x1:j,y1:K,x2:I,y2:te,width:J,color:fe,borderDash:G,borderDashOffset:A,tickWidth:q,tickColor:P,tickBorderDash:V,tickBorderDashOffset:ee}))}return this._ticksLength=m,this._borderValue=T,v}_computeLabelItems(r){const n=this.axis,s=this.options,{position:a,ticks:i}=s,o=this.isHorizontal(),c=this.ticks,{align:f,crossAlign:d,padding:h,mirror:m}=i,g=getTickMarkLength(s.grid),v=g+h,y=m?-h:v,_=-toRadians(this.labelRotation),w=[];let b,T,k,C,L,D,N,U,M,j,K,I,te="middle";if(a==="top")D=this.bottom-y,N=this._getXAxisLabelAlignment();else if(a==="bottom")D=this.top+y,N=this._getXAxisLabelAlignment();else if(a==="left"){const ne=this._getYAxisLabelAlignment(g);N=ne.textAlign,L=ne.x}else if(a==="right"){const ne=this._getYAxisLabelAlignment(g);N=ne.textAlign,L=ne.x}else if(n==="x"){if(a==="center")D=(r.top+r.bottom)/2+v;else if(isObject(a)){const ne=Object.keys(a)[0],me=a[ne];D=this.chart.scales[ne].getPixelForValue(me)+v}N=this._getXAxisLabelAlignment()}else if(n==="y"){if(a==="center")L=(r.left+r.right)/2-v;else if(isObject(a)){const ne=Object.keys(a)[0],me=a[ne];L=this.chart.scales[ne].getPixelForValue(me)}N=this._getYAxisLabelAlignment(g).textAlign}n==="y"&&(f==="start"?te="top":f==="end"&&(te="bottom"));const _e=this._getLabelSizes();for(b=0,T=c.length;b<T;++b){k=c[b],C=k.label;const ne=i.setContext(this.getContext(b));U=this.getPixelForTick(b)+i.labelOffset,M=this._resolveTickFontOptions(b),j=M.lineHeight,K=isArray(C)?C.length:1;const me=K/2,le=ne.color,he=ne.textStrokeColor,J=ne.textStrokeWidth;let fe=N;o?(L=U,N==="inner"&&(b===T-1?fe=this.options.reverse?"left":"right":b===0?fe=this.options.reverse?"right":"left":fe="center"),a==="top"?d==="near"||_!==0?I=-K*j+j/2:d==="center"?I=-_e.highest.height/2-me*j+j:I=-_e.highest.height+j/2:d==="near"||_!==0?I=j/2:d==="center"?I=_e.highest.height/2-me*j:I=_e.highest.height-K*j,m&&(I*=-1),_!==0&&!ne.showLabelBackdrop&&(L+=j/2*Math.sin(_))):(D=U,I=(1-K)*j/2);let G;if(ne.showLabelBackdrop){const A=toPadding(ne.backdropPadding),q=_e.heights[b],P=_e.widths[b];let V=I-A.top,ee=0-A.left;switch(te){case"middle":V-=q/2;break;case"bottom":V-=q;break}switch(N){case"center":ee-=P/2;break;case"right":ee-=P;break;case"inner":b===T-1?ee-=P:b>0&&(ee-=P/2);break}G={left:ee,top:V,width:P+A.width,height:q+A.height,color:ne.backdropColor}}w.push({label:C,font:M,textOffset:I,options:{rotation:_,color:le,strokeColor:he,strokeWidth:J,textAlign:fe,textBaseline:te,translation:[L,D],backdrop:G}})}return w}_getXAxisLabelAlignment(){const{position:r,ticks:n}=this.options;if(-toRadians(this.labelRotation))return r==="top"?"left":"right";let a="center";return n.align==="start"?a="left":n.align==="end"?a="right":n.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(r){const{position:n,ticks:{crossAlign:s,mirror:a,padding:i}}=this.options,o=this._getLabelSizes(),c=r+i,f=o.widest.width;let d,h;return n==="left"?a?(h=this.right+i,s==="near"?d="left":s==="center"?(d="center",h+=f/2):(d="right",h+=f)):(h=this.right-c,s==="near"?d="right":s==="center"?(d="center",h-=f/2):(d="left",h=this.left)):n==="right"?a?(h=this.left+i,s==="near"?d="right":s==="center"?(d="center",h-=f/2):(d="left",h-=f)):(h=this.left+c,s==="near"?d="left":s==="center"?(d="center",h+=f/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const r=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:r.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:r.width}}drawBackground(){const{ctx:r,options:{backgroundColor:n},left:s,top:a,width:i,height:o}=this;n&&(r.save(),r.fillStyle=n,r.fillRect(s,a,i,o),r.restore())}getLineWidthForValue(r){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const a=this.ticks.findIndex(i=>i.value===r);return a>=0?n.setContext(this.getContext(a)).lineWidth:0}drawGrid(r){const n=this.options.grid,s=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(r));let i,o;const c=(f,d,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(f.x,f.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=a.length;i<o;++i){const f=a[i];n.drawOnChartArea&&c({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&c({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:r,ctx:n,options:{border:s,grid:a}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const c=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let d,h,m,g;this.isHorizontal()?(d=_alignPixel(r,this.left,o)-o/2,h=_alignPixel(r,this.right,c)+c/2,m=g=f):(m=_alignPixel(r,this.top,o)-o/2,g=_alignPixel(r,this.bottom,c)+c/2,d=h=f),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(d,m),n.lineTo(h,g),n.stroke(),n.restore()}drawLabels(r){if(!this.options.ticks.display)return;const s=this.ctx,a=this._computeLabelArea();a&&clipArea(s,a);const i=this.getLabelItems(r);for(const o of i){const c=o.options,f=o.font,d=o.label,h=o.textOffset;renderText(s,d,0,h,f,c)}a&&unclipArea(s)}drawTitle(){const{ctx:r,options:{position:n,title:s,reverse:a}}=this;if(!s.display)return;const i=toFont(s.font),o=toPadding(s.padding),c=s.align;let f=i.lineHeight/2;n==="bottom"||n==="center"||isObject(n)?(f+=o.bottom,isArray(s.text)&&(f+=i.lineHeight*(s.text.length-1))):f+=o.top;const{titleX:d,titleY:h,maxWidth:m,rotation:g}=titleArgs(this,f,n,c);renderText(r,s.text,0,0,i,{color:s.color,maxWidth:m,rotation:g,textAlign:titleAlign(c,n,a),textBaseline:"middle",translation:[d,h]})}draw(r){this._isVisible()&&(this.drawBackground(),this.drawGrid(r),this.drawBorder(),this.drawTitle(),this.drawLabels(r))}_layers(){const r=this.options,n=r.ticks&&r.ticks.z||0,s=valueOrDefault(r.grid&&r.grid.z,-1),a=valueOrDefault(r.border&&r.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(r){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",a=[];let i,o;for(i=0,o=n.length;i<o;++i){const c=n[i];c[s]===this.id&&(!r||c.type===r)&&a.push(c)}return a}_resolveTickFontOptions(r){const n=this.options.ticks.setContext(this.getContext(r));return toFont(n.font)}_maxDigits(){const r=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/r}}class TypedRegistry{constructor(r,n,s){this.type=r,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(r){return Object.prototype.isPrototypeOf.call(this.type.prototype,r.prototype)}register(r){const n=Object.getPrototypeOf(r);let s;isIChartComponent(n)&&(s=this.register(n));const a=this.items,i=r.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+r);return i in a||(a[i]=r,registerDefaults(r,o,s),this.override&&defaults.override(r.id,r.overrides)),o}get(r){return this.items[r]}unregister(r){const n=this.items,s=r.id,a=this.scope;s in n&&delete n[s],a&&s in defaults[a]&&(delete defaults[a][s],this.override&&delete overrides[s])}}function registerDefaults(t,r,n){const s=merge(Object.create(null),[n?defaults.get(n):{},defaults.get(r),t.defaults]);defaults.set(r,s),t.defaultRoutes&&routeDefaults(r,t.defaultRoutes),t.descriptors&&defaults.describe(r,t.descriptors)}function routeDefaults(t,r){Object.keys(r).forEach(n=>{const s=n.split("."),a=s.pop(),i=[t].concat(s).join("."),o=r[n].split("."),c=o.pop(),f=o.join(".");defaults.route(i,a,f,c)})}function isIChartComponent(t){return"id"in t&&"defaults"in t}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...r){this._each("register",r)}remove(...r){this._each("unregister",r)}addControllers(...r){this._each("register",r,this.controllers)}addElements(...r){this._each("register",r,this.elements)}addPlugins(...r){this._each("register",r,this.plugins)}addScales(...r){this._each("register",r,this.scales)}getController(r){return this._get(r,this.controllers,"controller")}getElement(r){return this._get(r,this.elements,"element")}getPlugin(r){return this._get(r,this.plugins,"plugin")}getScale(r){return this._get(r,this.scales,"scale")}removeControllers(...r){this._each("unregister",r,this.controllers)}removeElements(...r){this._each("unregister",r,this.elements)}removePlugins(...r){this._each("unregister",r,this.plugins)}removeScales(...r){this._each("unregister",r,this.scales)}_each(r,n,s){[...n].forEach(a=>{const i=s||this._getRegistryForType(a);s||i.isForType(a)||i===this.plugins&&a.id?this._exec(r,i,a):each(a,o=>{const c=s||this._getRegistryForType(o);this._exec(r,c,o)})})}_exec(r,n,s){const a=_capitalize(r);callback(s["before"+a],[],s),n[r](s),callback(s["after"+a],[],s)}_getRegistryForType(r){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(r))return s}return this.plugins}_get(r,n,s){const a=n.get(r);if(a===void 0)throw new Error('"'+r+'" is not a registered '+s+".");return a}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(r,n,s,a){n==="beforeInit"&&(this._init=this._createDescriptors(r,!0),this._notify(this._init,r,"install"));const i=a?this._descriptors(r).filter(a):this._descriptors(r),o=this._notify(i,r,n,s);return n==="afterDestroy"&&(this._notify(i,r,"stop"),this._notify(this._init,r,"uninstall")),o}_notify(r,n,s,a){a=a||{};for(const i of r){const o=i.plugin,c=o[s],f=[n,a,i.options];if(callback(c,f,o)===!1&&a.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(r){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(r);return this._notifyStateChanges(r),n}_createDescriptors(r,n){const s=r&&r.config,a=valueOrDefault(s.options&&s.options.plugins,{}),i=allPlugins(s);return a===!1&&!n?[]:createDescriptors(r,i,a,n)}_notifyStateChanges(r){const n=this._oldCache||[],s=this._cache,a=(i,o)=>i.filter(c=>!o.some(f=>c.plugin.id===f.plugin.id));this._notify(a(n,s),r,"stop"),this._notify(a(s,n),r,"start")}}function allPlugins(t){const r={},n=[],s=Object.keys(registry.plugins.items);for(let i=0;i<s.length;i++)n.push(registry.getPlugin(s[i]));const a=t.plugins||[];for(let i=0;i<a.length;i++){const o=a[i];n.indexOf(o)===-1&&(n.push(o),r[o.id]=!0)}return{plugins:n,localIds:r}}function getOpts(t,r){return!r&&t===!1?null:t===!0?{}:t}function createDescriptors(t,{plugins:r,localIds:n},s,a){const i=[],o=t.getContext();for(const c of r){const f=c.id,d=getOpts(s[f],a);d!==null&&i.push({plugin:c,options:pluginOpts(t.config,{plugin:c,local:n[f]},d,o)})}return i}function pluginOpts(t,{plugin:r,local:n},s,a){const i=t.pluginScopeKeys(r),o=t.getOptionScopes(s,i);return n&&r.defaults&&o.push(r.defaults),t.createResolver(o,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(t,r){const n=defaults.datasets[t]||{};return((r.datasets||{})[t]||{}).indexAxis||r.indexAxis||n.indexAxis||"x"}function getAxisFromDefaultScaleID(t,r){let n=t;return t==="_index_"?n=r:t==="_value_"&&(n=r==="x"?"y":"x"),n}function getDefaultScaleIDFromAxis(t,r){return t===r?"_index_":"_value_"}function idMatchesAxis(t){if(t==="x"||t==="y"||t==="r")return t}function axisFromPosition(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function determineAxis(t,...r){if(idMatchesAxis(t))return t;for(const n of r){const s=n.axis||axisFromPosition(n.position)||t.length>1&&idMatchesAxis(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(t,r,n){if(n[r+"AxisID"]===t)return{axis:r}}function retrieveAxisFromDatasets(t,r){if(r.data&&r.data.datasets){const n=r.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return getAxisFromDataset(t,"x",n[0])||getAxisFromDataset(t,"y",n[0])}return{}}function mergeScaleConfig(t,r){const n=overrides[t.type]||{scales:{}},s=r.scales||{},a=getIndexAxis(t.type,r),i=Object.create(null);return Object.keys(s).forEach(o=>{const c=s[o];if(!isObject(c))return console.error(`Invalid scale configuration for scale: ${o}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const f=determineAxis(o,c,retrieveAxisFromDatasets(o,t),defaults.scales[c.type]),d=getDefaultScaleIDFromAxis(f,a),h=n.scales||{};i[o]=mergeIf(Object.create(null),[{axis:f},c,h[f],h[d]])}),t.data.datasets.forEach(o=>{const c=o.type||t.type,f=o.indexAxis||getIndexAxis(c,r),h=(overrides[c]||{}).scales||{};Object.keys(h).forEach(m=>{const g=getAxisFromDefaultScaleID(m,f),v=o[g+"AxisID"]||g;i[v]=i[v]||Object.create(null),mergeIf(i[v],[{axis:g},s[v],h[m]])})}),Object.keys(i).forEach(o=>{const c=i[o];mergeIf(c,[defaults.scales[c.type],defaults.scale])}),i}function initOptions(t){const r=t.options||(t.options={});r.plugins=valueOrDefault(r.plugins,{}),r.scales=mergeScaleConfig(t,r)}function initData(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function initConfig(t){return t=t||{},t.data=initData(t.data),initOptions(t),t}const keyCache=new Map,keysCached=new Set;function cachedKeys(t,r){let n=keyCache.get(t);return n||(n=r(),keyCache.set(t,n),keysCached.add(n)),n}const addIfFound=(t,r,n)=>{const s=resolveObjectKey(r,n);s!==void 0&&t.add(s)};class Config{constructor(r){this._config=initConfig(r),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(r){this._config.type=r}get data(){return this._config.data}set data(r){this._config.data=initData(r)}get options(){return this._config.options}set options(r){this._config.options=r}get plugins(){return this._config.plugins}update(){const r=this._config;this.clearCache(),initOptions(r)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(r){return cachedKeys(r,()=>[[`datasets.${r}`,""]])}datasetAnimationScopeKeys(r,n){return cachedKeys(`${r}.transition.${n}`,()=>[[`datasets.${r}.transitions.${n}`,`transitions.${n}`],[`datasets.${r}`,""]])}datasetElementScopeKeys(r,n){return cachedKeys(`${r}-${n}`,()=>[[`datasets.${r}.elements.${n}`,`datasets.${r}`,`elements.${n}`,""]])}pluginScopeKeys(r){const n=r.id,s=this.type;return cachedKeys(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...r.additionalOptionScopes||[]]])}_cachedScopes(r,n){const s=this._scopeCache;let a=s.get(r);return(!a||n)&&(a=new Map,s.set(r,a)),a}getOptionScopes(r,n,s){const{options:a,type:i}=this,o=this._cachedScopes(r,s),c=o.get(n);if(c)return c;const f=new Set;n.forEach(h=>{r&&(f.add(r),h.forEach(m=>addIfFound(f,r,m))),h.forEach(m=>addIfFound(f,a,m)),h.forEach(m=>addIfFound(f,overrides[i]||{},m)),h.forEach(m=>addIfFound(f,defaults,m)),h.forEach(m=>addIfFound(f,descriptors,m))});const d=Array.from(f);return d.length===0&&d.push(Object.create(null)),keysCached.has(n)&&o.set(n,d),d}chartOptionScopes(){const{options:r,type:n}=this;return[r,overrides[n]||{},defaults.datasets[n]||{},{type:n},defaults,descriptors]}resolveNamedOptions(r,n,s,a=[""]){const i={$shared:!0},{resolver:o,subPrefixes:c}=getResolver(this._resolverCache,r,a);let f=o;if(needContext(o,n)){i.$shared=!1,s=isFunction(s)?s():s;const d=this.createResolver(r,s,c);f=_attachContext(o,s,d)}for(const d of n)i[d]=f[d];return i}createResolver(r,n,s=[""],a){const{resolver:i}=getResolver(this._resolverCache,r,s);return isObject(n)?_attachContext(i,n,void 0,a):i}}function getResolver(t,r,n){let s=t.get(r);s||(s=new Map,t.set(r,s));const a=n.join();let i=s.get(a);return i||(i={resolver:_createResolver(r,n),subPrefixes:n.filter(c=>!c.toLowerCase().includes("hover"))},s.set(a,i)),i}const hasFunction=t=>isObject(t)&&Object.getOwnPropertyNames(t).some(r=>isFunction(t[r]));function needContext(t,r){const{isScriptable:n,isIndexable:s}=_descriptors(t);for(const a of r){const i=n(a),o=s(a),c=(o||i)&&t[a];if(i&&(isFunction(c)||hasFunction(c))||o&&isArray(c))return!0}return!1}var version="4.4.9";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(t,r){return t==="top"||t==="bottom"||KNOWN_POSITIONS.indexOf(t)===-1&&r==="x"}function compare2Level(t,r){return function(n,s){return n[t]===s[t]?n[r]-s[r]:n[t]-s[t]}}function onAnimationsComplete(t){const r=t.chart,n=r.options.animation;r.notifyPlugins("afterRender"),callback(n&&n.onComplete,[t],r)}function onAnimationProgress(t){const r=t.chart,n=r.options.animation;callback(n&&n.onProgress,[t],r)}function getCanvas(t){return _isDomSupported()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const instances={},getChart=t=>{const r=getCanvas(t);return Object.values(instances).filter(n=>n.canvas===r).pop()};function moveNumericKeys(t,r,n){const s=Object.keys(t);for(const a of s){const i=+a;if(i>=r){const o=t[a];delete t[a],(n>0||i>r)&&(t[i+n]=o)}}}function determineLastEvent(t,r,n,s){return!n||t.type==="mouseout"?null:s?r:t}var zr;let Chart$1=(zr=class{static register(...r){registry.add(...r),invalidatePlugins()}static unregister(...r){registry.remove(...r),invalidatePlugins()}constructor(r,n){const s=this.config=new Config(n),a=getCanvas(r),i=getChart(a);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||_detectPlatform(a)),this.platform.updateConfig(s);const c=this.platform.acquireContext(a,o.aspectRatio),f=c&&c.canvas,d=f&&f.height,h=f&&f.width;if(this.id=uid(),this.ctx=c,this.canvas=f,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(m=>this.update(m),o.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!c||!f){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:r,maintainAspectRatio:n},width:s,height:a,_aspectRatio:i}=this;return isNullOrUndef(r)?n&&i?i:a?s/a:null:r}get data(){return this.config.data}set data(r){this.config.data=r}get options(){return this._options}set options(r){this.config.options=r}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(r,n){animator.running(this)?this._resizeBeforeDraw={width:r,height:n}:this._resize(r,n)}_resize(r,n){const s=this.options,a=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(a,r,n,i),c=s.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,retinaScale(this,c,!0)&&(this.notifyPlugins("resize",{size:o}),callback(s.onResize,[this,o],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};each(n,(s,a)=>{s.id=a})}buildOrUpdateScales(){const r=this.options,n=r.scales,s=this.scales,a=Object.keys(s).reduce((o,c)=>(o[c]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const c=n[o],f=determineAxis(o,c),d=f==="r",h=f==="x";return{options:c,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),each(i,o=>{const c=o.options,f=c.id,d=determineAxis(f,c),h=valueOrDefault(c.type,o.dtype);(c.position===void 0||positionIsHorizontal(c.position,d)!==positionIsHorizontal(o.dposition))&&(c.position=o.dposition),a[f]=!0;let m=null;if(f in s&&s[f].type===h)m=s[f];else{const g=registry.getScale(h);m=new g({id:f,type:h,ctx:this.ctx,chart:this}),s[m.id]=m}m.init(c,r)}),each(a,(o,c)=>{o||delete s[c]}),each(s,o=>{layouts.configure(this,o,o.options),layouts.addBox(this,o)})}_updateMetasets(){const r=this._metasets,n=this.data.datasets.length,s=r.length;if(r.sort((a,i)=>a.index-i.index),s>n){for(let a=n;a<s;++a)this._destroyDatasetMeta(a);r.splice(n,s-n)}this._sortedMetasets=r.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:r,data:{datasets:n}}=this;r.length>n.length&&delete this._stacks,r.forEach((s,a)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){const r=[],n=this.data.datasets;let s,a;for(this._removeUnreferencedMetasets(),s=0,a=n.length;s<a;s++){const i=n[s];let o=this.getDatasetMeta(s);const c=i.type||this.config.type;if(o.type&&o.type!==c&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=c,o.indexAxis=i.indexAxis||getIndexAxis(c,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const f=registry.getController(c),{datasetElementType:d,dataElementType:h}=defaults.datasets[c];Object.assign(f,{dataElementType:registry.getElement(h),datasetElementType:d&&registry.getElement(d)}),o.controller=new f(this,s),r.push(o.controller)}}return this._updateMetasets(),r}_resetElements(){each(this.data.datasets,(r,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(r){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:r,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:m}=this.getDatasetMeta(d),g=!a&&i.indexOf(m)===-1;m.buildOrUpdateElements(g),o=Math.max(+m.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),a||each(i,d=>{d.reset()}),this._updateDatasets(r),this.notifyPlugins("afterUpdate",{mode:r}),this._layers.sort(compare2Level("z","_idx"));const{_active:c,_lastEvent:f}=this;f?this._eventHandler(f,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){each(this.scales,r=>{layouts.removeBox(this,r)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const r=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(r.events);(!setsEqual(n,s)||!!this._responsiveListeners!==r.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:r}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:a,count:i}of n){const o=s==="_removeElements"?-i:i;moveNumericKeys(r,a,o)}}_getUniformDataChanges(){const r=this._dataChanges;if(!r||!r.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(r.filter(o=>o[0]===i).map((o,c)=>c+","+o.splice(1).join(","))),a=s(0);for(let i=1;i<n;i++)if(!setsEqual(a,s(i)))return;return Array.from(a).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(r){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,r);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],each(this.boxes,a=>{s&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,i)=>{a._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(r){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:r,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,isFunction(r)?r({datasetIndex:n}):r);this.notifyPlugins("afterDatasetsUpdate",{mode:r})}}_updateDataset(r,n){const s=this.getDatasetMeta(r),a={meta:s,index:r,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(s.controller._update(n),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let r;if(this._resizeBeforeDraw){const{width:s,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(r=0;r<n.length&&n[r].z<=0;++r)n[r].draw(this.chartArea);for(this._drawDatasets();r<n.length;++r)n[r].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(r){const n=this._sortedMetasets,s=[];let a,i;for(a=0,i=n.length;a<i;++a){const o=n[a];(!r||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const r=this.getSortedVisibleDatasetMetas();for(let n=r.length-1;n>=0;--n)this._drawDataset(r[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(r){const n=this.ctx,s={meta:r,index:r.index,cancelable:!0},a=getDatasetClipArea(this,r);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(a&&clipArea(n,a),r.controller.draw(),a&&unclipArea(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(r){return _isPointInArea(r,this.chartArea,this._minPadding)}getElementsAtEventForMode(r,n,s,a){const i=Interaction.modes[n];return typeof i=="function"?i(this,r,s,a):[]}getDatasetMeta(r){const n=this.data.datasets[r],s=this._metasets;let a=s.filter(i=>i&&i._dataset===n).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:r,_dataset:n,_parsed:[],_sorted:!1},s.push(a)),a}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(r){const n=this.data.datasets[r];if(!n)return!1;const s=this.getDatasetMeta(r);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(r,n){const s=this.getDatasetMeta(r);s.hidden=!n}toggleDataVisibility(r){this._hiddenIndices[r]=!this._hiddenIndices[r]}getDataVisibility(r){return!this._hiddenIndices[r]}_updateVisibility(r,n,s){const a=s?"show":"hide",i=this.getDatasetMeta(r),o=i.controller._resolveAnimations(void 0,a);defined(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(r,s),o.update(i,{visible:s}),this.update(c=>c.datasetIndex===r?a:void 0))}hide(r,n){this._updateVisibility(r,n,!1)}show(r,n){this._updateVisibility(r,n,!0)}_destroyDatasetMeta(r){const n=this._metasets[r];n&&n.controller&&n.controller._destroy(),delete this._metasets[r]}_stop(){let r,n;for(this.stop(),animator.remove(this),r=0,n=this.data.datasets.length;r<n;++r)this._destroyDatasetMeta(r)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:r,ctx:n}=this;this._stop(),this.config.clearCache(),r&&(this.unbindEvents(),clearCanvas(r,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...r){return this.canvas.toDataURL(...r)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const r=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),r[i]=o},a=(i,o,c)=>{i.offsetX=o,i.offsetY=c,this._eventHandler(i)};each(this.options.events,i=>s(i,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const r=this._responsiveListeners,n=this.platform,s=(f,d)=>{n.addEventListener(this,f,d),r[f]=d},a=(f,d)=>{r[f]&&(n.removeEventListener(this,f,d),delete r[f])},i=(f,d)=>{this.canvas&&this.resize(f,d)};let o;const c=()=>{a("attach",c),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,a("resize",i),this._stop(),this._resize(0,0),s("attach",c)},n.isAttached(this.canvas)?c():o()}unbindEvents(){each(this._listeners,(r,n)=>{this.platform.removeEventListener(this,n,r)}),this._listeners={},each(this._responsiveListeners,(r,n)=>{this.platform.removeEventListener(this,n,r)}),this._responsiveListeners=void 0}updateHoverStyle(r,n,s){const a=s?"set":"remove";let i,o,c,f;for(n==="dataset"&&(i=this.getDatasetMeta(r[0].datasetIndex),i.controller["_"+a+"DatasetHoverStyle"]()),c=0,f=r.length;c<f;++c){o=r[c];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[a+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(r){const n=this._active||[],s=r.map(({datasetIndex:i,index:o})=>{const c=this.getDatasetMeta(i);if(!c)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:c.data[o],index:o}});!_elementsEqual(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(r,n,s){return this._plugins.notify(this,r,n,s)}isPluginEnabled(r){return this._plugins._cache.filter(n=>n.plugin.id===r).length===1}_updateHoverStyles(r,n,s){const a=this.options.hover,i=(f,d)=>f.filter(h=>!d.some(m=>h.datasetIndex===m.datasetIndex&&h.index===m.index)),o=i(n,r),c=s?r:i(r,n);o.length&&this.updateHoverStyle(o,a.mode,!1),c.length&&a.mode&&this.updateHoverStyle(c,a.mode,!0)}_eventHandler(r,n){const s={event:r,replay:n,cancelable:!0,inChartArea:this.isPointInArea(r)},a=o=>(o.options.events||this.options.events).includes(r.native.type);if(this.notifyPlugins("beforeEvent",s,a)===!1)return;const i=this._handleEvent(r,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,a),(i||s.changed)&&this.render(),this}_handleEvent(r,n,s){const{_active:a=[],options:i}=this,o=n,c=this._getActiveElements(r,a,s,o),f=_isClickEvent(r),d=determineLastEvent(r,this._lastEvent,s,f);s&&(this._lastEvent=null,callback(i.onHover,[r,c,this],this),f&&callback(i.onClick,[r,c,this],this));const h=!_elementsEqual(c,a);return(h||n)&&(this._active=c,this._updateHoverStyles(c,a,n)),this._lastEvent=d,h}_getActiveElements(r,n,s,a){if(r.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(r,i.mode,i,a)}},Le(zr,"defaults",defaults),Le(zr,"instances",instances),Le(zr,"overrides",overrides),Le(zr,"registry",registry),Le(zr,"version",version),Le(zr,"getChart",getChart),zr);function invalidatePlugins(){return each(Chart$1.instances,t=>t._plugins.invalidate())}function clipArc(t,r,n){const{startAngle:s,pixelMargin:a,x:i,y:o,outerRadius:c,innerRadius:f}=r;let d=a/c;t.beginPath(),t.arc(i,o,c,s-d,n+d),f>a?(d=a/f,t.arc(i,o,f,n+d,s-d,!0)):t.arc(i,o,a,n+HALF_PI,s-HALF_PI),t.closePath(),t.clip()}function toRadiusCorners(t){return _readValueToProps(t,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(t,r,n,s){const a=toRadiusCorners(t.options.borderRadius),i=(n-r)/2,o=Math.min(i,s*r/2),c=f=>{const d=(n-Math.min(i,f))*s/2;return _limitValue(f,0,Math.min(i,d))};return{outerStart:c(a.outerStart),outerEnd:c(a.outerEnd),innerStart:_limitValue(a.innerStart,0,o),innerEnd:_limitValue(a.innerEnd,0,o)}}function rThetaToXY(t,r,n,s){return{x:n+t*Math.cos(r),y:s+t*Math.sin(r)}}function pathArc(t,r,n,s,a,i){const{x:o,y:c,startAngle:f,pixelMargin:d,innerRadius:h}=r,m=Math.max(r.outerRadius+s+n-d,0),g=h>0?h+s+n+d:0;let v=0;const y=a-f;if(s){const ne=h>0?h-s:0,me=m>0?m-s:0,le=(ne+me)/2,he=le!==0?y*le/(le+s):y;v=(y-he)/2}const _=Math.max(.001,y*m-n/PI)/m,w=(y-_)/2,b=f+w+v,T=a-w-v,{outerStart:k,outerEnd:C,innerStart:L,innerEnd:D}=parseBorderRadius$1(r,g,m,T-b),N=m-k,U=m-C,M=b+k/N,j=T-C/U,K=g+L,I=g+D,te=b+L/K,_e=T-D/I;if(t.beginPath(),i){const ne=(M+j)/2;if(t.arc(o,c,m,M,ne),t.arc(o,c,m,ne,j),C>0){const J=rThetaToXY(U,j,o,c);t.arc(J.x,J.y,C,j,T+HALF_PI)}const me=rThetaToXY(I,T,o,c);if(t.lineTo(me.x,me.y),D>0){const J=rThetaToXY(I,_e,o,c);t.arc(J.x,J.y,D,T+HALF_PI,_e+Math.PI)}const le=(T-D/g+(b+L/g))/2;if(t.arc(o,c,g,T-D/g,le,!0),t.arc(o,c,g,le,b+L/g,!0),L>0){const J=rThetaToXY(K,te,o,c);t.arc(J.x,J.y,L,te+Math.PI,b-HALF_PI)}const he=rThetaToXY(N,b,o,c);if(t.lineTo(he.x,he.y),k>0){const J=rThetaToXY(N,M,o,c);t.arc(J.x,J.y,k,b-HALF_PI,M)}}else{t.moveTo(o,c);const ne=Math.cos(M)*m+o,me=Math.sin(M)*m+c;t.lineTo(ne,me);const le=Math.cos(j)*m+o,he=Math.sin(j)*m+c;t.lineTo(le,he)}t.closePath()}function drawArc(t,r,n,s,a){const{fullCircles:i,startAngle:o,circumference:c}=r;let f=r.endAngle;if(i){pathArc(t,r,n,s,f,a);for(let d=0;d<i;++d)t.fill();isNaN(c)||(f=o+(c%TAU||TAU))}return pathArc(t,r,n,s,f,a),t.fill(),f}function drawBorder(t,r,n,s,a){const{fullCircles:i,startAngle:o,circumference:c,options:f}=r,{borderWidth:d,borderJoinStyle:h,borderDash:m,borderDashOffset:g}=f,v=f.borderAlign==="inner";if(!d)return;t.setLineDash(m||[]),t.lineDashOffset=g,v?(t.lineWidth=d*2,t.lineJoin=h||"round"):(t.lineWidth=d,t.lineJoin=h||"bevel");let y=r.endAngle;if(i){pathArc(t,r,n,s,y,a);for(let _=0;_<i;++_)t.stroke();isNaN(c)||(y=o+(c%TAU||TAU))}v&&clipArc(t,r,y),i||(pathArc(t,r,n,s,y,a),t.stroke())}class ArcElement extends Element{constructor(n){super();Le(this,"circumference");Le(this,"endAngle");Le(this,"fullCircles");Le(this,"innerRadius");Le(this,"outerRadius");Le(this,"pixelMargin");Le(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,a){const i=this.getProps(["x","y"],a),{angle:o,distance:c}=getAngleFromPoint(i,{x:n,y:s}),{startAngle:f,endAngle:d,innerRadius:h,outerRadius:m,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],a),v=(this.options.spacing+this.options.borderWidth)/2,y=valueOrDefault(g,d-f),_=_angleBetween(o,f,d)&&f!==d,w=y>=TAU||_,b=_isBetween(c,h+v,m+v);return w&&b}getCenterPoint(n){const{x:s,y:a,startAngle:i,endAngle:o,innerRadius:c,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:d,spacing:h}=this.options,m=(i+o)/2,g=(c+f+h+d)/2;return{x:s+Math.cos(m)*g,y:a+Math.sin(m)*g}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:a}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,c=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=a>TAU?Math.floor(a/TAU):0,a===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const f=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(f)*i,Math.sin(f)*i);const d=1-Math.sin(Math.min(PI,a||0)),h=i*d;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,drawArc(n,this,h,o,c),drawBorder(n,this,h,o,c),n.restore()}}Le(ArcElement,"id","arc"),Le(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Le(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),Le(ArcElement,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function setStyle(t,r,n=r){t.lineCap=valueOrDefault(n.borderCapStyle,r.borderCapStyle),t.setLineDash(valueOrDefault(n.borderDash,r.borderDash)),t.lineDashOffset=valueOrDefault(n.borderDashOffset,r.borderDashOffset),t.lineJoin=valueOrDefault(n.borderJoinStyle,r.borderJoinStyle),t.lineWidth=valueOrDefault(n.borderWidth,r.borderWidth),t.strokeStyle=valueOrDefault(n.borderColor,r.borderColor)}function lineTo(t,r,n){t.lineTo(n.x,n.y)}function getLineMethod(t){return t.stepped?_steppedLineTo:t.tension||t.cubicInterpolationMode==="monotone"?_bezierCurveTo:lineTo}function pathVars(t,r,n={}){const s=t.length,{start:a=0,end:i=s-1}=n,{start:o,end:c}=r,f=Math.max(a,o),d=Math.min(i,c),h=a<o&&i<o||a>c&&i>c;return{count:s,start:f,loop:r.loop,ilen:d<f&&!h?s+d-f:d-f}}function pathSegment(t,r,n,s){const{points:a,options:i}=r,{count:o,start:c,loop:f,ilen:d}=pathVars(a,n,s),h=getLineMethod(i);let{move:m=!0,reverse:g}=s||{},v,y,_;for(v=0;v<=d;++v)y=a[(c+(g?d-v:v))%o],!y.skip&&(m?(t.moveTo(y.x,y.y),m=!1):h(t,_,y,g,i.stepped),_=y);return f&&(y=a[(c+(g?d:0))%o],h(t,_,y,g,i.stepped)),!!f}function fastPathSegment(t,r,n,s){const a=r.points,{count:i,start:o,ilen:c}=pathVars(a,n,s),{move:f=!0,reverse:d}=s||{};let h=0,m=0,g,v,y,_,w,b;const T=C=>(o+(d?c-C:C))%i,k=()=>{_!==w&&(t.lineTo(h,w),t.lineTo(h,_),t.lineTo(h,b))};for(f&&(v=a[T(0)],t.moveTo(v.x,v.y)),g=0;g<=c;++g){if(v=a[T(g)],v.skip)continue;const C=v.x,L=v.y,D=C|0;D===y?(L<_?_=L:L>w&&(w=L),h=(m*h+C)/++m):(k(),t.lineTo(C,L),y=D,m=0,_=w=L),b=L}k()}function _getSegmentMethod(t){const r=t.options,n=r.borderDash&&r.borderDash.length;return!t._decimated&&!t._loop&&!r.tension&&r.cubicInterpolationMode!=="monotone"&&!r.stepped&&!n?fastPathSegment:pathSegment}function _getInterpolationMethod(t){return t.stepped?_steppedInterpolation:t.tension||t.cubicInterpolationMode==="monotone"?_bezierInterpolation:_pointInLine}function strokePathWithCache(t,r,n,s){let a=r._path;a||(a=r._path=new Path2D,r.path(a,n,s)&&a.closePath()),setStyle(t,r.options),t.stroke(a)}function strokePathDirect(t,r,n,s){const{segments:a,options:i}=r,o=_getSegmentMethod(r);for(const c of a)setStyle(t,i,c.style),t.beginPath(),o(t,r,c,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const usePath2D=typeof Path2D=="function";function draw(t,r,n,s){usePath2D&&!r.options.segment?strokePathWithCache(t,r,n,s):strokePathDirect(t,r,n,s)}class LineElement extends Element{constructor(r){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,r&&Object.assign(this,r)}updateControlPoints(r,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const a=s.spanGaps?this._loop:this._fullLoop;_updateBezierControlPoints(this._points,s,r,a,n),this._pointsUpdated=!0}}set points(r){this._points=r,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_computeSegments(this,this.options.segment))}first(){const r=this.segments,n=this.points;return r.length&&n[r[0].start]}last(){const r=this.segments,n=this.points,s=r.length;return s&&n[r[s-1].end]}interpolate(r,n){const s=this.options,a=r[n],i=this.points,o=_boundSegments(this,{property:n,start:a,end:a});if(!o.length)return;const c=[],f=_getInterpolationMethod(s);let d,h;for(d=0,h=o.length;d<h;++d){const{start:m,end:g}=o[d],v=i[m],y=i[g];if(v===y){c.push(v);continue}const _=Math.abs((a-v[n])/(y[n]-v[n])),w=f(v,y,_,s.stepped);w[n]=r[n],c.push(w)}return c.length===1?c[0]:c}pathSegment(r,n,s){return _getSegmentMethod(this)(r,this,n,s)}path(r,n,s){const a=this.segments,i=_getSegmentMethod(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const c of a)o&=i(r,this,c,{start:n,end:n+s-1});return!!o}draw(r,n,s,a){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(r.save(),draw(r,this,s,a),r.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Le(LineElement,"id","line"),Le(LineElement,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Le(LineElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Le(LineElement,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"&&r!=="fill"});function inRange$1(t,r,n,s){const a=t.options,{[n]:i}=t.getProps([n],s);return Math.abs(r-i)<a.radius+a.hitRadius}class PointElement extends Element{constructor(n){super();Le(this,"parsed");Le(this,"skip");Le(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,a){const i=this.options,{x:o,y:c}=this.getProps(["x","y"],a);return Math.pow(n-o,2)+Math.pow(s-c,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,s){return inRange$1(this,n,"x",s)}inYRange(n,s){return inRange$1(this,n,"y",s)}getCenterPoint(n){const{x:s,y:a}=this.getProps(["x","y"],n);return{x:s,y:a}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const a=s&&n.borderWidth||0;return(s+a)*2}draw(n,s){const a=this.options;this.skip||a.radius<.1||!_isPointInArea(this,s,this.size(a)/2)||(n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.fillStyle=a.backgroundColor,drawPoint(n,a,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Le(PointElement,"id","point"),Le(PointElement,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Le(PointElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function getBarBounds(t,r){const{x:n,y:s,base:a,width:i,height:o}=t.getProps(["x","y","base","width","height"],r);let c,f,d,h,m;return t.horizontal?(m=o/2,c=Math.min(n,a),f=Math.max(n,a),d=s-m,h=s+m):(m=i/2,c=n-m,f=n+m,d=Math.min(s,a),h=Math.max(s,a)),{left:c,top:d,right:f,bottom:h}}function skipOrLimit(t,r,n,s){return t?0:_limitValue(r,n,s)}function parseBorderWidth(t,r,n){const s=t.options.borderWidth,a=t.borderSkipped,i=toTRBL(s);return{t:skipOrLimit(a.top,i.top,0,n),r:skipOrLimit(a.right,i.right,0,r),b:skipOrLimit(a.bottom,i.bottom,0,n),l:skipOrLimit(a.left,i.left,0,r)}}function parseBorderRadius(t,r,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),a=t.options.borderRadius,i=toTRBLCorners(a),o=Math.min(r,n),c=t.borderSkipped,f=s||isObject(a);return{topLeft:skipOrLimit(!f||c.top||c.left,i.topLeft,0,o),topRight:skipOrLimit(!f||c.top||c.right,i.topRight,0,o),bottomLeft:skipOrLimit(!f||c.bottom||c.left,i.bottomLeft,0,o),bottomRight:skipOrLimit(!f||c.bottom||c.right,i.bottomRight,0,o)}}function boundingRects(t){const r=getBarBounds(t),n=r.right-r.left,s=r.bottom-r.top,a=parseBorderWidth(t,n/2,s/2),i=parseBorderRadius(t,n/2,s/2);return{outer:{x:r.left,y:r.top,w:n,h:s,radius:i},inner:{x:r.left+a.l,y:r.top+a.t,w:n-a.l-a.r,h:s-a.t-a.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,i.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(a.b,a.r))}}}}function inRange(t,r,n,s){const a=r===null,i=n===null,c=t&&!(a&&i)&&getBarBounds(t,s);return c&&(a||_isBetween(r,c.left,c.right))&&(i||_isBetween(n,c.top,c.bottom))}function hasRadius(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function addNormalRectPath(t,r){t.rect(r.x,r.y,r.w,r.h)}function inflateRect(t,r,n={}){const s=t.x!==n.x?-r:0,a=t.y!==n.y?-r:0,i=(t.x+t.w!==n.x+n.w?r:0)-s,o=(t.y+t.h!==n.y+n.h?r:0)-a;return{x:t.x+s,y:t.y+a,w:t.w+i,h:t.h+o,radius:t.radius}}class BarElement extends Element{constructor(r){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,r&&Object.assign(this,r)}draw(r){const{inflateAmount:n,options:{borderColor:s,backgroundColor:a}}=this,{inner:i,outer:o}=boundingRects(this),c=hasRadius(o.radius)?addRoundedRectPath:addNormalRectPath;r.save(),(o.w!==i.w||o.h!==i.h)&&(r.beginPath(),c(r,inflateRect(o,n,i)),r.clip(),c(r,inflateRect(i,-n,o)),r.fillStyle=s,r.fill("evenodd")),r.beginPath(),c(r,inflateRect(i,n)),r.fillStyle=a,r.fill(),r.restore()}inRange(r,n,s){return inRange(this,r,n,s)}inXRange(r,n){return inRange(this,r,null,n)}inYRange(r,n){return inRange(this,null,r,n)}getCenterPoint(r){const{x:n,y:s,base:a,horizontal:i}=this.getProps(["x","y","base","horizontal"],r);return{x:i?(n+a)/2:n,y:i?s:(s+a)/2}}getRange(r){return r==="x"?this.width/2:this.height/2}}Le(BarElement,"id","bar"),Le(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Le(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const getBoxSize=(t,r)=>{let{boxHeight:n=r,boxWidth:s=r}=t;return t.usePointStyle&&(n=Math.min(n,r),s=t.pointStyleWidth||Math.min(s,r)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(r,n)}},itemsEqual=(t,r)=>t!==null&&r!==null&&t.datasetIndex===r.datasetIndex&&t.index===r.index;class Legend extends Element{constructor(r){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,n,s){this.maxWidth=r,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const r=this.options.labels||{};let n=callback(r.generateLabels,[this.chart],this)||[];r.filter&&(n=n.filter(s=>r.filter(s,this.chart.data))),r.sort&&(n=n.sort((s,a)=>r.sort(s,a,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:r,ctx:n}=this;if(!r.display){this.width=this.height=0;return}const s=r.labels,a=toFont(s.font),i=a.size,o=this._computeTitleHeight(),{boxWidth:c,itemHeight:f}=getBoxSize(s,i);let d,h;n.font=a.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,i,c,f)+10):(h=this.maxHeight,d=this._fitCols(o,a,c,f)+10),this.width=Math.min(d,r.maxWidth||this.maxWidth),this.height=Math.min(h,r.maxHeight||this.maxHeight)}_fitRows(r,n,s,a){const{ctx:i,maxWidth:o,options:{labels:{padding:c}}}=this,f=this.legendHitBoxes=[],d=this.lineWidths=[0],h=a+c;let m=r;i.textAlign="left",i.textBaseline="middle";let g=-1,v=-h;return this.legendItems.forEach((y,_)=>{const w=s+n/2+i.measureText(y.text).width;(_===0||d[d.length-1]+w+2*c>o)&&(m+=h,d[d.length-(_>0?0:1)]=0,v+=h,g++),f[_]={left:0,top:v,row:g,width:w,height:a},d[d.length-1]+=w+c}),m}_fitCols(r,n,s,a){const{ctx:i,maxHeight:o,options:{labels:{padding:c}}}=this,f=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-r;let m=c,g=0,v=0,y=0,_=0;return this.legendItems.forEach((w,b)=>{const{itemWidth:T,itemHeight:k}=calculateItemSize(s,n,i,w,a);b>0&&v+k+2*c>h&&(m+=g+c,d.push({width:g,height:v}),y+=g+c,_++,g=v=0),f[b]={left:y,top:v,col:_,width:T,height:k},g=Math.max(g,T),v+=k+c}),m+=g,d.push({width:g,height:v}),m}adjustHitBoxes(){if(!this.options.display)return;const r=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:a},rtl:i}}=this,o=getRtlAdapter(i,this.left,this.width);if(this.isHorizontal()){let c=0,f=_alignStartEnd(s,this.left+a,this.right-this.lineWidths[c]);for(const d of n)c!==d.row&&(c=d.row,f=_alignStartEnd(s,this.left+a,this.right-this.lineWidths[c])),d.top+=this.top+r+a,d.left=o.leftForLtr(o.x(f),d.width),f+=d.width+a}else{let c=0,f=_alignStartEnd(s,this.top+r+a,this.bottom-this.columnSizes[c].height);for(const d of n)d.col!==c&&(c=d.col,f=_alignStartEnd(s,this.top+r+a,this.bottom-this.columnSizes[c].height)),d.top=f,d.left+=this.left+a,d.left=o.leftForLtr(o.x(d.left),d.width),f+=d.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const r=this.ctx;clipArea(r,this),this._draw(),unclipArea(r)}}_draw(){const{options:r,columnSizes:n,lineWidths:s,ctx:a}=this,{align:i,labels:o}=r,c=defaults.color,f=getRtlAdapter(r.rtl,this.left,this.width),d=toFont(o.font),{padding:h}=o,m=d.size,g=m/2;let v;this.drawTitle(),a.textAlign=f.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=d.string;const{boxWidth:y,boxHeight:_,itemHeight:w}=getBoxSize(o,m),b=function(D,N,U){if(isNaN(y)||y<=0||isNaN(_)||_<0)return;a.save();const M=valueOrDefault(U.lineWidth,1);if(a.fillStyle=valueOrDefault(U.fillStyle,c),a.lineCap=valueOrDefault(U.lineCap,"butt"),a.lineDashOffset=valueOrDefault(U.lineDashOffset,0),a.lineJoin=valueOrDefault(U.lineJoin,"miter"),a.lineWidth=M,a.strokeStyle=valueOrDefault(U.strokeStyle,c),a.setLineDash(valueOrDefault(U.lineDash,[])),o.usePointStyle){const j={radius:_*Math.SQRT2/2,pointStyle:U.pointStyle,rotation:U.rotation,borderWidth:M},K=f.xPlus(D,y/2),I=N+g;drawPointLegend(a,j,K,I,o.pointStyleWidth&&y)}else{const j=N+Math.max((m-_)/2,0),K=f.leftForLtr(D,y),I=toTRBLCorners(U.borderRadius);a.beginPath(),Object.values(I).some(te=>te!==0)?addRoundedRectPath(a,{x:K,y:j,w:y,h:_,radius:I}):a.rect(K,j,y,_),a.fill(),M!==0&&a.stroke()}a.restore()},T=function(D,N,U){renderText(a,U.text,D,N+w/2,d,{strikethrough:U.hidden,textAlign:f.textAlign(U.textAlign)})},k=this.isHorizontal(),C=this._computeTitleHeight();k?v={x:_alignStartEnd(i,this.left+h,this.right-s[0]),y:this.top+h+C,line:0}:v={x:this.left+h,y:_alignStartEnd(i,this.top+C+h,this.bottom-n[0].height),line:0},overrideTextDirection(this.ctx,r.textDirection);const L=w+h;this.legendItems.forEach((D,N)=>{a.strokeStyle=D.fontColor,a.fillStyle=D.fontColor;const U=a.measureText(D.text).width,M=f.textAlign(D.textAlign||(D.textAlign=o.textAlign)),j=y+g+U;let K=v.x,I=v.y;f.setWidth(this.width),k?N>0&&K+j+h>this.right&&(I=v.y+=L,v.line++,K=v.x=_alignStartEnd(i,this.left+h,this.right-s[v.line])):N>0&&I+L>this.bottom&&(K=v.x=K+n[v.line].width+h,v.line++,I=v.y=_alignStartEnd(i,this.top+C+h,this.bottom-n[v.line].height));const te=f.x(K);if(b(te,I,D),K=_textX(M,K+y+g,k?K+j:this.right,r.rtl),T(f.x(K),I,D),k)v.x+=j+h;else if(typeof D.text!="string"){const _e=d.lineHeight;v.y+=calculateLegendItemHeight(D,_e)+h}else v.y+=L}),restoreTextDirection(this.ctx,r.textDirection)}drawTitle(){const r=this.options,n=r.title,s=toFont(n.font),a=toPadding(n.padding);if(!n.display)return;const i=getRtlAdapter(r.rtl,this.left,this.width),o=this.ctx,c=n.position,f=s.size/2,d=a.top+f;let h,m=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),h=this.top+d,m=_alignStartEnd(r.align,m,this.right-g);else{const y=this.columnSizes.reduce((_,w)=>Math.max(_,w.height),0);h=d+_alignStartEnd(r.align,this.top,this.bottom-y-r.labels.padding-this._computeTitleHeight())}const v=_alignStartEnd(c,m,m+g);o.textAlign=i.textAlign(_toLeftRightCenter(c)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,renderText(o,n.text,v,h,s)}_computeTitleHeight(){const r=this.options.title,n=toFont(r.font),s=toPadding(r.padding);return r.display?n.lineHeight+s.height:0}_getLegendItemAt(r,n){let s,a,i;if(_isBetween(r,this.left,this.right)&&_isBetween(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(a=i[s],_isBetween(r,a.left,a.left+a.width)&&_isBetween(n,a.top,a.top+a.height))return this.legendItems[s]}return null}handleEvent(r){const n=this.options;if(!isListened(r.type,n))return;const s=this._getLegendItemAt(r.x,r.y);if(r.type==="mousemove"||r.type==="mouseout"){const a=this._hoveredItem,i=itemsEqual(a,s);a&&!i&&callback(n.onLeave,[r,a,this],this),this._hoveredItem=s,s&&!i&&callback(n.onHover,[r,s,this],this)}else s&&callback(n.onClick,[r,s,this],this)}}function calculateItemSize(t,r,n,s,a){const i=calculateItemWidth(s,t,r,n),o=calculateItemHeight(a,s,r.lineHeight);return{itemWidth:i,itemHeight:o}}function calculateItemWidth(t,r,n,s){let a=t.text;return a&&typeof a!="string"&&(a=a.reduce((i,o)=>i.length>o.length?i:o)),r+n.size/2+s.measureText(a).width}function calculateItemHeight(t,r,n){let s=t;return typeof r.text!="string"&&(s=calculateLegendItemHeight(r,n)),s}function calculateLegendItemHeight(t,r){const n=t.text?t.text.length:0;return r*n}function isListened(t,r){return!!((t==="mousemove"||t==="mouseout")&&(r.onHover||r.onLeave)||r.onClick&&(t==="click"||t==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(t,r,n){const s=t.legend=new Legend({ctx:t.ctx,options:n,chart:t});layouts.configure(t,s,n),layouts.addBox(t,s)},stop(t){layouts.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,r,n){const s=t.legend;layouts.configure(t,s,n),s.options=n},afterUpdate(t){const r=t.legend;r.buildLabels(),r.adjustHitBoxes()},afterEvent(t,r){r.replay||t.legend.handleEvent(r.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,r,n){const s=r.datasetIndex,a=n.chart;a.isDatasetVisible(s)?(a.hide(s),r.hidden=!0):(a.show(s),r.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const r=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:a,color:i,useBorderRadius:o,borderRadius:c}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const d=f.controller.getStyle(n?0:void 0),h=toPadding(d.borderWidth);return{text:r[f.index].label,fillStyle:d.backgroundColor,fontColor:i,hidden:!f.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:a||d.textAlign,borderRadius:o&&(c||d.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Title extends Element{constructor(r){super(),this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=r,this.height=this.bottom=n;const a=isArray(s.text)?s.text.length:1;this._padding=toPadding(s.padding);const i=a*toFont(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const r=this.options.position;return r==="top"||r==="bottom"}_drawArgs(r){const{top:n,left:s,bottom:a,right:i,options:o}=this,c=o.align;let f=0,d,h,m;return this.isHorizontal()?(h=_alignStartEnd(c,s,i),m=n+r,d=i-s):(o.position==="left"?(h=s+r,m=_alignStartEnd(c,a,n),f=PI*-.5):(h=i-r,m=_alignStartEnd(c,n,a),f=PI*.5),d=a-n),{titleX:h,titleY:m,maxWidth:d,rotation:f}}draw(){const r=this.ctx,n=this.options;if(!n.display)return;const s=toFont(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:c,maxWidth:f,rotation:d}=this._drawArgs(i);renderText(r,n.text,0,0,s,{color:n.color,maxWidth:f,rotation:d,textAlign:_toLeftRightCenter(n.align),textBaseline:"middle",translation:[o,c]})}}function createTitle(t,r){const n=new Title({ctx:t.ctx,options:r,chart:t});layouts.configure(t,n,r),layouts.addBox(t,n),t.titleBlock=n}var plugin_title={id:"title",_element:Title,start(t,r,n){createTitle(t,n)},stop(t){const r=t.titleBlock;layouts.removeBox(t,r),delete t.titleBlock},beforeUpdate(t,r,n){const s=t.titleBlock;layouts.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(t){if(!t.length)return!1;let r,n,s=new Set,a=0,i=0;for(r=0,n=t.length;r<n;++r){const c=t[r].element;if(c&&c.hasValue()){const f=c.tooltipPosition();s.add(f.x),a+=f.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((c,f)=>c+f)/s.size,y:a/i}},nearest(t,r){if(!t.length)return!1;let n=r.x,s=r.y,a=Number.POSITIVE_INFINITY,i,o,c;for(i=0,o=t.length;i<o;++i){const f=t[i].element;if(f&&f.hasValue()){const d=f.getCenterPoint(),h=distanceBetweenPoints(r,d);h<a&&(a=h,c=f)}}if(c){const f=c.tooltipPosition();n=f.x,s=f.y}return{x:n,y:s}}};function pushOrConcat(t,r){return r&&(isArray(r)?Array.prototype.push.apply(t,r):t.push(r)),t}function splitNewlines(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function createTooltipItem(t,r){const{element:n,datasetIndex:s,index:a}=r,i=t.getDatasetMeta(s).controller,{label:o,value:c}=i.getLabelAndValue(a);return{chart:t,label:o,parsed:i.getParsed(a),raw:t.data.datasets[s].data[a],formattedValue:c,dataset:i.getDataset(),dataIndex:a,datasetIndex:s,element:n}}function getTooltipSize(t,r){const n=t.chart.ctx,{body:s,footer:a,title:i}=t,{boxWidth:o,boxHeight:c}=r,f=toFont(r.bodyFont),d=toFont(r.titleFont),h=toFont(r.footerFont),m=i.length,g=a.length,v=s.length,y=toPadding(r.padding);let _=y.height,w=0,b=s.reduce((C,L)=>C+L.before.length+L.lines.length+L.after.length,0);if(b+=t.beforeBody.length+t.afterBody.length,m&&(_+=m*d.lineHeight+(m-1)*r.titleSpacing+r.titleMarginBottom),b){const C=r.displayColors?Math.max(c,f.lineHeight):f.lineHeight;_+=v*C+(b-v)*f.lineHeight+(b-1)*r.bodySpacing}g&&(_+=r.footerMarginTop+g*h.lineHeight+(g-1)*r.footerSpacing);let T=0;const k=function(C){w=Math.max(w,n.measureText(C).width+T)};return n.save(),n.font=d.string,each(t.title,k),n.font=f.string,each(t.beforeBody.concat(t.afterBody),k),T=r.displayColors?o+2+r.boxPadding:0,each(s,C=>{each(C.before,k),each(C.lines,k),each(C.after,k)}),T=0,n.font=h.string,each(t.footer,k),n.restore(),w+=y.width,{width:w,height:_}}function determineYAlign(t,r){const{y:n,height:s}=r;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function doesNotFitWithAlign(t,r,n,s){const{x:a,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&a+i+o>r.width||t==="right"&&a-i-o<0)return!0}function determineXAlign(t,r,n,s){const{x:a,width:i}=n,{width:o,chartArea:{left:c,right:f}}=t;let d="center";return s==="center"?d=a<=(c+f)/2?"left":"right":a<=i/2?d="left":a>=o-i/2&&(d="right"),doesNotFitWithAlign(d,t,r,n)&&(d="center"),d}function determineAlignment(t,r,n){const s=n.yAlign||r.yAlign||determineYAlign(t,n);return{xAlign:n.xAlign||r.xAlign||determineXAlign(t,r,n,s),yAlign:s}}function alignX(t,r){let{x:n,width:s}=t;return r==="right"?n-=s:r==="center"&&(n-=s/2),n}function alignY(t,r,n){let{y:s,height:a}=t;return r==="top"?s+=n:r==="bottom"?s-=a+n:s-=a/2,s}function getBackgroundPoint(t,r,n,s){const{caretSize:a,caretPadding:i,cornerRadius:o}=t,{xAlign:c,yAlign:f}=n,d=a+i,{topLeft:h,topRight:m,bottomLeft:g,bottomRight:v}=toTRBLCorners(o);let y=alignX(r,c);const _=alignY(r,f,d);return f==="center"?c==="left"?y+=d:c==="right"&&(y-=d):c==="left"?y-=Math.max(h,g)+a:c==="right"&&(y+=Math.max(m,v)+a),{x:_limitValue(y,0,s.width-r.width),y:_limitValue(_,0,s.height-r.height)}}function getAlignedX(t,r,n){const s=toPadding(n.padding);return r==="center"?t.x+t.width/2:r==="right"?t.x+t.width-s.right:t.x+s.left}function getBeforeAfterBodyLines(t){return pushOrConcat([],splitNewlines(t))}function createTooltipContext(t,r,n){return createContext(t,{tooltip:r,tooltipItems:n,type:"tooltip"})}function overrideCallbacks(t,r){const n=r&&r.dataset&&r.dataset.tooltip&&r.dataset.tooltip.callbacks;return n?t.override(n):t}const defaultCallbacks={beforeTitle:noop$1,title(t){if(t.length>0){const r=t[0],n=r.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return r.dataset.label||"";if(r.label)return r.label;if(s>0&&r.dataIndex<s)return n[r.dataIndex]}return""},afterTitle:noop$1,beforeBody:noop$1,beforeLabel:noop$1,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let r=t.dataset.label||"";r&&(r+=": ");const n=t.formattedValue;return isNullOrUndef(n)||(r+=n),r},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:noop$1,afterBody:noop$1,beforeFooter:noop$1,footer:noop$1,afterFooter:noop$1};function invokeCallbackWithFallback(t,r,n,s){const a=t[r].call(n,s);return typeof a>"u"?defaultCallbacks[r].call(n,s):a}class Tooltip extends Element{constructor(r){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=r.chart,this.options=r.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(r){this.options=r,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const r=this._cachedAnimations;if(r)return r;const n=this.chart,s=this.options.setContext(this.getContext()),a=s.enabled&&n.options.animation&&s.animations,i=new Animations(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(r,n){const{callbacks:s}=n,a=invokeCallbackWithFallback(s,"beforeTitle",this,r),i=invokeCallbackWithFallback(s,"title",this,r),o=invokeCallbackWithFallback(s,"afterTitle",this,r);let c=[];return c=pushOrConcat(c,splitNewlines(a)),c=pushOrConcat(c,splitNewlines(i)),c=pushOrConcat(c,splitNewlines(o)),c}getBeforeBody(r,n){return getBeforeAfterBodyLines(invokeCallbackWithFallback(n.callbacks,"beforeBody",this,r))}getBody(r,n){const{callbacks:s}=n,a=[];return each(r,i=>{const o={before:[],lines:[],after:[]},c=overrideCallbacks(s,i);pushOrConcat(o.before,splitNewlines(invokeCallbackWithFallback(c,"beforeLabel",this,i))),pushOrConcat(o.lines,invokeCallbackWithFallback(c,"label",this,i)),pushOrConcat(o.after,splitNewlines(invokeCallbackWithFallback(c,"afterLabel",this,i))),a.push(o)}),a}getAfterBody(r,n){return getBeforeAfterBodyLines(invokeCallbackWithFallback(n.callbacks,"afterBody",this,r))}getFooter(r,n){const{callbacks:s}=n,a=invokeCallbackWithFallback(s,"beforeFooter",this,r),i=invokeCallbackWithFallback(s,"footer",this,r),o=invokeCallbackWithFallback(s,"afterFooter",this,r);let c=[];return c=pushOrConcat(c,splitNewlines(a)),c=pushOrConcat(c,splitNewlines(i)),c=pushOrConcat(c,splitNewlines(o)),c}_createItems(r){const n=this._active,s=this.chart.data,a=[],i=[],o=[];let c=[],f,d;for(f=0,d=n.length;f<d;++f)c.push(createTooltipItem(this.chart,n[f]));return r.filter&&(c=c.filter((h,m,g)=>r.filter(h,m,g,s))),r.itemSort&&(c=c.sort((h,m)=>r.itemSort(h,m,s))),each(c,h=>{const m=overrideCallbacks(r.callbacks,h);a.push(invokeCallbackWithFallback(m,"labelColor",this,h)),i.push(invokeCallbackWithFallback(m,"labelPointStyle",this,h)),o.push(invokeCallbackWithFallback(m,"labelTextColor",this,h))}),this.labelColors=a,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=c,c}update(r,n){const s=this.options.setContext(this.getContext()),a=this._active;let i,o=[];if(!a.length)this.opacity!==0&&(i={opacity:0});else{const c=positioners[s.position].call(this,a,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const f=this._size=getTooltipSize(this,s),d=Object.assign({},c,f),h=determineAlignment(this.chart,s,d),m=getBackgroundPoint(s,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,i={opacity:1,x:m.x,y:m.y,width:f.width,height:f.height,caretX:c.x,caretY:c.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),r&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(r,n,s,a){const i=this.getCaretPosition(r,s,a);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(r,n,s){const{xAlign:a,yAlign:i}=this,{caretSize:o,cornerRadius:c}=s,{topLeft:f,topRight:d,bottomLeft:h,bottomRight:m}=toTRBLCorners(c),{x:g,y:v}=r,{width:y,height:_}=n;let w,b,T,k,C,L;return i==="center"?(C=v+_/2,a==="left"?(w=g,b=w-o,k=C+o,L=C-o):(w=g+y,b=w+o,k=C-o,L=C+o),T=w):(a==="left"?b=g+Math.max(f,h)+o:a==="right"?b=g+y-Math.max(d,m)-o:b=this.caretX,i==="top"?(k=v,C=k-o,w=b-o,T=b+o):(k=v+_,C=k+o,w=b+o,T=b-o),L=k),{x1:w,x2:b,x3:T,y1:k,y2:C,y3:L}}drawTitle(r,n,s){const a=this.title,i=a.length;let o,c,f;if(i){const d=getRtlAdapter(s.rtl,this.x,this.width);for(r.x=getAlignedX(this,s.titleAlign,s),n.textAlign=d.textAlign(s.titleAlign),n.textBaseline="middle",o=toFont(s.titleFont),c=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,f=0;f<i;++f)n.fillText(a[f],d.x(r.x),r.y+o.lineHeight/2),r.y+=o.lineHeight+c,f+1===i&&(r.y+=s.titleMarginBottom-c)}}_drawColorBox(r,n,s,a,i){const o=this.labelColors[s],c=this.labelPointStyles[s],{boxHeight:f,boxWidth:d}=i,h=toFont(i.bodyFont),m=getAlignedX(this,"left",i),g=a.x(m),v=f<h.lineHeight?(h.lineHeight-f)/2:0,y=n.y+v;if(i.usePointStyle){const _={radius:Math.min(d,f)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},w=a.leftForLtr(g,d)+d/2,b=y+f/2;r.strokeStyle=i.multiKeyBackground,r.fillStyle=i.multiKeyBackground,drawPoint(r,_,w,b),r.strokeStyle=o.borderColor,r.fillStyle=o.backgroundColor,drawPoint(r,_,w,b)}else{r.lineWidth=isObject(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,r.strokeStyle=o.borderColor,r.setLineDash(o.borderDash||[]),r.lineDashOffset=o.borderDashOffset||0;const _=a.leftForLtr(g,d),w=a.leftForLtr(a.xPlus(g,1),d-2),b=toTRBLCorners(o.borderRadius);Object.values(b).some(T=>T!==0)?(r.beginPath(),r.fillStyle=i.multiKeyBackground,addRoundedRectPath(r,{x:_,y,w:d,h:f,radius:b}),r.fill(),r.stroke(),r.fillStyle=o.backgroundColor,r.beginPath(),addRoundedRectPath(r,{x:w,y:y+1,w:d-2,h:f-2,radius:b}),r.fill()):(r.fillStyle=i.multiKeyBackground,r.fillRect(_,y,d,f),r.strokeRect(_,y,d,f),r.fillStyle=o.backgroundColor,r.fillRect(w,y+1,d-2,f-2))}r.fillStyle=this.labelTextColors[s]}drawBody(r,n,s){const{body:a}=this,{bodySpacing:i,bodyAlign:o,displayColors:c,boxHeight:f,boxWidth:d,boxPadding:h}=s,m=toFont(s.bodyFont);let g=m.lineHeight,v=0;const y=getRtlAdapter(s.rtl,this.x,this.width),_=function(U){n.fillText(U,y.x(r.x+v),r.y+g/2),r.y+=g+i},w=y.textAlign(o);let b,T,k,C,L,D,N;for(n.textAlign=o,n.textBaseline="middle",n.font=m.string,r.x=getAlignedX(this,w,s),n.fillStyle=s.bodyColor,each(this.beforeBody,_),v=c&&w!=="right"?o==="center"?d/2+h:d+2+h:0,C=0,D=a.length;C<D;++C){for(b=a[C],T=this.labelTextColors[C],n.fillStyle=T,each(b.before,_),k=b.lines,c&&k.length&&(this._drawColorBox(n,r,C,y,s),g=Math.max(m.lineHeight,f)),L=0,N=k.length;L<N;++L)_(k[L]),g=m.lineHeight;each(b.after,_)}v=0,g=m.lineHeight,each(this.afterBody,_),r.y-=i}drawFooter(r,n,s){const a=this.footer,i=a.length;let o,c;if(i){const f=getRtlAdapter(s.rtl,this.x,this.width);for(r.x=getAlignedX(this,s.footerAlign,s),r.y+=s.footerMarginTop,n.textAlign=f.textAlign(s.footerAlign),n.textBaseline="middle",o=toFont(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,c=0;c<i;++c)n.fillText(a[c],f.x(r.x),r.y+o.lineHeight/2),r.y+=o.lineHeight+s.footerSpacing}}drawBackground(r,n,s,a){const{xAlign:i,yAlign:o}=this,{x:c,y:f}=r,{width:d,height:h}=s,{topLeft:m,topRight:g,bottomLeft:v,bottomRight:y}=toTRBLCorners(a.cornerRadius);n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.beginPath(),n.moveTo(c+m,f),o==="top"&&this.drawCaret(r,n,s,a),n.lineTo(c+d-g,f),n.quadraticCurveTo(c+d,f,c+d,f+g),o==="center"&&i==="right"&&this.drawCaret(r,n,s,a),n.lineTo(c+d,f+h-y),n.quadraticCurveTo(c+d,f+h,c+d-y,f+h),o==="bottom"&&this.drawCaret(r,n,s,a),n.lineTo(c+v,f+h),n.quadraticCurveTo(c,f+h,c,f+h-v),o==="center"&&i==="left"&&this.drawCaret(r,n,s,a),n.lineTo(c,f+m),n.quadraticCurveTo(c,f,c+m,f),n.closePath(),n.fill(),a.borderWidth>0&&n.stroke()}_updateAnimationTarget(r){const n=this.chart,s=this.$animations,a=s&&s.x,i=s&&s.y;if(a||i){const o=positioners[r.position].call(this,this._active,this._eventPosition);if(!o)return;const c=this._size=getTooltipSize(this,r),f=Object.assign({},o,this._size),d=determineAlignment(n,r,f),h=getBackgroundPoint(r,f,d,n);(a._to!==h.x||i._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=c.width,this.height=c.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(r){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const a={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=toPadding(n.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&c&&(r.save(),r.globalAlpha=s,this.drawBackground(i,r,a,n),overrideTextDirection(r,n.textDirection),i.y+=o.top,this.drawTitle(i,r,n),this.drawBody(i,r,n),this.drawFooter(i,r,n),restoreTextDirection(r,n.textDirection),r.restore())}getActiveElements(){return this._active||[]}setActiveElements(r,n){const s=this._active,a=r.map(({datasetIndex:c,index:f})=>{const d=this.chart.getDatasetMeta(c);if(!d)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:d.data[f],index:f}}),i=!_elementsEqual(s,a),o=this._positionChanged(a,n);(i||o)&&(this._active=a,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(r,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,i=this._active||[],o=this._getActiveElements(r,i,n,s),c=this._positionChanged(o,r),f=n||!_elementsEqual(o,i)||c;return f&&(this._active=o,(a.enabled||a.external)&&(this._eventPosition={x:r.x,y:r.y},this.update(!0,n))),f}_getActiveElements(r,n,s,a){const i=this.options;if(r.type==="mouseout")return[];if(!a)return n.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const o=this.chart.getElementsAtEventForMode(r,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(r,n){const{caretX:s,caretY:a,options:i}=this,o=positioners[i.position].call(this,r,n);return o!==!1&&(s!==o.x||a!==o.y)}}Le(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(t,r,n){n&&(t.tooltip=new Tooltip({chart:t,options:n}))},beforeUpdate(t,r,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,r,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const r=t.tooltip;if(r&&r._willRender()){const n={tooltip:r};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;r.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,r){if(t.tooltip){const n=r.replay;t.tooltip.handleEvent(r.event,n,r.inChartArea)&&(r.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,r)=>r.bodyFont.size,boxWidth:(t,r)=>r.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const addIfString=(t,r,n,s)=>(typeof r=="string"?(n=t.push(r)-1,s.unshift({index:n,label:r})):isNaN(r)&&(n=null),n);function findOrAddLabel(t,r,n,s){const a=t.indexOf(r);if(a===-1)return addIfString(t,r,n,s);const i=t.lastIndexOf(r);return a!==i?n:a}const validIndex=(t,r)=>t===null?null:_limitValue(Math.round(t),0,r);function _getLabelForValue(t){const r=this.getLabels();return t>=0&&t<r.length?r[t]:t}class CategoryScale extends Scale{constructor(r){super(r),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(r){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:a,label:i}of n)s[a]===i&&s.splice(a,1);this._addedLabels=[]}super.init(r)}parse(r,n){if(isNullOrUndef(r))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===r?n:findOrAddLabel(s,r,valueOrDefault(n,r),this._addedLabels),validIndex(n,s.length-1)}determineDataLimits(){const{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:s,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(r||(s=0),n||(a=this.getLabels().length-1)),this.min=s,this.max=a}buildTicks(){const r=this.min,n=this.max,s=this.options.offset,a=[];let i=this.getLabels();i=r===0&&n===i.length-1?i:i.slice(r,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=r;o<=n;o++)a.push({value:o});return a}getLabelForValue(r){return _getLabelForValue.call(this,r)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(r){return typeof r!="number"&&(r=this.parse(r)),r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getPixelForTick(r){const n=this.ticks;return r<0||r>n.length-1?null:this.getPixelForValue(n[r].value)}getValueForPixel(r){return Math.round(this._startValue+this.getDecimalForPixel(r)*this._valueRange)}getBasePixel(){return this.bottom}}Le(CategoryScale,"id","category"),Le(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(t,r){const n=[],{bounds:a,step:i,min:o,max:c,precision:f,count:d,maxTicks:h,maxDigits:m,includeBounds:g}=t,v=i||1,y=h-1,{min:_,max:w}=r,b=!isNullOrUndef(o),T=!isNullOrUndef(c),k=!isNullOrUndef(d),C=(w-_)/(m+1);let L=niceNum((w-_)/y/v)*v,D,N,U,M;if(L<1e-14&&!b&&!T)return[{value:_},{value:w}];M=Math.ceil(w/L)-Math.floor(_/L),M>y&&(L=niceNum(M*L/y/v)*v),isNullOrUndef(f)||(D=Math.pow(10,f),L=Math.ceil(L*D)/D),a==="ticks"?(N=Math.floor(_/L)*L,U=Math.ceil(w/L)*L):(N=_,U=w),b&&T&&i&&almostWhole((c-o)/i,L/1e3)?(M=Math.round(Math.min((c-o)/L,h)),L=(c-o)/M,N=o,U=c):k?(N=b?o:N,U=T?c:U,M=d-1,L=(U-N)/M):(M=(U-N)/L,almostEquals(M,Math.round(M),L/1e3)?M=Math.round(M):M=Math.ceil(M));const j=Math.max(_decimalPlaces(L),_decimalPlaces(N));D=Math.pow(10,isNullOrUndef(f)?j:f),N=Math.round(N*D)/D,U=Math.round(U*D)/D;let K=0;for(b&&(g&&N!==o?(n.push({value:o}),N<o&&K++,almostEquals(Math.round((N+K*L)*D)/D,o,relativeLabelSize(o,C,t))&&K++):N<o&&K++);K<M;++K){const I=Math.round((N+K*L)*D)/D;if(T&&I>c)break;n.push({value:I})}return T&&g&&U!==c?n.length&&almostEquals(n[n.length-1].value,c,relativeLabelSize(c,C,t))?n[n.length-1].value=c:n.push({value:c}):(!T||U===c)&&n.push({value:U}),n}function relativeLabelSize(t,r,{horizontal:n,minRotation:s}){const a=toRadians(s),i=(n?Math.sin(a):Math.cos(a))||.001,o=.75*r*(""+t).length;return Math.min(r/i,o)}class LinearScaleBase extends Scale{constructor(r){super(r),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(r,n){return isNullOrUndef(r)||(typeof r=="number"||r instanceof Number)&&!isFinite(+r)?null:+r}handleTickRangeOptions(){const{beginAtZero:r}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:a,max:i}=this;const o=f=>a=n?a:f,c=f=>i=s?i:f;if(r){const f=sign(a),d=sign(i);f<0&&d<0?c(0):f>0&&d>0&&o(0)}if(a===i){let f=i===0?1:Math.abs(i*.05);c(i+f),r||o(a-f)}this.min=a,this.max=i}getTickLimit(){const r=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=r,a;return s?(a=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),n=n||11),n&&(a=Math.min(n,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const r=this.options,n=r.ticks;let s=this.getTickLimit();s=Math.max(2,s);const a={maxTicks:s,bounds:r.bounds,min:r.min,max:r.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=generateTicks$1(a,i);return r.bounds==="ticks"&&_setMinAndMaxByKey(o,this,"value"),r.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const r=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&r.length){const a=(s-n)/Math.max(r.length-1,1)/2;n-=a,s+=a}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(r){return formatNumber(r,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:r,max:n}=this.getMinMax(!0);this.min=isNumberFinite(r)?r:0,this.max=isNumberFinite(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const r=this.isHorizontal(),n=r?this.width:this.height,s=toRadians(this.options.ticks.minRotation),a=(r?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/a))}getPixelForValue(r){return r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getValueForPixel(r){return this._startValue+this.getDecimalForPixel(r)*this._valueRange}}Le(LinearScale,"id","linear"),Le(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(t,r){return t-r}function parse(t,r){if(isNullOrUndef(r))return null;const n=t._adapter,{parser:s,round:a,isoWeekday:i}=t._parseOpts;let o=r;return typeof s=="function"&&(o=s(o)),isNumberFinite(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(a&&(o=a==="week"&&(isNumber(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,a)),+o)}function determineUnitForAutoTicks(t,r,n,s){const a=UNITS.length;for(let i=UNITS.indexOf(t);i<a-1;++i){const o=INTERVALS[UNITS[i]],c=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-r)/(c*o.size))<=s)return UNITS[i]}return UNITS[a-1]}function determineUnitForFormatting(t,r,n,s,a){for(let i=UNITS.length-1;i>=UNITS.indexOf(n);i--){const o=UNITS[i];if(INTERVALS[o].common&&t._adapter.diff(a,s,o)>=r-1)return o}return UNITS[n?UNITS.indexOf(n):0]}function determineMajorUnit(t){for(let r=UNITS.indexOf(t)+1,n=UNITS.length;r<n;++r)if(INTERVALS[UNITS[r]].common)return UNITS[r]}function addTick(t,r,n){if(!n)t[r]=!0;else if(n.length){const{lo:s,hi:a}=_lookup(n,r),i=n[s]>=r?n[s]:n[a];t[i]=!0}}function setMajorTicks(t,r,n,s){const a=t._adapter,i=+a.startOf(r[0].value,s),o=r[r.length-1].value;let c,f;for(c=i;c<=o;c=+a.add(c,1,s))f=n[c],f>=0&&(r[f].major=!0);return r}function ticksFromTimestamps(t,r,n){const s=[],a={},i=r.length;let o,c;for(o=0;o<i;++o)c=r[o],a[c]=o,s.push({value:c,major:!1});return i===0||!n?s:setMajorTicks(t,s,a,n)}class TimeScale extends Scale{constructor(r){super(r),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(r,n={}){const s=r.time||(r.time={}),a=this._adapter=new adapters._date(r.adapters.date);a.init(n),mergeIf(s.displayFormats,a.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(r),this._normalized=n.normalized}parse(r,n){return r===void 0?null:parse(this,r)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const r=this.options,n=this._adapter,s=r.time.unit||"day";let{min:a,max:i,minDefined:o,maxDefined:c}=this.getUserBounds();function f(d){!o&&!isNaN(d.min)&&(a=Math.min(a,d.min)),!c&&!isNaN(d.max)&&(i=Math.max(i,d.max))}(!o||!c)&&(f(this._getLabelBounds()),(r.bounds!=="ticks"||r.ticks.source!=="labels")&&f(this.getMinMax(!1))),a=isNumberFinite(a)&&!isNaN(a)?a:+n.startOf(Date.now(),s),i=isNumberFinite(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(a,i-1),this.max=Math.max(a+1,i)}_getLabelBounds(){const r=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return r.length&&(n=r[0],s=r[r.length-1]),{min:n,max:s}}buildTicks(){const r=this.options,n=r.time,s=r.ticks,a=s.source==="labels"?this.getLabelTimestamps():this._generate();r.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const i=this.min,o=this.max,c=_filterBetween(a,i,o);return this._unit=n.unit||(s.autoSkip?determineUnitForAutoTicks(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):determineUnitForFormatting(this,c.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(a),r.reverse&&c.reverse(),ticksFromTimestamps(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(r=>+r.value))}initOffsets(r=[]){let n=0,s=0,a,i;this.options.offset&&r.length&&(a=this.getDecimalForValue(r[0]),r.length===1?n=1-a:n=(this.getDecimalForValue(r[1])-a)/2,i=this.getDecimalForValue(r[r.length-1]),r.length===1?s=i:s=(i-this.getDecimalForValue(r[r.length-2]))/2);const o=r.length<3?.5:.25;n=_limitValue(n,0,o),s=_limitValue(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const r=this._adapter,n=this.min,s=this.max,a=this.options,i=a.time,o=i.unit||determineUnitForAutoTicks(i.minUnit,n,s,this._getLabelCapacity(n)),c=valueOrDefault(a.ticks.stepSize,1),f=o==="week"?i.isoWeekday:!1,d=isNumber(f)||f===!0,h={};let m=n,g,v;if(d&&(m=+r.startOf(m,"isoWeek",f)),m=+r.startOf(m,d?"day":o),r.diff(s,n,o)>1e5*c)throw new Error(n+" and "+s+" are too far apart with stepSize of "+c+" "+o);const y=a.ticks.source==="data"&&this.getDataTimestamps();for(g=m,v=0;g<s;g=+r.add(g,c,o),v++)addTick(h,g,y);return(g===s||a.bounds==="ticks"||v===1)&&addTick(h,g,y),Object.keys(h).sort(sorter).map(_=>+_)}getLabelForValue(r){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(r,s.tooltipFormat):n.format(r,s.displayFormats.datetime)}format(r,n){const a=this.options.time.displayFormats,i=this._unit,o=n||a[i];return this._adapter.format(r,o)}_tickFormatFunction(r,n,s,a){const i=this.options,o=i.ticks.callback;if(o)return callback(o,[r,n,s],this);const c=i.time.displayFormats,f=this._unit,d=this._majorUnit,h=f&&c[f],m=d&&c[d],g=s[n],v=d&&m&&g&&g.major;return this._adapter.format(r,a||(v?m:h))}generateTickLabels(r){let n,s,a;for(n=0,s=r.length;n<s;++n)a=r[n],a.label=this._tickFormatFunction(a.value,n,r)}getDecimalForValue(r){return r===null?NaN:(r-this.min)/(this.max-this.min)}getPixelForValue(r){const n=this._offsets,s=this.getDecimalForValue(r);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(r){const n=this._offsets,s=this.getDecimalForPixel(r)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(r){const n=this.options.ticks,s=this.ctx.measureText(r).width,a=toRadians(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(a),o=Math.sin(a),c=this._resolveTickFontOptions(0).size;return{w:s*i+c*o,h:s*o+c*i}}_getLabelCapacity(r){const n=this.options.time,s=n.displayFormats,a=s[n.unit]||s.millisecond,i=this._tickFormatFunction(r,0,ticksFromTimestamps(this,[r],this._majorUnit),a),o=this._getLabelSize(i),c=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return c>0?c:1}getDataTimestamps(){let r=this._cache.data||[],n,s;if(r.length)return r;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(n=0,s=a.length;n<s;++n)r=r.concat(a[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const r=this._cache.labels||[];let n,s;if(r.length)return r;const a=this.getLabels();for(n=0,s=a.length;n<s;++n)r.push(parse(this,a[n]));return this._cache.labels=this._normalized?r:this.normalize(r)}normalize(r){return _arrayUnique(r.sort(sorter))}}Le(TimeScale,"id","time"),Le(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(t,r,n){let s=0,a=t.length-1,i,o,c,f;n?(r>=t[s].pos&&r<=t[a].pos&&({lo:s,hi:a}=_lookupByKey(t,"pos",r)),{pos:i,time:c}=t[s],{pos:o,time:f}=t[a]):(r>=t[s].time&&r<=t[a].time&&({lo:s,hi:a}=_lookupByKey(t,"time",r)),{time:i,pos:c}=t[s],{time:o,pos:f}=t[a]);const d=o-i;return d?c+(f-c)*(r-i)/d:c}class TimeSeriesScale extends TimeScale{constructor(r){super(r),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const r=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(r);this._minPos=interpolate(n,this.min),this._tableRange=interpolate(n,this.max)-this._minPos,super.initOffsets(r)}buildLookupTable(r){const{min:n,max:s}=this,a=[],i=[];let o,c,f,d,h;for(o=0,c=r.length;o<c;++o)d=r[o],d>=n&&d<=s&&a.push(d);if(a.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,c=a.length;o<c;++o)h=a[o+1],f=a[o-1],d=a[o],Math.round((h+f)/2)!==d&&i.push({time:d,pos:o/(c-1)});return i}_generate(){const r=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(r)||!s.length)&&s.splice(0,0,r),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((a,i)=>a-i)}_getTimestampsForTable(){let r=this._cache.all||[];if(r.length)return r;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?r=this.normalize(n.concat(s)):r=n.length?n:s,r=this._cache.all=r,r}getDecimalForValue(r){return(interpolate(this._table,r)-this._minPos)/this._tableRange}getValueForPixel(r){const n=this._offsets,s=this.getDecimalForPixel(r)/n.factor-n.end;return interpolate(this._table,s*this._tableRange+this._minPos,!0)}}Le(TimeSeriesScale,"id","timeseries"),Le(TimeSeriesScale,"defaults",TimeScale.defaults);const defaultDatasetIdKey="label";function reforwardRef(t,r){typeof t=="function"?t(r):t&&(t.current=r)}function setOptions(t,r){const n=t.options;n&&r&&Object.assign(n,r)}function setLabels(t,r){t.labels=r}function setDatasets(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:defaultDatasetIdKey;const s=[];t.datasets=r.map(a=>{const i=t.datasets.find(o=>o[n]===a[n]);return!i||!a.data||s.includes(i)?{...a}:(s.push(i),Object.assign(i,a),i)})}function cloneData(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:defaultDatasetIdKey;const n={labels:[],datasets:[]};return setLabels(n,t.labels),setDatasets(n,t.datasets,r),n}function ChartComponent(t,r){const{height:n=150,width:s=300,redraw:a=!1,datasetIdKey:i,type:o,data:c,options:f,plugins:d=[],fallbackContent:h,updateMode:m,...g}=t,v=reactExports.useRef(null),y=reactExports.useRef(null),_=()=>{v.current&&(y.current=new Chart$1(v.current,{type:o,data:cloneData(c,i),options:f&&{...f},plugins:d}),reforwardRef(r,y.current))},w=()=>{reforwardRef(r,null),y.current&&(y.current.destroy(),y.current=null)};return reactExports.useEffect(()=>{!a&&y.current&&f&&setOptions(y.current,f)},[a,f]),reactExports.useEffect(()=>{!a&&y.current&&setLabels(y.current.config.data,c.labels)},[a,c.labels]),reactExports.useEffect(()=>{!a&&y.current&&c.datasets&&setDatasets(y.current.config.data,c.datasets,i)},[a,c.datasets]),reactExports.useEffect(()=>{y.current&&(a?(w(),setTimeout(_)):y.current.update(m))},[a,f,c.labels,c.datasets,m]),reactExports.useEffect(()=>{y.current&&(w(),setTimeout(_))},[o]),reactExports.useEffect(()=>(_(),()=>w()),[]),React.createElement("canvas",{ref:v,role:"img",height:n,width:s,...g},h)}const Chart=reactExports.forwardRef(ChartComponent);function createTypedChart(t,r){return Chart$1.register(r),reactExports.forwardRef((n,s)=>React.createElement(Chart,{...n,ref:s,type:t}))}const Line=createTypedChart("line",LineController),Bar=createTypedChart("bar",BarController),Doughnut=createTypedChart("doughnut",DoughnutController);Chart$1.register(ArcElement,plugin_tooltip,plugin_legend);const ExpenseChart=({transactions:t})=>{const{categories:r,settings:n}=useData(),s=reactExports.useMemo(()=>{const c=t.filter(y=>y.type==="expense").reduce((y,_)=>(y[_.category]||(y[_.category]=0),y[_.category]+=_.amount,y),{}),f=Object.entries(c).sort(([,y],[,_])=>_-y).slice(0,8),d=Object.entries(c).sort(([,y],[,_])=>_-y).slice(8).reduce((y,[,_])=>y+_,0),h=[...f];d>0&&h.push(["Other",d]);const m=h.map(([y])=>y),g=h.map(([,y])=>y),v=h.map(([y])=>{const _=r.find(w=>w.name===y);return(_==null?void 0:_.color)||"#6B7280"});return{labels:m,datasets:[{data:g,backgroundColor:v,borderColor:"transparent",borderWidth:0,hoverOffset:4}]}},[t,r]),a={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,boxWidth:8,font:{size:12},formatter:o=>{const c=s.datasets[0].data[o.dataIndex];return`${o.text}: ${formatCurrency(c,n.currency)}`}}},tooltip:{callbacks:{label:o=>{const c=o.raw;return`${o.label}: ${formatCurrency(c,n.currency)}`}}}},cutout:"70%"},i=s.datasets[0].data.reduce((o,c)=>o+c,0);return jsxRuntimeExports.jsx("div",{className:"relative h-full",children:i>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Doughnut,{data:s,options:a}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("span",{className:"block text-sm text-gray-500",children:"Total"}),jsxRuntimeExports.jsx("span",{className:"font-bold",children:formatCurrency(i,n.currency)})]})})]}):jsxRuntimeExports.jsx("div",{className:"h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No expense data to display"})})})},NavBar=()=>{const{i18n:t}=useTranslation(),r=n=>{t.changeLanguage(n),localStorage.setItem("language",n)};return React.useEffect(()=>{const n=localStorage.getItem("language");n&&t.changeLanguage(n)},[t]),jsxRuntimeExports.jsx("nav",{children:jsxRuntimeExports.jsxs("select",{onChange:n=>r(n.target.value),defaultValue:t.language,children:[jsxRuntimeExports.jsx("option",{value:"en",children:"English"}),jsxRuntimeExports.jsx("option",{value:"fr",children:"Français"})]})})};function getStartOfCurrentPeriod(t){const r=new Date,n=r.getFullYear(),s=r.getMonth();return r.getDate()<t?new Date(n,s-1,t):new Date(n,s,t)}function getEndOfCurrentPeriod(t){const r=getStartOfCurrentPeriod(t),n=new Date(r);return n.setMonth(n.getMonth()+1),n}const HomePage=()=>{const{transactions:t,settings:r}=useData(),{t:n}=useTranslation(),s=t.filter(f=>f.type==="expense").sort((f,d)=>new Date(d.date).getTime()-new Date(f.date).getTime()).slice(0,5),a=t.filter(f=>f.type==="income").sort((f,d)=>new Date(d.date).getTime()-new Date(f.date).getTime()).slice(0,5),i=getStartOfCurrentPeriod(r.firstDayOfMonth||1),o=getEndOfCurrentPeriod(r.firstDayOfMonth||1),c=t.filter(f=>{const d=new Date(f.date);return d>=i&&d<o});return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:n("home.title")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:format(new Date,"MMMM yyyy")}),jsxRuntimeExports.jsx(NavBar,{})," "]})]}),jsxRuntimeExports.jsx("section",{className:"mb-8 animate-fade-in",children:jsxRuntimeExports.jsx(BalanceCard,{transactions:c,currency:r.currency,startOfMonthDay:r.firstDayOfMonth||1})}),jsxRuntimeExports.jsxs("section",{className:"mb-8 animate-fade-in grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:n("expenses.title")}),jsxRuntimeExports.jsxs(Link,{to:"/reports",className:"text-primary-600 dark:text-primary-400 flex items-center text-sm",children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:n("view.all")}),jsxRuntimeExports.jsx(ArrowRight,{size:16})]})]}),jsxRuntimeExports.jsx("div",{className:"card h-64",children:jsxRuntimeExports.jsx(ExpenseChart,{transactions:c})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:n("recent.expenses")}),jsxRuntimeExports.jsxs(Link,{to:"/expenses",className:"text-primary-600 dark:text-primary-400 flex items-center text-sm",children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:n("view.all")}),jsxRuntimeExports.jsx(ArrowRight,{size:16})]})]}),s.length>0?jsxRuntimeExports.jsx(TransactionList,{transactions:s,limit:5}):jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(TrendingDown,{size:48,className:"text-gray-400 mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:n("no.recent.expenses")}),jsxRuntimeExports.jsxs(Link,{to:"/expenses/add",className:"btn-primary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:16,className:"mr-2"}),n("add.expense")]})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-8 animate-fade-in",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:n("recent.income")}),jsxRuntimeExports.jsxs(Link,{to:"/income",className:"text-primary-600 dark:text-primary-400 flex items-center text-sm",children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:n("view.all")}),jsxRuntimeExports.jsx(ArrowRight,{size:16})]})]}),a.length>0?jsxRuntimeExports.jsx(TransactionList,{transactions:a,limit:5}):jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(TrendingUp,{size:48,className:"text-gray-400 mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:n("no.recent.income")}),jsxRuntimeExports.jsxs(Link,{to:"/income/add",className:"btn-secondary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:16,className:"mr-2"}),n("add.income")]})]})]}),jsxRuntimeExports.jsxs("div",{className:"fixed bottom-20 right-4 flex flex-col space-y-4",children:[jsxRuntimeExports.jsx(Link,{to:"/expenses/add",className:"bg-primary-600 text-white rounded-full p-3 shadow-lg hover:bg-primary-700 transition-all","aria-label":"Add expense",children:jsxRuntimeExports.jsx(TrendingDown,{size:24})}),jsxRuntimeExports.jsx(Link,{to:"/income/add",className:"bg-accent-600 text-white rounded-full p-3 shadow-lg hover:bg-accent-700 transition-all","aria-label":"Add income",children:jsxRuntimeExports.jsx(TrendingUp,{size:24})})]})]})},ExpensesPage=()=>{var w,b,T;const{transactions:t,categories:r,settings:n}=useData(),s=sessionStorage.getItem("expensesFilters"),a=sessionStorage.getItem("expensesSearchTerm"),[i,o]=reactExports.useState(a||""),[c,f]=reactExports.useState(!1),[d,h]=reactExports.useState(s?JSON.parse(s):{categories:[],startDate:"",endDate:""});reactExports.useEffect(()=>{sessionStorage.setItem("expensesFilters",JSON.stringify(d))},[d]),reactExports.useEffect(()=>{sessionStorage.setItem("expensesSearchTerm",i)},[i]);const m=r.filter(k=>k.type==="expense"||k.type==="both"),g=t.filter(k=>k.type==="expense").filter(k=>!(i&&!k.description.toLowerCase().includes(i.toLowerCase())&&!k.category.toLowerCase().includes(i.toLowerCase())||d.categories&&d.categories.length>0&&!d.categories.includes(k.category)||d.startDate&&new Date(k.date)<new Date(d.startDate)||d.endDate&&new Date(k.date)>new Date(d.endDate))).sort((k,C)=>new Date(C.date).getTime()-new Date(k.date).getTime()),v=g.reduce((k,C)=>k+C.amount,0),y=k=>{h(C=>{const L=C.categories||[];return L.includes(k)?{...C,categories:L.filter(D=>D!==k)}:{...C,categories:[...L,k]}})},_=()=>{h({categories:[],startDate:"",endDate:""}),o("")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Expenses"}),jsxRuntimeExports.jsx("div",{className:"text-xl font-semibold text-red-500 dark:text-red-400",children:formatCurrency(v,n.currency)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"relative mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2",placeholder:"Search expenses...",value:i,onChange:k=>o(k.target.value)}),jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsxs("button",{className:"btn-outline flex items-center py-1 px-3 text-sm",onClick:()=>f(!c),children:[jsxRuntimeExports.jsx(Filter,{size:16,className:"mr-2"}),"Filters ",(w=d.categories)!=null&&w.length?`(${d.categories.length})`:""]}),(((b=d.categories)==null?void 0:b.length)||d.startDate||d.endDate)&&jsxRuntimeExports.jsx("button",{className:"text-sm text-primary-600 dark:text-primary-400",onClick:_,children:"Clear all"})]}),c&&jsxRuntimeExports.jsxs("div",{className:"card mb-4 animate-slide-up",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-2",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(k=>{var C;return jsxRuntimeExports.jsx("button",{className:`py-1 px-3 text-sm rounded-full transition-colors ${(C=d.categories)!=null&&C.includes(k.name)?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,onClick:()=>y(k.name),children:k.name},k.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"startDate",className:"input-label",children:"From Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"startDate",className:"w-full",value:d.startDate,onChange:k=>h({...d,startDate:k.target.value})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"endDate",className:"input-label",children:"To Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"endDate",className:"w-full",value:d.endDate,onChange:k=>h({...d,endDate:k.target.value})})]})]})]})]}),jsxRuntimeExports.jsx("section",{className:"mb-20",children:g.length>0?jsxRuntimeExports.jsx(TransactionList,{transactions:g}):jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 mb-2",children:jsxRuntimeExports.jsx(Filter,{size:48})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-1",children:"No expenses found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:i||(T=d.categories)!=null&&T.length||d.startDate||d.endDate?"Try changing your filters or search term":"Start tracking your expenses"})]}),jsxRuntimeExports.jsxs(Link,{to:"/expenses/add",className:"btn-primary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:18,className:"mr-2"}),"Add Expense"]})]})}),jsxRuntimeExports.jsx(Link,{to:"/expenses/add",className:"fixed bottom-20 right-4 bg-primary-600 text-white rounded-full p-4 shadow-lg hover:bg-primary-700 transition-all","aria-label":"Add expense",children:jsxRuntimeExports.jsx(Plus,{size:24})})]})},IncomePage=()=>{var y,_,w;const{transactions:t,categories:r,settings:n}=useData(),[s,a]=reactExports.useState(""),[i,o]=reactExports.useState(!1),[c,f]=reactExports.useState({categories:[],startDate:"",endDate:""}),d=r.filter(b=>b.type==="income"||b.type==="both"),h=t.filter(b=>b.type==="income").filter(b=>!(s&&!b.description.toLowerCase().includes(s.toLowerCase())&&!b.category.toLowerCase().includes(s.toLowerCase())||c.categories&&c.categories.length>0&&!c.categories.includes(b.category)||c.startDate&&new Date(b.date)<new Date(c.startDate)||c.endDate&&new Date(b.date)>new Date(c.endDate))).sort((b,T)=>new Date(T.date).getTime()-new Date(b.date).getTime()),m=getTransactionsTotalByType(h,"income"),g=b=>{f(T=>{const k=T.categories||[];return k.includes(b)?{...T,categories:k.filter(C=>C!==b)}:{...T,categories:[...k,b]}})},v=()=>{f({categories:[],startDate:"",endDate:""}),a("")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Income"}),jsxRuntimeExports.jsx("div",{className:"text-xl font-semibold text-green-500 dark:text-green-400",children:formatCurrency(m,n.currency)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"relative mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2",placeholder:"Search income...",value:s,onChange:b=>a(b.target.value)}),jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsxs("button",{className:"btn-outline flex items-center py-1 px-3 text-sm",onClick:()=>o(!i),children:[jsxRuntimeExports.jsx(Filter,{size:16,className:"mr-2"}),"Filters ",(y=c.categories)!=null&&y.length?`(${c.categories.length})`:""]}),(((_=c.categories)==null?void 0:_.length)||c.startDate||c.endDate)&&jsxRuntimeExports.jsx("button",{className:"text-sm text-primary-600 dark:text-primary-400",onClick:v,children:"Clear all"})]}),i&&jsxRuntimeExports.jsxs("div",{className:"card mb-4 animate-slide-up",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-2",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(b=>{var T;return jsxRuntimeExports.jsx("button",{className:`py-1 px-3 text-sm rounded-full transition-colors ${(T=c.categories)!=null&&T.includes(b.name)?"bg-accent-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,onClick:()=>g(b.name),children:b.name},b.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"startDate",className:"input-label",children:"From Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"startDate",className:"w-full",value:c.startDate,onChange:b=>f({...c,startDate:b.target.value})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"endDate",className:"input-label",children:"To Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"endDate",className:"w-full",value:c.endDate,onChange:b=>f({...c,endDate:b.target.value})})]})]})]})]}),jsxRuntimeExports.jsx("section",{className:"mb-20",children:h.length>0?jsxRuntimeExports.jsx(TransactionList,{transactions:h}):jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 mb-2",children:jsxRuntimeExports.jsx(Filter,{size:48})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-1",children:"No income found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:s||(w=c.categories)!=null&&w.length||c.startDate||c.endDate?"Try changing your filters or search term":"Start tracking your income"})]}),jsxRuntimeExports.jsxs(Link,{to:"/income/add",className:"btn-secondary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:18,className:"mr-2"}),"Add Income"]})]})}),jsxRuntimeExports.jsx(Link,{to:"/income/add",className:"fixed bottom-20 right-4 bg-accent-600 text-white rounded-full p-4 shadow-lg hover:bg-accent-700 transition-all","aria-label":"Add income",children:jsxRuntimeExports.jsx(Plus,{size:24})})]})},BudgetsPage=()=>{const{budgets:t,transactions:r,categories:n,settings:s,applyPlannedBudgets:a,addBudget:i,deleteBudget:o,updateBudget:c}=useData(),[f,d]=reactExports.useState(()=>{const P=new Date;return`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`}),[h,m]=reactExports.useState(!1),[g,v]=reactExports.useState(!1),[y,_]=reactExports.useState(null),[w,b]=reactExports.useState(null),[T,k]=reactExports.useState(!1),[C,L]=reactExports.useState(null),[D,N]=reactExports.useState(null),[U,M]=f.split("-").map(Number),j=new Date(U,M-1),K=new Date(U,M),I=t.filter(P=>!P.isTemplate&&new Date(P.startDate)>=j&&new Date(P.startDate)<K),te=I.map(P=>{const V=(P.categories&&Array.isArray(P.categories)?P.categories:[P.category]).filter(de=>typeof de=="string"),ee=r.filter(de=>V.includes(de.category)).reduce((de,ve)=>de+ve.amount,0),ge=P.amount-ee,xe=Math.min(ee/P.amount*100,100);return{...P,spent:ee,remaining:ge,percentage:xe,budgetCategories:V}}).sort((P,V)=>{const ee=P.remaining<0,ge=V.remaining<0,xe=P.remaining===0,de=V.remaining===0;return ee&&!ge?-1:!ee&&ge?1:!xe&&de?-1:xe&&!de?1:0}),_e=[],ne=new Date;for(let P=0;P<12;P++){const V=new Date(ne.getFullYear(),ne.getMonth()-P,1),ee=`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}`,ge=V.toLocaleDateString("en-US",{month:"long",year:"numeric"});_e.push({value:ee,label:ge})}const me=()=>{t.filter(ee=>!ee.isTemplate).forEach(ee=>o(ee.id)),t.filter(ee=>ee.isTemplate).forEach(ee=>{i({...ee,isTemplate:!1,startDate:new Date().toISOString().split("T")[0]})}),m(!1)},le=P=>{_(P),v(!0)},he=P=>{b(P)},J=()=>{if(!y||!w)return;const P=Math.abs(y.remaining),V=I.find(ee=>ee.id===w);!V||V.amount-P<0||(c({...V,amount:V.amount-P}),c({...y,amount:y.amount+P}),v(!1),_(null),b(null))},fe=P=>{L(P),k(!0)},G=P=>{N(P)},A=()=>{if(!C)return;const P=C.remaining;if(D&&P>0){const V=I.find(ee=>ee.id===D);V&&c({...V,amount:V.amount+P})}c({...C,amount:C.spent}),k(!1),L(null),N(null)},{t:q}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Budgets"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Total du budget : ",formatCurrency(te.reduce((P,V)=>P+V.amount,0),s.currency)]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>m(!0),className:"btn-outline flex items-center text-sm",title:"Reset to planned budgets",children:[jsxRuntimeExports.jsx(Copy,{size:16,className:"mr-2"}),"Reset to Plan"]}),jsxRuntimeExports.jsx("select",{value:f,onChange:P=>d(P.target.value),className:"border-none bg-gray-100 dark:bg-gray-800 rounded-lg px-3 py-1 focus:ring-0",children:_e.map(({value:P,label:V})=>jsxRuntimeExports.jsx("option",{value:P,children:V},P))})]})]}),jsxRuntimeExports.jsx("section",{className:"mb-20",children:te.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-4",children:te.map(P=>{const V=P.budgetCategories||[],ee=V.slice(0,3).map(je=>{const Y=n.find(Xe=>Xe.name===je);return Y?jsxRuntimeExports.jsx("div",{className:"w-6 h-6 rounded-full mr-1 flex items-center justify-center",style:{backgroundColor:Y.color+"30"},title:je,children:jsxRuntimeExports.jsx("span",{style:{color:Y.color,fontSize:12},children:je.charAt(0)})},je):null}),ge=V.length-3;let xe=null;if(ge>0){const je=V.slice(3).join(", ");xe=jsxRuntimeExports.jsxs("div",{className:"w-6 h-6 rounded-full mr-1 flex items-center justify-center bg-gray-300 text-gray-700 text-xs cursor-pointer",title:je,children:["+",ge]})}const de=P.remaining<0,ve=P.remaining===0;return jsxRuntimeExports.jsxs(Link,{to:`/budgets/${P.id}`,className:"card block hover:shadow-lg transition-shadow",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-row mr-2",children:[ee,xe]}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:P.name||V.join(", ")})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[ve?jsxRuntimeExports.jsx("div",{className:"flex items-center text-gray-400",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:"Finished"})}):de&&jsxRuntimeExports.jsxs("div",{className:"flex items-center text-warning-500",children:[jsxRuntimeExports.jsx(AlertTriangle,{size:16,className:"mr-1"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:"Over budget"}),jsxRuntimeExports.jsx("button",{className:"ml-2 btn-outline text-xs px-2 py-1 flex items-center",title:"Équilibrer",onClick:je=>{je.preventDefault(),le(P)},children:jsxRuntimeExports.jsx(Scale$1,{size:16})})]}),!ve&&!de&&jsxRuntimeExports.jsx("button",{className:"ml-2 btn-outline text-xs px-2 py-1 flex items-center",title:"Clôturer le budget",onClick:je=>{je.preventDefault(),fe(P)},children:jsxRuntimeExports.jsx(CheckCircle2,{size:16})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["Spent: ",formatCurrency(P.spent,s.currency)]}),!ve&&jsxRuntimeExports.jsxs("span",{className:`font-medium ${de?"text-warning-500":"text-green-500"}`,children:[de?"Over by ":"Left: ",formatCurrency(de?-P.remaining:P.remaining,s.currency)]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mb-1",children:jsxRuntimeExports.jsx("div",{className:`h-2.5 rounded-full ${de?"bg-warning-500":ve?"bg-gray-400":"bg-primary-600"}`,style:{width:`${Math.min(P.percentage,100)}%`}})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsxs("span",{children:[formatCurrency(P.spent,s.currency)," of ",formatCurrency(P.amount,s.currency)]}),jsxRuntimeExports.jsxs("span",{children:[Math.round(P.percentage),"%"]})]})]},P.id)})}):jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 mb-2",children:jsxRuntimeExports.jsx(Filter,{size:48})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-1",children:"No budgets found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Start by creating a budget for your expenses"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Link,{to:"/budgets/add",className:"btn-primary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:18,className:"mr-2"}),"Create Budget"]}),jsxRuntimeExports.jsxs(Link,{to:"/budgets/planned",className:"btn-outline flex items-center",children:[jsxRuntimeExports.jsx(Copy,{size:18,className:"mr-2"}),"Manage Planned Budgets"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"fixed bottom-20 right-4 flex flex-col space-y-2",children:[jsxRuntimeExports.jsx(Link,{to:"/budgets/planned",className:"bg-accent-600 text-white rounded-full p-4 shadow-lg hover:bg-accent-700 transition-all","aria-label":"Manage planned budgets",children:jsxRuntimeExports.jsx(ClipboardList,{size:24})}),jsxRuntimeExports.jsx(Link,{to:"/budgets/add",className:"bg-primary-600 text-white rounded-full p-4 shadow-lg hover:bg-primary-700 transition-all","aria-label":"Add budget",children:jsxRuntimeExports.jsx(Plus,{size:24})})]}),h&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Reset Monthly Budgets?"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"This will reset your current month's budgets to match your planned budget template. This action cannot be undone."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>m(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:me,children:"Reset to Plan"})]})]})}),g&&y&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Équilibrer le budget"}),jsxRuntimeExports.jsxs("p",{className:"mb-4",children:["Sélectionnez un budget à débiter pour couvrir le dépassement de ",jsxRuntimeExports.jsx("b",{children:formatCurrency(Math.abs(y.remaining),s.currency)})," :"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 mb-4",children:te.filter(P=>P.id!==y.id&&P.remaining>0).map(P=>jsxRuntimeExports.jsxs("label",{className:`flex items-center p-2 rounded cursor-pointer ${w===P.id?"bg-primary-100 dark:bg-primary-900/30":""}`,children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"targetBudget",value:P.id,checked:w===P.id,onChange:()=>he(P.id),className:"mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:P.name||P.budgetCategories.join(", ")}),jsxRuntimeExports.jsxs("span",{className:"ml-auto text-xs text-gray-500",children:["Restant : ",formatCurrency(P.remaining,s.currency)]})]},P.id))}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>v(!1),children:"Annuler"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",disabled:!w,onClick:J,children:"Équilibrer"})]})]})}),T&&C&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Clôturer le budget"}),jsxRuntimeExports.jsxs("p",{className:"mb-4",children:["Voulez-vous reverser le reste de ",jsxRuntimeExports.jsx("b",{children:formatCurrency(C.remaining,s.currency)})," sur un autre budget ? (optionnel)"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 mb-4",children:te.filter(P=>P.id!==C.id&&P.remaining>0).map(P=>jsxRuntimeExports.jsxs("label",{className:`flex items-center p-2 rounded cursor-pointer ${D===P.id?"bg-primary-100 dark:bg-primary-900/30":""}`,children:[jsxRuntimeExports.jsx("input",{type:"radio",name:"closeTargetBudget",value:P.id,checked:D===P.id,onChange:()=>G(P.id),className:"mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:P.name||P.budgetCategories.join(", ")}),jsxRuntimeExports.jsxs("span",{className:"ml-auto text-xs text-gray-500",children:["Restant : ",formatCurrency(P.remaining,s.currency)]})]},P.id))}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>k(!1),children:"Annuler"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:A,children:"Clôturer"})]})]})})]})};Chart$1.register(CategoryScale,LinearScale,PointElement,LineElement,BarElement,ArcElement,plugin_title,plugin_tooltip,plugin_legend);const ReportsPage=()=>{const{transactions:t,categories:r,settings:n}=useData(),[s,a]=reactExports.useState("6months"),[i,o]=reactExports.useState("overview"),c=n.firstDayOfMonth||1;function f(I,te,_e){const ne=new Date(I.getFullYear(),I.getMonth(),I.getDate());return ne.setDate(_e),I.getDate()<_e&&ne.setMonth(ne.getMonth()-1),ne.setMonth(ne.getMonth()-te),ne}const d=new Date;let h,m=6;switch(s){case"1month":m=1;break;case"3months":m=3;break;case"6months":m=6;break;case"12months":m=12;break;default:m=6}h=f(d,m,c);const g=[];let v=new Date(h);for(;v<d;)g.push(new Date(v)),v.setMonth(v.getMonth()+1);const y=t.filter(I=>new Date(I.date)>=h&&new Date(I.date)<=d),_=g.map((I,te)=>{const _e=new Date(I);return _e.setMonth(_e.getMonth()+1),y.filter(ne=>new Date(ne.date)>=I&&new Date(ne.date)<_e)}),w=_.map(I=>getTransactionsTotalByType(I,"income")),b=_.map(I=>getTransactionsTotalByType(I,"expense")),T=w.map((I,te)=>I-b[te]),k=g.map(I=>format(I,"MMM yyyy")),C={labels:k,datasets:[{label:"Income",data:w,backgroundColor:"rgba(34, 197, 94, 0.2)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1},{label:"Expenses",data:b,backgroundColor:"rgba(239, 68, 68, 0.2)",borderColor:"rgba(239, 68, 68, 1)",borderWidth:1}]},L={labels:k,datasets:[{label:"Balance",data:T,backgroundColor:"rgba(13, 148, 136, 0.2)",borderColor:"rgba(13, 148, 136, 1)",borderWidth:2,fill:!0,tension:.3}]},D={};y.filter(I=>I.type==="expense").forEach(I=>{D[I.category]||(D[I.category]=0),D[I.category]+=I.amount});const N=Object.entries(D).sort(([,I],[,te])=>te-I).slice(0,7),U=N.map(([I])=>{const te=r.find(_e=>_e.name===I);return(te==null?void 0:te.color)||"#6B7280"}),M={labels:N.map(([I])=>I),datasets:[{data:N.map(([,I])=>I),backgroundColor:U,borderWidth:0}]},j={responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:I=>formatCurrency(Number(I),n.currency)}}},plugins:{tooltip:{callbacks:{label:I=>{let te=I.dataset.label||"";return te&&(te+=": "),te+=formatCurrency(I.raw,n.currency),te}}}}},K={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:I=>{const te=I.raw,_e=I.dataset.data.reduce((me,le)=>me+le,0),ne=Math.round(te/_e*100);return`${I.label}: ${formatCurrency(te,n.currency)} (${ne}%)`}}}}};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Reports"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:I=>a(I.target.value),className:"border-none bg-gray-100 dark:bg-gray-800 rounded-lg px-3 py-1 focus:ring-0",children:[jsxRuntimeExports.jsx("option",{value:"1month",children:"Last Month"}),jsxRuntimeExports.jsx("option",{value:"3months",children:"Last 3 Months"}),jsxRuntimeExports.jsx("option",{value:"6months",children:"Last 6 Months"}),jsxRuntimeExports.jsx("option",{value:"12months",children:"Last 12 Months"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex mb-6 overflow-x-auto",children:[jsxRuntimeExports.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg ${i==="overview"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`,onClick:()=>o("overview"),children:"Overview"}),jsxRuntimeExports.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg ${i==="balance"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`,onClick:()=>o("balance"),children:"Balance"}),jsxRuntimeExports.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg ${i==="categories"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`,onClick:()=>o("categories"),children:"Categories"})]}),jsxRuntimeExports.jsx("div",{className:"card p-4 mb-8",children:jsxRuntimeExports.jsxs("div",{className:"h-80",children:[i==="overview"&&jsxRuntimeExports.jsx(Bar,{data:C,options:j}),i==="balance"&&jsxRuntimeExports.jsx(Line,{data:L,options:j}),i==="categories"&&jsxRuntimeExports.jsx(Doughnut,{data:M,options:K})]})}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Summary"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Total Income"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-semibold text-green-500 dark:text-green-400",children:formatCurrency(w.reduce((I,te)=>I+te,0),n.currency)})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Total Expenses"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-semibold text-red-500 dark:text-red-400",children:formatCurrency(b.reduce((I,te)=>I+te,0),n.currency)})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Net Balance"}),jsxRuntimeExports.jsx("p",{className:`text-xl font-semibold ${T.reduce((I,te)=>I+te,0)>=0?"text-green-500 dark:text-green-400":"text-red-500 dark:text-red-400"}`,children:formatCurrency(T.reduce((I,te)=>I+te,0),n.currency)})]})]})]}),i==="categories"&&jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Top Expense Categories"}),jsxRuntimeExports.jsx("div",{className:"card divide-y divide-gray-100 dark:divide-gray-800",children:N.map(([I,te])=>{var _e;return jsxRuntimeExports.jsxs("div",{className:"flex justify-between py-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:((_e=r.find(ne=>ne.name===I))==null?void 0:_e.color)||"#6B7280"}}),jsxRuntimeExports.jsx("span",{children:I})]}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:formatCurrency(te,n.currency)})]},I)})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(t){VALID_ANSI.indexOf(t)!=-1&&(current_ansi=CS2CP[0]=t)};function reset_ansi(){set_ansi(1252)}var set_cp=function(t){set_ansi(t)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(t){for(var r=[],n=0,s=t.length;n<s;++n)r[n]=t.charCodeAt(n);return r}function utf16leread(t){for(var r=[],n=0;n<t.length>>1;++n)r[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return r.join("")}function utf16beread(t){for(var r=[],n=0;n<t.length>>1;++n)r[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return r.join("")}var debom=function(t){var r=t.charCodeAt(0),n=t.charCodeAt(1);return r==255&&n==254?utf16leread(t.slice(2)):r==254&&n==255?utf16beread(t.slice(2)):r==65279?t.slice(1):t},_getchar=function(r){return String.fromCharCode(r)},_getansi=function(r){return String.fromCharCode(r)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(t){for(var r="",n=0,s=0,a=0,i=0,o=0,c=0,f=0,d=0;d<t.length;)n=t.charCodeAt(d++),i=n>>2,s=t.charCodeAt(d++),o=(n&3)<<4|s>>4,a=t.charCodeAt(d++),c=(s&15)<<2|a>>6,f=a&63,isNaN(s)?c=f=64:isNaN(a)&&(f=64),r+=Base64_map.charAt(i)+Base64_map.charAt(o)+Base64_map.charAt(c)+Base64_map.charAt(f);return r}function Base64_decode(t){var r="",n=0,s=0,a=0,i=0,o=0,c=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=Base64_map.indexOf(t.charAt(d++)),o=Base64_map.indexOf(t.charAt(d++)),n=i<<2|o>>4,r+=String.fromCharCode(n),c=Base64_map.indexOf(t.charAt(d++)),s=(o&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(s)),f=Base64_map.indexOf(t.charAt(d++)),a=(c&3)<<6|f,f!==64&&(r+=String.fromCharCode(a));return r}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,n){return n?new Buffer(r,n):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(t){return has_buf?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function new_unsafe_buf(t){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var s2a=function(r){return has_buf?Buffer_from(r,"binary"):r.split("").map(function(n){return n.charCodeAt(0)&255})};function s2ab(t){if(typeof ArrayBuffer>"u")return s2a(t);for(var r=new ArrayBuffer(t.length),n=new Uint8Array(r),s=0;s!=t.length;++s)n[s]=t.charCodeAt(s)&255;return r}function a2s(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],n=0;n<t.length;++n)r[n]=String.fromCharCode(t[n]);return r.join("")}function a2u(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function ab2a(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return ab2a(new Uint8Array(t));for(var r=new Array(t.length),n=0;n<t.length;++n)r[n]=t[n];return r}var bconcat=has_buf?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,n=0;for(r=0;r<t.length;++r)n+=t[r].length;var s=new Uint8Array(n),a=0;for(r=0,n=0;r<t.length;n+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)s.set(t[r],n);else{if(typeof t[r]=="string")throw"wtf";s.set(new Uint8Array(t[r]),n)}return s}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function utf8decode(t){for(var r=[],n=0,s=t.length+250,a=new_raw_buf(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[n++]=o;else if(o<2048)a[n++]=192|o>>6&31,a[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++i)&1023;a[n++]=240|o>>8&7,a[n++]=128|o>>2&63,a[n++]=128|c>>6&15|(o&3)<<4,a[n++]=128|c&63}else a[n++]=224|o>>12&15,a[n++]=128|o>>6&63,a[n++]=128|o&63;n>s&&(r.push(a.slice(0,n)),n=0,a=new_raw_buf(65535),s=65530)}return r.push(a.slice(0,n)),bconcat(r)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(t){for(var r="",n=t.length-1;n>=0;)r+=t.charAt(n--);return r}function pad0(t,r){var n=""+t;return n.length>=r?n:fill("0",r-n.length)+n}function pad_(t,r){var n=""+t;return n.length>=r?n:fill(" ",r-n.length)+n}function rpad_(t,r){var n=""+t;return n.length>=r?n:n+fill(" ",r-n.length)}function pad0r1(t,r){var n=""+Math.round(t);return n.length>=r?n:fill("0",r-n.length)+n}function pad0r2(t,r){var n=""+t;return n.length>=r?n:fill("0",r-n.length)+n}var p2_32=Math.pow(2,32);function pad0r(t,r){if(t>p2_32||t<-p2_32)return pad0r1(t,r);var n=Math.round(t);return pad0r2(n,r)}function SSF_isgeneral(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(t,r,n){for(var s=t<0?-1:1,a=t*s,i=0,o=1,c=0,f=1,d=0,h=0,m=Math.floor(a);d<r&&(m=Math.floor(a),c=m*o+i,h=m*d+f,!(a-m<5e-8));)a=1/(a-m),i=o,o=c,f=d,d=h;if(h>r&&(d>r?(h=f,c=i):(h=d,c=o)),!n)return[0,s*c,h];var g=Math.floor(s*c/h);return[g,s*c-g*h,h]}function SSF_parse_date_code(t,r,n){if(t>2958465||t<0)return null;var s=t|0,a=Math.floor(86400*(t-s)),i=0,o=[],c={D:s,T:a,u:86400*(t-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(s+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++s,++c.D)),s===60)o=n?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=n?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var f=new Date(1900,0,1);f.setDate(f.getDate()+s-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),s<60&&(i=(i+6)%7),n&&(i=SSF_fix_hijri(f,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(t,r){var n=t.getTime();return r?n-=1461*24*60*60*1e3:t>=SSFbase1904&&(n+=24*60*60*1e3),(n-(SSFdnthresh+(t.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(t){var r=t<0?12:11,n=SSF_strip_decimal(t.toFixed(12));return n.length<=r||(n=t.toPrecision(10),n.length<=r)?n:t.toExponential(5)}function SSF_large_exp(t){var r=SSF_strip_decimal(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function SSF_general_num(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return r>=-4&&r<=-1?n=t.toPrecision(10+r):Math.abs(r)<=9?n=SSF_small_exp(t):r===10?n=t.toFixed(10).substr(0,12):n=SSF_large_exp(t),SSF_strip_decimal(SSF_normalize_exp(n.toUpperCase()))}function SSF_general(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):SSF_general_num(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return SSF_format(14,datenum_local(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function SSF_fix_hijri(t,r){r[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function SSF_write_date(t,r,n,s){var a="",i=0,o=0,c=n.y,f,d=0;switch(t){case 98:c=n.y+543;case 121:switch(r.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(r.length){case 1:case 2:f=n.m,d=r.length;break;case 3:return months[n.m-1][1];case 5:return months[n.m-1][0];default:return months[n.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=n.d,d=r.length;break;case 3:return days[n.q][0];default:return days[n.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(n.H+11)%12,d=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=n.H,d=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=n.M,d=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return n.u===0&&(r=="s"||r=="ss")?pad0(n.S,r.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(n.S+n.u)),i>=60*o&&(i=0),r==="s"?i===0?"0":""+i/o:(a=pad0(i,2+s),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=n.D*24+n.H;break;case"[m]":case"[mm]":f=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":f=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+r}d=r.length===3?1:2;break;case 101:f=c,d=1;break}var h=d>0?pad0(f,d):"";return h}function commaify(t){var r=3;if(t.length<=r)return t;for(var n=t.length%r,s=t.substr(0,n);n!=t.length;n+=r)s+=(s.length>0?",":"")+t.substr(n,r);return s}var pct1=/%/g;function write_num_pct(t,r,n){var s=r.replace(pct1,""),a=r.length-s.length;return write_num(t,s,n*Math.pow(10,2*a))+fill("%",a)}function write_num_cm(t,r,n){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return write_num(t,r.substr(0,s),n/Math.pow(10,3*(r.length-s)))}function write_num_exp(t,r){var n,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),n.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+i):n+="E+"+(o-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else n=r.toExponential(s);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(t,r,n){var s=parseInt(t[4],10),a=Math.round(r*s),i=Math.floor(a/s),o=a-i*s,c=s;return n+(i===0?"":""+i)+" "+(o===0?fill(" ",t[1].length+1+t[4].length):pad_(o,t[1].length)+t[2]+"/"+t[3]+pad0(c,t[4].length))}function write_num_f2(t,r,n){return n+(r===0?"":""+r)+fill(" ",t[1].length+2+t[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(t){for(var r="",n,s=0;s!=t.length;++s)switch(n=t.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(n)}return r}function rnd(t,r){var n=Math.pow(10,r);return""+Math.round(t*n)/n}function dec(t,r){var n=t-Math.floor(t),s=Math.pow(10,r);return r<(""+Math.round(n*s)).length?0:Math.round(n*s)}function carry(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function flr(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function write_num_flt(t,r,n){if(t.charCodeAt(0)===40&&!r.match(closeparen)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?write_num_flt("n",s,n):"("+write_num_flt("n",s,-n)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm(t,r,n);if(r.indexOf("%")!==-1)return write_num_pct(t,r,n);if(r.indexOf("E")!==-1)return write_num_exp(r,n);if(r.charCodeAt(0)===36)return"$"+write_num_flt(t,r.substr(r.charAt(1)==" "?2:1),n);var a,i,o,c,f=Math.abs(n),d=n<0?"-":"";if(r.match(/^00+$/))return d+pad0r(f,r.length);if(r.match(/^[#?]+$/))return a=pad0r(n,0),a==="0"&&(a=""),a.length>r.length?a:hashq(r.substr(0,r.length-a.length))+a;if(i=r.match(frac1))return write_num_f1(i,f,d);if(r.match(/^#+0+$/))return d+pad0r(f,r.length-r.indexOf("0"));if(i=r.match(dec1))return a=rnd(n,i[1].length).replace(/^([^\.]+)$/,"$1."+hashq(i[1])).replace(/\.$/,"."+hashq(i[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+fill("0",hashq(i[1]).length-_.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+rnd(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+commaify(pad0r(f,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+write_num_flt(t,r,-n):commaify(""+(Math.floor(n)+carry(n,i[1].length)))+"."+pad0(dec(n,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return write_num_flt(t,r.replace(/^#,#*,/,""),n);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_strrev(write_num_flt(t,r.replace(/[\\-]/g,""),n)),o=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(r.match(phone))return a=write_num_flt(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=SSF_frac(f,Math.pow(10,o)-1,!1),a=""+d,h=write_num("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=rpad_(c[2],o),h.length<i[4].length&&(h=hashq(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=SSF_frac(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?pad_(c[1],o)+i[2]+"/"+i[3]+rpad_(c[2],o):fill(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=pad0r(n,0),r.length<=a.length?a:hashq(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=r.indexOf(".")-o,g=r.length-a.length-m;return hashq(r.substr(0,m)+a+r.substr(r.length-g))}if(i=r.match(/^00,000\.([#0]*0)$/))return o=dec(n,i[1].length),n<0?"-"+write_num_flt(t,r,-n):commaify(flr(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?pad0(0,3-y.length):"")+y})+"."+pad0(o,i[1].length);switch(r){case"###,##0.00":return write_num_flt(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var v=commaify(pad0r(f,0));return v!=="0"?d+v:"";case"###,###.00":return write_num_flt(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return write_num_flt(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function write_num_cm2(t,r,n){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return write_num(t,r.substr(0,s),n/Math.pow(10,3*(r.length-s)))}function write_num_pct2(t,r,n){var s=r.replace(pct1,""),a=r.length-s.length;return write_num(t,s,n*Math.pow(10,2*a))+fill("%",a)}function write_num_exp2(t,r){var n,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp2(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),!n.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+i):n+="E+"+(o-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else n=r.toExponential(s);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function write_num_int(t,r,n){if(t.charCodeAt(0)===40&&!r.match(closeparen)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?write_num_int("n",s,n):"("+write_num_int("n",s,-n)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm2(t,r,n);if(r.indexOf("%")!==-1)return write_num_pct2(t,r,n);if(r.indexOf("E")!==-1)return write_num_exp2(r,n);if(r.charCodeAt(0)===36)return"$"+write_num_int(t,r.substr(r.charAt(1)==" "?2:1),n);var a,i,o,c,f=Math.abs(n),d=n<0?"-":"";if(r.match(/^00+$/))return d+pad0(f,r.length);if(r.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>r.length?a:hashq(r.substr(0,r.length-a.length))+a;if(i=r.match(frac1))return write_num_f2(i,f,d);if(r.match(/^#+0+$/))return d+pad0(f,r.length-r.indexOf("0"));if(i=r.match(dec1))return a=(""+n).replace(/^([^\.]+)$/,"$1."+hashq(i[1])).replace(/\.$/,"."+hashq(i[1])),a=a.replace(/\.(\d*)$/,function(y,_){return"."+_+fill("0",hashq(i[1]).length-_.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+commaify(""+f);if(i=r.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+write_num_int(t,r,-n):commaify(""+n)+"."+fill("0",i[1].length);if(i=r.match(/^#,#*,#0/))return write_num_int(t,r.replace(/^#,#*,/,""),n);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_strrev(write_num_int(t,r.replace(/[\\-]/g,""),n)),o=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(r.match(phone))return a=write_num_int(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=SSF_frac(f,Math.pow(10,o)-1,!1),a=""+d,h=write_num("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=rpad_(c[2],o),h.length<i[4].length&&(h=hashq(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=SSF_frac(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?pad_(c[1],o)+i[2]+"/"+i[3]+rpad_(c[2],o):fill(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+n,r.length<=a.length?a:hashq(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=r.indexOf(".")-o,g=r.length-a.length-m;return hashq(r.substr(0,m)+a+r.substr(r.length-g))}if(i=r.match(/^00,000\.([#0]*0)$/))return n<0?"-"+write_num_int(t,r,-n):commaify(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?pad0(0,3-y.length):"")+y})+"."+pad0(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var v=commaify(""+f);return v!=="0"?d+v:"";default:if(r.match(/\.[0#?]*$/))return write_num_int(t,r.slice(0,r.lastIndexOf(".")),n)+hashq(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function write_num(t,r,n){return(n|0)===n?write_num_int(t,r,n):write_num_flt(t,r,n)}function SSF_split_fmt(t){for(var r=[],n=!1,s=0,a=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:n=!n;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=t.substr(a,s-a),a=s+1}if(r[r.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(t){for(var r=0,n="",s="";r<t.length;)switch(n=t.charAt(r)){case"G":SSF_isgeneral(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(s=n;t.charAt(r++)!=="]"&&r<t.length;)s+=t.charAt(r);if(s.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++r))>-1||n=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===n;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function eval_fmt(t,r,n,s){for(var a=[],i="",o=0,c="",f="t",d,h,m,g="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!SSF_isgeneral(t,o))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++o;break;case"\\":var v=t.charAt(++o),y=v==="("||v===")"?v:"t";a[a.length]={t:y,v},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=SSF_parse_date_code(r,n,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},f=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||d==null&&(d=SSF_parse_date_code(r,n),d==null))return"";for(i=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:i},f=c;break;case"A":case"a":case"上":var _={t:c,v:c};if(d==null&&(d=SSF_parse_date_code(r,n)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",g="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",o+=5,g="h"):t.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(_.v=d.H>=12?"下午":"上午"),_.t="T",o+=5,g="h"):(_.t="t",++o),d==null&&_.t==="T")return"";a[a.length]=_,f=c;break;case"[":for(i=c;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(SSF_abstime)){if(d==null&&(d=SSF_parse_date_code(r,n),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++o<t.length&&(c=t.charAt(o))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++o)===c;)i+=c;a[a.length]={t:c,v:i},f=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:s===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++o;break}var w=0,b=0,T;for(o=a.length-1,f="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,f="h",w<1&&(w=1);break;case"s":(T=a[o].v.match(/\.0+$/))&&(b=Math.max(b,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":f=a[o].t;break;case"m":f==="s"&&(a[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[o].v.match(/[Hh]/)&&(w=1),w<2&&a[o].v.match(/[Mm]/)&&(w=2),w<3&&a[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var k="",C;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=SSF_write_date(a[o].t.charCodeAt(0),a[o].v,d,b),a[o].t="t";break;case"n":case"?":for(C=o+1;a[C]!=null&&((c=a[C].t)==="?"||c==="D"||(c===" "||c==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[o].v+=a[C].v,a[C]={v:"",t:";"},++C;k+=a[o].v,o=C-1;break;case"G":a[o].t="t",a[o].v=SSF_general(r,n);break}var L="",D,N;if(k.length>0){k.charCodeAt(0)==40?(D=r<0&&k.charCodeAt(0)===45?-r:r,N=write_num("n",k,D)):(D=r<0&&s>1?-r:r,N=write_num("n",k,D),D<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),C=N.length-1;var U=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){U=o;break}var M=a.length;if(U===a.length&&N.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(C>=a[o].v.length-1?(C-=a[o].v.length,a[o].v=N.substr(C+1,a[o].v.length)):C<0?a[o].v="":(a[o].v=N.substr(0,C+1),C=-1),a[o].t="t",M=o);C>=0&&M<a.length&&(a[M].v=N.substr(0,C+1)+a[M].v)}else if(U!==a.length&&N.indexOf("E")===-1){for(C=N.indexOf(".")-1,o=U;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===U?a[o].v.indexOf(".")-1:a[o].v.length-1,L=a[o].v.substr(h+1);h>=0;--h)C>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(L=N.charAt(C--)+L);a[o].v=L,a[o].t="t",M=o}for(C>=0&&M<a.length&&(a[M].v=N.substr(0,C+1)+a[M].v),C=N.indexOf(".")+1,o=U;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==U)){for(h=a[o].v.indexOf(".")>-1&&o===U?a[o].v.indexOf(".")+1:0,L=a[o].v.substr(0,h);h<a[o].v.length;++h)C<N.length&&(L+=N.charAt(C++));a[o].v=L,a[o].t="t",M=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(D=s>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=write_num(a[o].t,a[o].v,D),a[o].t="t");var j="";for(o=0;o!==a.length;++o)a[o]!=null&&(j+=a[o].v);return j}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(t,r){if(r==null)return!1;var n=parseFloat(r[2]);switch(r[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function choose_fmt(t,r){var n=SSF_split_fmt(t),s=n.length,a=n[s-1].indexOf("@");if(s<4&&a>-1&&--s,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof r!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=r>0?n[0]:r<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[s,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(cfregex2),c=n[1].match(cfregex2);return chkcond(r,o)?[s,n[0]]:chkcond(r,c)?[s,n[1]]:[s,n[o!=null&&c!=null?2:1]]}return[s,i]}function SSF_format(t,r,n){n==null&&(n={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?s=n.dateNF:s=t;break;case"number":t==14&&n.dateNF?s=n.dateNF:s=(n.table!=null?n.table:table_fmt)[t],s==null&&(s=n.table&&n.table[SSF_default_map[t]]||table_fmt[SSF_default_map[t]]),s==null&&(s=SSF_default_str[t]||"General");break}if(SSF_isgeneral(s,0))return SSF_general(r,n);r instanceof Date&&(r=datenum_local(r,n.date1904));var a=choose_fmt(s,r);if(SSF_isgeneral(a[1]))return SSF_general(r,n);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return eval_fmt(a[1],r,n,a[0])}function SSF_load(t,r){if(typeof r!="number"){r=+r||-1;for(var n=0;n<392;++n){if(table_fmt[n]==null){r<0&&(r=n);continue}if(table_fmt[n]==t){r=n;break}}r<0&&(r=391)}return table_fmt[r]=t,r}function SSF_load_table(t){for(var r=0;r!=392;++r)t[r]!==void 0&&SSF_load(t[r],r)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(t){var r=typeof t=="number"?table_fmt[t]:t;return r=r.replace(dateNFregex,"(\\d+)"),new RegExp("^"+r+"$")}function dateNF_fix(t,r,n){var s=-1,a=-1,i=-1,o=-1,c=-1,f=-1;(r.match(dateNFregex)||[]).forEach(function(m,g){var v=parseInt(n[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":s=v;break;case"d":i=v;break;case"h":o=v;break;case"s":f=v;break;case"m":o>=0?c=v:a=v;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var d=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&c==-1&&f==-1?d:s==-1&&a==-1&&i==-1?h:d+"T"+h}var CRC32=function(){var t={};t.version="1.2.0";function r(){for(var N=0,U=new Array(256),M=0;M!=256;++M)N=M,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,U[M]=N;return typeof Int32Array<"u"?new Int32Array(U):U}var n=r();function s(N){var U=0,M=0,j=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)K[j]=N[j];for(j=0;j!=256;++j)for(M=N[j],U=256+j;U<4096;U+=256)M=K[U]=M>>>8^N[M&255];var I=[];for(j=1;j!=16;++j)I[j-1]=typeof Int32Array<"u"?K.subarray(j*256,j*256+256):K.slice(j*256,j*256+256);return I}var a=s(n),i=a[0],o=a[1],c=a[2],f=a[3],d=a[4],h=a[5],m=a[6],g=a[7],v=a[8],y=a[9],_=a[10],w=a[11],b=a[12],T=a[13],k=a[14];function C(N,U){for(var M=U^-1,j=0,K=N.length;j<K;)M=M>>>8^n[(M^N.charCodeAt(j++))&255];return~M}function L(N,U){for(var M=U^-1,j=N.length-15,K=0;K<j;)M=k[N[K++]^M&255]^T[N[K++]^M>>8&255]^b[N[K++]^M>>16&255]^w[N[K++]^M>>>24]^_[N[K++]]^y[N[K++]]^v[N[K++]]^g[N[K++]]^m[N[K++]]^h[N[K++]]^d[N[K++]]^f[N[K++]]^c[N[K++]]^o[N[K++]]^i[N[K++]]^n[N[K++]];for(j+=15;K<j;)M=M>>>8^n[(M^N[K++])&255];return~M}function D(N,U){for(var M=U^-1,j=0,K=N.length,I=0,te=0;j<K;)I=N.charCodeAt(j++),I<128?M=M>>>8^n[(M^I)&255]:I<2048?(M=M>>>8^n[(M^(192|I>>6&31))&255],M=M>>>8^n[(M^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,te=N.charCodeAt(j++)&1023,M=M>>>8^n[(M^(240|I>>8&7))&255],M=M>>>8^n[(M^(128|I>>2&63))&255],M=M>>>8^n[(M^(128|te>>6&15|(I&3)<<4))&255],M=M>>>8^n[(M^(128|te&63))&255]):(M=M>>>8^n[(M^(224|I>>12&15))&255],M=M>>>8^n[(M^(128|I>>6&63))&255],M=M>>>8^n[(M^(128|I&63))&255]);return~M}return t.table=n,t.bstr=C,t.buf=L,t.str=D,t}(),CFB=function(){var r={};r.version="1.2.1";function n(F,z){for(var O=F.split("/"),B=z.split("/"),W=0,H=0,ie=Math.min(O.length,B.length);W<ie;++W){if(H=O[W].length-B[W].length)return H;if(O[W]!=B[W])return O[W]<B[W]?-1:1}return O.length-B.length}function s(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:s(F.slice(0,-1));var z=F.lastIndexOf("/");return z===-1?F:F.slice(0,z+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var z=F.lastIndexOf("/");return z===-1?F:F.slice(z+1)}function i(F,z){typeof z=="string"&&(z=new Date(z));var O=z.getHours();O=O<<6|z.getMinutes(),O=O<<5|z.getSeconds()>>>1,F.write_shift(2,O);var B=z.getFullYear()-1980;B=B<<4|z.getMonth()+1,B=B<<5|z.getDate(),F.write_shift(2,B)}function o(F){var z=F.read_shift(2)&65535,O=F.read_shift(2)&65535,B=new Date,W=O&31;O>>>=5;var H=O&15;O>>>=4,B.setMilliseconds(0),B.setFullYear(O+1980),B.setMonth(H-1),B.setDate(W);var ie=z&31;z>>>=5;var pe=z&63;return z>>>=6,B.setHours(z),B.setMinutes(pe),B.setSeconds(ie<<1),B}function c(F){prep_blob(F,0);for(var z={},O=0;F.l<=F.length-4;){var B=F.read_shift(2),W=F.read_shift(2),H=F.l+W,ie={};switch(B){case 21589:O=F.read_shift(1),O&1&&(ie.mtime=F.read_shift(4)),W>5&&(O&2&&(ie.atime=F.read_shift(4)),O&4&&(ie.ctime=F.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}F.l=H,z[B]=ie}return z}var f;function d(){return f||(f={})}function h(F,z){if(F[0]==80&&F[1]==75)return on(F,z);if((F[0]|32)==109&&(F[1]|32)==105)return ys(F,z);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var O=3,B=512,W=0,H=0,ie=0,pe=0,ae=0,oe=[],ce=F.slice(0,512);prep_blob(ce,0);var Ee=m(ce);switch(O=Ee[0],O){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ee[1]==0)return on(F,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}B!==512&&(ce=F.slice(0,B),prep_blob(ce,28));var Ce=F.slice(0,B);g(ce,O);var Ne=ce.read_shift(4,"i");if(O===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);ce.l+=4,ie=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),pe=ce.read_shift(4,"i"),W=ce.read_shift(4,"i"),ae=ce.read_shift(4,"i"),H=ce.read_shift(4,"i");for(var be=-1,ke=0;ke<109&&(be=ce.read_shift(4,"i"),!(be<0));++ke)oe[ke]=be;var Ue=v(F,B);w(ae,H,Ue,B,oe);var qe=T(Ue,ie,oe,B);qe[ie].name="!Directory",W>0&&pe!==te&&(qe[pe].name="!MiniFAT"),qe[oe[0]].name="!FAT",qe.fat_addrs=oe,qe.ssz=B;var Je={},ot=[],Xr=[],wr=[];k(ie,qe,Ue,ot,W,Je,Xr,pe),y(Xr,wr,ot),ot.shift();var nr={FileIndex:Xr,FullPaths:wr};return z&&z.raw&&(nr.raw={header:Ce,sectors:Ue}),nr}function m(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(_e,"Header Signature: "),F.l+=16;var z=F.read_shift(2,"u");return[F.read_shift(2,"u"),z]}function g(F,z){var O=9;switch(F.l+=2,O=F.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function v(F,z){for(var O=Math.ceil(F.length/z)-1,B=[],W=1;W<O;++W)B[W-1]=F.slice(W*z,(W+1)*z);return B[O-1]=F.slice(O*z),B}function y(F,z,O){for(var B=0,W=0,H=0,ie=0,pe=0,ae=O.length,oe=[],ce=[];B<ae;++B)oe[B]=ce[B]=B,z[B]=O[B];for(;pe<ce.length;++pe)B=ce[pe],W=F[B].L,H=F[B].R,ie=F[B].C,oe[B]===B&&(W!==-1&&oe[W]!==W&&(oe[B]=oe[W]),H!==-1&&oe[H]!==H&&(oe[B]=oe[H])),ie!==-1&&(oe[ie]=B),W!==-1&&B!=oe[B]&&(oe[W]=oe[B],ce.lastIndexOf(W)<pe&&ce.push(W)),H!==-1&&B!=oe[B]&&(oe[H]=oe[B],ce.lastIndexOf(H)<pe&&ce.push(H));for(B=1;B<ae;++B)oe[B]===B&&(H!==-1&&oe[H]!==H?oe[B]=oe[H]:W!==-1&&oe[W]!==W&&(oe[B]=oe[W]));for(B=1;B<ae;++B)if(F[B].type!==0){if(pe=B,pe!=oe[pe])do pe=oe[pe],z[B]=z[pe]+"/"+z[B];while(pe!==0&&oe[pe]!==-1&&pe!=oe[pe]);oe[B]=-1}for(z[0]+="/",B=1;B<ae;++B)F[B].type!==2&&(z[B]+="/")}function _(F,z,O){for(var B=F.start,W=F.size,H=[],ie=B;O&&W>0&&ie>=0;)H.push(z.slice(ie*I,ie*I+I)),W-=I,ie=__readInt32LE(O,ie*4);return H.length===0?new_buf(0):bconcat(H).slice(0,F.size)}function w(F,z,O,B,W){var H=te;if(F===te){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var ie=O[F],pe=(B>>>2)-1;if(!ie)return;for(var ae=0;ae<pe&&(H=__readInt32LE(ie,ae*4))!==te;++ae)W.push(H);w(__readInt32LE(ie,B-4),z-1,O,B,W)}}function b(F,z,O,B,W){var H=[],ie=[];W||(W=[]);var pe=B-1,ae=0,oe=0;for(ae=z;ae>=0;){W[ae]=!0,H[H.length]=ae,ie.push(F[ae]);var ce=O[Math.floor(ae*4/B)];if(oe=ae*4&pe,B<4+oe)throw new Error("FAT boundary crossed: "+ae+" 4 "+B);if(!F[ce])break;ae=__readInt32LE(F[ce],oe)}return{nodes:H,data:__toBuffer([ie])}}function T(F,z,O,B){var W=F.length,H=[],ie=[],pe=[],ae=[],oe=B-1,ce=0,Ee=0,Ce=0,Ne=0;for(ce=0;ce<W;++ce)if(pe=[],Ce=ce+z,Ce>=W&&(Ce-=W),!ie[Ce]){ae=[];var be=[];for(Ee=Ce;Ee>=0;){be[Ee]=!0,ie[Ee]=!0,pe[pe.length]=Ee,ae.push(F[Ee]);var ke=O[Math.floor(Ee*4/B)];if(Ne=Ee*4&oe,B<4+Ne)throw new Error("FAT boundary crossed: "+Ee+" 4 "+B);if(!F[ke]||(Ee=__readInt32LE(F[ke],Ne),be[Ee]))break}H[Ce]={nodes:pe,data:__toBuffer([ae])}}return H}function k(F,z,O,B,W,H,ie,pe){for(var ae=0,oe=B.length?2:0,ce=z[F].data,Ee=0,Ce=0,Ne;Ee<ce.length;Ee+=128){var be=ce.slice(Ee,Ee+128);prep_blob(be,64),Ce=be.read_shift(2),Ne=__utf16le(be,0,Ce-oe),B.push(Ne);var ke={name:Ne,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},Ue=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Ue!==0&&(ke.ct=C(be,be.l-8));var qe=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);qe!==0&&(ke.mt=C(be,be.l-8)),ke.start=be.read_shift(4,"i"),ke.size=be.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=te,ke.name=""),ke.type===5?(ae=ke.start,W>0&&ae!==te&&(z[ae].name="!StreamData")):ke.size>=4096?(ke.storage="fat",z[ke.start]===void 0&&(z[ke.start]=b(O,ke.start,z.fat_addrs,z.ssz)),z[ke.start].name=ke.name,ke.content=z[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:ae!==te&&ke.start!==te&&z[ae]&&(ke.content=_(ke,z[ae].data,(z[pe]||{}).data))),ke.content&&prep_blob(ke.content,0),H[Ne]=ke,ie.push(ke)}}function C(F,z){return new Date((__readUInt32LE(F,z+4)/1e7*Math.pow(2,32)+__readUInt32LE(F,z)/1e7-11644473600)*1e3)}function L(F,z){return d(),h(f.readFileSync(F),z)}function D(F,z){var O=z&&z.type;switch(O||has_buf&&Buffer.isBuffer(F)&&(O="buffer"),O||"base64"){case"file":return L(F,z);case"base64":return h(s2a(Base64_decode(F)),z);case"binary":return h(s2a(F),z)}return h(F,z)}function N(F,z){var O=z||{},B=O.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=B+"/",F.FileIndex[0]={name:B,type:5}),O.CLSID&&(F.FileIndex[0].clsid=O.CLSID),U(F)}function U(F){var z="Sh33tJ5";if(!CFB.find(F,"/"+z)){var O=new_buf(4);O[0]=55,O[1]=O[3]=50,O[2]=54,F.FileIndex.push({name:z,type:2,content:O,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+z),M(F)}}function M(F,z){N(F);for(var O=!1,B=!1,W=F.FullPaths.length-1;W>=0;--W){var H=F.FileIndex[W];switch(H.type){case 0:B?O=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!z)){var ie=new Date(1987,1,19),pe=0,ae=Object.create?Object.create(null):{},oe=[];for(W=0;W<F.FullPaths.length;++W)ae[F.FullPaths[W]]=!0,F.FileIndex[W].type!==0&&oe.push([F.FullPaths[W],F.FileIndex[W]]);for(W=0;W<oe.length;++W){var ce=s(oe[W][0]);B=ae[ce],B||(oe.push([ce,{name:a(ce).replace("/",""),type:1,clsid:me,ct:ie,mt:ie,content:null}]),ae[ce]=!0)}for(oe.sort(function(Ne,be){return n(Ne[0],be[0])}),F.FullPaths=[],F.FileIndex=[],W=0;W<oe.length;++W)F.FullPaths[W]=oe[W][0],F.FileIndex[W]=oe[W][1];for(W=0;W<oe.length;++W){var Ee=F.FileIndex[W],Ce=F.FullPaths[W];if(Ee.name=a(Ce).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||me,W===0)Ee.C=oe.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Ce.slice(-1)=="/"){for(pe=W+1;pe<oe.length&&s(F.FullPaths[pe])!=Ce;++pe);for(Ee.C=pe>=oe.length?-1:pe,pe=W+1;pe<oe.length&&s(F.FullPaths[pe])!=s(Ce);++pe);Ee.R=pe>=oe.length?-1:pe,Ee.type=1}else s(F.FullPaths[W+1]||"")==s(Ce)&&(Ee.R=W+1),Ee.type=2}}}function j(F,z){var O=z||{};if(O.fileType=="mad")return Vr(F,O);switch(M(F),O.fileType){case"zip":return yr(F,O)}var B=function(Ne){for(var be=0,ke=0,Ue=0;Ue<Ne.FileIndex.length;++Ue){var qe=Ne.FileIndex[Ue];if(qe.content){var Je=qe.content.length;Je>0&&(Je<4096?be+=Je+63>>6:ke+=Je+511>>9)}}for(var ot=Ne.FullPaths.length+3>>2,Xr=be+7>>3,wr=be+127>>7,nr=Xr+ke+ot+wr,pt=nr+127>>7,On=pt<=109?0:Math.ceil((pt-109)/127);nr+pt+On+127>>7>pt;)On=++pt<=109?0:Math.ceil((pt-109)/127);var lt=[1,On,pt,wr,ot,ke,be,0];return Ne.FileIndex[0].size=be<<6,lt[7]=(Ne.FileIndex[0].start=lt[0]+lt[1]+lt[2]+lt[3]+lt[4]+lt[5])+(lt[6]+7>>3),lt}(F),W=new_buf(B[7]<<9),H=0,ie=0;{for(H=0;H<8;++H)W.write_shift(1,ne[H]);for(H=0;H<8;++H)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),H=0;H<3;++H)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,B[2]),W.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:te),W.write_shift(4,B[3]),W.write_shift(-4,B[1]?B[0]-1:te),W.write_shift(4,B[1]),H=0;H<109;++H)W.write_shift(-4,H<B[2]?B[1]+H:-1)}if(B[1])for(ie=0;ie<B[1];++ie){for(;H<236+ie*127;++H)W.write_shift(-4,H<B[2]?B[1]+H:-1);W.write_shift(-4,ie===B[1]-1?te:ie+1)}var pe=function(Ne){for(ie+=Ne;H<ie-1;++H)W.write_shift(-4,H+1);Ne&&(++H,W.write_shift(-4,te))};for(ie=H=0,ie+=B[1];H<ie;++H)W.write_shift(-4,le.DIFSECT);for(ie+=B[2];H<ie;++H)W.write_shift(-4,le.FATSECT);pe(B[3]),pe(B[4]);for(var ae=0,oe=0,ce=F.FileIndex[0];ae<F.FileIndex.length;++ae)ce=F.FileIndex[ae],ce.content&&(oe=ce.content.length,!(oe<4096)&&(ce.start=ie,pe(oe+511>>9)));for(pe(B[6]+7>>3);W.l&511;)W.write_shift(-4,le.ENDOFCHAIN);for(ie=H=0,ae=0;ae<F.FileIndex.length;++ae)ce=F.FileIndex[ae],ce.content&&(oe=ce.content.length,!(!oe||oe>=4096)&&(ce.start=ie,pe(oe+63>>6)));for(;W.l&511;)W.write_shift(-4,le.ENDOFCHAIN);for(H=0;H<B[4]<<2;++H){var Ee=F.FullPaths[H];if(!Ee||Ee.length===0){for(ae=0;ae<17;++ae)W.write_shift(4,0);for(ae=0;ae<3;++ae)W.write_shift(4,-1);for(ae=0;ae<12;++ae)W.write_shift(4,0);continue}ce=F.FileIndex[H],H===0&&(ce.start=ce.size?ce.start-1:te);var Ce=H===0&&O.root||ce.name;if(oe=2*(Ce.length+1),W.write_shift(64,Ce,"utf16le"),W.write_shift(2,oe),W.write_shift(1,ce.type),W.write_shift(1,ce.color),W.write_shift(-4,ce.L),W.write_shift(-4,ce.R),W.write_shift(-4,ce.C),ce.clsid)W.write_shift(16,ce.clsid,"hex");else for(ae=0;ae<4;++ae)W.write_shift(4,0);W.write_shift(4,ce.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ce.start),W.write_shift(4,ce.size),W.write_shift(4,0)}for(H=1;H<F.FileIndex.length;++H)if(ce=F.FileIndex[H],ce.size>=4096)if(W.l=ce.start+1<<9,has_buf&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+511&-512;else{for(ae=0;ae<ce.size;++ae)W.write_shift(1,ce.content[ae]);for(;ae&511;++ae)W.write_shift(1,0)}for(H=1;H<F.FileIndex.length;++H)if(ce=F.FileIndex[H],ce.size>0&&ce.size<4096)if(has_buf&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+63&-64;else{for(ae=0;ae<ce.size;++ae)W.write_shift(1,ce.content[ae]);for(;ae&63;++ae)W.write_shift(1,0)}if(has_buf)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function K(F,z){var O=F.FullPaths.map(function(ae){return ae.toUpperCase()}),B=O.map(function(ae){var oe=ae.split("/");return oe[oe.length-(ae.slice(-1)=="/"?2:1)]}),W=!1;z.charCodeAt(0)===47?(W=!0,z=O[0].slice(0,-1)+z):W=z.indexOf("/")!==-1;var H=z.toUpperCase(),ie=W===!0?O.indexOf(H):B.indexOf(H);if(ie!==-1)return F.FileIndex[ie];var pe=!H.match(chr1);for(H=H.replace(chr0,""),pe&&(H=H.replace(chr1,"!")),ie=0;ie<O.length;++ie)if((pe?O[ie].replace(chr1,"!"):O[ie]).replace(chr0,"")==H||(pe?B[ie].replace(chr1,"!"):B[ie]).replace(chr0,"")==H)return F.FileIndex[ie];return null}var I=64,te=-2,_e="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(F,z,O){d();var B=j(F,O);f.writeFileSync(z,B)}function J(F){for(var z=new Array(F.length),O=0;O<F.length;++O)z[O]=String.fromCharCode(F[O]);return z.join("")}function fe(F,z){var O=j(F,z);switch(z&&z.type||"buffer"){case"file":return d(),f.writeFileSync(z.filename,O),O;case"binary":return typeof O=="string"?O:J(O);case"base64":return Base64_encode(typeof O=="string"?O:J(O));case"buffer":if(has_buf)return Buffer.isBuffer(O)?O:Buffer_from(O);case"array":return typeof O=="string"?s2a(O):O}return O}var G;function A(F){try{var z=F.InflateRaw,O=new z;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)G=F;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function q(F,z){if(!G)return sn(F,z);var O=G.InflateRaw,B=new O,W=B._processChunk(F.slice(F.l),B._finishFlushFlag);return F.l+=B.bytesRead,W}function P(F){return G?G.deflateRawSync(F):ze(F)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(F){var z=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(z>>16|z>>8|z)&255}for(var de=typeof Uint8Array<"u",ve=de?new Uint8Array(256):[],je=0;je<256;++je)ve[je]=xe(je);function Y(F,z){var O=ve[F&255];return z<=8?O>>>8-z:(O=O<<8|ve[F>>8&255],z<=16?O>>>16-z:(O=O<<8|ve[F>>16&255],O>>>24-z))}function Xe(F,z){var O=z&7,B=z>>>3;return(F[B]|(O<=6?0:F[B+1]<<8))>>>O&3}function Ve(F,z){var O=z&7,B=z>>>3;return(F[B]|(O<=5?0:F[B+1]<<8))>>>O&7}function Ye(F,z){var O=z&7,B=z>>>3;return(F[B]|(O<=4?0:F[B+1]<<8))>>>O&15}function We(F,z){var O=z&7,B=z>>>3;return(F[B]|(O<=3?0:F[B+1]<<8))>>>O&31}function Re(F,z){var O=z&7,B=z>>>3;return(F[B]|(O<=1?0:F[B+1]<<8))>>>O&127}function tt(F,z,O){var B=z&7,W=z>>>3,H=(1<<O)-1,ie=F[W]>>>B;return O<8-B||(ie|=F[W+1]<<8-B,O<16-B)||(ie|=F[W+2]<<16-B,O<24-B)||(ie|=F[W+3]<<24-B),ie&H}function yt(F,z,O){var B=z&7,W=z>>>3;return B<=5?F[W]|=(O&7)<<B:(F[W]|=O<<B&255,F[W+1]=(O&7)>>8-B),z+3}function wt(F,z,O){var B=z&7,W=z>>>3;return O=(O&1)<<B,F[W]|=O,z+1}function Et(F,z,O){var B=z&7,W=z>>>3;return O<<=B,F[W]|=O&255,O>>>=8,F[W+1]=O,z+8}function lr(F,z,O){var B=z&7,W=z>>>3;return O<<=B,F[W]|=O&255,O>>>=8,F[W+1]=O&255,F[W+2]=O>>>8,z+16}function Gt(F,z){var O=F.length,B=2*O>z?2*O:z+5,W=0;if(O>=z)return F;if(has_buf){var H=new_unsafe_buf(B);if(F.copy)F.copy(H);else for(;W<F.length;++W)H[W]=F[W];return H}else if(de){var ie=new Uint8Array(B);if(ie.set)ie.set(F);else for(;W<O;++W)ie[W]=F[W];return ie}return F.length=B,F}function St(F){for(var z=new Array(F),O=0;O<F;++O)z[O]=0;return z}function zt(F,z,O){var B=1,W=0,H=0,ie=0,pe=0,ae=F.length,oe=de?new Uint16Array(32):St(32);for(H=0;H<32;++H)oe[H]=0;for(H=ae;H<O;++H)F[H]=0;ae=F.length;var ce=de?new Uint16Array(ae):St(ae);for(H=0;H<ae;++H)oe[W=F[H]]++,B<W&&(B=W),ce[H]=0;for(oe[0]=0,H=1;H<=B;++H)oe[H+16]=pe=pe+oe[H-1]<<1;for(H=0;H<ae;++H)pe=F[H],pe!=0&&(ce[H]=oe[pe+16]++);var Ee=0;for(H=0;H<ae;++H)if(Ee=F[H],Ee!=0)for(pe=Y(ce[H],B)>>B-Ee,ie=(1<<B+4-Ee)-1;ie>=0;--ie)z[pe|ie<<Ee]=Ee&15|H<<4;return B}var Kt=de?new Uint16Array(512):St(512),cr=de?new Uint16Array(32):St(32);if(!de){for(var ut=0;ut<512;++ut)Kt[ut]=0;for(ut=0;ut<32;++ut)cr[ut]=0}(function(){for(var F=[],z=0;z<32;z++)F.push(5);zt(F,cr,32);var O=[];for(z=0;z<=143;z++)O.push(8);for(;z<=255;z++)O.push(9);for(;z<=279;z++)O.push(7);for(;z<=287;z++)O.push(8);zt(O,Kt,288)})();var jt=function(){for(var z=de?new Uint8Array(32768):[],O=0,B=0;O<ge.length-1;++O)for(;B<ge[O+1];++B)z[B]=O;for(;B<32768;++B)z[B]=29;var W=de?new Uint8Array(259):[];for(O=0,B=0;O<ee.length-1;++O)for(;B<ee[O+1];++B)W[B]=O;function H(pe,ae){for(var oe=0;oe<pe.length;){var ce=Math.min(65535,pe.length-oe),Ee=oe+ce==pe.length;for(ae.write_shift(1,+Ee),ae.write_shift(2,ce),ae.write_shift(2,~ce&65535);ce-- >0;)ae[ae.l++]=pe[oe++]}return ae.l}function ie(pe,ae){for(var oe=0,ce=0,Ee=de?new Uint16Array(32768):[];ce<pe.length;){var Ce=Math.min(65535,pe.length-ce);if(Ce<10){for(oe=yt(ae,oe,+(ce+Ce==pe.length)),oe&7&&(oe+=8-(oe&7)),ae.l=oe/8|0,ae.write_shift(2,Ce),ae.write_shift(2,~Ce&65535);Ce-- >0;)ae[ae.l++]=pe[ce++];oe=ae.l*8;continue}oe=yt(ae,oe,+(ce+Ce==pe.length)+2);for(var Ne=0;Ce-- >0;){var be=pe[ce];Ne=(Ne<<5^be)&32767;var ke=-1,Ue=0;if((ke=Ee[Ne])&&(ke|=ce&-32768,ke>ce&&(ke-=32768),ke<ce))for(;pe[ke+Ue]==pe[ce+Ue]&&Ue<250;)++Ue;if(Ue>2){be=W[Ue],be<=22?oe=Et(ae,oe,ve[be+1]>>1)-1:(Et(ae,oe,3),oe+=5,Et(ae,oe,ve[be-23]>>5),oe+=3);var qe=be<8?0:be-4>>2;qe>0&&(lr(ae,oe,Ue-ee[be]),oe+=qe),be=z[ce-ke],oe=Et(ae,oe,ve[be]>>3),oe-=3;var Je=be<4?0:be-2>>1;Je>0&&(lr(ae,oe,ce-ke-ge[be]),oe+=Je);for(var ot=0;ot<Ue;++ot)Ee[Ne]=ce&32767,Ne=(Ne<<5^pe[ce])&32767,++ce;Ce-=Ue-1}else be<=143?be=be+48:oe=wt(ae,oe,1),oe=Et(ae,oe,ve[be]),Ee[Ne]=ce&32767,++ce}oe=Et(ae,oe,0)-1}return ae.l=(oe+7)/8|0,ae.l}return function(ae,oe){return ae.length<8?H(ae,oe):ie(ae,oe)}}();function ze(F){var z=new_buf(50+Math.floor(F.length*1.1)),O=jt(F,z);return z.slice(0,O)}var Ke=de?new Uint16Array(32768):St(32768),Nt=de?new Uint16Array(32768):St(32768),at=de?new Uint16Array(128):St(128),rr=1,ms=1;function An(F,z){var O=We(F,z)+257;z+=5;var B=We(F,z)+1;z+=5;var W=Ye(F,z)+4;z+=4;for(var H=0,ie=de?new Uint8Array(19):St(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,oe=de?new Uint8Array(8):St(8),ce=de?new Uint8Array(8):St(8),Ee=ie.length,Ce=0;Ce<W;++Ce)ie[V[Ce]]=H=Ve(F,z),ae<H&&(ae=H),oe[H]++,z+=3;var Ne=0;for(oe[0]=0,Ce=1;Ce<=ae;++Ce)ce[Ce]=Ne=Ne+oe[Ce-1]<<1;for(Ce=0;Ce<Ee;++Ce)(Ne=ie[Ce])!=0&&(pe[Ce]=ce[Ne]++);var be=0;for(Ce=0;Ce<Ee;++Ce)if(be=ie[Ce],be!=0){Ne=ve[pe[Ce]]>>8-be;for(var ke=(1<<7-be)-1;ke>=0;--ke)at[Ne|ke<<be]=be&7|Ce<<3}var Ue=[];for(ae=1;Ue.length<O+B;)switch(Ne=at[Re(F,z)],z+=Ne&7,Ne>>>=3){case 16:for(H=3+Xe(F,z),z+=2,Ne=Ue[Ue.length-1];H-- >0;)Ue.push(Ne);break;case 17:for(H=3+Ve(F,z),z+=3;H-- >0;)Ue.push(0);break;case 18:for(H=11+Re(F,z),z+=7;H-- >0;)Ue.push(0);break;default:Ue.push(Ne),ae<Ne&&(ae=Ne);break}var qe=Ue.slice(0,O),Je=Ue.slice(O);for(Ce=O;Ce<286;++Ce)qe[Ce]=0;for(Ce=B;Ce<30;++Ce)Je[Ce]=0;return rr=zt(qe,Ke,286),ms=zt(Je,Nt,30),z}function Dn(F,z){if(F[0]==3&&!(F[1]&3))return[new_raw_buf(z),2];for(var O=0,B=0,W=new_unsafe_buf(z||1<<18),H=0,ie=W.length>>>0,pe=0,ae=0;(B&1)==0;){if(B=Ve(F,O),O+=3,B>>>1)B>>1==1?(pe=9,ae=5):(O=An(F,O),pe=rr,ae=ms);else{O&7&&(O+=8-(O&7));var oe=F[O>>>3]|F[(O>>>3)+1]<<8;if(O+=32,oe>0)for(!z&&ie<H+oe&&(W=Gt(W,H+oe),ie=W.length);oe-- >0;)W[H++]=F[O>>>3],O+=8;continue}for(;;){!z&&ie<H+32767&&(W=Gt(W,H+32767),ie=W.length);var ce=tt(F,O,pe),Ee=B>>>1==1?Kt[ce]:Ke[ce];if(O+=Ee&15,Ee>>>=4,(Ee>>>8&255)===0)W[H++]=Ee;else{if(Ee==256)break;Ee-=257;var Ce=Ee<8?0:Ee-4>>2;Ce>5&&(Ce=0);var Ne=H+ee[Ee];Ce>0&&(Ne+=tt(F,O,Ce),O+=Ce),ce=tt(F,O,ae),Ee=B>>>1==1?cr[ce]:Nt[ce],O+=Ee&15,Ee>>>=4;var be=Ee<4?0:Ee-2>>1,ke=ge[Ee];for(be>0&&(ke+=tt(F,O,be),O+=be),!z&&ie<Ne&&(W=Gt(W,Ne+100),ie=W.length);H<Ne;)W[H]=W[H-ke],++H}}}return z?[W,O+7>>>3]:[W.slice(0,H),O+7>>>3]}function sn(F,z){var O=F.slice(F.l||0),B=Dn(O,z);return F.l+=B[1],B[0]}function an(F,z){if(F)typeof console<"u"&&console.error(z);else throw new Error(z)}function on(F,z){var O=F;prep_blob(O,0);var B=[],W=[],H={FileIndex:B,FullPaths:W};N(H,{root:z.root});for(var ie=O.length-4;(O[ie]!=80||O[ie+1]!=75||O[ie+2]!=5||O[ie+3]!=6)&&ie>=0;)--ie;O.l=ie+4,O.l+=4;var pe=O.read_shift(2);O.l+=6;var ae=O.read_shift(4);for(O.l=ae,ie=0;ie<pe;++ie){O.l+=20;var oe=O.read_shift(4),ce=O.read_shift(4),Ee=O.read_shift(2),Ce=O.read_shift(2),Ne=O.read_shift(2);O.l+=8;var be=O.read_shift(4),ke=c(O.slice(O.l+Ee,O.l+Ee+Ce));O.l+=Ee+Ce+Ne;var Ue=O.l;O.l=be+4,vr(O,oe,ce,H,ke),O.l=Ue}return H}function vr(F,z,O,B,W){F.l+=2;var H=F.read_shift(2),ie=F.read_shift(2),pe=o(F);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ae=F.read_shift(4),oe=F.read_shift(4),ce=F.read_shift(4),Ee=F.read_shift(2),Ce=F.read_shift(2),Ne="",be=0;be<Ee;++be)Ne+=String.fromCharCode(F[F.l++]);if(Ce){var ke=c(F.slice(F.l,F.l+Ce));(ke[21589]||{}).mt&&(pe=ke[21589].mt),((W||{})[21589]||{}).mt&&(pe=W[21589].mt)}F.l+=Ce;var Ue=F.slice(F.l,F.l+oe);switch(ie){case 8:Ue=q(F,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var qe=!1;H&8&&(ae=F.read_shift(4),ae==134695760&&(ae=F.read_shift(4),qe=!0),oe=F.read_shift(4),ce=F.read_shift(4)),oe!=z&&an(qe,"Bad compressed size: "+z+" != "+oe),ce!=O&&an(qe,"Bad uncompressed size: "+O+" != "+ce),ur(B,Ne,Ue,{unsafe:!0,mt:pe})}function yr(F,z){var O=z||{},B=[],W=[],H=new_buf(1),ie=O.compression?8:0,pe=0,ae=0,oe=0,ce=0,Ee=0,Ce=F.FullPaths[0],Ne=Ce,be=F.FileIndex[0],ke=[],Ue=0;for(ae=1;ae<F.FullPaths.length;++ae)if(Ne=F.FullPaths[ae].slice(Ce.length),be=F.FileIndex[ae],!(!be.size||!be.content||Ne=="Sh33tJ5")){var qe=ce,Je=new_buf(Ne.length);for(oe=0;oe<Ne.length;++oe)Je.write_shift(1,Ne.charCodeAt(oe)&127);Je=Je.slice(0,Je.l),ke[Ee]=CRC32.buf(be.content,0);var ot=be.content;ie==8&&(ot=P(ot)),H=new_buf(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,pe),H.write_shift(2,ie),be.mt?i(H,be.mt):H.write_shift(4,0),H.write_shift(-4,ke[Ee]),H.write_shift(4,ot.length),H.write_shift(4,be.content.length),H.write_shift(2,Je.length),H.write_shift(2,0),ce+=H.length,B.push(H),ce+=Je.length,B.push(Je),ce+=ot.length,B.push(ot),H=new_buf(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,pe),H.write_shift(2,ie),H.write_shift(4,0),H.write_shift(-4,ke[Ee]),H.write_shift(4,ot.length),H.write_shift(4,be.content.length),H.write_shift(2,Je.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,qe),Ue+=H.l,W.push(H),Ue+=Je.length,W.push(Je),++Ee}return H=new_buf(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Ee),H.write_shift(2,Ee),H.write_shift(4,Ue),H.write_shift(4,ce),H.write_shift(2,0),bconcat([bconcat(B),bconcat(W),H])}var Wr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xs(F,z){if(F.ctype)return F.ctype;var O=F.name||"",B=O.match(/\.([^\.]+)$/);return B&&Wr[B[1]]||z&&(B=(O=z).match(/[\.\\]([^\.\\])+$/),B&&Wr[B[1]])?Wr[B[1]]:"application/octet-stream"}function gs(F){for(var z=Base64_encode(F),O=[],B=0;B<z.length;B+=76)O.push(z.slice(B,B+76));return O.join(`\r
`)+`\r
`}function _s(F){var z=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var ce=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],B=z.split(`\r
`),W=0;W<B.length;++W){var H=B[W];if(H.length==0){O.push("");continue}for(var ie=0;ie<H.length;){var pe=76,ae=H.slice(ie,ie+pe);ae.charAt(pe-1)=="="?pe--:ae.charAt(pe-2)=="="?pe-=2:ae.charAt(pe-3)=="="&&(pe-=3),ae=H.slice(ie,ie+pe),ie+=pe,ie<H.length&&(ae+="="),O.push(ae)}}return O.join(`\r
`)}function vs(F){for(var z=[],O=0;O<F.length;++O){for(var B=F[O];O<=F.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+F[++O];z.push(B)}for(var W=0;W<z.length;++W)z[W]=z[W].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return s2a(z.join(`\r
`))}function Pn(F,z,O){for(var B="",W="",H="",ie,pe=0;pe<10;++pe){var ae=z[pe];if(!ae||ae.match(/^\s*$/))break;var oe=ae.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":B=oe[2].trim();break;case"content-type":H=oe[2].trim();break;case"content-transfer-encoding":W=oe[2].trim();break}}switch(++pe,W.toLowerCase()){case"base64":ie=s2a(Base64_decode(z.slice(pe).join("")));break;case"quoted-printable":ie=vs(z.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ce=ur(F,B.slice(O.length),ie,{unsafe:!0});H&&(ce.ctype=H)}function ys(F,z){if(J(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=z&&z.root||"",B=(has_buf&&Buffer.isBuffer(F)?F.toString("binary"):J(F)).split(`\r
`),W=0,H="";for(W=0;W<B.length;++W)if(H=B[W],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var ie=(B[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var pe="--"+(ie[1]||""),ae=[],oe=[],ce={FileIndex:ae,FullPaths:oe};N(ce);var Ee,Ce=0;for(W=0;W<B.length;++W){var Ne=B[W];Ne!==pe&&Ne!==pe+"--"||(Ce++&&Pn(ce,B.slice(Ee,W),O),Ee=W)}return ce}function Vr(F,z){var O=z||{},B=O.boundary||"SheetJS";B="------="+B;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],H=F.FullPaths[0],ie=H,pe=F.FileIndex[0],ae=1;ae<F.FullPaths.length;++ae)if(ie=F.FullPaths[ae].slice(H.length),pe=F.FileIndex[ae],!(!pe.size||!pe.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var oe=pe.content,ce=has_buf&&Buffer.isBuffer(oe)?oe.toString("binary"):J(oe),Ee=0,Ce=Math.min(1024,ce.length),Ne=0,be=0;be<=Ce;++be)(Ne=ce.charCodeAt(be))>=32&&Ne<128&&++Ee;var ke=Ee>=Ce*4/5;W.push(B),W.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ie),W.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),W.push("Content-Type: "+xs(pe,ie)),W.push(""),W.push(ke?_s(ce):gs(ce))}return W.push(B+`--\r
`),W.join(`\r
`)}function Ln(F){var z={};return N(z,F),z}function ur(F,z,O,B){var W=B&&B.unsafe;W||N(F);var H=!W&&CFB.find(F,z);if(!H){var ie=F.FullPaths[0];z.slice(0,ie.length)==ie?ie=z:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+z).replace("//","/")),H={name:a(z),type:2},F.FileIndex.push(H),F.FullPaths.push(ie),W||CFB.utils.cfb_gc(F)}return H.content=O,H.size=O?O.length:0,B&&(B.CLSID&&(H.clsid=B.CLSID),B.mt&&(H.mt=B.mt),B.ct&&(H.ct=B.ct)),H}function ka(F,z){N(F);var O=CFB.find(F,z);if(O){for(var B=0;B<F.FileIndex.length;++B)if(F.FileIndex[B]==O)return F.FileIndex.splice(B,1),F.FullPaths.splice(B,1),!0}return!1}function Hr(F,z,O){N(F);var B=CFB.find(F,z);if(B){for(var W=0;W<F.FileIndex.length;++W)if(F.FileIndex[W]==B)return F.FileIndex[W].name=a(O),F.FullPaths[W]=O,!0}return!1}function ln(F){M(F,!0)}return r.find=K,r.read=D,r.parse=h,r.write=fe,r.writeFile=he,r.utils={cfb_new:Ln,cfb_add:ur,cfb_del:ka,cfb_mov:Hr,cfb_gc:ln,ReadShift,CheckField,prep_blob,bconcat,use_zlib:A,_deflateRaw:ze,_inflateRaw:sn,consts:le},r}();function blobify(t){return typeof t=="string"?s2ab(t):Array.isArray(t)?a2u(t):t}function write_dl(t,r,n){if(typeof Deno<"u"){if(n&&typeof r=="string")switch(n){case"utf8":r=new TextEncoder(n).encode(r);break;case"binary":r=s2ab(r);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,r)}var s=n=="utf8"?utf8write(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var a=new Blob([blobify(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=a2s(r)),c.write(r),c.close(),r}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function read_binary(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var n=r.read();return r.close(),n}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+t)}function keys(t){for(var r=Object.keys(t),n=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(t,r[s])&&n.push(r[s]);return n}function evert_key(t,r){for(var n=[],s=keys(t),a=0;a!==s.length;++a)n[t[s[a]][r]]==null&&(n[t[s[a]][r]]=s[a]);return n}function evert(t){for(var r=[],n=keys(t),s=0;s!==n.length;++s)r[t[n[s]]]=n[s];return r}function evert_num(t){for(var r=[],n=keys(t),s=0;s!==n.length;++s)r[t[n[s]]]=parseInt(n[s],10);return r}function evert_arr(t){for(var r=[],n=keys(t),s=0;s!==n.length;++s)r[t[n[s]]]==null&&(r[t[n[s]]]=[]),r[t[n[s]]].push(n[s]);return r}var basedate=new Date(1899,11,30,0,0,0);function datenum(t,r){var n=t.getTime(),s=basedate.getTime()+(t.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(n-s)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(t){var r=new Date;return r.setTime(t*24*60*60*1e3+dnthresh),r.getTimezoneOffset()!==refoffset&&r.setTime(r.getTime()+(r.getTimezoneOffset()-refoffset)*6e4),r}function parse_isodur(t){var r=0,n=0,s=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(s=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(s)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=n*parseInt(a[i],10)}return r}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(t,r){var n=new Date(t);if(good_pd)return r>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):r<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(good_pd_date.getFullYear()==1917&&!isNaN(n.getFullYear())){var s=n.getFullYear();return t.indexOf(""+s)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function cc2str(t,r){if(has_buf&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return utf8write(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return utf8write(utf16beread(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return utf8write(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return utf8write(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return n[i]||i})}catch{}for(var s=[],a=0;a!=t.length;++a)s.push(String.fromCharCode(t[a]));return s.join("")}function dup(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=dup(t[n]));return r}function fill(t,r){for(var n="";n.length<r;)n+=t;return n}function fuzzynum(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var n=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,i){return n=-n,i}),!isNaN(r=Number(s)))?r/n:r}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(t){var r=new Date(t),n=new Date(NaN),s=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return n;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&lower_months.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return s<0||s>8099?n:(a>0||i>1)&&s!=101?r:t.match(/[^-0-9:,\/\\]/)?n:r}var split_regex=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,s,a){if(t||typeof s=="string")return n.split(s);for(var i=n.split(s),o=[i[0]],c=1;c<i.length;++c)o.push(a),o.push(i[c]);return o}}();function getdatastr(t){return t?t.content&&t.type?cc2str(t.content,!0):t.data?debom(t.data):t.asNodeBuffer&&has_buf?debom(t.asNodeBuffer().toString("binary")):t.asBinary?debom(t.asBinary()):t._data&&t._data.getContent?debom(cc2str(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function getdatabin(t){if(!t)return null;if(t.data)return char_codes(t.data);if(t.asNodeBuffer&&has_buf)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?char_codes(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function getdata(t){return t&&t.name.slice(-4)===".bin"?getdatabin(t):getdatastr(t)}function safegetzipfile(t,r){for(var n=t.FullPaths||keys(t.files),s=r.toLowerCase().replace(/[\/]/g,"\\"),a=s.replace(/\\/g,"/"),i=0;i<n.length;++i){var o=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||a==o)return t.files?t.files[n[i]]:t.FileIndex[i]}return null}function getzipfile(t,r){var n=safegetzipfile(t,r);if(n==null)throw new Error("Cannot find file "+r+" in zip");return n}function getzipdata(t,r,n){if(!n)return getdata(getzipfile(t,r));if(!r)return null;try{return getzipdata(t,r)}catch{return null}}function getzipstr(t,r,n){if(!n)return getdatastr(getzipfile(t,r));if(!r)return null;try{return getzipstr(t,r)}catch{return null}}function getzipbin(t,r,n){return getdatabin(getzipfile(t,r))}function zipentries(t){for(var r=t.FullPaths||keys(t.files),n=[],s=0;s<r.length;++s)r[s].slice(-1)!="/"&&n.push(r[s].replace(/^Root Entry[\/]/,""));return n.sort()}function zip_add_file(t,r,n){if(t.FullPaths){if(typeof n=="string"){var s;return has_buf?s=Buffer_from(n):s=utf8decode(n),CFB.utils.cfb_add(t,r,s)}CFB.utils.cfb_add(t,r,n)}else t.file(r,n)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(t,r){switch(r.type){case"base64":return CFB.read(t,{type:"base64"});case"binary":return CFB.read(t,{type:"binary"});case"buffer":case"array":return CFB.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function resolve_path(t,r){if(t.charAt(0)=="/")return t.slice(1);var n=r.split("/");r.slice(-1)!="/"&&n.pop();for(var s=t.split("/");s.length!==0;){var a=s.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(t,r,n){for(var s={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(r||(s[0]=t.slice(0,a)),a===t.length)return s;var o=t.match(attregexg),c=0,f="",d=0,h="",m="",g=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(g=(a=m.charCodeAt(i+1))==34||a==39?1:0,f=m.slice(i+1+g,m.length-g),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),s[h]=f,s[h.toLowerCase()]=f;else{var v=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(s[v]&&h.slice(c-3,c)=="ext")continue;s[v]=f,s[v.toLowerCase()]=f}}return s}function strip_ns(t){return t.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function n(s){var a=s+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,f){return encodings[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,f){return String.fromCharCode(parseInt(f,16))});var o=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,o)+n(a.slice(o+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(t){var r=t+"";return r.replace(decregex,function(n){return rencoding[n]}).replace(charegex,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(t){return escapexml(t).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(t){var r=t+"";return r.replace(decregex,function(n){return rencoding[n]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(t){var r=t+"";return r.replace(decregex,function(n){return rencoding[n]}).replace(htmlcharegex,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var t=/&#(\d+);/g;function r(n,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(t,r)}}();function xlml_unfixstr(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(t){for(var r="",n=0,s=0,a=0,i=0,o=0,c=0;n<t.length;){if(s=t.charCodeAt(n++),s<128){r+=String.fromCharCode(s);continue}if(a=t.charCodeAt(n++),s>191&&s<224){o=(s&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(i=t.charCodeAt(n++),s<240){r+=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(n++),c=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function utf8readb(t){var r=new_raw_buf(2*t.length),n,s,a=1,i=0,o=0,c;for(s=0;s<t.length;s+=a)a=1,(c=t.charCodeAt(s))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(s+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(r[i++]=o&255,r[i++]=o>>>8,o=0),r[i++]=n%256,r[i++]=n>>>8;return r.slice(0,i).toString("ucs2")}function utf8readc(t){return Buffer_from(t,"binary").toString("utf8")}var utf8corpus="foo bar bazâð£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(t){return Buffer_from(t,"utf8").toString("binary")}:function(t){for(var r=[],n=0,s=0,a=0;n<t.length;)switch(s=t.charCodeAt(n++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=t.charCodeAt(n++)-56320+(s<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},matchtag=function(){var t={};return function(n,s){var a=n+"|"+(s||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",s||"")}}(),htmldecode=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(n){for(var s=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)s=s.replace(t[a][0],t[a][1]);return s}}(),vtregex=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(t,r){var n=parsexmltag(t),s=t.match(vtregex(n.baseType))||[],a=[];if(s.length!=n.size){if(r.WTF)throw new Error("unexpected vector length "+s.length+" != "+n.size);return a}return s.forEach(function(i){var o=i.replace(vtvregex,"").match(vtmregex);o&&a.push({v:utf8read(o[2]),t:o[1]})}),a}var wtregex=/(^\s|\s$|\n)/;function writetag(t,r){return"<"+t+(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function wxt_helper(t){return keys(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function writextag(t,r,n){return"<"+t+(n!=null?wxt_helper(n):"")+(r!=null?(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function write_w3cdtf(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(r)throw n}return""}function write_vt(t,r){switch(typeof t){case"string":var n=writextag("vt:lpwstr",escapexml(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return writextag((t|0)==t?"vt:i4":"vt:r8",escapexml(String(t)));case"boolean":return writextag("vt:bool",t?"true":"false")}if(t instanceof Date)return writextag("vt:filetime",write_w3cdtf(t));throw new Error("Unable to serialize "+t)}function xlml_normalize(t){if(has_buf&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return utf8read(a2s(ab2a(t)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(t,r){for(var n=1-2*(t[r+7]>>>7),s=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,i=5;i>=0;--i)a=a*256+t[r+i];return s==2047?a==0?n*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),n*Math.pow(2,s-52)*a)}function write_double_le(t,r,n){var s=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,o=s?-r:r;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var c=0;c<=5;++c,i/=256)t[n+c]=i&255;t[n+6]=(a&15)<<4|i&15,t[n+7]=a>>4|s}var ___toBuffer=function(t){for(var r=[],n=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var a=0,i=t[0][s].length;a<i;a+=n)r.push.apply(r,t[0][s].slice(a,a+n));return r},__toBuffer=has_buf?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)})):___toBuffer(t)}:___toBuffer,___utf16le=function(t,r,n){for(var s=[],a=r;a<n;a+=2)s.push(String.fromCharCode(__readUInt16LE(t,a)));return s.join("").replace(chr0,"")},__utf16le=has_buf?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf16le",r,n).replace(chr0,""):___utf16le(t,r,n)}:___utf16le,___hexlify=function(t,r,n){for(var s=[],a=r;a<r+n;++a)s.push(("0"+t[a].toString(16)).slice(-2));return s.join("")},__hexlify=has_buf?function(t,r,n){return Buffer.isBuffer(t)?t.toString("hex",r,r+n):___hexlify(t,r,n)}:___hexlify,___utf8=function(t,r,n){for(var s=[],a=r;a<n;a++)s.push(String.fromCharCode(__readUInt8(t,a)));return s.join("")},__utf8=has_buf?function(r,n,s){return Buffer.isBuffer(r)?r.toString("utf8",n,s):___utf8(r,n,s)}:___utf8,___lpstr=function(t,r){var n=__readUInt32LE(t,r);return n>0?__utf8(t,r+4,r+4+n-1):""},__lpstr=___lpstr,___cpstr=function(t,r){var n=__readUInt32LE(t,r);return n>0?__utf8(t,r+4,r+4+n-1):""},__cpstr=___cpstr,___lpwstr=function(t,r){var n=2*__readUInt32LE(t,r);return n>0?__utf8(t,r+4,r+4+n-1):""},__lpwstr=___lpwstr,___lpp4=function(r,n){var s=__readUInt32LE(r,n);return s>0?__utf16le(r,n+4,n+4+s):""},__lpp4=___lpp4,___8lpp4=function(t,r){var n=__readUInt32LE(t,r);return n>0?__utf8(t,r+4,r+4+n):""},__8lpp4=___8lpp4,___double=function(t,r){return read_double_le(t,r)},__double=___double,is_buf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};has_buf&&(__lpstr=function(r,n){if(!Buffer.isBuffer(r))return ___lpstr(r,n);var s=r.readUInt32LE(n);return s>0?r.toString("utf8",n+4,n+4+s-1):""},__cpstr=function(r,n){if(!Buffer.isBuffer(r))return ___cpstr(r,n);var s=r.readUInt32LE(n);return s>0?r.toString("utf8",n+4,n+4+s-1):""},__lpwstr=function(r,n){if(!Buffer.isBuffer(r))return ___lpwstr(r,n);var s=2*r.readUInt32LE(n);return r.toString("utf16le",n+4,n+4+s-1)},__lpp4=function(r,n){if(!Buffer.isBuffer(r))return ___lpp4(r,n);var s=r.readUInt32LE(n);return r.toString("utf16le",n+4,n+4+s)},__8lpp4=function(r,n){if(!Buffer.isBuffer(r))return ___8lpp4(r,n);var s=r.readUInt32LE(n);return r.toString("utf8",n+4,n+4+s)},__double=function(r,n){return Buffer.isBuffer(r)?r.readDoubleLE(n):___double(r,n)},is_buf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var __readUInt8=function(t,r){return t[r]},__readUInt16LE=function(t,r){return t[r+1]*256+t[r]},__readInt16LE=function(t,r){var n=t[r+1]*256+t[r];return n<32768?n:(65535-n+1)*-1},__readUInt32LE=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},__readInt32LE=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},__readInt32BE=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function ReadShift(t,r){var n="",s,a,i=[],o,c,f,d;switch(r){case"dbcs":if(d=this.l,has_buf&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)n+=String.fromCharCode(__readUInt16LE(this,d)),d+=2;t*=2;break;case"utf8":n=__utf8(this,this.l,this.l+t);break;case"utf16le":t*=2,n=__utf16le(this,this.l,this.l+t);break;case"wstr":return ReadShift.call(this,t,"dbcs");case"lpstr-ansi":n=__lpstr(this,this.l),t=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":n=__cpstr(this,this.l),t=4+__readUInt32LE(this,this.l);break;case"lpwstr":n=__lpwstr(this,this.l),t=4+2*__readUInt32LE(this,this.l);break;case"lpp4":t=4+__readUInt32LE(this,this.l),n=__lpp4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+__readUInt32LE(this,this.l),n=__8lpp4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(o=__readUInt8(this,this.l+t++))!==0;)i.push(_getchar(o));n=i.join("");break;case"_wstr":for(t=0,n="";(o=__readUInt16LE(this,this.l+t))!==0;)i.push(_getchar(o)),t+=2;t+=2,n=i.join("");break;case"dbcs-cont":for(n="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=__readUInt8(this,d),this.l=d+1,c=ReadShift.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_getchar(__readUInt16LE(this,d))),d+=2}n=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=__readUInt8(this,d),this.l=d+1,c=ReadShift.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_getchar(__readUInt8(this,d))),d+=1}n=i.join("");break;default:switch(t){case 1:return s=__readUInt8(this,this.l),this.l++,s;case 2:return s=(r==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(s=(t>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,s):(a=__readUInt32LE(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=__double(this,this.l):a=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=__hexlify(this,this.l,t);break}}return this.l+=t,n}var __writeUInt32LE=function(t,r,n){t[n]=r&255,t[n+1]=r>>>8&255,t[n+2]=r>>>16&255,t[n+3]=r>>>24&255},__writeInt32LE=function(t,r,n){t[n]=r&255,t[n+1]=r>>8&255,t[n+2]=r>>16&255,t[n+3]=r>>24&255},__writeUInt16LE=function(t,r,n){t[n]=r&255,t[n+1]=r>>>8&255};function WriteShift(t,r,n){var s=0,a=0;if(n==="dbcs"){for(a=0;a!=r.length;++a)__writeUInt16LE(this,r.charCodeAt(a),this.l+2*a);s=2*r.length}else if(n==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;s=r.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,__writeUInt32LE(this,r,this.l);break;case 8:if(s=8,n==="f"){write_double_le(this,r,this.l);break}case 16:break;case-4:s=4,__writeInt32LE(this,r,this.l);break}return this.l+=s,this}function CheckField(t,r){var n=__hexlify(this,this.l,t.length>>1);if(n!==t)throw new Error(r+"Expected "+t+" saw "+n);this.l+=t.length>>1}function prep_blob(t,r){t.l=r,t.read_shift=ReadShift,t.chk=CheckField,t.write_shift=WriteShift}function parsenoop(t,r){t.l+=r}function new_buf(t){var r=new_raw_buf(t);return prep_blob(r,0),r}function recordhopper(t,r,n){if(t){var s,a,i;prep_blob(t,t.l||0);for(var o=t.length,c=0,f=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=XLSBRecordEnum[c]||XLSBRecordEnum[65535];for(s=t.read_shift(1),i=s&127,a=1;a<4&&s&128;++a)i+=((s=t.read_shift(1))&127)<<7*a;f=t.l+i;var h=d.f&&d.f(t,i,n);if(t.l=f,r(h,d,c))return}}}function buf_array(){var t=[],r=has_buf?256:2048,n=function(d){var h=new_buf(d);return prep_blob(h,0),h},s=n(r),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},i=function(d){return s&&d<s.length-s.l?s:(a(),s=n(Math.max(d+1,r)))},o=function(){return a(),bconcat(t)},c=function(d){a(),s=d,s.l==null&&(s.l=s.length),i(r)};return{next:i,push:c,end:o,_bufs:t}}function write_record(t,r,n,s){var a=+r,i;if(!isNaN(a)){s||(s=XLSBRecordEnum[a].p||(n||[]).length||0),i=1+(a>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&is_buf(n)&&t.push(n)}}function shift_cell_xls(t,r,n){var s=dup(t);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!n||n.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function shift_range_xls(t,r,n){var s=dup(t);return s.s=shift_cell_xls(s.s,r.s,n),s.e=shift_cell_xls(s.e,r.s,n),s}function encode_cell_xls(t,r){if(t.cRel&&t.c<0)for(t=dup(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=dup(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var n=encode_cell(t);return!t.cRel&&t.cRel!=null&&(n=fix_col(n)),!t.rRel&&t.rRel!=null&&(n=fix_row(n)),n}function encode_range_xls(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+encode_col(t.s.c)+":"+(t.e.cRel?"":"$")+encode_col(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+encode_row(t.s.r)+":"+(t.e.rRel?"":"$")+encode_row(t.e.r):encode_cell_xls(t.s,r.biff)+":"+encode_cell_xls(t.e,r.biff)}function decode_row(t){return parseInt(unfix_row(t),10)-1}function encode_row(t){return""+(t+1)}function fix_row(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(t){return t.replace(/\$(\d+)$/,"$1")}function decode_col(t){for(var r=unfix_col(t),n=0,s=0;s!==r.length;++s)n=26*n+r.charCodeAt(s)-64;return n-1}function encode_col(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function fix_col(t){return t.replace(/^([A-Z])/,"$$$1")}function unfix_col(t){return t.replace(/^\$([A-Z])/,"$1")}function split_cell(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(t){for(var r=0,n=0,s=0;s<t.length;++s){var a=t.charCodeAt(s);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:r-1}}function encode_cell(t){for(var r=t.c+1,n="";r;r=(r-1)/26|0)n=String.fromCharCode((r-1)%26+65)+n;return n+(t.r+1)}function decode_range(t){var r=t.indexOf(":");return r==-1?{s:decode_cell(t),e:decode_cell(t)}:{s:decode_cell(t.slice(0,r)),e:decode_cell(t.slice(r+1))}}function encode_range(t,r){return typeof r>"u"||typeof r=="number"?encode_range(t.s,t.e):(typeof t!="string"&&(t=encode_cell(t)),typeof r!="string"&&(r=encode_cell(r)),t==r?t:t+":"+r)}function safe_decode_range(t){var r={s:{c:0,r:0},e:{c:0,r:0}},n=0,s=0,a=0,i=t.length;for(n=0;s<i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)n=26*n+a;for(r.s.c=--n,n=0;s<i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)n=10*n+a;if(r.s.r=--n,s===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,n=0;s!=i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)n=26*n+a;for(r.e.c=--n,n=0;s!=i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)n=10*n+a;return r.e.r=--n,r}function safe_format_cell(t,r){var n=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=SSF_format(t.z,n?datenum(r):r)}catch{}try{return t.w=SSF_format((t.XF||{}).numFmtId||(n?14:0),n?datenum(r):r)}catch{return""+r}}function format_cell(t,r,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?BErr[t.v]||t.v:r==null?safe_format_cell(t,t.v):safe_format_cell(t,r))}function sheet_to_workbook(t,r){var n=r&&r.sheet?r.sheet:"Sheet1",s={};return s[n]=t,{SheetNames:[n],Sheets:s}}function sheet_add_aoa(t,r,n){var s=n||{},a=t?Array.isArray(t):s.dense,i=t||(a?[]:{}),o=0,c=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var f=typeof s.origin=="string"?decode_cell(s.origin):s.origin;o=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=safe_decode_range(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var m=0;m!=r.length;++m)if(r[m]){if(!Array.isArray(r[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=r[m].length;++g)if(!(typeof r[m][g]>"u")){var v={v:r[m][g]},y=o+m,_=c+g;if(d.s.r>y&&(d.s.r=y),d.s.c>_&&(d.s.c=_),d.e.r<y&&(d.e.r=y),d.e.c<_&&(d.e.c=_),r[m][g]&&typeof r[m][g]=="object"&&!Array.isArray(r[m][g])&&!(r[m][g]instanceof Date))v=r[m][g];else if(Array.isArray(v.v)&&(v.f=r[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(s.nullError)v.t="e",v.v=0;else if(s.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=s.dateNF||table_fmt[14],s.cellDates?(v.t="d",v.w=SSF_format(v.z,datenum(v.v))):(v.t="n",v.v=datenum(v.v),v.w=SSF_format(v.z,v.v))):v.t="s";if(a)i[y]||(i[y]=[]),i[y][_]&&i[y][_].z&&(v.z=i[y][_].z),i[y][_]=v;else{var w=encode_cell({c:_,r:y});i[w]&&i[w].z&&(v.z=i[w].z),i[w]=v}}}return d.s.c<1e7&&(i["!ref"]=encode_range(d)),i}function aoa_to_sheet(t,r){return sheet_add_aoa(null,t,r)}function parse_Int32LE(t){return t.read_shift(4,"i")}function write_UInt32LE(t,r){return r||(r=new_buf(4)),r.write_shift(4,t),r}function parse_XLWideString(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function write_XLWideString(t,r){var n=!1;return r==null&&(n=!0,r=new_buf(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),n?r.slice(0,r.l):r}function parse_StrRun(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function write_StrRun(t,r){return r||(r=new_buf(4)),r.write_shift(2,0),r.write_shift(2,0),r}function parse_RichStr(t,r){var n=t.l,s=t.read_shift(1),a=parse_XLWideString(t),i=[],o={t:a,h:a};if((s&1)!==0){for(var c=t.read_shift(4),f=0;f!=c;++f)i.push(parse_StrRun(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=n+r,o}function write_RichStr(t,r){var n=!1;return r==null&&(n=!0,r=new_buf(15+4*t.t.length)),r.write_shift(1,0),write_XLWideString(t.t,r),n?r.slice(0,r.l):r}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(t,r){var n=!1;return r==null&&(n=!0,r=new_buf(23+4*t.t.length)),r.write_shift(1,1),write_XLWideString(t.t,r),r.write_shift(4,1),write_StrRun({},r),n?r.slice(0,r.l):r}function parse_XLSBCell(t){var r=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:n}}function write_XLSBCell(t,r){return r==null&&(r=new_buf(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function parse_XLSBShortCell(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function write_XLSBShortCell(t,r){return r==null&&(r=new_buf(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function write_XLNullableWideString(t,r){var n=!1;return r==null&&(n=!0,r=new_buf(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),n?r.slice(0,r.l):r}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(t){var r=t.slice(t.l,t.l+4),n=r[0]&1,s=r[0]&2;t.l+=4;var a=s===0?__double([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):__readInt32LE(r,0)>>2;return n?a/100:a}function write_RkNumber(t,r){r==null&&(r=new_buf(4));var n=0,s=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,n=1),s)r.write_shift(-4,((n?a:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function parse_RfX(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function write_RfX(t,r){return r||(r=new_buf(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function write_Xnum(t,r){return(r||new_buf(8)).write_shift(8,t,"f")}function parse_BrtColor(t){var r={},n=t.read_shift(1),s=n>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(1);switch(t.l++,s){case 0:r.auto=1;break;case 1:r.index=a;var d=XLSIcv[a];d&&(r.rgb=rgb2Hex(d));break;case 2:r.rgb=rgb2Hex([o,c,f]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function write_BrtColor(t,r){if(r||(r=new_buf(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),r.write_shift(2,n),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function parse_FontFlags(t){var r=t.read_shift(1);t.l++;var n={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return n}function write_FontFlags(t,r){r||(r=new_buf(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,n),r.write_shift(1,0),r}function parse_ClipboardFormatOrString(t,r){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=t.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(t){return parse_ClipboardFormatOrString(t,1)}function parse_ClipboardFormatOrUnicodeString(t){return parse_ClipboardFormatOrString(t,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(t){var r=new_ct();if(!t||!t.match)return r;var n={};if((t.match(tagregex)||[]).forEach(function(s){var a=parsexmltag(s);switch(a[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":r[ct2type[a.ContentType]]!==void 0&&r[ct2type[a.ContentType]].push(a.PartName);break}}),r.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=n,delete r.calcchains,r}function write_ct(t,r){var n=evert_arr(ct2type),s=[],a;s[s.length]=XML_HEADER,s[s.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return writextag("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],s[s.length]=writextag("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:CT_LIST[f][r.bookType]||CT_LIST[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(d){s[s.length]=writextag("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:CT_LIST[f][r.bookType]||CT_LIST[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(d){s[s.length]=writextag("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function parse_rels(t,r){var n={"!id":{}};if(!t)return n;r.charAt(0)!=="/"&&(r="/"+r);var s={};return(t.match(tagregex)||[]).forEach(function(a){var i=parsexmltag(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:resolve_path(i.Target,r);n[c]=o,s[i.Id]=o}}),n["!id"]=s,n}function write_rels(t){var r=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(t["!id"]).forEach(function(n){r[r.length]=writextag("Relationship",null,t["!id"][n])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function add_rels(t,r,n,s,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,a.Id="rId"+r,a.Type=s,a.Target=n,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,r}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(t,r){for(var n=xlml_normalize(t),s,a;s=xlmlregex.exec(n);)switch(s[3]){case"manifest":break;case"file-entry":if(a=parsexmltag(s[0],!1),a.path=="/"&&a.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw s}}function write_manifest(t){var r=[XML_HEADER];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)r.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function write_rdf_type(t,r,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(t){var r=[XML_HEADER];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)r.push(write_rdf_type(t[n][0],t[n][1])),r.push(write_rdf_has("",t[n][0]));return r.push(write_rdf_type("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var t=new Array(CORE_PROPS.length),r=0;r<CORE_PROPS.length;++r){var n=CORE_PROPS[r],s="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[r]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return t}();function parse_core_props(t){var r={};t=utf8read(t);for(var n=0;n<CORE_PROPS.length;++n){var s=CORE_PROPS[n],a=t.match(CORE_PROPS_REGEX[n]);a!=null&&a.length>0&&(r[s[1]]=unescapexml(a[1])),s[2]==="date"&&r[s[1]]&&(r[s[1]]=parseDate(r[s[1]]))}return r}function cp_doit(t,r,n,s,a){a[t]!=null||r==null||r===""||(a[t]=r,r=escapexml(r),s[s.length]=n?writextag(t,r,n):writetag(t,r))}function write_core_props(t,r){var n=r||{},s=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],a={};if(!t&&!n.Props)return s.join("");t&&(t.CreatedDate!=null&&cp_doit("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:write_w3cdtf(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),t.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:write_w3cdtf(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var i=0;i!=CORE_PROPS.length;++i){var o=CORE_PROPS[i],c=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&cp_doit(o[0],c,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(t,r,n,s){var a=[];if(typeof t=="string")a=parseVector(t,s);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(h){return{v:h}}));var o=typeof r=="string"?parseVector(r,s).map(function(h){return h.v}):r,c=0,f=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=f,n.SheetNames=o.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=f,n.DefinedNames=o.slice(c,c+f);break;case"Charts":case"Diagramme":n.Chartsheets=f,n.ChartNames=o.slice(c,c+f);break}c+=f}}function parse_ext_props(t,r,n){var s={};return r||(r={}),t=utf8read(t),EXT_PROPS.forEach(function(a){var i=(t.match(matchtag(a[0]))||[])[1];switch(a[2]){case"string":i&&(r[a[1]]=unescapexml(i));break;case"bool":r[a[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(s[a[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&load_props_pairs(s.HeadingPairs,s.TitlesOfParts,r,n),r}function write_ext_props(t){var r=[],n=writextag;return t||(t={}),t.Application="SheetJS",r[r.length]=XML_HEADER,r[r.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(s){if(t[s[1]]!==void 0){var a;switch(s[2]){case"string":a=escapexml(String(t[s[1]]));break;case"bool":a=t[s[1]]?"true":"false";break}a!==void 0&&(r[r.length]=n(s[0],a))}}),r[r.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+escapexml(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(t,r){var n={},s="",a=t.match(custregex);if(a)for(var i=0;i!=a.length;++i){var o=a[i],c=parsexmltag(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":s=unescapexml(c.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":n[s]=unescapexml(h);break;case"bool":n[s]=parsexmlbool(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[s]=parseInt(h,10);break;case"r4":case"r8":case"decimal":n[s]=parseFloat(h);break;case"filetime":case"date":n[s]=parseDate(h);break;case"cy":case"error":n[s]=unescapexml(h);break;default:if(d.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(r.WTF)throw new Error(o)}}}return n}function write_cust_props(t){var r=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!t)return r.join("");var n=1;return keys(t).forEach(function(a){++n,r[r.length]=writextag("property",write_vt(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:escapexml(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(t,r,n){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),r=evert_XLMLDPM[r]||r,t[r]=n}function xlml_write_docprops(t,r){var n=[];return keys(XLMLDocPropsMap).map(function(s){for(var a=0;a<CORE_PROPS.length;++a)if(CORE_PROPS[a][1]==s)return CORE_PROPS[a];for(a=0;a<EXT_PROPS.length;++a)if(EXT_PROPS[a][1]==s)return EXT_PROPS[a];throw s}).forEach(function(s){if(t[s[1]]!=null){var a=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t[s[1]];switch(s[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(writetag(XLMLDocPropsMap[s[1]]||s[1],a))}}),writextag("DocumentProperties",n.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(t,r){var n=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return t&&keys(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<CORE_PROPS.length;++o)if(i==CORE_PROPS[o][1])return;for(o=0;o<EXT_PROPS.length;++o)if(i==EXT_PROPS[o][1])return;for(o=0;o<n.length;++o)if(i==n[o])return;var c=t[i],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(writextag(escapexmltag(i),c,{"dt:dt":f}))}}),r&&keys(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=r[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),a.push(writextag(escapexmltag(i),o,{"dt:dt":c}))}}),"<"+s+' xmlns="'+XLMLNS.o+'">'+a.join("")+"</"+s+">"}function parse_FILETIME(t){var r=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,n=r.getTime()/1e3+11644473600,s=n%Math.pow(2,32),a=(n-s)/Math.pow(2,32);s*=1e7,a*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),a+=i);var o=new_buf(8);return o.write_shift(4,s),o.write_shift(4,a),o}function parse_lpstr(t,r,n){var s=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-s&3;)++t.l;return a}function parse_lpwstr(t,r,n){var s=t.read_shift(0,"lpwstr");return s}function parse_VtStringBase(t,r,n){return r===31?parse_lpwstr(t):parse_lpstr(t,r,n)}function parse_VtString(t,r,n){return parse_VtStringBase(t,r,n===!1?0:4)}function parse_VtUnalignedString(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(t,r,0)}function parse_VtVecLpwstrValue(t){for(var r=t.read_shift(4),n=[],s=0;s!=r;++s){var a=t.l;n[s]=t.read_shift(0,"lpwstr").replace(chr0,""),t.l-a&2&&(t.l+=2)}return n}function parse_VtVecUnalignedLpstrValue(t){for(var r=t.read_shift(4),n=[],s=0;s!=r;++s)n[s]=t.read_shift(0,"lpstr-cp").replace(chr0,"");return n}function parse_VtHeadingPair(t){var r=t.l,n=parse_TypedPropertyValue(t,VT_USTR);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var s=parse_TypedPropertyValue(t,VT_I4);return[n,s]}function parse_VtVecHeadingPairValue(t){for(var r=t.read_shift(4),n=[],s=0;s<r/2;++s)n.push(parse_VtHeadingPair(t));return n}function parse_dictionary(t,r){for(var n=t.read_shift(4),s={},a=0;a!=n;++a){var i=t.read_shift(4),o=t.read_shift(4);s[i]=t.read_shift(o,r===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),r===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),s}function parse_BLOB(t){var r=t.read_shift(4),n=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),n}function parse_ClipboardData(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function parse_TypedPropertyValue(t,r,n){var s=t.read_shift(2),a,i=n||{};if(t.l+=2,r!==VT_VARIANT&&s!==r&&VT_CUSTOM.indexOf(r)===-1&&!((r&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+r+" saw "+s);switch(r===VT_VARIANT?s:r){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return parse_lpstr(t,s,4).replace(chr0,"");case 31:return parse_lpwstr(t);case 64:return parse_FILETIME(t);case 65:return parse_BLOB(t);case 71:return parse_ClipboardData(t);case 80:return parse_VtString(t,s,!i.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(t,s).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(t);case 4126:case 4127:return s==4127?parse_VtVecLpwstrValue(t):parse_VtVecUnalignedLpstrValue(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+s)}}function write_TypedPropertyValue(t,r){var n=new_buf(4),s=new_buf(4);switch(n.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,r);break;case 5:s=new_buf(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=write_FILETIME(r);break;case 31:case 80:for(s=new_buf(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return bconcat([n,s])}function parse_PropertySet(t,r){var n=t.l,s=t.read_shift(4),a=t.read_shift(4),i=[],o=0,c=0,f=-1,d={};for(o=0;o!=a;++o){var h=t.read_shift(4),m=t.read_shift(4);i[o]=[h,m+n]}i.sort(function(T,k){return T[1]-k[1]});var g={};for(o=0;o!=a;++o){if(t.l!==i[o][1]){var v=!0;if(o>0&&r)switch(r[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,v=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],v=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],v=!1);break}if((!r||o==0)&&t.l<=i[o][1]&&(v=!1,t.l=i[o][1]),v)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(r){var y=r[i[o][0]];if(g[y.n]=parse_TypedPropertyValue(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(c=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(i[o][0]===1){if(c=g.CodePage=parse_TypedPropertyValue(t,VT_I2),set_cp(c),f!==-1){var _=t.l;t.l=i[f][1],d=parse_dictionary(t,c),t.l=_}}else if(i[o][0]===0){if(c===0){f=o,t.l=i[o+1][1];continue}d=parse_dictionary(t,c)}else{var w=d[i[o][0]],b;switch(t[t.l]){case 65:t.l+=4,b=parse_BLOB(t);break;case 30:t.l+=4,b=parse_VtString(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=parse_VtString(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=parsebool(t,4);break;case 64:t.l+=4,b=parseDate(parse_FILETIME(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[w]=b}}return t.l=n+s,g}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function write_PropertySet(t,r,n){var s=new_buf(8),a=[],i=[],o=8,c=0,f=new_buf(8),d=new_buf(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),o+=8+f.length,!r){d=new_buf(8),d.write_shift(4,0),a.unshift(d);var h=[new_buf(4)];for(h[0].write_shift(4,t.length),c=0;c<t.length;++c){var m=t[c][0];for(f=new_buf(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);h.push(f)}f=bconcat(h),i.unshift(f),o+=8+f.length}for(c=0;c<t.length;++c)if(!(r&&!r[t[c][0]])&&!(XLSPSSkip.indexOf(t[c][0])>-1||PseudoPropsPairs.indexOf(t[c][0])>-1)&&t[c][1]!=null){var g=t[c][1],v=0;if(r){v=+r[t[c][0]];var y=n[v];if(y.p=="version"&&typeof g=="string"){var _=g.split(".");g=(+_[0]<<16)+(+_[1]||0)}f=write_TypedPropertyValue(y.t,g)}else{var w=guess_property_type(g);w==-1&&(w=31,g=String(g)),f=write_TypedPropertyValue(w,g)}i.push(f),d=new_buf(8),d.write_shift(4,r?v:2+c),a.push(d),o+=8+f.length}var b=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,b),b+=i[c].length;return s.write_shift(4,o),s.write_shift(4,i.length),bconcat([s].concat(a).concat(i))}function parse_PropertySetStream(t,r,n){var s=t.content;if(!s)return{};prep_blob(s,0);var a,i,o,c,f=0;s.chk("feff","Byte Order: "),s.read_shift(2);var d=s.read_shift(4),h=s.read_shift(16);if(h!==CFB.utils.consts.HEADER_CLSID&&h!==n)throw new Error("Bad PropertySet CLSID "+h);if(a=s.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=s.read_shift(16),c=s.read_shift(4),a===1&&c!==s.l)throw new Error("Length mismatch: "+c+" !== "+s.l);a===2&&(o=s.read_shift(16),f=s.read_shift(4));var m=parse_PropertySet(s,r),g={SystemIdentifier:d};for(var v in m)g[v]=m[v];if(g.FMTID=i,a===1)return g;if(f-s.l==2&&(s.l+=2),s.l!==f)throw new Error("Length mismatch 2: "+s.l+" !== "+f);var y;try{y=parse_PropertySet(s,null)}catch{}for(v in y)g[v]=y[v];return g.FMTID=[i,o],g}function write_PropertySetStream(t,r,n,s,a,i){var o=new_buf(a?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,a?68:48);var f=write_PropertySet(t,n,s);if(c.push(f),a){var d=write_PropertySet(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),c.push(d)}return bconcat(c)}function parsenoop2(t,r){return t.read_shift(r),null}function writezeroes(t,r){r||(r=new_buf(t));for(var n=0;n<t;++n)r.write_shift(1,0);return r}function parslurp(t,r,n){for(var s=[],a=t.l+r;t.l<a;)s.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return s}function parsebool(t,r){return t.read_shift(r)===1}function writebool(t,r){return r||(r=new_buf(2)),r.write_shift(2,+!!t),r}function parseuint16(t){return t.read_shift(2,"u")}function writeuint16(t,r){return r||(r=new_buf(2)),r.write_shift(2,t),r}function parseuint16a(t,r){return parslurp(t,r,parseuint16)}function parse_Bes(t){var r=t.read_shift(1),n=t.read_shift(1);return n===1?r:r===1}function write_Bes(t,r,n){return n||(n=new_buf(2)),n.write_shift(1,r=="e"?+t:+!!t),n.write_shift(1,r=="e"?1:0),n}function parse_ShortXLUnicodeString(t,r,n){var s=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var o=s?t.read_shift(s,a):"";return o}function parse_XLUnicodeRichExtendedString(t){var r=t.read_shift(2),n=t.read_shift(1),s=n&4,a=n&8,i=1+(n&1),o=0,c,f={};a&&(o=t.read_shift(2)),s&&(c=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",h=r===0?"":t.read_shift(r,d);return a&&(t.l+=4*o),s&&(t.l+=c),f.t=h,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function write_XLUnicodeRichExtendedString(t){var r=t.t||"",n=new_buf(3);n.write_shift(2,r.length),n.write_shift(1,1);var s=new_buf(2*r.length);s.write_shift(2*r.length,r,"utf16le");var a=[n,s];return bconcat(a)}function parse_XLUnicodeStringNoCch(t,r,n){var s;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(r,"cpstr");if(n.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?s=t.read_shift(r,"sbcs-cont"):s=t.read_shift(r,"dbcs-cont"),s}function parse_XLUnicodeString(t,r,n){var s=t.read_shift(n&&n.biff==2?1:2);return s===0?(t.l++,""):parse_XLUnicodeStringNoCch(t,s,n)}function parse_XLUnicodeString2(t,r,n){if(n.biff>5)return parse_XLUnicodeString(t,r,n);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(t,r,n){return n||(n=new_buf(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function parse_ControlInfo(t){var r=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[r,n]}function parse_URLMoniker(t){var r=t.read_shift(4),n=t.l,s=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),t.l=n);var a=t.read_shift((s?r-24:r)>>1,"utf16le").replace(chr0,"");return s&&(t.l+=24),a}function parse_FileMoniker(t){for(var r=t.read_shift(2),n="";r-- >0;)n+="../";var s=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+s.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(chr0,"");return n+o}function parse_HyperlinkMoniker(t,r){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(t);case"0303000000000000c000000000000046":return parse_FileMoniker(t);default:throw new Error("Unsupported Moniker "+n)}}function parse_HyperlinkString(t){var r=t.read_shift(4),n=r>0?t.read_shift(r,"utf16le").replace(chr0,""):"";return n}function write_HyperlinkString(t,r){r||(r=new_buf(6+t.length*2)),r.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function parse_Hyperlink(t,r){var n=t.l+r,s=t.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var a=t.read_shift(2);t.l+=2;var i,o,c,f,d="",h,m;a&16&&(i=parse_HyperlinkString(t,n-t.l)),a&128&&(o=parse_HyperlinkString(t,n-t.l)),(a&257)===257&&(c=parse_HyperlinkString(t,n-t.l)),(a&257)===1&&(f=parse_HyperlinkMoniker(t,n-t.l)),a&8&&(d=parse_HyperlinkString(t,n-t.l)),a&32&&(h=t.read_shift(16)),a&64&&(m=parse_FILETIME(t)),t.l=n;var g=o||c||f||"";g&&d&&(g+="#"+d),g||(g="#"+d),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return h&&(v.guid=h),m&&(v.time=m),i&&(v.Tooltip=i),v}function write_Hyperlink(t){var r=new_buf(512),n=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),i=a>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)r.write_shift(4,o[n]);if(i==28)s=s.slice(1),write_HyperlinkString(s,r);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)r.write_shift(1,parseInt(o[n],16));var c=a>-1?s.slice(0,a):s;for(r.write_shift(4,2*(c.length+1)),n=0;n<c.length;++n)r.write_shift(2,c.charCodeAt(n));r.write_shift(2,0),i&8&&write_HyperlinkString(a>-1?s.slice(a+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)r.write_shift(1,parseInt(o[n],16));for(var f=0;s.slice(f*3,f*3+3)=="../"||s.slice(f*3,f*3+3)=="..\\";)++f;for(r.write_shift(2,f),r.write_shift(4,s.length-3*f+1),n=0;n<s.length-3*f;++n)r.write_shift(1,s.charCodeAt(n+3*f)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),n=0;n<6;++n)r.write_shift(4,0)}return r.slice(0,r.l)}function parse_LongRGBA(t){var r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1),a=t.read_shift(1);return[r,n,s,a]}function parse_LongRGB(t,r){var n=parse_LongRGBA(t);return n[3]=0,n}function parse_XLSCell(t){var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{r,c:n,ixfe:s}}function write_XLSCell(t,r,n,s){return s||(s=new_buf(6)),s.write_shift(2,t),s.write_shift(2,r),s.write_shift(2,n||0),s}function parse_frtHeader(t){var r=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:r,flags:n}}function parse_OptXLUnicodeString(t,r,n){return r===0?"":parse_XLUnicodeString2(t,r,n)}function parse_XTI(t,r,n){var s=n.biff>8?4:2,a=t.read_shift(s),i=t.read_shift(s,"i"),o=t.read_shift(s,"i");return[a,i,o]}function parse_RkRec(t){var r=t.read_shift(2),n=parse_RkNumber(t);return[r,n]}function parse_AddinUdf(t,r,n){t.l+=4,r-=4;var s=t.l+r,a=parse_ShortXLUnicodeString(t,r,n),i=t.read_shift(2);if(s-=t.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return t.l+=i,a}function parse_Ref8U(t){var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);return{s:{c:s,r},e:{c:a,r:n}}}function write_Ref8U(t,r){return r||(r=new_buf(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function parse_RefU(t){var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1);return{s:{c:s,r},e:{c:a,r:n}}}var parse_Ref=parse_RefU;function parse_FtCmo(t){t.l+=4;var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return t.l+=12,[n,r,s]}function parse_FtNts(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function parse_FtCf(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function parse_FtSkip(t){t.l+=2,t.l+=t.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(t,r){for(var n=t.l+r,s=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{s.push(FtTab[a](t,n-t.l))}catch{return t.l=n,s}}return t.l!=n&&(t.l=n),s}function parse_BOF(t,r){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),r-=2,r>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(r),n}function write_BOF(t,r,n){var s=1536,a=16;switch(n.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=new_buf(a);return i.write_shift(2,s),i.write_shift(2,r),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function parse_InterfaceHdr(t,r){return r===0||t.read_shift(2),1200}function parse_WriteAccess(t,r,n){if(n.enc)return t.l+=r,"";var s=t.l,a=parse_XLUnicodeString2(t,0,n);return t.read_shift(r+s-t.l),a}function write_WriteAccess(t,r){var n=!r||r.biff==8,s=new_buf(n?112:54);for(s.write_shift(r.biff==8?2:1,7),n&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(n?0:536870912));s.l<s.length;)s.write_shift(1,n?0:32);return s}function parse_WsBool(t,r,n){var s=n&&n.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function parse_BoundSheet8(t,r,n){var s=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=parse_ShortXLUnicodeString(t,0,n);return o.length===0&&(o="Sheet1"),{pos:s,hs:a,dt:i,name:o}}function write_BoundSheet8(t,r){var n=!r||r.biff>=8?2:1,s=new_buf(8+n*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(n*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function parse_SST(t,r){for(var n=t.l+r,s=t.read_shift(4),a=t.read_shift(4),i=[],o=0;o!=a&&t.l<n;++o)i.push(parse_XLUnicodeRichExtendedString(t));return i.Count=s,i.Unique=a,i}function write_SST(t,r){var n=new_buf(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var s=[],a=0;a<t.length;++a)s[a]=write_XLUnicodeRichExtendedString(t[a]);var i=bconcat([n].concat(s));return i.parts=[n.length].concat(s.map(function(o){return o.length})),i}function parse_ExtSST(t,r){var n={};return n.dsst=t.read_shift(2),t.l+=r-2,n}function parse_Row(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var n=t.read_shift(2);t.l+=4;var s=t.read_shift(1);return t.l+=3,s&7&&(r.level=s&7),s&32&&(r.hidden=!0),s&64&&(r.hpt=n/20),r}function parse_ForceFullCalculation(t){var r=parse_frtHeader(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var n=t.read_shift(4);return n!==0}function parse_RecalcId(t){return t.read_shift(2),t.read_shift(4)}function parse_DefaultRowHeight(t,r,n){var s=0;n&&n.biff==2||(s=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(s=1-(a>>15),a&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,a]}function parse_Window1(t){var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[r,n],Dim:[s,a],Flags:i,CurTab:o,FirstTab:c,Selected:f,TabRatio:d}}function write_Window1(){var t=new_buf(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function parse_Window2(t,r,n){if(n&&n.biff>=2&&n.biff<5)return{};var s=t.read_shift(2);return{RTL:s&64}}function write_Window2(t){var r=new_buf(18),n=1718;return t&&t.RTL&&(n|=64),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function parse_Pane(){}function parse_Font(t,r,n){var s={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return s.name=parse_ShortXLUnicodeString(t,0,n),s}function write_Font(t,r){var n=t.name||"Arial",s=r&&r.biff==5,a=s?15+n.length:16+2*n.length,i=new_buf(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*n.length,n,s?"sbcs":"utf16le"),i}function parse_LabelSst(t){var r=parse_XLSCell(t);return r.isst=t.read_shift(4),r}function write_LabelSst(t,r,n,s){var a=new_buf(10);return write_XLSCell(t,r,s,a),a.write_shift(4,n),a}function parse_Label(t,r,n){n.biffguess&&n.biff==2&&(n.biff=5);var s=t.l+r,a=parse_XLSCell(t);n.biff==2&&t.l++;var i=parse_XLUnicodeString(t,s-t.l,n);return a.val=i,a}function write_Label(t,r,n,s,a){var i=!a||a.biff==8,o=new_buf(8+ +i+(1+i)*n.length);return write_XLSCell(t,r,s,o),o.write_shift(2,n.length),i&&o.write_shift(1,1),o.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),o}function parse_Format(t,r,n){var s=t.read_shift(2),a=parse_XLUnicodeString2(t,0,n);return[s,a]}function write_Format(t,r,n,s){var a=n&&n.biff==5;s||(s=new_buf(a?3+r.length:5+2*r.length)),s.write_shift(2,t),s.write_shift(a?1:2,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(t,r,n){var s=t.l+r,a=n.biff==8||!n.biff?4:2,i=t.read_shift(a),o=t.read_shift(a),c=t.read_shift(2),f=t.read_shift(2);return t.l=s,{s:{r:i,c},e:{r:o,c:f}}}function write_Dimensions(t,r){var n=r.biff==8||!r.biff?4:2,s=new_buf(2*n+6);return s.write_shift(n,t.s.r),s.write_shift(n,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function parse_RK(t){var r=t.read_shift(2),n=t.read_shift(2),s=parse_RkRec(t);return{r,c:n,ixfe:s[0],rknum:s[1]}}function parse_MulRk(t,r){for(var n=t.l+r-2,s=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(parse_RkRec(t));if(t.l!==n)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:s,c:a,C:o,rkrec:i}}function parse_MulBlank(t,r){for(var n=t.l+r-2,s=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:s,c:a,C:o,ixfe:i}}function parse_CellStyleXF(t,r,n,s){var a={},i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(2);return a.patternType=XLSFillPattern[c>>26],s.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function parse_XF(t,r,n){var s={};return s.ifnt=t.read_shift(2),s.numFmtId=t.read_shift(2),s.flags=t.read_shift(2),s.fStyle=s.flags>>2&1,r-=6,s.data=parse_CellStyleXF(t,r,s.fStyle,n),s}function write_XF(t,r,n,s){var a=n&&n.biff==5;s||(s=new_buf(a?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,r<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function parse_Guts(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function write_Guts(t){var r=new_buf(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function parse_BoolErr(t,r,n){var s=parse_XLSCell(t);(n.biff==2||r==9)&&++t.l;var a=parse_Bes(t);return s.val=a,s.t=a===!0||a===!1?"b":"e",s}function write_BoolErr(t,r,n,s,a,i){var o=new_buf(8);return write_XLSCell(t,r,s,o),write_Bes(n,i,o),o}function parse_Number(t,r,n){n.biffguess&&n.biff==2&&(n.biff=5);var s=parse_XLSCell(t),a=parse_Xnum(t);return s.val=a,s}function write_Number(t,r,n,s){var a=new_buf(14);return write_XLSCell(t,r,s,a),write_Xnum(n,a),a}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(t,r,n){var s=t.l+r,a=t.read_shift(2),i=t.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=parse_XLUnicodeStringNoCch(t,i),c=[];s>t.l;)c.push(parse_XLUnicodeString(t));return[i,a,o,c]}function parse_ExternName(t,r,n){var s=t.read_shift(2),a,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return n.sbcch===14849&&(a=parse_AddinUdf(t,r-2,n)),i.body=a||t.read_shift(r-2),typeof a=="string"&&(i.Name=a),i}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(t,r,n){var s=t.l+r,a=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),f=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),f=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var d=parse_XLUnicodeStringNoCch(t,o,n);a&32&&(d=XLSLblBuiltIn[d.charCodeAt(0)]);var h=s-t.l;n&&n.biff==2&&--h;var m=s==t.l||c===0||!(h>0)?[]:parse_NameParsedFormula(t,h,n,c);return{chKey:i,Name:d,itab:f,rgce:m}}function parse_ExternSheet(t,r,n){if(n.biff<8)return parse_BIFF5ExternSheet(t,r,n);for(var s=[],a=t.l+r,i=t.read_shift(n.biff>8?4:2);i--!==0;)s.push(parse_XTI(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return s}function parse_BIFF5ExternSheet(t,r,n){t[t.l+1]==3&&t[t.l]++;var s=parse_ShortXLUnicodeString(t,r,n);return s.charCodeAt(0)==3?s.slice(1):s}function parse_NameCmt(t,r,n){if(n.biff<8){t.l+=r;return}var s=t.read_shift(2),a=t.read_shift(2),i=parse_XLUnicodeStringNoCch(t,s,n),o=parse_XLUnicodeStringNoCch(t,a,n);return[i,o]}function parse_ShrFmla(t,r,n){var s=parse_RefU(t);t.l++;var a=t.read_shift(1);return r-=8,[parse_SharedParsedFormula(t,r,n),a,s]}function parse_Array(t,r,n){var s=parse_Ref(t);switch(n.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[s,parse_ArrayParsedFormula(t,r,n)]}function parse_MTRSettings(t){var r=t.read_shift(4)!==0,n=t.read_shift(4)!==0,s=t.read_shift(4);return[r,n,s]}function parse_NoteSh(t,r,n){if(!(n.biff<8)){var s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=parse_XLUnicodeString2(t,0,n);return n.biff<8&&t.read_shift(1),[{r:s,c:a},c,o,i]}}function parse_Note(t,r,n){return parse_NoteSh(t,r,n)}function parse_MergeCells(t,r){for(var n=[],s=t.read_shift(2);s--;)n.push(parse_Ref8U(t));return n}function write_MergeCells(t){var r=new_buf(2+t.length*8);r.write_shift(2,t.length);for(var n=0;n<t.length;++n)write_Ref8U(t[n],r);return r}function parse_Obj(t,r,n){if(n&&n.biff<8)return parse_BIFF5Obj(t,r,n);var s=parse_FtCmo(t),a=parse_FtArray(t,r-22,s[1]);return{cmo:s,ft:a}}var parse_BIFF5OT={8:function(t,r){var n=t.l+r;t.l+=10;var s=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:s}}};function parse_BIFF5Obj(t,r,n){t.l+=4;var s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var o=[];return o.push((parse_BIFF5OT[s]||parsenoop)(t,r,n)),{cmo:[a,s,i],ft:o}}function parse_TxO(t,r,n){var s=t.l,a="";try{t.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=parse_ControlInfo(t,6,n);var c=t.read_shift(2);t.read_shift(2),parseuint16(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-s!=t.lens[d])throw new Error("TxO: bad continue record");var h=t[t.l],m=parse_XLUnicodeStringNoCch(t,t.lens[d+1]-t.lens[d]-1);if(a+=m,a.length>=(h?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=s+r,{t:a}}catch{return t.l=s+r,{t:a}}}function parse_HLink(t,r){var n=parse_Ref8U(t);t.l+=16;var s=parse_Hyperlink(t,r-24);return[n,s]}function write_HLink(t){var r=new_buf(24),n=decode_cell(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(s[a],16));return bconcat([r,write_Hyperlink(t[1])])}function parse_HLinkTooltip(t,r){t.read_shift(2);var n=parse_Ref8U(t),s=t.read_shift((r-10)/2,"dbcs-cont");return s=s.replace(chr0,""),[n,s]}function write_HLinkTooltip(t){var r=t[1].Tooltip,n=new_buf(10+2*(r.length+1));n.write_shift(2,2048);var s=decode_cell(t[0]);n.write_shift(2,s.r),n.write_shift(2,s.r),n.write_shift(2,s.c),n.write_shift(2,s.c);for(var a=0;a<r.length;++a)n.write_shift(2,r.charCodeAt(a));return n.write_shift(2,0),n}function parse_Country(t){var r=[0,0],n;return n=t.read_shift(2),r[0]=CountryEnum[n]||n,n=t.read_shift(2),r[1]=CountryEnum[n]||n,r}function write_Country(t){return t||(t=new_buf(4)),t.write_shift(2,1),t.write_shift(2,1),t}function parse_ClrtClient(t){for(var r=t.read_shift(2),n=[];r-- >0;)n.push(parse_LongRGB(t));return n}function parse_Palette(t){for(var r=t.read_shift(2),n=[];r-- >0;)n.push(parse_LongRGB(t));return n}function parse_XFCRC(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function parse_ColInfo(t,r,n){if(!n.cellStyles)return parsenoop(t,r);var s=n&&n.biff>=12?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(s),c=t.read_shift(s),f=t.read_shift(2);s==2&&(t.l+=2);var d={s:a,e:i,w:o,ixfe:c,flags:f};return(n.biff>=5||!n.biff)&&(d.level=f>>8&7),d}function write_ColInfo(t,r){var n=new_buf(12);n.write_shift(2,r),n.write_shift(2,r),n.write_shift(2,t.width*256),n.write_shift(2,0);var s=0;return t.hidden&&(s|=1),n.write_shift(1,s),s=t.level||0,n.write_shift(1,s),n.write_shift(2,0),n}function parse_Setup(t,r){var n={};return r<32||(t.l+=16,n.header=parse_Xnum(t),n.footer=parse_Xnum(t),t.l+=2),n}function parse_ShtProps(t,r,n){var s={area:!1};if(n.biff!=5)return t.l+=r,s;var a=t.read_shift(1);return t.l+=3,a&16&&(s.area=!0),s}function write_RRTabId(t){for(var r=new_buf(2*t),n=0;n<t;++n)r.write_shift(2,n+1);return r}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(t){var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(4),a={fmt:r,env:n,len:s,data:t.slice(t.l,t.l+s)};return t.l+=s,a}function parse_BIFF2STR(t,r,n){n.biffguess&&n.biff==5&&(n.biff=2);var s=parse_XLSCell(t);++t.l;var a=parse_XLUnicodeString2(t,r-7,n);return s.t="str",s.val=a,s}function parse_BIFF2NUM(t){var r=parse_XLSCell(t);++t.l;var n=parse_Xnum(t);return r.t="n",r.val=n,r}function write_BIFF2NUM(t,r,n){var s=new_buf(15);return write_BIFF2Cell(s,t,r),s.write_shift(8,n,"f"),s}function parse_BIFF2INT(t){var r=parse_XLSCell(t);++t.l;var n=t.read_shift(2);return r.t="n",r.val=n,r}function write_BIFF2INT(t,r,n){var s=new_buf(9);return write_BIFF2Cell(s,t,r),s.write_shift(2,n),s}function parse_BIFF2STRING(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function parse_BIFF2FONTXTRA(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function parse_RString(t,r,n){var s=t.l+r,a=parse_XLSCell(t),i=t.read_shift(2),o=parse_XLUnicodeStringNoCch(t,i,n);return t.l=s,a.t="str",a.val=o,a}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,f){var d=[],h=new_raw_buf(1);switch(f.type){case"base64":h=s2a(Base64_decode(c));break;case"binary":h=s2a(c);break;case"buffer":case"array":h=c;break}prep_blob(h,0);var m=h.read_shift(1),g=!!(m&136),v=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var _=0,w=521;m==2&&(_=h.read_shift(2)),h.l+=3,m!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),m!=2&&(w=h.read_shift(2));var b=h.read_shift(2),T=f.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(T=t[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var k=[],C={},L=Math.min(h.length,m==2?521:w-10-(v?264:0)),D=y?32:11;h.l<L&&h[h.l]!=13;)switch(C={},C.name=$cptable.utils.decode(T,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,C.type=String.fromCharCode(h.read_shift(1)),m!=2&&!y&&(C.offset=h.read_shift(4)),C.len=h.read_shift(1),m==2&&(C.offset=h.read_shift(2)),C.dec=h.read_shift(1),C.name.length&&k.push(C),m!=2&&(h.l+=y?13:14),C.type){case"B":(!v||C.len!=8)&&f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var N=0,U=0;for(d[0]=[],U=0;U!=k.length;++U)d[0][U]=k[U].name;for(;_-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,d[++N]=[],U=0,U=0;U!=k.length;++U){var M=h.slice(h.l,h.l+k[U].len);h.l+=k[U].len,prep_blob(M,0);var j=$cptable.utils.decode(T,M);switch(k[U].type){case"C":j.trim().length&&(d[N][U]=j.replace(/\s+$/,""));break;case"D":j.length===8?d[N][U]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):d[N][U]=j;break;case"F":d[N][U]=parseFloat(j.trim());break;case"+":case"I":d[N][U]=y?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":d[N][U]=!0;break;case"N":case"F":d[N][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[N][U]="##MEMO##"+(y?parseInt(j.trim(),10):M.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(d[N][U]=+j||0);break;case"@":d[N][U]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":d[N][U]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":d[N][U]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][U]=-M.read_shift(-8,"f");break;case"B":if(v&&k[U].len==8){d[N][U]=M.read_shift(8,"f");break}case"G":case"P":M.l+=k[U].len;break;case"0":if(k[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[U].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=k,d}function s(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=aoa_to_sheet(n(c,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function a(c,f){try{return sheet_to_workbook(s(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,f){var d=f||{};if(+d.codepage>=0&&set_cp(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=buf_array(),m=sheet_to_json(c,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),y=c["!cols"]||[],_=0,w=0,b=0,T=1;for(_=0;_<g.length;++_){if(((y[_]||{}).DBF||{}).name){g[_]=y[_].DBF.name,++b;continue}if(g[_]!=null){if(++b,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(w=0;w<1024;++w)if(g.indexOf(g[_]+"_"+w)==-1){g[_]+="_"+w;break}}}}var k=safe_decode_range(c["!ref"]),C=[],L=[],D=[];for(_=0;_<=k.e.c-k.s.c;++_){var N="",U="",M=0,j=[];for(w=0;w<v.length;++w)v[w][_]!=null&&j.push(v[w][_]);if(j.length==0||g[_]==null){C[_]="?";continue}for(w=0;w<j.length;++w){switch(typeof j[w]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=j[w]instanceof Date?"D":"C";break;default:U="C"}M=Math.max(M,String(j[w]).length),N=N&&N!=U?"C":U}M>250&&(M=250),U=((y[_]||{}).DBF||{}).type,U=="C"&&y[_].DBF.len>M&&(M=y[_].DBF.len),N=="B"&&U=="N"&&(N="N",D[_]=y[_].DBF.dec,M=y[_].DBF.len),L[_]=N=="C"||U=="N"?M:i[N]||0,T+=L[_],C[_]=N}var K=h.next(32);for(K.write_shift(4,318902576),K.write_shift(4,v.length),K.write_shift(2,296+32*b),K.write_shift(2,T),_=0;_<4;++_)K.write_shift(4,0);for(K.write_shift(4,0|(+r[current_ansi]||3)<<8),_=0,w=0;_<g.length;++_)if(g[_]!=null){var I=h.next(32),te=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,te,"sbcs"),I.write_shift(1,C[_]=="?"?"C":C[_],"sbcs"),I.write_shift(4,w),I.write_shift(1,L[_]||i[C[_]]||0),I.write_shift(1,D[_]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=L[_]||i[C[_]]||0}var _e=h.next(264);for(_e.write_shift(4,13),_=0;_<65;++_)_e.write_shift(4,0);for(_=0;_<v.length;++_){var ne=h.next(T);for(ne.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(C[w]){case"L":ne.write_shift(1,v[_][w]==null?63:v[_][w]?84:70);break;case"B":ne.write_shift(8,v[_][w]||0,"f");break;case"N":var me="0";for(typeof v[_][w]=="number"&&(me=v[_][w].toFixed(D[w]||0)),b=0;b<L[w]-me.length;++b)ne.write_shift(1,32);ne.write_shift(1,me,"sbcs");break;case"D":v[_][w]?(ne.write_shift(4,("0000"+v[_][w].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(v[_][w].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+v[_][w].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var le=String(v[_][w]!=null?v[_][w]:"").slice(0,L[w]);for(ne.write_shift(1,le,"sbcs"),b=0;b<L[w]-le.length;++b)ne.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:s,from_sheet:o}}(),SYLK=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+keys(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(g,v){var y=t[v];return typeof y=="number"?_getansi(y):y},s=function(g,v,y){var _=v.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return _==59?g:_getansi(_)};t["|"]=254;function a(g,v){switch(v.type){case"base64":return i(Base64_decode(g),v);case"binary":return i(g,v);case"buffer":return i(has_buf&&Buffer.isBuffer(g)?g.toString("binary"):a2s(g),v);case"array":return i(cc2str(g),v)}throw new Error("Unrecognized type "+v.type)}function i(g,v){var y=g.split(/[\n\r]+/),_=-1,w=-1,b=0,T=0,k=[],C=[],L=null,D={},N=[],U=[],M=[],j=0,K;for(+v.codepage>=0&&set_cp(+v.codepage);b!==y.length;++b){j=0;var I=y[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,n),te=I.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),_e=te[0],ne;if(I.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&C.push(I.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,le=!1,he=!1,J=!1,fe=-1,G=-1;for(T=1;T<te.length;++T)switch(te[T].charAt(0)){case"A":break;case"X":w=parseInt(te[T].slice(1))-1,le=!0;break;case"Y":for(_=parseInt(te[T].slice(1))-1,le||(w=0),K=k.length;K<=_;++K)k[K]=[];break;case"K":ne=te[T].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(fuzzynum(ne))?isNaN(fuzzydate(ne).getDate())||(ne=parseDate(ne)):(ne=fuzzynum(ne),L!==null&&fmt_is_date(L)&&(ne=numdate(ne))),me=!0;break;case"E":J=!0;var A=rc_to_a1(te[T].slice(1),{r:_,c:w});k[_][w]=[k[_][w],A];break;case"S":he=!0,k[_][w]=[k[_][w],"S5S"];break;case"G":break;case"R":fe=parseInt(te[T].slice(1))-1;break;case"C":G=parseInt(te[T].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}if(me&&(k[_][w]&&k[_][w].length==2?k[_][w][0]=ne:k[_][w]=ne,L=null),he){if(J)throw new Error("SYLK shared formula cannot have own formula");var q=fe>-1&&k[fe][G];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");k[_][w][1]=shift_formula_str(q[1],{r:_-fe,c:w-G})}break;case"F":var P=0;for(T=1;T<te.length;++T)switch(te[T].charAt(0)){case"X":w=parseInt(te[T].slice(1))-1,++P;break;case"Y":for(_=parseInt(te[T].slice(1))-1,K=k.length;K<=_;++K)k[K]=[];break;case"M":j=parseInt(te[T].slice(1))/20;break;case"F":break;case"G":break;case"P":L=C[parseInt(te[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=te[T].slice(1).split(" "),K=parseInt(M[0],10);K<=parseInt(M[1],10);++K)j=parseInt(M[2],10),U[K-1]=j===0?{hidden:!0}:{wch:j},process_col(U[K-1]);break;case"C":w=parseInt(te[T].slice(1))-1,U[w]||(U[w]={});break;case"R":_=parseInt(te[T].slice(1))-1,N[_]||(N[_]={}),j>0?(N[_].hpt=j,N[_].hpx=pt2px(j)):j===0&&(N[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}P<1&&(L=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+I)}}return N.length>0&&(D["!rows"]=N),U.length>0&&(D["!cols"]=U),v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),[k,D]}function o(g,v){var y=a(g,v),_=y[0],w=y[1],b=aoa_to_sheet(_,v);return keys(w).forEach(function(T){b[T]=w[T]}),b}function c(g,v){return sheet_to_workbook(o(g,v),v)}function f(g,v,y,_){var w="C;Y"+(y+1)+";X"+(_+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+a1_to_rc(g.f,{r:y,c:_}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(g,v){v.forEach(function(y,_){var w="F;W"+(_+1)+" "+(_+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=width2px(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=px2char(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function h(g,v){v.forEach(function(y,_){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*px2pt(y.hpx)+";"),w.length>2&&g.push(w+"R"+(_+1))})}function m(g,v){var y=["ID;PWXL;N;E"],_=[],w=safe_decode_range(g["!ref"]),b,T=Array.isArray(g),k=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&d(y,g["!cols"]),g["!rows"]&&h(y,g["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var C=w.s.r;C<=w.e.r;++C)for(var L=w.s.c;L<=w.e.c;++L){var D=encode_cell({r:C,c:L});b=T?(g[C]||[])[L]:g[D],!(!b||b.v==null&&(!b.f||b.F))&&_.push(f(b,g,C,L))}return y.join(k)+k+_.join(k)+k+"E"+k}return{to_workbook:c,to_sheet:o,from_sheet:m}}(),DIF=function(){function t(i,o){switch(o.type){case"base64":return r(Base64_decode(i),o);case"binary":return r(i,o);case"buffer":return r(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),o);case"array":return r(cc2str(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){for(var c=i.split(`
`),f=-1,d=-1,h=0,m=[];h!==c.length;++h){if(c[h].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var g=c[h].trim().split(","),v=g[0],y=g[1];++h;for(var _=c[h]||"";(_.match(/["]/g)||[]).length&1&&h<c.length-1;)_+=`
`+c[++h];switch(_=_.trim(),+v){case-1:if(_==="BOT"){m[++f]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?m[f][d]=!0:_==="FALSE"?m[f][d]=!1:isNaN(fuzzynum(y))?isNaN(fuzzydate(y).getDate())?m[f][d]=y:m[f][d]=parseDate(y):m[f][d]=fuzzynum(y),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),m[f][d++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function n(i,o){return aoa_to_sheet(t(i,o),o)}function s(i,o){return sheet_to_workbook(n(i,o),o)}var a=function(){var i=function(f,d,h,m,g){f.push(d),f.push(h+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},o=function(f,d,h,m){f.push(d+","+h),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],h=safe_decode_range(f["!ref"]),m,g=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var v=h.s.r;v<=h.e.r;++v){o(d,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var _=encode_cell({r:v,c:y});if(m=g?(f[v]||[])[y]:f[_],!m){o(d,1,0,"");continue}switch(m.t){case"n":var w=m.w;!w&&m.v!=null&&(w=m.v),w==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,w,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=SSF_format(m.z||table_fmt[14],datenum(parseDate(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var b=`\r
`,T=d.join(b);return T}}();return{to_workbook:s,to_sheet:n,from_sheet:a}}(),ETH=function(){function t(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(m,g){for(var v=m.split(`
`),y=-1,_=-1,w=0,b=[];w!==v.length;++w){var T=v[w].trim().split(":");if(T[0]==="cell"){var k=decode_cell(T[1]);if(b.length<=k.r)for(y=b.length;y<=k.r;++y)b[y]||(b[y]=[]);switch(y=k.r,_=k.c,T[2]){case"t":b[y][_]=t(T[3]);break;case"v":b[y][_]=+T[3];break;case"vtf":var C=T[T.length-1];case"vtc":switch(T[3]){case"nl":b[y][_]=!!+T[4];break;default:b[y][_]=+T[4];break}T[2]=="vtf"&&(b[y][_]=[b[y][_],C])}}}return g&&g.sheetRows&&(b=b.slice(0,g.sheetRows)),b}function s(m,g){return aoa_to_sheet(n(m,g),g)}function a(m,g){return sheet_to_workbook(s(m,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],y,_="",w=decode_range(m["!ref"]),b=Array.isArray(m),T=w.s.r;T<=w.e.r;++T)for(var k=w.s.c;k<=w.e.c;++k)if(_=encode_cell({r:T,c:k}),y=b?(m[T]||[])[k]:m[_],!(!y||y.v==null||y.t==="z")){switch(v=["cell",_,"t"],y.t){case"s":case"str":v.push(r(y.v));break;case"n":y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=r(y.f)):(v[2]="v",v[3]=y.v);break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=r(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=datenum(parseDate(y.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=y.w||SSF_format(y.z||table_fmt[14],C);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(m){return[i,o,c,o,d(m),f].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:h}}(),PRN=function(){function t(h,m,g,v,y){y.raw?m[g][v]=h:h===""||(h==="TRUE"?m[g][v]=!0:h==="FALSE"?m[g][v]=!1:isNaN(fuzzynum(h))?isNaN(fuzzydate(h).getDate())?m[g][v]=h:m[g][v]=parseDate(h):m[g][v]=fuzzynum(h))}function r(h,m){var g=m||{},v=[];if(!h||h.length===0)return v;for(var y=h.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var w=10,b=0,T=0;T<=_;++T)b=y[T].indexOf(" "),b==-1?b=y[T].length:b++,w=Math.max(w,b);for(T=0;T<=_;++T){v[T]=[];var k=0;for(t(y[T].slice(0,w).trim(),v,T,k,g),k=1;k<=(y[T].length-w)/10+1;++k)t(y[T].slice(w+(k-1)*10,w+k*10).trim(),v,T,k,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var n={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(h){for(var m={},g=!1,v=0,y=0;v<h.length;++v)(y=h.charCodeAt(v))==34?g=!g:!g&&y in n&&(m[y]=(m[y]||0)+1);y=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v]);if(!y.length){m=s;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v])}return y.sort(function(_,w){return _[0]-w[0]||s[_[1]]-s[w[1]]}),n[y.pop()[1]]||44}function i(h,m){var g=m||{},v="",y=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(v=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(v=h.charAt(4),h=h.slice(6)):v=a(h.slice(0,1024)):g&&g.FS?v=g.FS:v=a(h.slice(0,1024));var w=0,b=0,T=0,k=0,C=0,L=v.charCodeAt(0),D=!1,N=0,U=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?dateNF_regex(g.dateNF):null;function j(){var K=h.slice(k,C),I={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)I.t="z";else if(g.raw)I.t="s",I.v=K;else if(K.trim().length===0)I.t="s",I.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(I.t="s",I.v=K.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(K)?(I.t="n",I.f=K.slice(1)):(I.t="s",I.v=K);else if(K=="TRUE")I.t="b",I.v=!0;else if(K=="FALSE")I.t="b",I.v=!1;else if(!isNaN(T=fuzzynum(K)))I.t="n",g.cellText!==!1&&(I.w=K),I.v=T;else if(!isNaN(fuzzydate(K).getDate())||M&&K.match(M)){I.z=g.dateNF||table_fmt[14];var te=0;M&&K.match(M)&&(K=dateNF_fix(K,g.dateNF,K.match(M)||[]),te=1),g.cellDates?(I.t="d",I.v=parseDate(K,te)):(I.t="n",I.v=datenum(parseDate(K,te))),g.cellText!==!1&&(I.w=SSF_format(I.z,I.v instanceof Date?datenum(I.v):I.v)),g.cellNF||delete I.z}else I.t="s",I.v=K;if(I.t=="z"||(g.dense?(y[w]||(y[w]=[]),y[w][b]=I):y[encode_cell({c:b,r:w})]=I),k=C+1,U=h.charCodeAt(k),_.e.c<b&&(_.e.c=b),_.e.r<w&&(_.e.r=w),N==L)++b;else if(b=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;C<h.length;++C)switch(N=h.charCodeAt(C)){case 34:U===34&&(D=!D);break;case L:case 10:case 13:if(!D&&j())break e;break}return C-k>0&&j(),y["!ref"]=encode_range(_),y}function o(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):aoa_to_sheet(r(h,m),m)}function c(h,m){var g="",v=m.type=="string"?[0,0,0,0]:firstbyte(h,m);switch(m.type){case"base64":g=Base64_decode(h);break;case"binary":g=h;break;case"buffer":m.codepage==65001?g=h.toString("utf8"):(m.codepage,g=has_buf&&Buffer.isBuffer(h)?h.toString("binary"):a2s(h));break;case"array":g=cc2str(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=utf8read(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=utf8read(g):m.type=="binary",g.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(m.type=="string"?g:utf8read(g),m):o(g,m)}function f(h,m){return sheet_to_workbook(c(h,m),m)}function d(h){for(var m=[],g=safe_decode_range(h["!ref"]),v,y=Array.isArray(h),_=g.s.r;_<=g.e.r;++_){for(var w=[],b=g.s.c;b<=g.e.c;++b){var T=encode_cell({r:_,c:b});if(v=y?(h[_]||[])[b]:h[T],!v||v.v==null){w.push("          ");continue}for(var k=(v.w||(format_cell(v),v.w)||"").slice(0,10);k.length<10;)k+=" ";w.push(k+(b===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}}();function read_wb_ID(t,r){var n=r||{},s=!!n.WTF;n.WTF=!0;try{var a=SYLK.to_workbook(t,n);return n.WTF=s,a}catch(i){if(n.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return PRN.to_workbook(t,r)}}var WK_=function(){function t(A,q,P){if(A){prep_blob(A,A.l||0);for(var V=P.Enum||fe;A.l<A.length;){var ee=A.read_shift(2),ge=V[ee]||V[65535],xe=A.read_shift(2),de=A.l+xe,ve=ge.f&&ge.f(A,xe,P);if(A.l=de,q(ve,ge,ee))return}}}function r(A,q){switch(q.type){case"base64":return n(s2a(Base64_decode(A)),q);case"binary":return n(s2a(A),q);case"buffer":case"array":return n(A,q)}throw"Unsupported type "+q.type}function n(A,q){if(!A)return A;var P=q||{},V=P.dense?[]:{},ee="Sheet1",ge="",xe=0,de={},ve=[],je=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Xe=P.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)P.Enum=fe,t(A,function(Re,tt,yt){switch(yt){case 0:P.vers=Re,Re>=4096&&(P.qpro=!0);break;case 6:Y=Re;break;case 204:Re&&(ge=Re);break;case 222:ge=Re;break;case 15:case 51:P.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:yt==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=P.dateNF||table_fmt[14],P.cellDates&&(Re[1].t="d",Re[1].v=numdate(Re[1].v))),P.qpro&&Re[3]>xe&&(V["!ref"]=encode_range(Y),de[ee]=V,ve.push(ee),V=P.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},xe=Re[3],ee=ge||"Sheet"+(xe+1),ge="");var wt=P.dense?(V[Re[0].r]||[])[Re[0].c]:V[encode_cell(Re[0])];if(wt){wt.t=Re[1].t,wt.v=Re[1].v,Re[1].z!=null&&(wt.z=Re[1].z),Re[1].f!=null&&(wt.f=Re[1].f);break}P.dense?(V[Re[0].r]||(V[Re[0].r]=[]),V[Re[0].r][Re[0].c]=Re[1]):V[encode_cell(Re[0])]=Re[1];break}},P);else if(A[2]==26||A[2]==14)P.Enum=G,A[2]==14&&(P.qpro=!0,A.l=0),t(A,function(Re,tt,yt){switch(yt){case 204:ee=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>xe&&(V["!ref"]=encode_range(Y),de[ee]=V,ve.push(ee),V=P.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},xe=Re[3],ee="Sheet"+(xe+1)),Xe>0&&Re[0].r>=Xe)break;P.dense?(V[Re[0].r]||(V[Re[0].r]=[]),V[Re[0].r][Re[0].c]=Re[1]):V[encode_cell(Re[0])]=Re[1],Y.e.c<Re[0].c&&(Y.e.c=Re[0].c),Y.e.r<Re[0].r&&(Y.e.r=Re[0].r);break;case 27:Re[14e3]&&(je[Re[14e3][0]]=Re[14e3][1]);break;case 1537:je[Re[0]]=Re[1],Re[0]==xe&&(ee=Re[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(V["!ref"]=encode_range(Y),de[ge||ee]=V,ve.push(ge||ee),!je.length)return{SheetNames:ve,Sheets:de};for(var Ve={},Ye=[],We=0;We<je.length;++We)de[ve[We]]?(Ye.push(je[We]||ve[We]),Ve[je[We]]=de[je[We]]||de[ve[We]]):(Ye.push(je[We]),Ve[je[We]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:Ve}}function s(A,q){var P=q||{};if(+P.codepage>=0&&set_cp(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var V=buf_array(),ee=safe_decode_range(A["!ref"]),ge=Array.isArray(A),xe=[];write_biff_rec(V,0,i(1030)),write_biff_rec(V,6,f(ee));for(var de=Math.min(ee.e.r,8191),ve=ee.s.r;ve<=de;++ve)for(var je=encode_row(ve),Y=ee.s.c;Y<=ee.e.c;++Y){ve===ee.s.r&&(xe[Y]=encode_col(Y));var Xe=xe[Y]+je,Ve=ge?(A[ve]||[])[Y]:A[Xe];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?write_biff_rec(V,13,v(ve,Y,Ve.v)):write_biff_rec(V,14,_(ve,Y,Ve.v));else{var Ye=format_cell(Ve);write_biff_rec(V,15,m(ve,Y,Ye.slice(0,239)))}}return write_biff_rec(V,1),V.end()}function a(A,q){var P=q||{};if(+P.codepage>=0&&set_cp(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var V=buf_array();write_biff_rec(V,0,o(A));for(var ee=0,ge=0;ee<A.SheetNames.length;++ee)(A.Sheets[A.SheetNames[ee]]||{})["!ref"]&&write_biff_rec(V,27,J(A.SheetNames[ee],ge++));var xe=0;for(ee=0;ee<A.SheetNames.length;++ee){var de=A.Sheets[A.SheetNames[ee]];if(!(!de||!de["!ref"])){for(var ve=safe_decode_range(de["!ref"]),je=Array.isArray(de),Y=[],Xe=Math.min(ve.e.r,8191),Ve=ve.s.r;Ve<=Xe;++Ve)for(var Ye=encode_row(Ve),We=ve.s.c;We<=ve.e.c;++We){Ve===ve.s.r&&(Y[We]=encode_col(We));var Re=Y[We]+Ye,tt=je?(de[Ve]||[])[We]:de[Re];if(!(!tt||tt.t=="z"))if(tt.t=="n")write_biff_rec(V,23,j(Ve,We,xe,tt.v));else{var yt=format_cell(tt);write_biff_rec(V,22,N(Ve,We,xe,yt.slice(0,239)))}}++xe}}return write_biff_rec(V,1),V.end()}function i(A){var q=new_buf(2);return q.write_shift(2,A),q}function o(A){var q=new_buf(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var P=0,V=0,ee=0,ge=0;ge<A.SheetNames.length;++ge){var xe=A.SheetNames[ge],de=A.Sheets[xe];if(!(!de||!de["!ref"])){++ee;var ve=decode_range(de["!ref"]);P<ve.e.r&&(P=ve.e.r),V<ve.e.c&&(V=ve.e.c)}}return P>8191&&(P=8191),q.write_shift(2,P),q.write_shift(1,ee),q.write_shift(1,V),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function c(A,q,P){var V={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&P.qpro?(V.s.c=A.read_shift(1),A.l++,V.s.r=A.read_shift(2),V.e.c=A.read_shift(1),A.l++,V.e.r=A.read_shift(2),V):(V.s.c=A.read_shift(2),V.s.r=A.read_shift(2),q==12&&P.qpro&&(A.l+=2),V.e.c=A.read_shift(2),V.e.r=A.read_shift(2),q==12&&P.qpro&&(A.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function f(A){var q=new_buf(8);return q.write_shift(2,A.s.c),q.write_shift(2,A.s.r),q.write_shift(2,A.e.c),q.write_shift(2,A.e.r),q}function d(A,q,P){var V=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(V[0].c=A.read_shift(1),V[3]=A.read_shift(1),V[0].r=A.read_shift(2),A.l+=2):(V[2]=A.read_shift(1),V[0].c=A.read_shift(2),V[0].r=A.read_shift(2)),V}function h(A,q,P){var V=A.l+q,ee=d(A,q,P);if(ee[1].t="s",P.vers==20768){A.l++;var ge=A.read_shift(1);return ee[1].v=A.read_shift(ge,"utf8"),ee}return P.qpro&&A.l++,ee[1].v=A.read_shift(V-A.l,"cstr"),ee}function m(A,q,P){var V=new_buf(7+P.length);V.write_shift(1,255),V.write_shift(2,q),V.write_shift(2,A),V.write_shift(1,39);for(var ee=0;ee<V.length;++ee){var ge=P.charCodeAt(ee);V.write_shift(1,ge>=128?95:ge)}return V.write_shift(1,0),V}function g(A,q,P){var V=d(A,q,P);return V[1].v=A.read_shift(2,"i"),V}function v(A,q,P){var V=new_buf(7);return V.write_shift(1,255),V.write_shift(2,q),V.write_shift(2,A),V.write_shift(2,P,"i"),V}function y(A,q,P){var V=d(A,q,P);return V[1].v=A.read_shift(8,"f"),V}function _(A,q,P){var V=new_buf(13);return V.write_shift(1,255),V.write_shift(2,q),V.write_shift(2,A),V.write_shift(8,P,"f"),V}function w(A,q,P){var V=A.l+q,ee=d(A,q,P);if(ee[1].v=A.read_shift(8,"f"),P.qpro)A.l=V;else{var ge=A.read_shift(2);C(A.slice(A.l,A.l+ge),ee),A.l+=ge}return ee}function b(A,q,P){var V=q&32768;return q&=-32769,q=(V?A:0)+(q>=8192?q-16384:q),(V?"":"$")+(P?encode_col(q):encode_row(q))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(A,q){prep_blob(A,0);for(var P=[],V=0,ee="",ge="",xe="",de="";A.l<A.length;){var ve=A[A.l++];switch(ve){case 0:P.push(A.read_shift(8,"f"));break;case 1:ge=b(q[0].c,A.read_shift(2),!0),ee=b(q[0].r,A.read_shift(2),!1),P.push(ge+ee);break;case 2:{var je=b(q[0].c,A.read_shift(2),!0),Y=b(q[0].r,A.read_shift(2),!1);ge=b(q[0].c,A.read_shift(2),!0),ee=b(q[0].r,A.read_shift(2),!1),P.push(je+Y+":"+ge+ee)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(A.read_shift(2));break;case 6:{for(var Xe="";ve=A[A.l++];)Xe+=String.fromCharCode(ve);P.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:de=P.pop(),xe=P.pop(),P.push(["AND","OR"][ve-20]+"("+xe+","+de+")");break;default:if(ve<32&&k[ve])de=P.pop(),xe=P.pop(),P.push(xe+k[ve]+de);else if(T[ve]){if(V=T[ve][1],V==69&&(V=A[A.l++]),V>P.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+P.join("|")+"|");return}var Ve=P.slice(-V);P.length-=V,P.push(T[ve][0]+"("+Ve.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}P.length==1?q[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function L(A){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=A.read_shift(2),q[3]=A[A.l++],q[0].c=A[A.l++],q}function D(A,q){var P=L(A);return P[1].t="s",P[1].v=A.read_shift(q-4,"cstr"),P}function N(A,q,P,V){var ee=new_buf(6+V.length);ee.write_shift(2,A),ee.write_shift(1,P),ee.write_shift(1,q),ee.write_shift(1,39);for(var ge=0;ge<V.length;++ge){var xe=V.charCodeAt(ge);ee.write_shift(1,xe>=128?95:xe)}return ee.write_shift(1,0),ee}function U(A,q){var P=L(A);P[1].v=A.read_shift(2);var V=P[1].v>>1;if(P[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return P[1].v=V,P}function M(A,q){var P=L(A),V=A.read_shift(4),ee=A.read_shift(4),ge=A.read_shift(2);if(ge==65535)return V===0&&ee===3221225472?(P[1].t="e",P[1].v=15):V===0&&ee===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var xe=ge&32768;return ge=(ge&32767)-16446,P[1].v=(1-xe*2)*(ee*Math.pow(2,ge+32)+V*Math.pow(2,ge)),P}function j(A,q,P,V){var ee=new_buf(14);if(ee.write_shift(2,A),ee.write_shift(1,P),ee.write_shift(1,q),V==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var ge=0,xe=0,de=0,ve=0;return V<0&&(ge=1,V=-V),xe=Math.log2(V)|0,V/=Math.pow(2,xe-31),ve=V>>>0,(ve&2147483648)==0&&(V/=2,++xe,ve=V>>>0),V-=ve,ve|=2147483648,ve>>>=0,V*=Math.pow(2,32),de=V>>>0,ee.write_shift(4,de),ee.write_shift(4,ve),xe+=16383+(ge?32768:0),ee.write_shift(2,xe),ee}function K(A,q){var P=M(A);return A.l+=q-14,P}function I(A,q){var P=L(A),V=A.read_shift(4);return P[1].v=V>>6,P}function te(A,q){var P=L(A),V=A.read_shift(8,"f");return P[1].v=V,P}function _e(A,q){var P=te(A);return A.l+=q-10,P}function ne(A,q){return A[A.l+q-1]==0?A.read_shift(q,"cstr"):""}function me(A,q){var P=A[A.l++];P>q-1&&(P=q-1);for(var V="";V.length<P;)V+=String.fromCharCode(A[A.l++]);return V}function le(A,q,P){if(!(!P.qpro||q<21)){var V=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var ee=A.read_shift(q-21,"cstr");return[V,ee]}}function he(A,q){for(var P={},V=A.l+q;A.l<V;){var ee=A.read_shift(2);if(ee==14e3){for(P[ee]=[0,""],P[ee][0]=A.read_shift(2);A[A.l];)P[ee][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return P}function J(A,q){var P=new_buf(5+A.length);P.write_shift(2,14e3),P.write_shift(2,q);for(var V=0;V<A.length;++V){var ee=A.charCodeAt(V);P[P.l++]=ee>127?95:ee}return P[P.l++]=0,P}var fe={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:r}}();function parse_rpr(t){var r={},n=t.match(tagregex),s=0,a=!1;if(n)for(;s!=n.length;++s){var i=parsexmltag(n[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=CS2CP[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return r}var parse_rs=function(){var t=matchtag("t"),r=matchtag("rPr");function n(i){var o=i.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:unescapexml(o[1])},f=i.match(r);return f&&(c.s=parse_rpr(f[1])),c}var s=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(a).map(n).filter(function(c){return c.v})}}(),rs_to_html=function(){var r=/(\r\n|\n)/g;function n(a,i,o){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),a}function s(a){var i=[[],a.v,[]];return a.v?(a.s&&n(a.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(t,r){var n=r?r.cellHTML:!0,s={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=unescapexml(utf8read(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=utf8read(t),n&&(s.h=escapehtml(s.t))):t.match(sirregex)&&(s.r=utf8read(t),s.t=unescapexml(utf8read((t.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),n&&(s.h=rs_to_html(parse_rs(s.r)))),s):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(t,r){var n=[],s="";if(!t)return n;var a=t.match(sstr0);if(a){s=a[2].replace(sstr1,"").split(sstr2);for(var i=0;i!=s.length;++i){var o=parse_si(s[i].trim(),r);o!=null&&(n[n.length]=o)}a=parsexmltag(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(t,r){if(!r.bookSST)return"";var n=[XML_HEADER];n[n.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var a=t[s],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(straywsregex)&&(i+=' xml:space="preserve"'),i+=">"+escapexml(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function parse_BrtBeginSst(t){return[t.read_shift(4),t.read_shift(4)]}function parse_sst_bin(t,r){var n=[],s=!1;return recordhopper(t,function(i,o,c){switch(c){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function write_BrtBeginSst(t,r){return r||(r=new_buf(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var write_BrtSSTItem=write_RichStr;function write_sst_bin(t){var r=buf_array();write_record(r,159,write_BrtBeginSst(t));for(var n=0;n<t.length;++n)write_record(r,19,write_BrtSSTItem(t[n]));return write_record(r,160),r.end()}function _JS2ANSI(t){for(var r=[],n=t.split(""),s=0;s<n.length;++s)r[s]=n[s].charCodeAt(0);return r}function parse_CRYPTOVersion(t,r){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),n}function parse_DataSpaceVersionInfo(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(t,4),r.U=parse_CRYPTOVersion(t,4),r.W=parse_CRYPTOVersion(t,4),r}function parse_DataSpaceMapEntry(t){for(var r=t.read_shift(4),n=t.l+r-4,s={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(s.name=t.read_shift(0,"lpp4"),s.comps=i,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return s}function parse_DataSpaceMap(t){var r=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)r.push(parse_DataSpaceMapEntry(t));return r}function parse_DataSpaceDefinition(t){var r=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function parse_TransformInfoHeader(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(t,4),r.U=parse_CRYPTOVersion(t,4),r.W=parse_CRYPTOVersion(t,4),r}function parse_Primary(t){var r=parse_TransformInfoHeader(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function parse_EncryptionHeader(t,r){var n=t.l+r,s={};s.Flags=t.read_shift(4)&63,t.l+=4,s.AlgID=t.read_shift(4);var a=!1;switch(s.AlgID){case 26126:case 26127:case 26128:a=s.Flags==36;break;case 26625:a=s.Flags==4;break;case 0:a=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=t.read_shift(4),s.KeySize=t.read_shift(4),s.ProviderType=t.read_shift(4),t.l+=8,s.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,s}function parse_EncryptionVerifier(t,r){var n={},s=t.l+r;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,s),t.l=s,n}function parse_EncryptionInfo(t){var r=parse_CRYPTOVersion(t);switch(r.Minor){case 2:return[r.Minor,parse_EncInfoStd(t)];case 3:return[r.Minor,parse_EncInfoExt()];case 4:return[r.Minor,parse_EncInfoAgl(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function parse_EncInfoStd(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),s=parse_EncryptionHeader(t,n),a=parse_EncryptionVerifier(t,t.length-t.l);return{t:"Std",h:s,v:a}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),s={};return n.replace(tagregex,function(i){var o=parsexmltag(i);switch(strip_ns(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){s[c]=o[c]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function parse_RC4CryptoHeader(t,r){var n={},s=n.EncryptionVersionInfo=parse_CRYPTOVersion(t,4);if(r-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);n.Flags=t.read_shift(4),r-=4;var a=t.read_shift(4);return r-=4,n.EncryptionHeader=parse_EncryptionHeader(t,a),r-=a,n.EncryptionVerifier=parse_EncryptionVerifier(t,r),n}function parse_RC4Header(t){var r={},n=r.EncryptionVersionInfo=parse_CRYPTOVersion(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function crypto_CreatePasswordVerifier_Method1(t){var r=0,n,s=_JS2ANSI(t),a=s.length+1,i,o,c,f,d;for(n=new_raw_buf(a),n[0]=s.length,i=1;i!=a;++i)n[i]=s[i-1];for(i=a-1;i>=0;--i)o=n[i],c=(r&16384)===0?0:1,f=r<<1&32767,d=c|f,r=d^o;return r^52811}var crypto_CreateXorArray_Method1=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},a=function(o,c){return s(o^c)},i=function(o){for(var c=r[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var h=o[d],m=0;m!=7;++m)h&64&&(c^=n[f]),h*=2,--f;return c};return function(o){for(var c=_JS2ANSI(o),f=i(c),d=c.length,h=new_raw_buf(16),m=0;m!=16;++m)h[m]=0;var g,v,y;for((d&1)===1&&(g=f>>8,h[d]=a(t[0],g),--d,g=f&255,v=c[c.length-1],h[d]=a(v,g));d>0;)--d,g=f>>8,h[d]=a(c[d],g),--d,g=f&255,h[d]=a(c[d],g);for(d=15,y=15-c.length;y>0;)g=f>>8,h[d]=a(t[y],g),--d,--y,g=f&255,h[d]=a(c[d],g),--d,--y;return h}}(),crypto_DecryptData_Method1=function(t,r,n,s,a){a||(a=r),s||(s=crypto_CreateXorArray_Method1(t));var i,o;for(i=0;i!=r.length;++i)o=r[i],o^=s[n],o=(o>>5|o<<3)&255,a[i]=o,++n;return[a,n,s]},crypto_MakeXorDecryptor=function(t){var r=0,n=crypto_CreateXorArray_Method1(t);return function(s){var a=crypto_DecryptData_Method1("",s,r,n);return r=a[1],a[0]}};function parse_XORObfuscation(t,r,n,s){var a={key:parseuint16(t),verificationBytes:parseuint16(t)};return n.password&&(a.verifier=crypto_CreatePasswordVerifier_Method1(n.password)),s.valid=a.verificationBytes===a.verifier,s.valid&&(s.insitu=crypto_MakeXorDecryptor(n.password)),a}function parse_FilePassHeader(t,r,n){var s=n||{};return s.Info=t.read_shift(2),t.l-=2,s.Info===1?s.Data=parse_RC4Header(t):s.Data=parse_RC4CryptoHeader(t,r),s}function parse_FilePass(t,r,n){var s={Type:n.biff>=8?t.read_shift(2):0};return s.Type?parse_FilePassHeader(t,r-2,s):parse_XORObfuscation(t,n.biff>=8?r:r-2,n,s),s}var RTF=function(){function t(a,i){switch(i.type){case"base64":return r(Base64_decode(a),i);case"binary":return r(a,i);case"buffer":return r(has_buf&&Buffer.isBuffer(a)?a.toString("binary"):a2s(a),i);case"array":return r(cc2str(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var o=i||{},c=o.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,m){Array.isArray(c)&&(c[m]=[]);for(var g=/\\\w+\b/g,v=0,y,_=-1;y=g.exec(h);){switch(y[0]){case"\\cell":var w=h.slice(v,g.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var b={v:w,t:"s"};Array.isArray(c)?c[m][_]=b:c[encode_cell({r:m,c:_})]=b}break}v=g.lastIndex}_>d.e.c&&(d.e.c=_)}),c["!ref"]=encode_range(d),c}function n(a,i){return sheet_to_workbook(t(a,i),i)}function s(a){for(var i=["{\\rtf1\\ansi"],o=safe_decode_range(a["!ref"]),c,f=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var m=encode_cell({r:d,c:h});c=f?(a[d]||[])[h]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(format_cell(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:s}}();function hex2RGB(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function rgb2Hex(t){for(var r=0,n=1;r!=3;++r)n=n*256+(t[r]>255?255:t[r]<0?0:t[r]);return n.toString(16).toUpperCase().slice(1)}function rgb2HSL(t){var r=t[0]/255,n=t[1]/255,s=t[2]/255,a=Math.max(r,n,s),i=Math.min(r,n,s),o=a-i;if(o===0)return[0,0,r];var c=0,f=0,d=a+i;switch(f=o/(d>1?2-d:d),a){case r:c=((n-s)/o+6)%6;break;case n:c=(s-r)/o+2;break;case s:c=(r-n)/o+4;break}return[c/6,f,d/2]}function hsl2RGB(t){var r=t[0],n=t[1],s=t[2],a=n*2*(s<.5?s:1-s),i=s-a/2,o=[i,i,i],c=6*r,f;if(n!==0)switch(c|0){case 0:case 6:f=a*c,o[0]+=a,o[1]+=f;break;case 1:f=a*(2-c),o[0]+=f,o[1]+=a;break;case 2:f=a*(c-2),o[1]+=a,o[2]+=f;break;case 3:f=a*(4-c),o[1]+=f,o[2]+=a;break;case 4:f=a*(c-4),o[2]+=a,o[0]+=f;break;case 5:f=a*(6-c),o[2]+=f,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function rgb_tint(t,r){if(r===0)return t;var n=rgb2HSL(hex2RGB(t));return r<0?n[2]=n[2]*(1+r):n[2]=1-(1-n[2])*(1-r),rgb2Hex(hsl2RGB(n))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(t){return Math.floor((t+Math.round(128/MDW)/256)*MDW)}function px2char(t){return Math.floor((t-5)/MDW*100+.5)/100}function char2width(t){return Math.round((t*MDW+5)/MDW*256)/256}function cycle_width(t){return char2width(px2char(width2px(t)))}function find_mdw_colw(t){var r=Math.abs(t-cycle_width(t)),n=MDW;if(r>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(t-cycle_width(t))<=r&&(r=Math.abs(t-cycle_width(t)),n=MDW);MDW=n}function process_col(t){t.width?(t.wpx=width2px(t.width),t.wch=px2char(t.wpx),t.MDW=MDW):t.wpx?(t.wch=px2char(t.wpx),t.width=char2width(t.wch),t.MDW=MDW):typeof t.wch=="number"&&(t.width=char2width(t.wch),t.wpx=width2px(t.width),t.MDW=MDW),t.customWidth&&delete t.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(t){return t*96/PPI}function pt2px(t){return t*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(t,r,n,s){r.Borders=[];var a={},i=!1;(t[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=parsexmlbool(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=parsexmlbool(c.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function parse_fills(t,r,n,s){r.Fills=[];var a={},i=!1;(t[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function parse_fonts(t,r,n,s){r.Fonts=[];var a={},i=!1;(t[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=utf8read(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?parsexmlbool(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?parsexmlbool(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?parsexmlbool(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?parsexmlbool(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?parsexmlbool(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?parsexmlbool(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?parsexmlbool(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=CS2CP[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=parsexmlbool(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=XLSIcv[a.color.index];a.color.index==81&&(f=XLSIcv[1]),f||(f=XLSIcv[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=rgb_tint(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function parse_numFmts(t,r,n){r.NumberFmt=[];for(var s=keys(table_fmt),a=0;a<s.length;++a)r.NumberFmt[s[a]]=table_fmt[s[a]];var i=t[0].match(tagregex);if(i)for(a=0;a<i.length;++a){var o=parsexmltag(i[a]);switch(strip_ns(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=unescapexml(utf8read(o.formatCode)),f=parseInt(o.numFmtId,10);if(r.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&r.NumberFmt[f]!=null;--f);r.NumberFmt[f]=c}SSF_load(c,f)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function write_numFmts(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&(r[r.length]=writextag("numFmt",null,{numFmtId:s,formatCode:escapexml(t[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=writextag("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(t,r,n){r.CellXf=[];var s,a=!1;(t[0].match(tagregex)||[]).forEach(function(i){var o=parsexmltag(i),c=0;switch(strip_ns(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],c=0;c<cellXF_uint.length;++c)s[cellXF_uint[c]]&&(s[cellXF_uint[c]]=parseInt(s[cellXF_uint[c]],10));for(c=0;c<cellXF_bool.length;++c)s[cellXF_bool[c]]&&(s[cellXF_bool[c]]=parsexmlbool(s[cellXF_bool[c]]));if(r.NumberFmt&&s.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[s.numFmtId]==r.NumberFmt[c]){s.numFmtId=c;break}}r.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=parsexmlbool(o.wrapText)),s.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function write_cellXfs(t){var r=[];return r[r.length]=writextag("cellXfs",null),t.forEach(function(n){r[r.length]=writextag("xf",null,n)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=writextag("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var parse_sty_xml=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(r))&&parse_numFmts(m,h,d),(m=c.match(a))&&parse_fonts(m,h,f,d),(m=c.match(s))&&parse_fills(m,h,f,d),(m=c.match(i))&&parse_borders(m,h,f,d),(m=c.match(n))&&parse_cellXfs(m,h,d),h}}();function write_sty_xml(t,r){var n=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],s;return t.SSF&&(s=write_numFmts(t.SSF))!=null&&(n[n.length]=s),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=write_cellXfs(r.cellXfs))&&(n[n.length]=s),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function parse_BrtFmt(t,r){var n=t.read_shift(2),s=parse_XLWideString(t);return[n,s]}function write_BrtFmt(t,r,n){n||(n=new_buf(6+4*r.length)),n.write_shift(2,t),write_XLWideString(r,n);var s=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),s}function parse_BrtFont(t,r,n){var s={};s.sz=t.read_shift(2)/20;var a=parse_FontFlags(t);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var i=t.read_shift(2);switch(i===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(s.underline=o);var c=t.read_shift(1);c>0&&(s.family=c);var f=t.read_shift(1);switch(f>0&&(s.charset=f),t.l++,s.color=parse_BrtColor(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=parse_XLWideString(t),s}function write_BrtFont(t,r){r||(r=new_buf(25+4*32)),r.write_shift(2,t.sz*20),write_FontFlags(t,r),r.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),r.write_shift(2,n),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),write_BrtColor(t.color,r);var s=0;return s=2,r.write_shift(1,s),write_XLWideString(t.name,r),r.length>r.l?r.slice(0,r.l):r}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(t,r){r||(r=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var n=rev_XLSBFillPTNames[t.patternType];n==null&&(n=40),r.write_shift(4,n);var s=0;if(n!=40)for(write_BrtColor({auto:1},r),write_BrtColor({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function parse_BrtXF(t,r){var n=t.l+r,s=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:s,numFmtId:a}}function write_BrtXF(t,r,n){n||(n=new_buf(16)),n.write_shift(2,r||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var s=0;return n.write_shift(1,s),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function write_Blxf(t,r){return r||(r=new_buf(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var parse_BrtBorder=parsenoop;function write_BrtBorder(t,r){return r||(r=new_buf(51)),r.write_shift(1,0),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),r.length>r.l?r.slice(0,r.l):r}function write_BrtStyle(t,r){return r||(r=new_buf(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),write_XLNullableWideString(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function write_BrtBeginTableStyles(t,r,n){var s=new_buf(2052);return s.write_shift(4,t),write_XLNullableWideString(r,s),write_XLNullableWideString(n,s),s.length>s.l?s.slice(0,s.l):s}function parse_sty_bin(t,r,n){var s={};s.NumberFmt=[];for(var a in table_fmt)s.NumberFmt[a]=table_fmt[a];s.CellXf=[],s.Fonts=[];var i=[],o=!1;return recordhopper(t,function(f,d,h){switch(h){case 44:s.NumberFmt[f[0]]=f[1],SSF_load(f[1],f[0]);break;case 43:s.Fonts.push(f),f.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(f.color.rgb=rgb_tint(r.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(h);else if(d.T<0)i.pop();else if(!o||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),s}function write_FMTS_bin(t,r){if(r){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&++n}),n!=0&&(write_record(t,615,write_UInt32LE(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&write_record(t,44,write_BrtFmt(a,r[a]))}),write_record(t,616))}}function write_FONTS_bin(t){var r=1;write_record(t,611,write_UInt32LE(r)),write_record(t,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(t,612)}function write_FILLS_bin(t){var r=2;write_record(t,603,write_UInt32LE(r)),write_record(t,45,write_BrtFill({patternType:"none"})),write_record(t,45,write_BrtFill({patternType:"gray125"})),write_record(t,604)}function write_BORDERS_bin(t){var r=1;write_record(t,613,write_UInt32LE(r)),write_record(t,46,write_BrtBorder()),write_record(t,614)}function write_CELLSTYLEXFS_bin(t){var r=1;write_record(t,626,write_UInt32LE(r)),write_record(t,47,write_BrtXF({numFmtId:0},65535)),write_record(t,627)}function write_CELLXFS_bin(t,r){write_record(t,617,write_UInt32LE(r.length)),r.forEach(function(n){write_record(t,47,write_BrtXF(n,0))}),write_record(t,618)}function write_STYLES_bin(t){var r=1;write_record(t,619,write_UInt32LE(r)),write_record(t,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(t,620)}function write_DXFS_bin(t){var r=0;write_record(t,505,write_UInt32LE(r)),write_record(t,506)}function write_TABLESTYLES_bin(t){var r=0;write_record(t,508,write_BrtBeginTableStyles(r,"TableStyleMedium9","PivotStyleMedium4")),write_record(t,509)}function write_sty_bin(t,r){var n=buf_array();return write_record(n,278),write_FMTS_bin(n,t.SSF),write_FONTS_bin(n),write_FILLS_bin(n),write_BORDERS_bin(n),write_CELLSTYLEXFS_bin(n),write_CELLXFS_bin(n,r.cellXfs),write_STYLES_bin(n),write_DXFS_bin(n),write_TABLESTYLES_bin(n),write_record(n,279),n.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(t,r,n){r.themeElements.clrScheme=[];var s={};(t[0].match(tagregex)||[]).forEach(function(a){var i=parsexmltag(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(t,r,n){r.themeElements={};var s;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(a){if(!(s=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](s,r,n)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(t,r){(!t||t.length===0)&&(t=write_theme());var n,s={};if(!(n=t.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(n[0],s,r),s.raw=t,s}function write_theme(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[XML_HEADER];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function parse_Theme(t,r,n){var s=t.l+r,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=s;return}var i=t.slice(t.l);t.l=s;var o;try{o=zip_read(i,{type:"array"})}catch{return}var c=getzipstr(o,"theme/theme/theme1.xml",!0);if(c)return parse_theme_xml(c,n)}}function parse_ColorTheme(t){return t.read_shift(4)}function parse_FullColorExt(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=parse_IcvXF(t,4);break;case 2:r.xclrValue=parse_LongRGBA(t);break;case 3:r.xclrValue=parse_ColorTheme(t);break;case 4:t.l+=4;break}return t.l+=8,r}function parse_IcvXF(t,r){return parsenoop(t,r)}function parse_XFExtGradient(t,r){return parsenoop(t,r)}function parse_ExtProp(t){var r=t.read_shift(2),n=t.read_shift(2)-4,s=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=parse_FullColorExt(t);break;case 6:s[1]=parse_XFExtGradient(t,n);break;case 14:case 15:s[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+n)}return s}function parse_XFExt(t,r){var n=t.l+r;t.l+=2;var s=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(parse_ExtProp(t,n-t.l));return{ixfe:s,ext:i}}function update_xfext(t,r){r.forEach(function(n){n[0]})}function parse_BrtMdtinfo(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:parse_XLWideString(t)}}function write_BrtMdtinfo(t){var r=new_buf(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),write_XLWideString(t.name,r),r.slice(0,r.l)}function parse_BrtMdb(t){for(var r=[],n=t.read_shift(4);n-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function write_BrtMdb(t){var r=new_buf(4+8*t.length);r.write_shift(4,t.length);for(var n=0;n<t.length;++n)r.write_shift(4,t[n][0]),r.write_shift(4,t[n][1]);return r}function write_BrtBeginEsfmd(t,r){var n=new_buf(8+2*r.length);return n.write_shift(4,t),write_XLWideString(r,n),n.slice(0,n.l)}function parse_BrtBeginEsmdb(t){return t.l+=4,t.read_shift(4)!=0}function write_BrtBeginEsmdb(t,r){var n=new_buf(8);return n.write_shift(4,t),n.write_shift(4,1),n}function parse_xlmeta_bin(t,r,n){var s={Types:[],Cell:[],Value:[]},a=n||{},i=[],o=!1,c=2;return recordhopper(t,function(f,d,h){switch(h){case 335:s.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?s.Cell.push({type:s.Types[m[0]-1].name,index:m[1]}):c==0&&s.Value.push({type:s.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),s}function write_xlmeta_bin(){var t=buf_array();return write_record(t,332),write_record(t,334,write_UInt32LE(1)),write_record(t,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(t,336),write_record(t,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(t,52),write_record(t,35,write_UInt32LE(514)),write_record(t,4096,write_UInt32LE(0)),write_record(t,4097,writeuint16(1)),write_record(t,36),write_record(t,53),write_record(t,340),write_record(t,337,write_BrtBeginEsmdb(1)),write_record(t,51,write_BrtMdb([[1,0]])),write_record(t,338),write_record(t,333),t.end()}function parse_xlmeta_xml(t,r,n){var s={Types:[],Cell:[],Value:[]};if(!t)return s;var a=!1,i=2,o;return t.replace(tagregex,function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<s.Types.length;++d)s.Types[d].name==f.name&&(o=s.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[f.t-1].name,index:+f.v}):i==0&&s.Value.push({type:s.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),s}function write_xlmeta_xml(){var t=[XML_HEADER];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function parse_cc_xml(t){var r=[];if(!t)return r;var n=1;return(t.match(tagregex)||[]).forEach(function(s){var a=parsexmltag(s);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,r.push(a);break}}),r}function parse_BrtCalcChainItem$(t){var r={};r.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),r.r=encode_cell(n);var s=t.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}function parse_cc_bin(t,r,n){var s=[];return recordhopper(t,function(i,o,c){switch(c){case 63:s.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),s}function parse_xlink_xml(){}function parse_xlink_bin(t,r,n,s){if(!t)return t;var a=s||{},i=!1;recordhopper(t,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function parse_drawing(t,r){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][n].Target}var _shapeid=1024;function write_comments_vml(t,r){for(var n=[21600,21600],s=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:s})];_shapeid<t*1e3;)_shapeid+=1e3;return r.forEach(function(i){var o=decode_cell(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=writextag("v:fill",f,c),h={on:"t",obscured:"t"};++_shapeid,a=a.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,writextag("v:shadow",null,h),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(o.r)),writetag("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function sheet_insert_comments(t,r,n,s){var a=Array.isArray(t),i;r.forEach(function(o){var c=decode_cell(o.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[o.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[o.ref]=i;var f=safe_decode_range(t["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=encode_range(f);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:n};o.h&&(h.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!n&&i.c[m].T)return;n&&!i.c[m].T&&i.c.splice(m,1)}if(n&&s){for(m=0;m<s.length;++m)if(h.a==s[m].id){h.a=s[m].name||h.a;break}}i.c.push(h)})}function parse_comments_xml(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],s=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=parsexmltag(c[0]),d={author:f.authorId&&n[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=decode_cell(f.ref);if(!(r.sheetRows&&r.sheetRows<=h.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&parse_si(m[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(d.h=g.h),s.push(d)}}}}),s}function write_comments_xml(t){var r=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],n=[];return r.push("<authors>"),t.forEach(function(s){s[1].forEach(function(a){var i=escapexml(a.a);n.indexOf(i)==-1&&(n.push(i),r.push("<author>"+i+"</author>")),a.T&&a.ID&&n.indexOf("tc="+a.ID)==-1&&(n.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(s){var a=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=n.indexOf("tc="+s[1][0].ID):s[1].forEach(function(f){f.a&&(a=n.indexOf(escapexml(f.a))),i.push(f.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),i.length<=1)r.push(writetag("t",escapexml(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;r.push(writetag("t",escapexml(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_tcmnt_xml(t,r){var n=[],s=!1,a={},i=0;return t.replace(tagregex,function(c,f){var d=parsexmltag(c);switch(strip_ns(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":i=f+c.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),n}function write_tcmnt_xml(t,r,n){var s=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};c==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),s.push(writextag("threadedComment",writetag("text",o.t||""),f))})}),s.push("</ThreadedComments>"),s.join("")}function parse_people_xml(t,r){var n=[],s=!1;return t.replace(tagregex,function(i){var o=parsexmltag(i);switch(strip_ns(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),n}function write_people_xml(t){var r=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,s){r.push(writextag("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:n,providerId:"None"}))}),r.push("</personList>"),r.join("")}function parse_BrtBeginComment(t){var r={};r.iauthor=t.read_shift(4);var n=parse_UncheckedRfX(t);return r.rfx=n.s,r.ref=encode_cell(n.s),t.l+=16,r}function write_BrtBeginComment(t,r){return r==null&&(r=new_buf(36)),r.write_shift(4,t[1].iauthor),write_UncheckedRfX(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(t){return write_XLWideString(t.slice(0,54))}function parse_comments_bin(t,r){var n=[],s=[],a={},i=!1;return recordhopper(t,function(c,f,d){switch(d){case 632:s.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=s[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function write_comments_bin(t){var r=buf_array(),n=[];return write_record(r,628),write_record(r,630),t.forEach(function(s){s[1].forEach(function(a){n.indexOf(a.a)>-1||(n.push(a.a.slice(0,54)),write_record(r,632,write_BrtCommentAuthor(a.a)))})}),write_record(r,631),write_record(r,633),t.forEach(function(s){s[1].forEach(function(a){a.iauthor=n.indexOf(a.a);var i={s:decode_cell(s[0]),e:decode_cell(s[0])};write_record(r,635,write_BrtBeginComment([i,a])),a.t&&a.t.length>0&&write_record(r,637,write_BrtCommentText(a)),write_record(r,636),delete a.iauthor})}),write_record(r,634),write_record(r,629),r.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(t){var r=CFB.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,s){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(r,a,t.FileIndex[s].content)}}),CFB.write(r)}function fill_vba_xls(t,r){r.FullPaths.forEach(function(n,s){if(s!=0){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&CFB.utils.cfb_add(t,a,r.FileIndex[s].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function n(s,a,i,o){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return c?h+=r.c:--h,f?d+=r.r:--d,a+(c?"":"$")+encode_col(h)+(f?"":"$")+encode_row(d)}return function(a,i){return r=i,a.replace(t,n)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(r,n){return r.replace(crefregex,function(s,a,i,o,c,f){var d=decode_col(o)-(i?0:n.c),h=decode_row(f)-(c?0:n.r),m=h==0?"":c?h+1:"["+h+"]",g=d==0?"":i?d+1:"["+d+"]";return a+"R"+m+"C"+g})}}();function shift_formula_str(t,r){return t.replace(crefregex,function(n,s,a,i,o,c){return s+(a=="$"?a+i:encode_col(decode_col(i)+r.c))+(o=="$"?o+c:encode_row(decode_row(c)+r.r))})}function shift_formula_xlsx(t,r,n){var s=decode_range(r),a=s.s,i=decode_cell(n),o={r:i.r-a.r,c:i.c-a.c};return shift_formula_str(t,o)}function fuzzyfmla(t){return t.length!=1}function _xlfn(t){return t.replace(/_xlfn\./g,"")}function parseread1(t){t.l+=1}function parse_ColRelU(t,r){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function parse_RgceArea(t,r,n){var s=2;if(n){if(n.biff>=2&&n.biff<=5)return parse_RgceArea_BIFF2(t);n.biff==12&&(s=4)}var a=t.read_shift(s),i=t.read_shift(s),o=parse_ColRelU(t),c=parse_ColRelU(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function parse_RgceArea_BIFF2(t){var r=parse_ColRelU(t),n=parse_ColRelU(t),s=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function parse_RgceAreaRel(t,r,n){if(n.biff<8)return parse_RgceArea_BIFF2(t);var s=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),i=parse_ColRelU(t),o=parse_ColRelU(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function parse_RgceLoc(t,r,n){if(n&&n.biff>=2&&n.biff<=5)return parse_RgceLoc_BIFF2(t);var s=t.read_shift(n&&n.biff==12?4:2),a=parse_ColRelU(t);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function parse_RgceLoc_BIFF2(t){var r=parse_ColRelU(t),n=t.read_shift(1);return{r:r[0],c:n,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(t){var r=t.read_shift(2),n=t.read_shift(2);return{r,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function parse_RgceLocRel(t,r,n){var s=n&&n.biff?n.biff:8;if(s>=2&&s<=5)return parse_RgceLocRel_BIFF2(t);var a=t.read_shift(s>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:c}}function parse_RgceLocRel_BIFF2(t){var r=t.read_shift(2),n=t.read_shift(1),s=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),a==1&&n>=128&&(n=n-256),{r,c:n,cRel:a,rRel:s}}function parse_PtgArea(t,r,n){var s=(t[t.l++]&96)>>5,a=parse_RgceArea(t,n.biff>=2&&n.biff<=5?6:8,n);return[s,a]}function parse_PtgArea3d(t,r,n){var s=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=parse_RgceArea(t,i,n);return[s,a,o]}function parse_PtgAreaErr(t,r,n){var s=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[s]}function parse_PtgAreaErr3d(t,r,n){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[s,a]}function parse_PtgAreaN(t,r,n){var s=(t[t.l++]&96)>>5,a=parse_RgceAreaRel(t,r-1,n);return[s,a]}function parse_PtgArray(t,r,n){var s=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[s]}function parse_PtgAttrBaxcel(t){var r=t[t.l+1]&1,n=1;return t.l+=4,[r,n]}function parse_PtgAttrChoose(t,r,n){t.l+=2;for(var s=t.read_shift(n&&n.biff==2?1:2),a=[],i=0;i<=s;++i)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function parse_PtgAttrGoto(t,r,n){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(n&&n.biff==2?1:2)]}function parse_PtgAttrIf(t,r,n){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(n&&n.biff==2?1:2)]}function parse_PtgAttrIfError(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function parse_PtgAttrSemi(t,r,n){var s=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[s]}function parse_PtgAttrSpaceType(t){var r=t.read_shift(1),n=t.read_shift(1);return[r,n]}function parse_PtgAttrSpace(t){return t.read_shift(2),parse_PtgAttrSpaceType(t)}function parse_PtgAttrSpaceSemi(t){return t.read_shift(2),parse_PtgAttrSpaceType(t)}function parse_PtgRef(t,r,n){var s=(t[t.l]&96)>>5;t.l+=1;var a=parse_RgceLoc(t,0,n);return[s,a]}function parse_PtgRefN(t,r,n){var s=(t[t.l]&96)>>5;t.l+=1;var a=parse_RgceLocRel(t,0,n);return[s,a]}function parse_PtgRef3d(t,r,n){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var i=parse_RgceLoc(t,0,n);return[s,a,i]}function parse_PtgFunc(t,r,n){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[FtabArgc[a],Ftab[a],s]}function parse_PtgFuncVar(t,r,n){var s=t[t.l++],a=t.read_shift(1),i=n&&n.biff<=3?[s==88?-1:0,t.read_shift(1)]:parsetab(t);return[a,(i[0]===0?Ftab:Cetab)[i[1]]]}function parsetab(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function parse_PtgAttrSum(t,r,n){t.l+=n&&n.biff==2?3:4}function parse_PtgExp(t,r,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[s,a]}function parse_PtgErr(t){return t.l++,BErr[t.read_shift(1)]}function parse_PtgInt(t){return t.l++,t.read_shift(2)}function parse_PtgBool(t){return t.l++,t.read_shift(1)!==0}function parse_PtgNum(t){return t.l++,parse_Xnum(t)}function parse_PtgStr(t,r,n){return t.l++,parse_ShortXLUnicodeString(t,r-1,n)}function parse_SerAr(t,r){var n=[t.read_shift(1)];if(r==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=parsebool(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:n[1]=BErr[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=parse_Xnum(t);break;case 2:n[1]=parse_XLUnicodeString2(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function parse_PtgExtraMem(t,r,n){for(var s=t.read_shift(n.biff==12?4:2),a=[],i=0;i!=s;++i)a.push((n.biff==12?parse_UncheckedRfX:parse_Ref8U)(t));return a}function parse_PtgExtraArray(t,r,n){var s=0,a=0;n.biff==12?(s=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),s=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--s,--a==0&&(a=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var c=0;c!=a;++c)o[i][c]=parse_SerAr(t,n.biff);return o}function parse_PtgName(t,r,n){var s=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,i]}function parse_PtgNameX(t,r,n){if(n.biff==5)return parse_PtgNameX_BIFF5(t);var s=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[s,a,i]}function parse_PtgNameX_BIFF5(t){var r=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[r,n,s]}function parse_PtgMemArea(t,r,n){var s=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[s,a]}function parse_PtgMemFunc(t,r,n){var s=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[s,a]}function parse_PtgRefErr(t,r,n){var s=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[s]}function parse_PtgRefErr3d(t,r,n){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[s,a]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(t,r,n){return t.l+=2,[parse_RgceElfLoc(t)]}function parse_PtgElfNoop(t){return t.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(t){return t.l+=2,[parseuint16(t),t.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(t){t.l+=2;var r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=PtgListRT[n>>2&31];return{ixti:r,coltype:n&3,rt:o,idx:s,c:a,C:i}}function parse_PtgSxName(t){return t.l+=2,[t.read_shift(4)]}function parse_PtgSheet(t,r,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(t,r,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(t){var r=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[r,n]}function parse_PtgMemNoMemN(t){var r=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[r,n]}function parse_PtgAttrNoop(t){return t.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(t,r,n,s){if(s.biff<8)return parsenoop(t,r);for(var a=t.l+r,i=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=parse_PtgExtraArray(t,0,s),i.push(n[o][1]);break;case"PtgMemArea":n[o][2]=parse_PtgExtraMem(t,n[o][1],s),i.push(n[o][2]);break;case"PtgExp":s&&s.biff==12&&(n[o][1][1]=t.read_shift(4),i.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return r=a-t.l,r!==0&&i.push(parsenoop(t,r)),i}function parse_Rgce(t,r,n){for(var s=t.l+r,a,i,o=[];s!=t.l;)r=s-t.l,i=t[t.l],a=PtgTypes[i]||PtgTypes[PtgDupes[i]],(i===24||i===25)&&(a=(i===24?Ptg18:Ptg19)[t[t.l+1]]),!a||!a.f?parsenoop(t,r):o.push([a.n,a.f(t,r,n)]);return o}function stringify_array(t){for(var r=[],n=0;n<t.length;++n){for(var s=t[n],a=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function get_ixti_raw(t,r,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[r];if(n.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!s)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[s[0]][0]){case 357:return a=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[s[0]][0][3]?(a=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function get_ixti(t,r,n){var s=get_ixti_raw(t,r,n);return s=="#REF"?s:formula_quote_sheet_name(s,n)}function stringify_formula(t,r,n,s,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},c=[],f,d,h,m=0,g=0,v,y="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",b=0,T=t[0].length;b<T;++b){var k=t[0][b];switch(k[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=fill(" ",t[0][_][1][1]);break;case 1:w=fill("\r",t[0][_][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}d=d+w,_=-1}c.push(d+PtgBinOp[k[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=shift_cell_xls(k[1][1],o,a),c.push(encode_cell_xls(h,i));break;case"PtgRefN":h=n?shift_cell_xls(k[1][1],n,a):k[1][1],c.push(encode_cell_xls(h,i));break;case"PtgRef3d":m=k[1][1],h=shift_cell_xls(k[1][2],o,a),y=get_ixti(s,m,a),c.push(y+"!"+encode_cell_xls(h,i));break;case"PtgFunc":case"PtgFuncVar":var C=k[1][0],L=k[1][1];C||(C=0),C&=127;var D=C==0?[]:c.slice(-C);c.length-=C,L==="User"&&(L=D.shift()),c.push(L+"("+D.join(",")+")");break;case"PtgBool":c.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(k[1]);break;case"PtgNum":c.push(String(k[1]));break;case"PtgStr":c.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(k[1]);break;case"PtgAreaN":v=shift_range_xls(k[1][1],n?{s:n}:o,a),c.push(encode_range_xls(v,a));break;case"PtgArea":v=shift_range_xls(k[1][1],o,a),c.push(encode_range_xls(v,a));break;case"PtgArea3d":m=k[1][1],v=k[1][2],y=get_ixti(s,m,a),c.push(y+"!"+encode_range_xls(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=k[1][2];var N=(s.names||[])[g-1]||(s[0]||[])[g],U=N?N.Name:"SH33TJSNAME"+String(g);U&&U.slice(0,6)=="_xlfn."&&!a.xlfn&&(U=U.slice(6)),c.push(U);break;case"PtgNameX":var M=k[1][1];g=k[1][2];var j;if(a.biff<=5)M<0&&(M=-M),s[M]&&(j=s[M][g]);else{var K="";if(((s[M]||[])[0]||[])[0]==14849||(((s[M]||[])[0]||[])[0]==1025?s[M][g]&&s[M][g].itab>0&&(K=s.SheetNames[s[M][g].itab-1]+"!"):K=s.SheetNames[g-1]+"!"),s[M]&&s[M][g])K+=s[M][g].Name;else if(s[0]&&s[0][g])K+=s[0][g].Name;else{var I=(get_ixti_raw(s,M,a)||"").split(";;");I[g-1]?K=I[g-1]:K+="SH33TJSERRX"}c.push(K);break}j||(j={Name:"SH33TJSERRY"}),c.push(j.Name);break;case"PtgParen":var te="(",_e=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:te=fill(" ",t[0][_][1][1])+te;break;case 3:te=fill("\r",t[0][_][1][1])+te;break;case 4:_e=fill(" ",t[0][_][1][1])+_e;break;case 5:_e=fill("\r",t[0][_][1][1])+_e;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}c.push(te+c.pop()+_e);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:k[1][1],r:k[1][0]};var ne={c:n.c,r:n.r};if(s.sharedf[encode_cell(h)]){var me=s.sharedf[encode_cell(h)];c.push(stringify_formula(me,o,ne,s,a))}else{var le=!1;for(f=0;f!=s.arrayf.length;++f)if(d=s.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){c.push(stringify_formula(d[1],o,ne,s,a)),le=!0;break}le||c.push(k[1])}break;case"PtgArray":c.push("{"+stringify_array(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&_>=0&&he.indexOf(t[0][b][0])==-1){k=t[0][_];var J=!0;switch(k[1][0]){case 4:J=!1;case 0:w=fill(" ",k[1][1]);break;case 5:J=!1;case 1:w=fill("\r",k[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}c.push((J?w:"")+c.pop()+(J?"":w)),_=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function parse_ArrayParsedFormula(t,r,n){var s=t.l+r,a=n.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],parsenoop(t,r-2)];var c=parse_Rgce(t,o,n);return r!==o+a&&(i=parse_RgbExtra(t,r-o-a,c,n)),t.l=s,[c,i]}function parse_XLSCellParsedFormula(t,r,n){var s=t.l+r,a=n.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],parsenoop(t,r-2)];var c=parse_Rgce(t,o,n);return r!==o+a&&(i=parse_RgbExtra(t,r-o-a,c,n)),t.l=s,[c,i]}function parse_NameParsedFormula(t,r,n,s){var a=t.l+r,i=parse_Rgce(t,s,n),o;return a!==t.l&&(o=parse_RgbExtra(t,a-t.l,i,n)),[i,o]}function parse_SharedParsedFormula(t,r,n){var s=t.l+r,a,i=t.read_shift(2),o=parse_Rgce(t,i,n);return i==65535?[[],parsenoop(t,r-2)]:(r!==i+2&&(a=parse_RgbExtra(t,s-i-2,o,n)),[o,a])}function parse_FormulaValue(t){var r;if(__readUInt16LE(t,t.l+6)!==65535)return[parse_Xnum(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function write_FormulaValue(t){if(t==null){var r=new_buf(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return write_Xnum(t);return write_Xnum(0)}function parse_Formula(t,r,n){var s=t.l+r,a=parse_XLSCell(t);n.biff==2&&++t.l;var i=parse_FormulaValue(t),o=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=parse_XLSCellParsedFormula(t,s-t.l,n);return{cell:a,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function write_Formula(t,r,n,s,a){var i=write_XLSCell(r,n,a),o=write_FormulaValue(t.v),c=new_buf(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=new_buf(t.bf.length),h=0;h<t.bf.length;++h)d[h]=t.bf[h];var m=bconcat([i,o,c,d]);return m}function parse_XLSBParsedFormula(t,r,n){var s=t.read_shift(4),a=parse_Rgce(t,s,n),i=t.read_shift(4),o=i>0?parse_RgbExtra(t,i,a,n):null;return[a,o]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(t){var r="of:="+t.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(t){var r=t.split(":"),n=r[0].split(".")[0];return[n,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function csf_to_ods_3D(t){return t.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(t,r,n){var s=0,a=t.length;if(n){if(browser_has_Map?n.has(r):Object.prototype.hasOwnProperty.call(n,r)){for(var i=browser_has_Map?n.get(r):n[r];s<i.length;++s)if(t[i[s]].t===r)return t.Count++,i[s]}}else for(;s<a;++s)if(t[s].t===r)return t.Count++,s;return t[a]={t:r},t.Count++,t.Unique++,n&&(browser_has_Map?(n.has(r)||n.set(r,[]),n.get(r).push(a)):(Object.prototype.hasOwnProperty.call(n,r)||(n[r]=[]),n[r].push(a))),a}function col_obj_w(t,r){var n={min:t+1,max:t+1},s=-1;return r.MDW&&(MDW=r.MDW),r.width!=null?n.customWidth=1:r.wpx!=null?s=px2char(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(n.width=char2width(s),n.customWidth=1):r.width!=null&&(n.width=r.width),r.hidden&&(n.hidden=!0),r.level!=null&&(n.outlineLevel=n.level=r.level),n}function default_margins(t,r){if(t){var n=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function get_cell_style(t,r,n){var s=n.revssf[r.z!=null?r.z:"General"],a=60,i=t.length;if(s==null&&n.ssf){for(;a<392;++a)if(n.ssf[a]==null){SSF_load(r.z,a),n.ssf[a]=r.z,n.revssf[r.z]=s=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===s)return a;return t[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function safe_format(t,r,n,s,a,i){try{s.cellNF&&(t.z=table_fmt[r])}catch(c){if(s.WTF)throw c}if(!(t.t==="z"&&!s.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=parseDate(t.v)),(!s||s.cellText!==!1)&&t.t!=="z")try{if(table_fmt[r]==null&&SSF_load(SSFImplicit[r]||"General",r),t.t==="e")t.w=t.w||BErr[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v);else if(t.t==="d"){var o=datenum(t.v);(o|0)===o?t.w=o.toString(10):t.w=SSF_general_num(o)}else{if(t.v===void 0)return"";t.w=SSF_general(t.v,_ssfopts)}else t.t==="d"?t.w=SSF_format(r,datenum(t.v),_ssfopts):t.w=SSF_format(r,t.v,_ssfopts)}catch(c){if(s.WTF)throw c}if(s.cellStyles&&n!=null)try{t.s=i.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=rgb_tint(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),s.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=rgb_tint(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),s.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(s.WTF&&i.Fills)throw c}}}function check_ws(t,r,n){if(t&&t["!ref"]){var s=safe_decode_range(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function parse_ws_xml_dim(t,r){var n=safe_decode_range(r);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=encode_range(n))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(t,r,n,s,a,i,o){if(!t)return t;s||(s={"!id":{}});var c=r.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=t.match(sheetdataregex);m?(d=t.slice(0,m.index),h=t.slice(m.index+m[0].length)):d=h=t;var g=d.match(sheetprregex);g?parse_ws_xml_sheetpr(g[0],c,a,n):(g=d.match(sheetprregex2))&&parse_ws_xml_sheetpr2(g[0],g[1]||"",c,a,n);var v=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=d.slice(v,v+50).match(dimregex);y&&parse_ws_xml_dim(c,y[1])}var _=d.match(svsregex);_&&_[1]&&parse_ws_xml_sheetviews(_[1],a);var w=[];if(r.cellStyles){var b=d.match(colregex);b&&parse_ws_xml_cols(w,b)}m&&parse_ws_xml_data(m[1],c,r,f,i,o);var T=h.match(afregex);T&&(c["!autofilter"]=parse_ws_xml_autofilter(T[0]));var k=[],C=h.match(mergecregex);if(C)for(v=0;v!=C.length;++v)k[v]=safe_decode_range(C[v].slice(C[v].indexOf('"')+1));var L=h.match(hlinkregex);L&&parse_ws_xml_hlinks(c,L,s);var D=h.match(marginregex);if(D&&(c["!margins"]=parse_ws_xml_margins(parsexmltag(D[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=encode_range(f)),r.sheetRows>0&&c["!ref"]){var N=safe_decode_range(c["!ref"]);r.sheetRows<=+N.e.r&&(N.e.r=r.sheetRows-1,N.e.r>f.e.r&&(N.e.r=f.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>f.e.c&&(N.e.c=f.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),c["!fullref"]=c["!ref"],c["!ref"]=encode_range(N))}return w.length>0&&(c["!cols"]=w),k.length>0&&(c["!merges"]=k),c}function write_ws_xml_merges(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)r+='<mergeCell ref="'+encode_range(t[n])+'"/>';return r+"</mergeCells>"}function parse_ws_xml_sheetpr(t,r,n,s){var a=parsexmltag(t);n.Sheets[s]||(n.Sheets[s]={}),a.codeName&&(n.Sheets[s].CodeName=unescapexml(utf8read(a.codeName)))}function parse_ws_xml_sheetpr2(t,r,n,s,a){parse_ws_xml_sheetpr(t.slice(0,t.indexOf(">")),n,s,a)}function write_ws_xml_sheetpr(t,r,n,s,a){var i=!1,o={},c=null;if(s.bookType!=="xlsx"&&r.vbaraw){var f=r.SheetNames[n];try{r.Workbook&&(f=r.Workbook.Sheets[n].CodeName||f)}catch{}i=!0,o.codeName=utf8write(escapexml(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),c=(c||"")+writextag("outlinePr",null,d)}!i&&!c||(a[a.length]=writextag("sheetPr",c,o))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(t){var r={sheet:1};return sheetprot_deffalse.forEach(function(n){t[n]!=null&&t[n]&&(r[n]="1")}),sheetprot_deftrue.forEach(function(n){t[n]!=null&&!t[n]&&(r[n]="0")}),t.password&&(r.password=crypto_CreatePasswordVerifier_Method1(t.password).toString(16).toUpperCase()),writextag("sheetProtection",null,r)}function parse_ws_xml_hlinks(t,r,n){for(var s=Array.isArray(t),a=0;a!=r.length;++a){var i=parsexmltag(utf8read(r[a]),!0);if(!i.ref)return;var o=((n||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+unescapexml(i.location))):(i.Target="#"+unescapexml(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=safe_decode_range(i.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var h=encode_cell({c:d,r:f});s?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=i):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=i)}}}function parse_ws_xml_margins(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(r[n]=parseFloat(t[n]))}),r}function write_ws_xml_margins(t){return default_margins(t),writextag("pageMargins",null,t)}function parse_ws_xml_cols(t,r){for(var n=!1,s=0;s!=r.length;++s){var a=parsexmltag(r[s],!0);a.hidden&&(a.hidden=parsexmlbool(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,find_mdw_colw(a.width)),process_col(a);i<=o;)t[i++]=dup(a)}}function write_ws_xml_cols(t,r){for(var n=["<cols>"],s,a=0;a!=r.length;++a)(s=r[a])&&(n[n.length]=writextag("col",null,col_obj_w(a,s)));return n[n.length]="</cols>",n.join("")}function parse_ws_xml_autofilter(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}function write_ws_xml_autofilter(t,r,n,s){var a=typeof t.ref=="string"?t.ref:encode_range(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,o=decode_range(a);o.s.r==o.e.r&&(o.e.r=decode_range(r["!ref"]).e.r,a=encode_range(o));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==s){f.Ref="'"+n.SheetNames[s]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+n.SheetNames[s]+"'!"+a}),writextag("autoFilter",null,{ref:a})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(t,r){r.Views||(r.Views=[{}]),(t.match(sviewregex)||[]).forEach(function(n,s){var a=parsexmltag(n);r.Views[s]||(r.Views[s]={}),+a.zoomScale&&(r.Views[s].zoom=+a.zoomScale),parsexmlbool(a.rightToLeft)&&(r.Views[s].RTL=!0)})}function write_ws_xml_sheetviews(t,r,n,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,a),{})}function write_ws_xml_cell(t,r,n,s){if(t.c&&n["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=BErr[t.v];break;case"d":s&&s.cellDates?a=parseDate(t.v,-1).toISOString():(t=dup(t),t.t="n",a=""+(t.v=datenum(parseDate(t.v)))),typeof t.z>"u"&&(t.z=table_fmt[14]);break;default:a=t.v;break}var c=writetag("v",escapexml(a)),f={r},d=get_cell_style(s.cellXfs,t,s);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){c=writetag("v",""+get_sst_id(s.Strings,t.v,s.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;c=writextag("f",escapexml(t.f),h)+(t.v!=null?c:"")}return t.l&&n["!links"].push([r,t.l]),t.D&&(f.cm=1),writextag("c",c,f)}var parse_ws_xml_data=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=matchtag("v"),o=matchtag("f");return function(f,d,h,m,g,v){for(var y=0,_="",w=[],b=[],T=0,k=0,C=0,L="",D,N,U=0,M=0,j,K,I=0,te=0,_e=Array.isArray(v.CellXf),ne,me=[],le=[],he=Array.isArray(d),J=[],fe={},G=!1,A=!!h.sheetStubs,q=f.split(r),P=0,V=q.length;P!=V;++P){_=q[P].trim();var ee=_.length;if(ee!==0){var ge=0;e:for(y=0;y<ee;++y)switch(_[y]){case">":if(_[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(N=parsexmltag(_.slice(ge,y),!0),U=N.r!=null?parseInt(N.r,10):U+1,M=-1,h.sheetRows&&h.sheetRows<U)continue;fe={},G=!1,N.ht&&(G=!0,fe.hpt=parseFloat(N.ht),fe.hpx=pt2px(fe.hpt)),N.hidden=="1"&&(G=!0,fe.hidden=!0),N.outlineLevel!=null&&(G=!0,fe.level=+N.outlineLevel),G&&(J[U-1]=fe)}break;case"<":ge=y;break}if(ge>=y)break;if(N=parsexmltag(_.slice(ge,y),!0),U=N.r!=null?parseInt(N.r,10):U+1,M=-1,!(h.sheetRows&&h.sheetRows<U)){m.s.r>U-1&&(m.s.r=U-1),m.e.r<U-1&&(m.e.r=U-1),h&&h.cellStyles&&(fe={},G=!1,N.ht&&(G=!0,fe.hpt=parseFloat(N.ht),fe.hpx=pt2px(fe.hpt)),N.hidden=="1"&&(G=!0,fe.hidden=!0),N.outlineLevel!=null&&(G=!0,fe.level=+N.outlineLevel),G&&(J[U-1]=fe)),w=_.slice(y).split(t);for(var xe=0;xe!=w.length&&w[xe].trim().charAt(0)=="<";++xe);for(w=w.slice(xe),y=0;y!=w.length;++y)if(_=w[y].trim(),_.length!==0){if(b=_.match(n),T=y,k=0,C=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,b!=null&&b.length===2){for(T=0,L=b[1],k=0;k!=L.length&&!((C=L.charCodeAt(k)-64)<1||C>26);++k)T=26*T+C;--T,M=T}else++M;for(k=0;k!=_.length&&_.charCodeAt(k)!==62;++k);if(++k,N=parsexmltag(_.slice(0,k),!0),N.r||(N.r=encode_cell({r:U-1,c:M})),L=_.slice(k),D={t:""},(b=L.match(i))!=null&&b[1]!==""&&(D.v=unescapexml(b[1])),h.cellFormula){if((b=L.match(o))!=null&&b[1]!==""){if(D.f=unescapexml(utf8read(b[1])).replace(/\r\n/g,`
`),h.xlfn||(D.f=_xlfn(D.f)),b[0].indexOf('t="array"')>-1)D.F=(L.match(a)||[])[1],D.F.indexOf(":")>-1&&me.push([safe_decode_range(D.F),D.F]);else if(b[0].indexOf('t="shared"')>-1){K=parsexmltag(b[0]);var de=unescapexml(utf8read(b[1]));h.xlfn||(de=_xlfn(de)),le[parseInt(K.si,10)]=[K,de,N.r]}}else(b=L.match(/<f[^>]*\/>/))&&(K=parsexmltag(b[0]),le[K.si]&&(D.f=shift_formula_xlsx(le[K.si][1],le[K.si][2],N.r)));var ve=decode_cell(N.r);for(k=0;k<me.length;++k)ve.r>=me[k][0].s.r&&ve.r<=me[k][0].e.r&&ve.c>=me[k][0].s.c&&ve.c<=me[k][0].e.c&&(D.F=me[k][1])}if(N.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(A)D.t="z";else continue;else D.t=N.t||"n";switch(m.s.c>M&&(m.s.c=M),m.e.c<M&&(m.e.c=M),D.t){case"n":if(D.v==""||D.v==null){if(!A)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!A)continue;D.t="z"}else j=strs[parseInt(D.v,10)],D.v=j.t,D.r=j.r,h.cellHTML&&(D.h=j.h);break;case"str":D.t="s",D.v=D.v!=null?utf8read(D.v):"",h.cellHTML&&(D.h=escapehtml(D.v));break;case"inlineStr":b=L.match(s),D.t="s",b!=null&&(j=parse_si(b[1]))?(D.v=j.t,h.cellHTML&&(D.h=j.h)):D.v="";break;case"b":D.v=parsexmlbool(D.v);break;case"d":h.cellDates?D.v=parseDate(D.v,1):(D.v=datenum(parseDate(D.v,1)),D.t="n");break;case"e":(!h||h.cellText!==!1)&&(D.w=D.v),D.v=RBErr[D.v];break}if(I=te=0,ne=null,_e&&N.s!==void 0&&(ne=v.CellXf[N.s],ne!=null&&(ne.numFmtId!=null&&(I=ne.numFmtId),h.cellStyles&&ne.fillId!=null&&(te=ne.fillId))),safe_format(D,I,te,h,g,v),h.cellDates&&_e&&D.t=="n"&&fmt_is_date(table_fmt[I])&&(D.t="d",D.v=numdate(D.v)),N.cm&&h.xlmeta){var je=(h.xlmeta.Cell||[])[+N.cm-1];je&&je.type=="XLDAPR"&&(D.D=!0)}if(he){var Y=decode_cell(N.r);d[Y.r]||(d[Y.r]=[]),d[Y.r][Y.c]=D}else d[N.r]=D}}}}J.length>0&&(d["!rows"]=J)}}();function write_ws_xml_data(t,r,n,s){var a=[],i=[],o=safe_decode_range(t["!ref"]),c="",f,d="",h=[],m=0,g=0,v=t["!rows"],y=Array.isArray(t),_={r:d},w,b=-1;for(g=o.s.c;g<=o.e.c;++g)h[g]=encode_col(g);for(m=o.s.r;m<=o.e.r;++m){for(i=[],d=encode_row(m),g=o.s.c;g<=o.e.c;++g){f=h[g]+d;var T=y?(t[m]||[])[g]:t[f];T!==void 0&&(c=write_ws_xml_cell(T,f,t,r))!=null&&i.push(c)}(i.length>0||v&&v[m])&&(_={r:d},v&&v[m]&&(w=v[m],w.hidden&&(_.hidden=1),b=-1,w.hpx?b=px2pt(w.hpx):w.hpt&&(b=w.hpt),b>-1&&(_.ht=b,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),a[a.length]=writextag("row",i.join(""),_))}if(v)for(;m<v.length;++m)v&&v[m]&&(_={r:m+1},w=v[m],w.hidden&&(_.hidden=1),b=-1,w.hpx?b=px2pt(w.hpx):w.hpt&&(b=w.hpt),b>-1&&(_.ht=b,_.customHeight=1),w.level&&(_.outlineLevel=w.level),a[a.length]=writextag("row","",_));return a.join("")}function write_ws_xml(t,r,n,s){var a=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],i=n.SheetNames[t],o=0,c="",f=n.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",h=safe_decode_range(d);if(h.e.c>16383||h.e.r>1048575){if(r.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=encode_range(h)}s||(s={}),f["!comments"]=[];var m=[];write_ws_xml_sheetpr(f,n,t,r,a),a[a.length]=writextag("dimension",null,{ref:d}),a[a.length]=write_ws_xml_sheetviews(f,r,t,n),r.sheetFormat&&(a[a.length]=writextag("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=write_ws_xml_cols(f,f["!cols"])),a[o=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=write_ws_xml_data(f,r),c.length>0&&(a[a.length]=c)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),f["!protect"]&&(a[a.length]=write_ws_xml_protection(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=write_ws_xml_autofilter(f["!autofilter"],f,n,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=write_ws_xml_merges(f["!merges"]));var g=-1,v,y=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(_){_[1].Target&&(v={ref:_[0]},_[1].Target.charAt(0)!="#"&&(y=add_rels(s,-1,escapexml(_[1].Target).replace(/#.*$/,""),RELS.HLINK),v["r:id"]="rId"+y),(g=_[1].Target.indexOf("#"))>-1&&(v.location=escapexml(_[1].Target.slice(g+1))),_[1].Tooltip&&(v.tooltip=escapexml(_[1].Tooltip)),a[a.length]=writextag("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=write_ws_xml_margins(f["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(y=add_rels(s,-1,"../drawings/drawing"+(t+1)+".xml",RELS.DRAW),a[a.length]=writextag("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=m),f["!comments"].length>0&&(y=add_rels(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",RELS.VML),a[a.length]=writextag("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtRowHdr(t,r){var n={},s=t.l+r;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=s,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=a/20),n}function write_BrtRowHdr(t,r,n){var s=new_buf(145),a=(n["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var i=320;a.hpx?i=px2pt(a.hpx)*20:a.hpt&&(i=a.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var c=0,f=s.l;s.l+=4;for(var d={r:t,c:0},h=0;h<16;++h)if(!(r.s.c>h+1<<10||r.e.c<h<<10)){for(var m=-1,g=-1,v=h<<10;v<h+1<<10;++v){d.c=v;var y=Array.isArray(n)?(n[d.r]||[])[d.c]:n[encode_cell(d)];y&&(m<0&&(m=v),g=v)}m<0||(++c,s.write_shift(4,m),s.write_shift(4,g))}var _=s.l;return s.l=f,s.write_shift(4,c),s.l=_,s.length>s.l?s.slice(0,s.l):s}function write_row_header(t,r,n,s){var a=write_BrtRowHdr(s,n,r);(a.length>17||(r["!rows"]||[])[s])&&write_record(t,0,a)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(t,r){var n={},s=t[t.l];return++t.l,n.above=!(s&64),n.left=!(s&128),t.l+=18,n.name=parse_XLSBCodeName(t),n}function write_BrtWsProp(t,r,n){n==null&&(n=new_buf(84+4*t.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),n.write_shift(1,s);for(var a=1;a<3;++a)n.write_shift(1,0);return write_BrtColor({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),write_XLSBCodeName(t,n),n.slice(0,n.l)}function parse_BrtCellBlank(t){var r=parse_XLSBCell(t);return[r]}function write_BrtCellBlank(t,r,n){return n==null&&(n=new_buf(8)),write_XLSBCell(r,n)}function parse_BrtShortBlank(t){var r=parse_XLSBShortCell(t);return[r]}function write_BrtShortBlank(t,r,n){return n==null&&(n=new_buf(4)),write_XLSBShortCell(r,n)}function parse_BrtCellBool(t){var r=parse_XLSBCell(t),n=t.read_shift(1);return[r,n,"b"]}function write_BrtCellBool(t,r,n){return n==null&&(n=new_buf(9)),write_XLSBCell(r,n),n.write_shift(1,t.v?1:0),n}function parse_BrtShortBool(t){var r=parse_XLSBShortCell(t),n=t.read_shift(1);return[r,n,"b"]}function write_BrtShortBool(t,r,n){return n==null&&(n=new_buf(5)),write_XLSBShortCell(r,n),n.write_shift(1,t.v?1:0),n}function parse_BrtCellError(t){var r=parse_XLSBCell(t),n=t.read_shift(1);return[r,n,"e"]}function write_BrtCellError(t,r,n){return n==null&&(n=new_buf(9)),write_XLSBCell(r,n),n.write_shift(1,t.v),n}function parse_BrtShortError(t){var r=parse_XLSBShortCell(t),n=t.read_shift(1);return[r,n,"e"]}function write_BrtShortError(t,r,n){return n==null&&(n=new_buf(8)),write_XLSBShortCell(r,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function parse_BrtCellIsst(t){var r=parse_XLSBCell(t),n=t.read_shift(4);return[r,n,"s"]}function write_BrtCellIsst(t,r,n){return n==null&&(n=new_buf(12)),write_XLSBCell(r,n),n.write_shift(4,r.v),n}function parse_BrtShortIsst(t){var r=parse_XLSBShortCell(t),n=t.read_shift(4);return[r,n,"s"]}function write_BrtShortIsst(t,r,n){return n==null&&(n=new_buf(8)),write_XLSBShortCell(r,n),n.write_shift(4,r.v),n}function parse_BrtCellReal(t){var r=parse_XLSBCell(t),n=parse_Xnum(t);return[r,n,"n"]}function write_BrtCellReal(t,r,n){return n==null&&(n=new_buf(16)),write_XLSBCell(r,n),write_Xnum(t.v,n),n}function parse_BrtShortReal(t){var r=parse_XLSBShortCell(t),n=parse_Xnum(t);return[r,n,"n"]}function write_BrtShortReal(t,r,n){return n==null&&(n=new_buf(12)),write_XLSBShortCell(r,n),write_Xnum(t.v,n),n}function parse_BrtCellRk(t){var r=parse_XLSBCell(t),n=parse_RkNumber(t);return[r,n,"n"]}function write_BrtCellRk(t,r,n){return n==null&&(n=new_buf(12)),write_XLSBCell(r,n),write_RkNumber(t.v,n),n}function parse_BrtShortRk(t){var r=parse_XLSBShortCell(t),n=parse_RkNumber(t);return[r,n,"n"]}function write_BrtShortRk(t,r,n){return n==null&&(n=new_buf(8)),write_XLSBShortCell(r,n),write_RkNumber(t.v,n),n}function parse_BrtCellRString(t){var r=parse_XLSBCell(t),n=parse_RichStr(t);return[r,n,"is"]}function parse_BrtCellSt(t){var r=parse_XLSBCell(t),n=parse_XLWideString(t);return[r,n,"str"]}function write_BrtCellSt(t,r,n){return n==null&&(n=new_buf(12+4*t.v.length)),write_XLSBCell(r,n),write_XLWideString(t.v,n),n.length>n.l?n.slice(0,n.l):n}function parse_BrtShortSt(t){var r=parse_XLSBShortCell(t),n=parse_XLWideString(t);return[r,n,"str"]}function write_BrtShortSt(t,r,n){return n==null&&(n=new_buf(8+4*t.v.length)),write_XLSBShortCell(r,n),write_XLWideString(t.v,n),n.length>n.l?n.slice(0,n.l):n}function parse_BrtFmlaBool(t,r,n){var s=t.l+r,a=parse_XLSBCell(t);a.r=n["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(n.cellFormula){t.l+=2;var c=parse_XLSBCellParsedFormula(t,s-t.l,n);o[3]=stringify_formula(c,null,a,n.supbooks,n)}else t.l=s;return o}function parse_BrtFmlaError(t,r,n){var s=t.l+r,a=parse_XLSBCell(t);a.r=n["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(n.cellFormula){t.l+=2;var c=parse_XLSBCellParsedFormula(t,s-t.l,n);o[3]=stringify_formula(c,null,a,n.supbooks,n)}else t.l=s;return o}function parse_BrtFmlaNum(t,r,n){var s=t.l+r,a=parse_XLSBCell(t);a.r=n["!row"];var i=parse_Xnum(t),o=[a,i,"n"];if(n.cellFormula){t.l+=2;var c=parse_XLSBCellParsedFormula(t,s-t.l,n);o[3]=stringify_formula(c,null,a,n.supbooks,n)}else t.l=s;return o}function parse_BrtFmlaString(t,r,n){var s=t.l+r,a=parse_XLSBCell(t);a.r=n["!row"];var i=parse_XLWideString(t),o=[a,i,"str"];if(n.cellFormula){t.l+=2;var c=parse_XLSBCellParsedFormula(t,s-t.l,n);o[3]=stringify_formula(c,null,a,n.supbooks,n)}else t.l=s;return o}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(t,r){return r==null&&(r=new_buf(4)),r.write_shift(4,t),r}function parse_BrtHLink(t,r){var n=t.l+r,s=parse_UncheckedRfX(t),a=parse_XLNullableWideString(t),i=parse_XLWideString(t),o=parse_XLWideString(t),c=parse_XLWideString(t);t.l=n;var f={rfx:s,relId:a,loc:i,display:c};return o&&(f.Tooltip=o),f}function write_BrtHLink(t,r){var n=new_buf(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(t[0]),e:decode_cell(t[0])},n),write_RelID("rId"+r,n);var s=t[1].Target.indexOf("#"),a=s==-1?"":t[1].Target.slice(s+1);return write_XLWideString(a||"",n),write_XLWideString(t[1].Tooltip||"",n),write_XLWideString("",n),n.slice(0,n.l)}function parse_BrtPane(){}function parse_BrtArrFmla(t,r,n){var s=t.l+r,a=parse_RfX(t),i=t.read_shift(1),o=[a];if(o[2]=i,n.cellFormula){var c=parse_XLSBArrayParsedFormula(t,s-t.l,n);o[1]=c}else t.l=s;return o}function parse_BrtShrFmla(t,r,n){var s=t.l+r,a=parse_UncheckedRfX(t),i=[a];if(n.cellFormula){var o=parse_XLSBSharedParsedFormula(t,s-t.l,n);i[1]=o,t.l=s}else t.l=s;return i}function write_BrtColInfo(t,r,n){n==null&&(n=new_buf(18));var s=col_obj_w(t,r);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(s.width||10)*256),n.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),n.write_shift(2,a),n}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(t){var r={};return BrtMarginKeys.forEach(function(n){r[n]=parse_Xnum(t)}),r}function write_BrtMargins(t,r){return r==null&&(r=new_buf(6*8)),default_margins(t),BrtMarginKeys.forEach(function(n){write_Xnum(t[n],r)}),r}function parse_BrtBeginWsView(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function write_BrtBeginWsView(t,r,n){n==null&&(n=new_buf(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),n.write_shift(2,s),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function write_BrtCellIgnoreEC(t){var r=new_buf(24);return r.write_shift(4,4),r.write_shift(4,1),write_UncheckedRfX(t,r),r}function write_BrtSheetProtection(t,r){return r==null&&(r=new_buf(16*4+2)),r.write_shift(2,t.password?crypto_CreatePasswordVerifier_Method1(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?r.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):r.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),r}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(t,r,n,s,a,i,o){if(!t)return t;var c=r||{};s||(s={"!id":{}});var f=c.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,y,_,w,b,T,k,C,L,D=[];c.biff=12,c["!row"]=0;var N=0,U=!1,M=[],j={},K=c.supbooks||a.supbooks||[[]];if(K.sharedf=j,K.arrayf=M,K.SheetNames=a.SheetNames||a.Sheets.map(function(he){return he.name}),!c.supbooks&&(c.supbooks=K,a.Names))for(var I=0;I<a.Names.length;++I)K[0][I+1]=a.Names[I];var te=[],_e=[],ne=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var me;if(recordhopper(t,function(J,fe,G){if(!g)switch(G){case 148:d=J;break;case 0:v=J,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),C=encode_row(w=v.r),c["!row"]=v.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=pt2px(J.hpt)),_e[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:J[2]},J[2]){case"n":y.v=J[1];break;case"s":k=strs[J[1]],y.v=k.t,y.r=k.r;break;case"b":y.v=!!J[1];break;case"e":y.v=J[1],c.cellText!==!1&&(y.w=BErr[y.v]);break;case"str":y.t="s",y.v=J[1];break;case"is":y.t="s",y.v=J[1].t;break}if((_=o.CellXf[J[0].iStyleRef])&&safe_format(y,_.numFmtId,null,c,i,o),b=J[0].c==-1?b+1:J[0].c,c.dense?(f[w]||(f[w]=[]),f[w][b]=y):f[encode_col(b)+C]=y,c.cellFormula){for(U=!1,N=0;N<M.length;++N){var A=M[N];v.r>=A[0].s.r&&v.r<=A[0].e.r&&b>=A[0].s.c&&b<=A[0].e.c&&(y.F=encode_range(A[0]),U=!0)}!U&&J.length>3&&(y.f=J[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>b&&(h.s.c=b),h.e.r<v.r&&(h.e.r=v.r),h.e.c<b&&(h.e.c=b),c.cellDates&&_&&y.t=="n"&&fmt_is_date(table_fmt[_.numFmtId])){var q=SSF_parse_date_code(y.v);q&&(y.t="d",y.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;y={t:"z",v:void 0},b=J[0].c==-1?b+1:J[0].c,c.dense?(f[w]||(f[w]=[]),f[w][b]=y):f[encode_col(b)+C]=y,h.s.r>v.r&&(h.s.r=v.r),h.s.c>b&&(h.s.c=b),h.e.r<v.r&&(h.e.r=v.r),h.e.c<b&&(h.e.c=b),me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 176:D.push(J);break;case 49:me=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var P=s["!id"][J.relId];for(P?(J.Target=P.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=P):J.relId==""&&(J.Target="#"+J.loc),w=J.rfx.s.r;w<=J.rfx.e.r;++w)for(b=J.rfx.s.c;b<=J.rfx.e.c;++b)c.dense?(f[w]||(f[w]=[]),f[w][b]||(f[w][b]={t:"z",v:void 0}),f[w][b].l=J):(T=encode_cell({c:b,r:w}),f[T]||(f[T]={t:"z",v:void 0}),f[T].l=J);break;case 426:if(!c.cellFormula)break;M.push(J),L=c.dense?f[w][b]:f[encode_col(b)+C],L.f=stringify_formula(J[1],h,{r:v.r,c:b},K,c),L.F=encode_range(J[0]);break;case 427:if(!c.cellFormula)break;j[encode_cell(J[0].s)]=J[1],L=c.dense?f[w][b]:f[encode_col(b)+C],L.f=stringify_formula(J[1],h,{r:v.r,c:b},K,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)te[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},ne||(ne=!0,find_mdw_colw(J.w/256)),process_col(te[J.e+1]);break;case 161:f["!autofilter"]={ref:encode_range(J)};break;case 476:f["!margins"]=J;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),J.name&&(a.Sheets[n].CodeName=J.name),(J.above||J.left)&&(f["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!fe.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=encode_range(d||h)),c.sheetRows&&f["!ref"]){var le=safe_decode_range(f["!ref"]);c.sheetRows<=+le.e.r&&(le.e.r=c.sheetRows-1,le.e.r>h.e.r&&(le.e.r=h.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>h.e.c&&(le.e.c=h.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=encode_range(le))}return D.length>0&&(f["!merges"]=D),te.length>0&&(f["!cols"]=te),_e.length>0&&(f["!rows"]=_e),f}function write_ws_bin_cell(t,r,n,s,a,i,o){if(r.v===void 0)return!1;var c="";switch(r.t){case"b":c=r.v?"1":"0";break;case"d":r=dup(r),r.z=r.z||table_fmt[14],r.v=datenum(parseDate(r.v)),r.t="n";break;case"n":case"e":c=""+r.v;break;default:c=r.v;break}var f={r:n,c:s};switch(f.s=get_cell_style(a.cellXfs,r,a),r.l&&i["!links"].push([encode_cell(f),r.l]),r.c&&i["!comments"].push([encode_cell(f),r.c]),r.t){case"s":case"str":return a.bookSST?(c=get_sst_id(a.Strings,r.v,a.revStrings),f.t="s",f.v=c,o?write_record(t,18,write_BrtShortIsst(r,f)):write_record(t,7,write_BrtCellIsst(r,f))):(f.t="str",o?write_record(t,17,write_BrtShortSt(r,f)):write_record(t,6,write_BrtCellSt(r,f))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?write_record(t,13,write_BrtShortRk(r,f)):write_record(t,2,write_BrtCellRk(r,f)):o?write_record(t,16,write_BrtShortReal(r,f)):write_record(t,5,write_BrtCellReal(r,f)),!0;case"b":return f.t="b",o?write_record(t,15,write_BrtShortBool(r,f)):write_record(t,4,write_BrtCellBool(r,f)),!0;case"e":return f.t="e",o?write_record(t,14,write_BrtShortError(r,f)):write_record(t,3,write_BrtCellError(r,f)),!0}return o?write_record(t,12,write_BrtShortBlank(r,f)):write_record(t,1,write_BrtCellBlank(r,f)),!0}function write_CELLTABLE(t,r,n,s){var a=safe_decode_range(r["!ref"]||"A1"),i,o="",c=[];write_record(t,145);var f=Array.isArray(r),d=a.e.r;r["!rows"]&&(d=Math.max(a.e.r,r["!rows"].length-1));for(var h=a.s.r;h<=d;++h){o=encode_row(h),write_row_header(t,r,a,h);var m=!1;if(h<=a.e.r)for(var g=a.s.c;g<=a.e.c;++g){h===a.s.r&&(c[g]=encode_col(g)),i=c[g]+o;var v=f?(r[h]||[])[g]:r[i];if(!v){m=!1;continue}m=write_ws_bin_cell(t,v,h,g,s,r,m)}}write_record(t,146)}function write_MERGECELLS(t,r){!r||!r["!merges"]||(write_record(t,177,write_BrtBeginMergeCells(r["!merges"].length)),r["!merges"].forEach(function(n){write_record(t,176,write_BrtMergeCell(n))}),write_record(t,178))}function write_COLINFOS(t,r){!r||!r["!cols"]||(write_record(t,390),r["!cols"].forEach(function(n,s){n&&write_record(t,60,write_BrtColInfo(s,n))}),write_record(t,391))}function write_IGNOREECS(t,r){!r||!r["!ref"]||(write_record(t,648),write_record(t,649,write_BrtCellIgnoreEC(safe_decode_range(r["!ref"]))),write_record(t,650))}function write_HLINKS(t,r,n){r["!links"].forEach(function(s){if(s[1].Target){var a=add_rels(n,-1,s[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(t,494,write_BrtHLink(s,a))}}),delete r["!links"]}function write_LEGACYDRAWING(t,r,n,s){if(r["!comments"].length>0){var a=add_rels(s,-1,"../drawings/vmlDrawing"+(n+1)+".vml",RELS.VML);write_record(t,551,write_RelID("rId"+a)),r["!legacy"]=a}}function write_AUTOFILTER(t,r,n,s){if(r["!autofilter"]){var a=r["!autofilter"],i=typeof a.ref=="string"?a.ref:encode_range(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,c=decode_range(i);c.s.r==c.e.r&&(c.e.r=decode_range(r["!ref"]).e.r,i=encode_range(c));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+n.SheetNames[s]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+n.SheetNames[s]+"'!"+i}),write_record(t,161,write_UncheckedRfX(safe_decode_range(i))),write_record(t,162)}}function write_WSVIEWS2(t,r,n){write_record(t,133),write_record(t,137,write_BrtBeginWsView(r,n)),write_record(t,138),write_record(t,134)}function write_SHEETPROTECT(t,r){r["!protect"]&&write_record(t,535,write_BrtSheetProtection(r["!protect"]))}function write_ws_bin(t,r,n,s){var a=buf_array(),i=n.SheetNames[t],o=n.Sheets[i]||{},c=i;try{n&&n.Workbook&&(c=n.Workbook.Sheets[t].CodeName||c)}catch{}var f=safe_decode_range(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],write_record(a,129),(n.vbaraw||o["!outline"])&&write_record(a,147,write_BrtWsProp(c,o["!outline"])),write_record(a,148,write_BrtWsDim(f)),write_WSVIEWS2(a,o,n.Workbook),write_COLINFOS(a,o),write_CELLTABLE(a,o,t,r),write_SHEETPROTECT(a,o),write_AUTOFILTER(a,o,n,t),write_MERGECELLS(a,o),write_HLINKS(a,o,s),o["!margins"]&&write_record(a,476,write_BrtMargins(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&write_IGNOREECS(a,o),write_LEGACYDRAWING(a,o,t,s),write_record(a,130),a.end()}function parse_Cache(t){var r=[],n=t.match(/^<c:numCache>/),s;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(r[+o[1]]=n?+o[2]:o[2])});var a=unescapexml((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[r,a,s]}function parse_chart(t,r,n,s,a,i){var o=i||{"!type":"chart"};if(!t)return i;var c=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=parse_Cache(m);h.s.r=h.s.c=0,h.e.c=c,d=encode_col(c),g[0].forEach(function(v,y){o[d+encode_row(y)]={t:"n",v,z:g[1]},f=y}),h.e.r<f&&(h.e.r=f),++c}),c>0&&(o["!ref"]=encode_range(h)),o}function parse_cs_xml(t,r,n,s,a){if(!t)return t;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(sheetprregex);return c&&parse_ws_xml_sheetpr(c[0],i,a,n),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function parse_BrtCsProp(t,r){t.l+=10;var n=parse_XLWideString(t);return{name:n}}function parse_cs_bin(t,r,n,s,a){if(!t)return t;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return recordhopper(t,function(f,d,h){switch(h){case 550:i["!rel"]=f;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),f.name&&(a.Sheets[n].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||r.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},r),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(t,r){for(var n=0;n!=t.length;++n)for(var s=t[n],a=0;a!=r.length;++a){var i=r[a];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=parsexmlbool(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function push_defaults(t,r){for(var n=0;n!=r.length;++n){var s=r[n];if(t[s[0]]==null)t[s[0]]=s[1];else switch(s[2]){case"bool":typeof t[s[0]]=="string"&&(t[s[0]]=parsexmlbool(t[s[0]]));break;case"int":typeof t[s[0]]=="string"&&(t[s[0]]=parseInt(t[s[0]],10));break}}}function parse_wb_defaults(t){push_defaults(t.WBProps,WBPropsDef),push_defaults(t.CalcPr,CalcPrDef),push_defaults_array(t.WBView,WBViewDef),push_defaults_array(t.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(t.WBProps.date1904)}function safe1904(t){return!t.Workbook||!t.Workbook.WBProps?"false":parsexmlbool(t.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return badchars.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function check_wb_names(t,r,n){t.forEach(function(s,a){check_ws_name(s);for(var i=0;i<a;++i)if(s==t[i])throw new Error("Duplicate Sheet Name: "+s);if(n){var o=r&&r[a]&&r[a].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function check_wb(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];check_wb_names(t.SheetNames,r,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)check_ws(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(t,r){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,a="xmlns",i={},o=0;if(t.replace(tagregex,function(f,d){var h=parsexmltag(f);switch(strip_ns(h[0])){case"<?xml":break;case"<workbook":f.match(wbnsregex)&&(a="xmlns"+f.match(/<(\w+):/)[1]),n.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],n.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":n.WBProps[m[0]]=parsexmlbool(h[m[0]]);break;case"int":n.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:n.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(n.WBProps.CodeName=utf8read(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],n.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=unescapexml(utf8read(h.name)),delete h[0],n.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=utf8read(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),parsexmlbool(h.hidden||"0")&&(i.Hidden=!0),o=d+f.length;break;case"</definedName>":i.Ref=unescapexml(utf8read(t.slice(o,d))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],n.CalcPr=h;break;case"<calcPr/>":delete h[0],n.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),XMLNS_main.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return parse_wb_defaults(n),n}function write_wb_xml(t){var r=[XML_HEADER];r[r.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(WBPropsDef.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(s[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=writextag("workbookPr",null,s);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:escapexml(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=writextag("sheet",null,o)}return r[r.length]="</sheets>",n&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(r[r.length]=writextag("definedName",escapexml(c.Ref),f))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBundleSh(t,r){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=parse_RelID(t),n.name=parse_XLWideString(t),n}function write_BrtBundleSh(t,r){return r||(r=new_buf(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),write_RelID(t.strRelID,r),write_XLWideString(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtWbProp(t,r){var n={},s=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=r>8?parse_XLWideString(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(s&65536),n.backupFile=!!(s&64),n.checkCompatibility=!!(s&4096),n.date1904=!!(s&1),n.filterPrivacy=!!(s&8),n.hidePivotFieldList=!!(s&1024),n.promptedSolutions=!!(s&16),n.publishItems=!!(s&2048),n.refreshAllConnections=!!(s&262144),n.saveExternalLinkValues=!!(s&128),n.showBorderUnselectedTables=!!(s&4),n.showInkAnnotation=!!(s&32),n.showObjects=["all","placeholders","none"][s>>13&3],n.showPivotChartFilter=!!(s&32768),n.updateLinks=["userSet","never","always"][s>>8&3],n}function write_BrtWbProp(t,r){r||(r=new_buf(72));var n=0;return t&&t.filterPrivacy&&(n|=8),r.write_shift(4,n),r.write_shift(4,0),write_XLSBCodeName(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function parse_BrtFRTArchID$(t,r){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=r-8,n}function parse_BrtName(t,r,n){var s=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),i=parse_XLNameWideString(t),o=parse_XLSBNameParsedFormula(t,0,n),c=parse_XLNullableWideString(t);t.l=s;var f={Name:i,Ptg:o};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function parse_wb_bin(t,r){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],a=!1;r||(r={}),r.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(t,function(f,d,h){switch(h){case 156:o.SheetNames.push(f.name),n.Sheets.push(f);break;case 153:n.WBProps=f;break;case 39:f.Sheet!=null&&(r.SID=f.Sheet),f.Ref=stringify_formula(f.Ptg,null,null,o,r),delete r.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,f]):o[0]=[h,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(h),a=!0;break;case 36:s.pop(),a=!1;break;case 37:s.push(h),a=!0;break;case 38:s.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||r.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},r),parse_wb_defaults(n),n.Names=i,n.supbooks=o,n}function write_BUNDLESHS(t,r){write_record(t,143);for(var n=0;n!=r.SheetNames.length;++n){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n]&&r.Workbook.Sheets[n].Hidden||0,a={Hidden:s,iTabID:n+1,strRelID:"rId"+(n+1),name:r.SheetNames[n]};write_record(t,156,write_BrtBundleSh(a))}write_record(t,144)}function write_BrtFileVersion(t,r){r||(r=new_buf(127));for(var n=0;n!=4;++n)r.write_shift(4,0);return write_XLWideString("SheetJS",r),write_XLWideString(XLSX.version,r),write_XLWideString(XLSX.version,r),write_XLWideString("7262",r),r.length>r.l?r.slice(0,r.l):r}function write_BrtBookView(t,r){r||(r=new_buf(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var n=120;return r.write_shift(1,n),r.length>r.l?r.slice(0,r.l):r}function write_BOOKVIEWS(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var n=r.Workbook.Sheets,s=0,a=-1,i=-1;s<n.length;++s)!n[s]||!n[s].Hidden&&a==-1?a=s:n[s].Hidden==1&&i==-1&&(i=s);i>a||(write_record(t,135),write_record(t,158,write_BrtBookView(a)),write_record(t,136))}}function write_wb_bin(t,r){var n=buf_array();return write_record(n,131),write_record(n,128,write_BrtFileVersion()),write_record(n,153,write_BrtWbProp(t.Workbook&&t.Workbook.WBProps||null)),write_BOOKVIEWS(n,t),write_BUNDLESHS(n,t),write_record(n,132),n.end()}function parse_wb(t,r,n){return r.slice(-4)===".bin"?parse_wb_bin(t,n):parse_wb_xml(t,n)}function parse_ws(t,r,n,s,a,i,o,c){return r.slice(-4)===".bin"?parse_ws_bin(t,s,n,a,i,o,c):parse_ws_xml(t,s,n,a,i,o,c)}function parse_cs(t,r,n,s,a,i,o,c){return r.slice(-4)===".bin"?parse_cs_bin(t,s,n,a,i):parse_cs_xml(t,s,n,a,i)}function parse_ms(t,r,n,s,a,i,o,c){return r.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(t,r,n,s,a,i,o,c){return r.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(t,r,n,s){return r.slice(-4)===".bin"?parse_sty_bin(t,n,s):parse_sty_xml(t,n,s)}function parse_theme(t,r,n){return parse_theme_xml(t,n)}function parse_sst(t,r,n){return r.slice(-4)===".bin"?parse_sst_bin(t,n):parse_sst_xml(t,n)}function parse_cmnt(t,r,n){return r.slice(-4)===".bin"?parse_comments_bin(t,n):parse_comments_xml(t,n)}function parse_cc(t,r,n){return r.slice(-4)===".bin"?parse_cc_bin(t):parse_cc_xml(t)}function parse_xlink(t,r,n,s){return n.slice(-4)===".bin"?parse_xlink_bin(t,r,n,s):void 0}function parse_xlmeta(t,r,n){return r.slice(-4)===".bin"?parse_xlmeta_bin(t,r,n):parse_xlmeta_xml(t,r,n)}function write_wb(t,r,n){return(r.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(t)}function write_ws(t,r,n,s,a){return(r.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(t,n,s,a)}function write_sty(t,r,n){return(r.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(t,n)}function write_sst(t,r,n){return(r.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(t,n)}function write_cmnt(t,r,n){return(r.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(t)}function write_xlmeta(t){return(t.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(t,r){var n=t.split(/\s+/),s=[];if(s[0]=n[0],n.length===1)return s;var a=t.match(attregexg2),i,o,c,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(attregex2),(o=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),s[c]=i[2].slice(1,i[2].length-1));return s}function xlml_parsexmltagobj(t){var r=t.split(/\s+/),n={};if(r.length===1)return n;var s=t.match(attregexg2),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(attregex2),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}var XLMLFormatMap;function xlml_format(t,r){var n=XLMLFormatMap[t]||unescapexml(t);return n==="General"?SSF_general(r):SSF_format(n,r)}function xlml_set_custprop(t,r,n,s){var a=s;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=parsexmlbool(s);break;case"i2":case"int":a=parseInt(s,10);break;case"r4":case"float":a=parseFloat(s);break;case"date":case"dateTime.tz":a=parseDate(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[unescapexml(r)]=a}function safe_format_xlml(t,r,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||BErr[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v):t.w=SSF_general(t.v):t.w=xlml_format(r||"General",t.v)}catch(i){if(n.WTF)throw i}try{var s=XLMLFormatMap[r]||r||"General";if(n.cellNF&&(t.z=s),n.cellDates&&t.t=="n"&&fmt_is_date(s)){var a=SSF_parse_date_code(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function process_style_xlml(t,r,n){if(n.cellStyles&&r.Interior){var s=r.Interior;s.Pattern&&(s.patternType=XLMLPatternTypeMap[s.Pattern]||s.Pattern)}t[r.ID]=r}function parse_xlml_data(t,r,n,s,a,i,o,c,f,d){var h="General",m=s.StyleID,g={};d=d||{};var v=[],y=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&v.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(n.Type){case"Boolean":s.t="b",s.v=parsexmlbool(t);break;case"String":s.t="s",s.r=xlml_fixstr(unescapexml(t)),s.v=t.indexOf("<")>-1?unescapexml(r||t).replace(/<.*?>/g,""):s.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),s.v=(parseDate(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=unescapexml(t):s.v<60&&(s.v=s.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+t),s.t||(s.t="n");break;case"Error":s.t="e",s.v=RBErr[t],d.cellText!==!1&&(s.w=t);break;default:t==""&&r==""?s.t="z":(s.t="s",s.v=xlml_fixstr(r||t));break}if(safe_format_xlml(s,h,d),d.cellFormula!==!1)if(s.Formula){var _=unescapexml(s.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),s.f=rc_to_a1(_,a),delete s.Formula,s.ArrayRange=="RC"?s.F=rc_to_a1("RC:RC",a):s.ArrayRange&&(s.F=rc_to_a1(s.ArrayRange,a),f.push([safe_decode_range(s.F),s.F]))}else for(y=0;y<f.length;++y)a.r>=f[y][0].s.r&&a.r<=f[y][0].e.r&&a.c>=f[y][0].s.c&&a.c<=f[y][0].e.c&&(s.F=f[y][1]);d.cellStyles&&(v.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),s.s=g),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function xlml_clean_comment(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function parse_xlml_xml(t,r){var n=r||{};make_ssf();var s=debom(xlml_normalize(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(s=utf8read(s));var a=s.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=dup(n);return o.type="string",PRN.to_workbook(s,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){a.indexOf("<"+tt)>=0&&(i=!0)}),i)return html_to_workbook(s,n);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,h={},m=[],g=n.dense?[]:{},v="",y={},_={},w=xlml_parsexmltag('<Data ss:Type="String">'),b=0,T=0,k=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},D={},N="",U=0,M=[],j={},K={},I=0,te=[],_e=[],ne={},me=[],le,he=!1,J=[],fe=[],G={},A=0,q=0,P={Sheets:[],WBProps:{date1904:!1}},V={};xlmlregex.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";c=xlmlregex.exec(s);)switch(c[3]=(ee=c[3]).toLowerCase()){case"data":if(ee=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?parse_xlml_data(s.slice(b,c.index),N,w,f[f.length-1][0]=="comment"?ne:y,{c:T,r:k},L,me[T],_,J,n):(N="",w=xlml_parsexmltag(c[0]),b=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(_e.length>0&&(y.c=_e),(!n.sheetRows||n.sheetRows>k)&&y.v!==void 0&&(n.dense?(g[k]||(g[k]=[]),g[k][T]=y):g[encode_col(T)+encode_row(k)]=y),y.HRef&&(y.l={Target:unescapexml(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(A=T+(parseInt(y.MergeAcross,10)|0),q=k+(parseInt(y.MergeDown,10)|0),M.push({s:{c:T,r:k},e:{c:A,r:q}})),!n.sheetStubs)y.MergeAcross?T=A+1:++T;else if(y.MergeAcross||y.MergeDown){for(var ge=T;ge<=A;++ge)for(var xe=k;xe<=q;++xe)(ge>T||xe>k)&&(n.dense?(g[xe]||(g[xe]=[]),g[xe][ge]={t:"z"}):g[encode_col(ge)+encode_row(xe)]={t:"z"});T=A+1}else++T;else y=xlml_parsexmltagobj(c[0]),y.Index&&(T=+y.Index-1),T<C.s.c&&(C.s.c=T),T>C.e.c&&(C.e.c=T),c[0].slice(-2)==="/>"&&++T,_e=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(k<C.s.r&&(C.s.r=k),k>C.e.r&&(C.e.r=k),c[0].slice(-2)==="/>"&&(_=xlml_parsexmltag(c[0]),_.Index&&(k=+_.Index-1)),T=0,++k):(_=xlml_parsexmltag(c[0]),_.Index&&(k=+_.Index-1),G={},(_.AutoFitHeight=="0"||_.Height)&&(G.hpx=parseInt(_.Height,10),G.hpt=px2pt(G.hpx),fe[k]=G),_.Hidden=="1"&&(G.hidden=!0,fe[k]=G));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));m.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(g["!ref"]=encode_range(C),n.sheetRows&&n.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=n.sheetRows-1,g["!ref"]=encode_range(C))),M.length&&(g["!merges"]=M),me.length>0&&(g["!cols"]=me),fe.length>0&&(g["!rows"]=fe),h[v]=g}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=T=0,f.push([c[3],!1]),d=xlml_parsexmltag(c[0]),v=unescapexml(d.Name),g=n.dense?[]:{},M=[],J=[],fe=[],V={name:v,Hidden:0},P.Sheets.push(V);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),me=[],he=!1}break;case"style":c[1]==="/"?process_style_xlml(L,D,n):D=xlml_parsexmltag(c[0]);break;case"numberformat":D.nf=unescapexml(xlml_parsexmltag(c[0]).Format||"General"),XLMLFormatMap[D.nf]&&(D.nf=XLMLFormatMap[D.nf]);for(var de=0;de!=392&&table_fmt[de]!=D.nf;++de);if(de==392){for(de=57;de!=392;++de)if(table_fmt[de]==null){SSF_load(D.nf,de);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=xlml_parsexmltag(c[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!he&&le.wpx>10){he=!0,MDW=DEF_MDW;for(var ve=0;ve<me.length;++ve)me[ve]&&process_col(me[ve])}he&&process_col(le),me[le.Index-1||me.length]=le;for(var je=0;je<+le.Span;++je)me[me.length]=dup(le);break;case"namedrange":if(c[1]==="/")break;P.Names||(P.Names=[]);var Y=parsexmltag(c[0]),Xe={Name:Y.Name,Ref:rc_to_a1(Y.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Xe.Sheet=P.Sheets.length-1),P.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?N+=s.slice(U,c.index):U=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;D.Interior=xlml_parsexmltag(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?xlml_set_prop(j,ee,s.slice(I,c.index)):I=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));xlml_clean_comment(ne),_e.push(ne)}else f.push([c[3],!1]),d=xlml_parsexmltag(c[0]),ne={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ve=xlml_parsexmltag(c[0]);g["!autofilter"]={ref:rc_to_a1(Ve.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return parse_fods(s,n);var Ye=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(c[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(s.slice(I,c.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else I=c.index+c[0].length;break;case"header":g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+parsexmltag(c[0]).Margin)||(g["!margins"].header=+parsexmltag(c[0]).Margin);break;case"footer":g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+parsexmltag(c[0]).Margin)||(g["!margins"].footer=+parsexmltag(c[0]).Margin);break;case"pagemargins":var We=parsexmltag(c[0]);g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+We.Top)||(g["!margins"].top=+We.Top),isNaN(+We.Left)||(g["!margins"].left=+We.Left),isNaN(+We.Right)||(g["!margins"].right=+We.Right),isNaN(+We.Bottom)||(g["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?xlml_set_custprop(K,ee,te,s.slice(I,c.index)):(te=c,I=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Re={};return!n.bookSheets&&!n.bookProps&&(Re.Sheets=h),Re.SheetNames=m,Re.Workbook=P,Re.SSF=dup(table_fmt),Re.Props=j,Re.Custprops=K,Re}function parse_xlml(t,r){switch(fix_read_opts(r=r||{}),r.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(t),r);case"binary":case"buffer":case"file":return parse_xlml_xml(t,r);case"array":return parse_xlml_xml(a2s(t),r)}}function write_props_xlml(t,r){var n=[];return t.Props&&n.push(xlml_write_docprops(t.Props,r)),t.Custprops&&n.push(xlml_write_custprops(t.Props,t.Custprops)),n.join("")}function write_wb_xlml(){return""}function write_sty_xlml(t,r){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,a){var i=[];i.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[s.numFmtId])}));var o={"ss:ID":"s"+(21+a)};n.push(writextag("Style",i.join(""),o))}),writextag("Styles",n.join(""))}function write_name_xlml(t){return writextag("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+a1_to_rc(t.Ref,{r:0,c:0})})}function write_names_xlml(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,n=[],s=0;s<r.length;++s){var a=r[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||n.push(write_name_xlml(a)))}return writextag("Names",n.join(""))}function write_ws_xlml_names(t,r,n,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,i=[],o=0;o<a.length;++o){var c=a[o];c.Sheet==n&&(c.Name.match(/^_xlfn\./)||i.push(write_name_xlml(c)))}return i.join("")}function write_ws_xlml_wsopts(t,r,n,s){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(writextag("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(writextag("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(writextag("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[n])if(s.Workbook.Sheets[n].Hidden)a.push(writextag("Visible",s.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(writetag("ProtectContents","True")),t["!protect"].objects&&a.push(writetag("ProtectObjects","True")),t["!protect"].scenarios&&a.push(writetag("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(writetag("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":writextag("WorksheetOptions",a.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(t){return t.map(function(r){var n=xlml_unfixstr(r.t||""),s=writextag("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",s,{"ss:Author":r.a})}).join("")}function write_ws_xlml_cell(t,r,n,s,a,i,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+escapexml(a1_to_rc(t.f,o))),t.F&&t.F.slice(0,r.length)==r){var f=decode_cell(t.F.slice(r.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=escapexml(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=escapexml(t.l.Tooltip))),n["!merges"])for(var d=n["!merges"],h=0;h!=d.length;++h)d[h].s.c!=o.c||d[h].s.r!=o.r||(d[h].e.c>d[h].s.c&&(c["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(c["ss:MergeDown"]=d[h].e.r-d[h].s.r));var m="",g="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":m="Number",g=String(t.v);break;case"b":m="Boolean",g=t.v?"1":"0";break;case"e":m="Error",g=BErr[t.v];break;case"d":m="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||table_fmt[14]);break;case"s":m="String",g=escapexlml(t.v||"");break}var v=get_cell_style(s.cellXfs,t,s);c["ss:StyleID"]="s"+(21+v),c["ss:Index"]=o.c+1;var y=t.v!=null?g:"",_=t.t=="z"?"":'<Data ss:Type="'+m+'">'+y+"</Data>";return(t.c||[]).length>0&&(_+=write_ws_xlml_comment(t.c)),writextag("Cell",_,c)}function write_ws_xlml_row(t,r){var n='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=pt2px(r.hpt)),r.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(n+=' ss:Hidden="1"')),n+">"}function write_ws_xlml_table(t,r,n,s){if(!t["!ref"])return"";var a=safe_decode_range(t["!ref"]),i=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(w,b){process_col(w);var T=!!w.width,k=col_obj_w(b,w),C={"ss:Index":b+1};T&&(C["ss:Width"]=width2px(k.width)),w.hidden&&(C["ss:Hidden"]="1"),c.push(writextag("Column",null,C))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var h=[write_ws_xlml_row(d,(t["!rows"]||[])[d])],m=a.s.c;m<=a.e.c;++m){var g=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>m)&&!(i[o].s.r>d)&&!(i[o].e.c<m)&&!(i[o].e.r<d)){(i[o].s.c!=m||i[o].s.r!=d)&&(g=!0);break}if(!g){var v={r:d,c:m},y=encode_cell(v),_=f?(t[d]||[])[m]:t[y];h.push(write_ws_xlml_cell(_,y,t,r,n,s,v))}}h.push("</Row>"),h.length>2&&c.push(h.join(""))}return c.join("")}function write_ws_xlml(t,r,n){var s=[],a=n.SheetNames[t],i=n.Sheets[a],o=i?write_ws_xlml_names(i,r,t,n):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?write_ws_xlml_table(i,r,t,n):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(write_ws_xlml_wsopts(i,r,t,n)),s.join("")}function write_xlml(t,r){r||(r={}),t.SSF||(t.SSF=dup(table_fmt)),t.SSF&&(make_ssf(),SSF_load_table(t.SSF),r.revssf=evert_num(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(write_props_xlml(t,r)),n.push(write_wb_xlml()),n.push(""),n.push("");for(var s=0;s<t.SheetNames.length;++s)n.push(writextag("Worksheet",write_ws_xlml(s,r,t),{"ss:Name":escapexml(t.SheetNames[s])}));return n[2]=write_sty_xlml(t,r),n[3]=write_names_xlml(t),XML_HEADER+writextag("Workbook",n.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(t){var r={},n=t.content;if(n.l=28,r.AnsiUserType=n.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(n),n.length-n.l<=4)return r;var s=n.read_shift(4);if(s==0||s>40||(n.l-=4,r.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(s=n.read_shift(4),s!==1907505652)||(r.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(n),s=n.read_shift(4),s==0||s>40))return r;n.l-=4,r.Reserved2=n.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(t,r,n,s,a){var i=s,o=[],c=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}o.push(c),n.l+=i;for(var f=__readUInt16LE(n,n.l),d=XLSRecordEnum[f],h=0;d!=null&&CONTINUE_RT.indexOf(f)>-1;)i=__readUInt16LE(n,n.l+2),h=n.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),c=n.slice(h,n.l+4+i),o.push(c),n.l+=4+i,d=XLSRecordEnum[f=__readUInt16LE(n,n.l)];var m=bconcat(o);prep_blob(m,0);var g=0;m.lens=[];for(var v=0;v<o.length;++v)m.lens.push(g),g+=o[v].length;if(m.length<s)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+m.length+" < "+s;return r.f(m,m.length,a)}function safe_format_xf(t,r,n){if(t.t!=="z"&&t.XF){var s=0;try{s=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=table_fmt[s])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||BErr[t.v]:s===0||s=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v):t.w=SSF_general(t.v):t.w=SSF_format(s,t.v,{date1904:!!n,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&s&&t.t=="n"&&fmt_is_date(table_fmt[s]||String(s))){var a=SSF_parse_date_code(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function make_cell(t,r,n){return{v:t,ixfe:r,t:n}}function parse_workbook(t,r){var n={opts:{}},s={},a=r.dense?[]:{},i={},o={},c=null,f=[],d="",h={},m,g="",v,y,_,w,b={},T=[],k,C,L=[],D=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},M=function(ze){return ze<8?XLSIcv[ze]:ze<64&&D[ze-8]||XLSIcv[ze]},j=function(ze,Ke,Nt){var at=Ke.XF.data;if(!(!at||!at.patternType||!Nt||!Nt.cellStyles)){Ke.s={},Ke.s.patternType=at.patternType;var rr;(rr=rgb2Hex(M(at.icvFore)))&&(Ke.s.fgColor={rgb:rr}),(rr=rgb2Hex(M(at.icvBack)))&&(Ke.s.bgColor={rgb:rr})}},K=function(ze,Ke,Nt){if(!(G>1)&&!(Nt.sheetRows&&ze.r>=Nt.sheetRows)){if(Nt.cellStyles&&Ke.XF&&Ke.XF.data&&j(ze,Ke,Nt),delete Ke.ixfe,delete Ke.XF,m=ze,g=encode_cell(ze),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<o.s.r&&(o.s.r=ze.r),ze.c<o.s.c&&(o.s.c=ze.c),ze.r+1>o.e.r&&(o.e.r=ze.r+1),ze.c+1>o.e.c&&(o.e.c=ze.c+1),Nt.cellFormula&&Ke.f){for(var at=0;at<T.length;++at)if(!(T[at][0].s.c>ze.c||T[at][0].s.r>ze.r)&&!(T[at][0].e.c<ze.c||T[at][0].e.r<ze.r)){Ke.F=encode_range(T[at][0]),(T[at][0].s.c!=ze.c||T[at][0].s.r!=ze.r)&&delete Ke.f,Ke.f&&(Ke.f=""+stringify_formula(T[at][1],o,ze,J,I));break}}Nt.dense?(a[ze.r]||(a[ze.r]=[]),a[ze.r][ze.c]=Ke):a[g]=Ke}},I={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(I.password=r.password);var te,_e=[],ne=[],me=[],le=[],he=!1,J=[];J.SheetNames=I.snames,J.sharedf=I.sharedf,J.arrayf=I.arrayf,J.names=[],J.XTI=[];var fe=0,G=0,A=0,q=[],P=[],V;I.codepage=1200,set_cp(1200);for(var ee=!1;t.l<t.length-1;){var ge=t.l,xe=t.read_shift(2);if(xe===0&&fe===10)break;var de=t.l===t.length?0:t.read_shift(2),ve=XLSRecordEnum[xe];if(ve&&ve.f){if(r.bookSheets&&fe===133&&xe!==133)break;if(fe=xe,ve.r===2||ve.r==12){var je=t.read_shift(2);if(de-=2,!I.enc&&je!==xe&&((je&255)<<8|je>>8)!==xe)throw new Error("rt mismatch: "+je+"!="+xe);ve.r==12&&(t.l+=10,de-=10)}var Y={};if(xe===10?Y=ve.f(t,de,I):Y=slurp(xe,ve,t,de,I),G==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(xe){case 34:n.opts.Date1904=N.WBProps.date1904=Y;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=Y,!r.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=Y;break;case 66:var Xe=Number(Y);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}set_cp(I.codepage=Xe),ee=!0;break;case 317:I.rrtabid=Y;break;case 25:I.winlocked=Y;break;case 439:n.opts.RefreshAll=Y;break;case 12:n.opts.CalcCount=Y;break;case 16:n.opts.CalcDelta=Y;break;case 17:n.opts.CalcIter=Y;break;case 13:n.opts.CalcMode=Y;break;case 14:n.opts.CalcPrecision=Y;break;case 95:n.opts.CalcSaveRecalc=Y;break;case 15:I.CalcRefMode=Y;break;case 2211:n.opts.FullCalc=Y;break;case 129:Y.fDialog&&(a["!type"]="dialog"),Y.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Y.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(Y);break;case 430:J.push([Y]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(Y);break;case 24:case 536:V={Name:Y.Name,Ref:stringify_formula(Y.rgce,o,null,J,I)},Y.itab>0&&(V.Sheet=Y.itab-1),J.names.push(V),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(P[Y.itab-1]={ref:encode_range(Y.rgce[0][0][1][2])});break;case 22:I.ExternCount=Y;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(Y),J.XTI=J.XTI.concat(Y);break;case 2196:if(I.biff<8)break;V!=null&&(V.Comment=Y[1]);break;case 18:a["!protect"]=Y;break;case 19:Y!==0&&I.WTF&&console.error("Password verifier: "+Y);break;case 133:i[Y.pos]=Y,I.snames.push(Y.name);break;case 10:{if(--G)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=encode_range(o),r.sheetRows&&r.sheetRows<=o.e.r){var Ve=o.e.r;o.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=encode_range(o),o.e.r=Ve}o.e.r++,o.e.c++}_e.length>0&&(a["!merges"]=_e),ne.length>0&&(a["!objects"]=ne),me.length>0&&(a["!cols"]=me),le.length>0&&(a["!rows"]=le),N.Sheets.push(U)}d===""?h=a:s[d]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),I.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(I.biff=5,ee=!0,set_cp(I.codepage=28591)),I.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(I.biff=2),G++)break;if(a=r.dense?[]:{},I.biff<8&&!ee&&(ee=!0,set_cp(I.codepage=r.codepage||1252)),I.biff<5||Y.BIFFVer==0&&Y.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:t.l-de,name:d};i[Ye.pos]=Ye,I.snames.push(d)}else d=(i[ge]||{name:""}).name;Y.dt==32&&(a["!type"]="chart"),Y.dt==64&&(a["!type"]="macro"),_e=[],ne=[],I.arrayf=T=[],me=[],le=[],he=!1,U={Hidden:(i[ge]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[Y.r]||[])[Y.c]:a[encode_cell({c:Y.c,r:Y.r})])&&++Y.c,k={ixfe:Y.ixfe,XF:L[Y.ixfe]||{},v:Y.val,t:"n"},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r);break;case 5:case 517:k={ixfe:Y.ixfe,XF:L[Y.ixfe],v:Y.val,t:Y.t},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r);break;case 638:k={ixfe:Y.ixfe,XF:L[Y.ixfe],v:Y.rknum,t:"n"},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r);break;case 189:for(var We=Y.c;We<=Y.C;++We){var Re=Y.rkrec[We-Y.c][0];k={ixfe:Re,XF:L[Re],v:Y.rkrec[We-Y.c][1],t:"n"},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:We,r:Y.r},k,r)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(k=make_cell(Y.val,Y.cell.ixfe,Y.tt),k.XF=L[k.ixfe],r.cellFormula){var tt=Y.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var yt=tt[0][0][1][0],wt=tt[0][0][1][1],Et=encode_cell({r:yt,c:wt});b[Et]?k.f=""+stringify_formula(Y.formula,o,Y.cell,J,I):k.F=((r.dense?(a[yt]||[])[wt]:a[Et])||{}).F}else k.f=""+stringify_formula(Y.formula,o,Y.cell,J,I)}A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K(Y.cell,k,r),c=Y}break;case 7:case 519:if(c)c.val=Y,k=make_cell(Y,c.cell.ixfe,"s"),k.XF=L[k.ixfe],r.cellFormula&&(k.f=""+stringify_formula(c.formula,o,c.cell,J,I)),A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K(c.cell,k,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(Y);var lr=encode_cell(Y[0].s);if(v=r.dense?(a[Y[0].s.r]||[])[Y[0].s.c]:a[lr],r.cellFormula&&v){if(!c||!lr||!v)break;v.f=""+stringify_formula(Y[1],o,Y[0],J,I),v.F=encode_range(Y[0])}}break;case 1212:{if(!r.cellFormula)break;if(g){if(!c)break;b[encode_cell(c.cell)]=Y[0],v=r.dense?(a[c.cell.r]||[])[c.cell.c]:a[encode_cell(c.cell)],(v||{}).f=""+stringify_formula(Y[0],o,m,J,I)}}break;case 253:k=make_cell(f[Y.isst].t,Y.ixfe,"s"),f[Y.isst].h&&(k.h=f[Y.isst].h),k.XF=L[k.ixfe],A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r);break;case 513:r.sheetStubs&&(k={ixfe:Y.ixfe,XF:L[Y.ixfe],t:"z"},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r));break;case 190:if(r.sheetStubs)for(var Gt=Y.c;Gt<=Y.C;++Gt){var St=Y.ixfe[Gt-Y.c];k={ixfe:St,XF:L[St],t:"z"},A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Gt,r:Y.r},k,r)}break;case 214:case 516:case 4:k=make_cell(Y.val,Y.ixfe,"s"),k.XF=L[k.ixfe],A>0&&(k.z=q[k.ixfe>>8&63]),safe_format_xf(k,r,n.opts.Date1904),K({c:Y.c,r:Y.r},k,r);break;case 0:case 512:G===1&&(o=Y);break;case 252:f=Y;break;case 1054:if(I.biff==4){q[A++]=Y[1];for(var zt=0;zt<A+163&&table_fmt[zt]!=Y[1];++zt);zt>=163&&SSF_load(Y[1],A+163)}else SSF_load(Y[1],Y[0]);break;case 30:{q[A++]=Y;for(var Kt=0;Kt<A+163&&table_fmt[Kt]!=Y;++Kt);Kt>=163&&SSF_load(Y,A+163)}break;case 229:_e=_e.concat(Y);break;case 93:ne[Y.cmo[0]]=I.lastobj=Y;break;case 438:I.lastobj.TxO=Y;break;case 127:I.lastobj.ImData=Y;break;case 440:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(_=Y[0].s.c;_<=Y[0].e.c;++_)v=r.dense?(a[w]||[])[_]:a[encode_cell({c:_,r:w})],v&&(v.l=Y[1]);break;case 2048:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(_=Y[0].s.c;_<=Y[0].e.c;++_)v=r.dense?(a[w]||[])[_]:a[encode_cell({c:_,r:w})],v&&v.l&&(v.l.Tooltip=Y[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;v=r.dense?(a[Y[0].r]||[])[Y[0].c]:a[encode_cell(Y[0])];var cr=ne[Y[2]];v||(r.dense?(a[Y[0].r]||(a[Y[0].r]=[]),v=a[Y[0].r][Y[0].c]={t:"z"}):v=a[encode_cell(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),v.c||(v.c=[]),y={a:Y[1],t:cr.TxO.t},v.c.push(y)}break;case 2173:update_xfext(L[Y.ixfe],Y.ext);break;case 125:{if(!I.cellStyles)break;for(;Y.e>=Y.s;)me[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},he||(he=!0,find_mdw_colw(Y.w/256)),process_col(me[Y.e+1])}break;case 520:{var ut={};Y.level!=null&&(le[Y.r]=ut,ut.level=Y.level),Y.hidden&&(le[Y.r]=ut,ut.hidden=!0),Y.hpt&&(le[Y.r]=ut,ut.hpt=Y.hpt,ut.hpx=pt2px(Y.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||default_margins(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=Y;break;case 161:a["!margins"]||default_margins(a["!margins"]={}),a["!margins"].header=Y.header,a["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(N.Views[0].RTL=!0);break;case 146:D=Y;break;case 2198:te=Y;break;case 140:C=Y;break;case 442:d?U.CodeName=Y||U.name:N.WBProps.CodeName=Y||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),t.l+=de}return n.SheetNames=keys(i).sort(function(jt,ze){return Number(jt)-Number(ze)}).map(function(jt){return i[jt].name}),r.bookSheets||(n.Sheets=s),!n.SheetNames.length&&h["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=h)):n.Preamble=h,n.Sheets&&P.forEach(function(jt,ze){n.Sheets[n.SheetNames[ze]]["!autofilter"]=jt}),n.Strings=f,n.SSF=dup(table_fmt),I.enc&&(n.Encryption=I.enc),te&&(n.Themes=te),n.Metadata={},C!==void 0&&(n.Metadata.Country=C),J.names.length>0&&(N.Names=J.names),n.Workbook=N,n}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(t,r,n){var s=CFB.find(t,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var a=parse_PropertySetStream(s,DocSummaryPIDDSI,PSCLSID.DSI);for(var i in a)r[i]=a[i]}catch(d){if(n.WTF)throw d}var o=CFB.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=parse_PropertySetStream(o,SummaryPIDSI,PSCLSID.SI);for(var f in c)r[f]==null&&(r[f]=c[f])}catch(d){if(n.WTF)throw d}r.HeadingPairs&&r.TitlesOfParts&&(load_props_pairs(r.HeadingPairs,r.TitlesOfParts,r,n),delete r.HeadingPairs,delete r.TitlesOfParts)}function write_xls_props(t,r){var n=[],s=[],a=[],i=0,o,c=evert_key(DocSummaryPIDDSI,"n"),f=evert_key(SummaryPIDSI,"n");if(t.Props)for(o=keys(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?n:Object.prototype.hasOwnProperty.call(f,o[i])?s:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=keys(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?n:Object.prototype.hasOwnProperty.call(f,o[i])?s:a).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)XLSPSSkip.indexOf(a[i][0])>-1||PseudoPropsPairs.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);s.length&&CFB.utils.cfb_add(r,"/SummaryInformation",write_PropertySetStream(s,PSCLSID.SI,f,SummaryPIDSI)),(n.length||d.length)&&CFB.utils.cfb_add(r,"/DocumentSummaryInformation",write_PropertySetStream(n,PSCLSID.DSI,c,DocSummaryPIDDSI,d.length?d:null,PSCLSID.UDI))}function parse_xlscfb(t,r){r||(r={}),fix_read_opts(r),reset_cp(),r.codepage&&set_ansi(r.codepage);var n,s;if(t.FullPaths){if(CFB.find(t,"/encryption"))throw new Error("File is password-protected");n=CFB.find(t,"!CompObj"),s=CFB.find(t,"/Workbook")||CFB.find(t,"/Book")}else{switch(r.type){case"base64":t=s2a(Base64_decode(t));break;case"binary":t=s2a(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}prep_blob(t,0),s={content:t}}var a,i;if(n&&parse_compobj(n),r.bookProps&&!r.bookSheets)a={};else{var o=has_buf?"buffer":"array";if(s&&s.content)a=parse_workbook(s.content,r);else if((i=CFB.find(t,"PerfectOffice_MAIN"))&&i.content)a=WK_.to_workbook(i.content,(r.type=o,r));else if((i=CFB.find(t,"NativeContent_MAIN"))&&i.content)a=WK_.to_workbook(i.content,(r.type=o,r));else throw(i=CFB.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&CFB.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=make_vba_xls(t))}var c={};return t.FullPaths&&parse_xls_props(t,c,r),a.Props=a.Custprops=c,r.bookFiles&&(a.cfb=t),a}function write_xlscfb(t,r){var n=r||{},s=CFB.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return CFB.utils.cfb_add(s,a,write_biff_buf(t,n)),n.biff==8&&(t.Props||t.Custprops)&&write_xls_props(t,s),n.biff==8&&t.vbaraw&&fill_vba_xls(s,CFB.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(t,r,n,s){var a=r;if(!isNaN(a)){var i=s||(n||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&is_buf(n)&&t.push(n)}}function write_biff_continue(t,r,n,s){var a=(n||[]).length||0;if(a<=8224)return write_biff_rec(t,r,n,a);var i=r;if(!isNaN(i)){for(var o=n.parts||[],c=0,f=0,d=0;d+(o[c]||8224)<=8224;)d+=o[c]||8224,c++;var h=t.next(4);for(h.write_shift(2,i),h.write_shift(2,d),t.push(n.slice(f,f+d)),f+=d;f<a;){for(h=t.next(4),h.write_shift(2,60),d=0;d+(o[c]||8224)<=8224;)d+=o[c]||8224,c++;h.write_shift(2,d),t.push(n.slice(f,f+d)),f+=d}}}function write_BIFF2Cell(t,r,n){return t||(t=new_buf(7)),t.write_shift(2,r),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function write_BIFF2BERR(t,r,n,s){var a=new_buf(9);return write_BIFF2Cell(a,t,r),write_Bes(n,s||"b",a),a}function write_BIFF2LABEL(t,r,n){var s=new_buf(8+2*n.length);return write_BIFF2Cell(s,t,r),s.write_shift(1,n.length),s.write_shift(n.length,n,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function write_ws_biff2_cell(t,r,n,s){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?datenum(parseDate(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?write_biff_rec(t,2,write_BIFF2INT(n,s,a)):write_biff_rec(t,3,write_BIFF2NUM(n,s,a));return;case"b":case"e":write_biff_rec(t,5,write_BIFF2BERR(n,s,r.v,r.t));return;case"s":case"str":write_biff_rec(t,4,write_BIFF2LABEL(n,s,(r.v||"").slice(0,255)));return}write_biff_rec(t,1,write_BIFF2Cell(null,n,s))}function write_ws_biff2(t,r,n,s){var a=Array.isArray(r),i=safe_decode_range(r["!ref"]||"A1"),o,c="",f=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=encode_range(i)}for(var d=i.s.r;d<=i.e.r;++d){c=encode_row(d);for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(f[h]=encode_col(h)),o=f[h]+c;var m=a?(r[d]||[])[h]:r[o];m&&write_ws_biff2_cell(t,m,d,h)}}}function write_biff2_buf(t,r){for(var n=r||{},s=buf_array(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==n.sheet&&(a=i);if(a==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return write_biff_rec(s,n.biff==4?1033:n.biff==3?521:9,write_BOF(t,16,n)),write_ws_biff2(s,t.Sheets[t.SheetNames[a]],a,n),write_biff_rec(s,10),s.end()}function write_FONTS_biff8(t,r,n){write_biff_rec(t,49,write_Font({sz:12,name:"Arial"},n))}function write_FMTS_biff8(t,r,n){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&write_biff_rec(t,1054,write_Format(a,r[a],n))})}function write_FEAT(t,r){var n=new_buf(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),write_biff_rec(t,2151,n),n=new_buf(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),write_Ref8U(safe_decode_range(r["!ref"]||"A1"),n),n.write_shift(4,4),write_biff_rec(t,2152,n)}function write_CELLXFS_biff8(t,r){for(var n=0;n<16;++n)write_biff_rec(t,224,write_XF({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){write_biff_rec(t,224,write_XF(s,0,r))})}function write_ws_biff8_hlinks(t,r){for(var n=0;n<r["!links"].length;++n){var s=r["!links"][n];write_biff_rec(t,440,write_HLink(s)),s[1].Tooltip&&write_biff_rec(t,2048,write_HLinkTooltip(s))}delete r["!links"]}function write_ws_cols_biff8(t,r){if(r){var n=0;r.forEach(function(s,a){++n<=256&&s&&write_biff_rec(t,125,write_ColInfo(col_obj_w(a,s),a))})}}function write_ws_biff8_cell(t,r,n,s,a){var i=16+get_cell_style(a.cellXfs,r,a);if(r.v==null&&!r.bf){write_biff_rec(t,513,write_XLSCell(n,s,i));return}if(r.bf)write_biff_rec(t,6,write_Formula(r,n,s,a,i));else switch(r.t){case"d":case"n":var o=r.t=="d"?datenum(parseDate(r.v)):r.v;write_biff_rec(t,515,write_Number(n,s,o,i));break;case"b":case"e":write_biff_rec(t,517,write_BoolErr(n,s,r.v,i,a,r.t));break;case"s":case"str":if(a.bookSST){var c=get_sst_id(a.Strings,r.v,a.revStrings);write_biff_rec(t,253,write_LabelSst(n,s,c,i))}else write_biff_rec(t,516,write_Label(n,s,(r.v||"").slice(0,255),i,a));break;default:write_biff_rec(t,513,write_XLSCell(n,s,i))}}function write_ws_biff8(t,r,n){var s=buf_array(),a=n.SheetNames[t],i=n.Sheets[a]||{},o=(n||{}).Workbook||{},c=(o.Sheets||[])[t]||{},f=Array.isArray(i),d=r.biff==8,h,m="",g=[],v=safe_decode_range(i["!ref"]||"A1"),y=d?65536:16384;if(v.e.c>255||v.e.r>=y){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,y-1)}write_biff_rec(s,2057,write_BOF(n,16,r)),write_biff_rec(s,13,writeuint16(1)),write_biff_rec(s,12,writeuint16(100)),write_biff_rec(s,15,writebool(!0)),write_biff_rec(s,17,writebool(!1)),write_biff_rec(s,16,write_Xnum(.001)),write_biff_rec(s,95,writebool(!0)),write_biff_rec(s,42,writebool(!1)),write_biff_rec(s,43,writebool(!1)),write_biff_rec(s,130,writeuint16(1)),write_biff_rec(s,128,write_Guts()),write_biff_rec(s,131,writebool(!1)),write_biff_rec(s,132,writebool(!1)),d&&write_ws_cols_biff8(s,i["!cols"]),write_biff_rec(s,512,write_Dimensions(v,r)),d&&(i["!links"]=[]);for(var _=v.s.r;_<=v.e.r;++_){m=encode_row(_);for(var w=v.s.c;w<=v.e.c;++w){_===v.s.r&&(g[w]=encode_col(w)),h=g[w]+m;var b=f?(i[_]||[])[w]:i[h];b&&(write_ws_biff8_cell(s,b,_,w,r),d&&b.l&&i["!links"].push([h,b.l]))}}var T=c.CodeName||c.name||a;return d&&write_biff_rec(s,574,write_Window2((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&write_biff_rec(s,229,write_MergeCells(i["!merges"])),d&&write_ws_biff8_hlinks(s,i),write_biff_rec(s,442,write_XLUnicodeString(T)),d&&write_FEAT(s,i),write_biff_rec(s,10),s.end()}function write_biff8_global(t,r,n){var s=buf_array(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},c=n.biff==8,f=n.biff==5;if(write_biff_rec(s,2057,write_BOF(t,5,n)),n.bookType=="xla"&&write_biff_rec(s,135),write_biff_rec(s,225,c?writeuint16(1200):null),write_biff_rec(s,193,writezeroes(2)),f&&write_biff_rec(s,191),f&&write_biff_rec(s,192),write_biff_rec(s,226),write_biff_rec(s,92,write_WriteAccess("SheetJS",n)),write_biff_rec(s,66,writeuint16(c?1200:1252)),c&&write_biff_rec(s,353,writeuint16(0)),c&&write_biff_rec(s,448),write_biff_rec(s,317,write_RRTabId(t.SheetNames.length)),c&&t.vbaraw&&write_biff_rec(s,211),c&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";write_biff_rec(s,442,write_XLUnicodeString(d))}write_biff_rec(s,156,writeuint16(17)),write_biff_rec(s,25,writebool(!1)),write_biff_rec(s,18,writebool(!1)),write_biff_rec(s,19,writeuint16(0)),c&&write_biff_rec(s,431,writebool(!1)),c&&write_biff_rec(s,444,writeuint16(0)),write_biff_rec(s,61,write_Window1()),write_biff_rec(s,64,writebool(!1)),write_biff_rec(s,141,writeuint16(0)),write_biff_rec(s,34,writebool(safe1904(t)=="true")),write_biff_rec(s,14,writebool(!0)),c&&write_biff_rec(s,439,writebool(!1)),write_biff_rec(s,218,writeuint16(0)),write_FONTS_biff8(s,t,n),write_FMTS_biff8(s,t.SSF,n),write_CELLXFS_biff8(s,n),c&&write_biff_rec(s,352,writebool(!1));var h=s.end(),m=buf_array();c&&write_biff_rec(m,140,write_Country()),c&&n.Strings&&write_biff_continue(m,252,write_SST(n.Strings)),write_biff_rec(m,10);var g=m.end(),v=buf_array(),y=0,_=0;for(_=0;_<t.SheetNames.length;++_)y+=(c?12:11)+(c?2:1)*t.SheetNames[_].length;var w=h.length+y+g.length;for(_=0;_<t.SheetNames.length;++_){var b=i[_]||{};write_biff_rec(v,133,write_BoundSheet8({pos:w,hs:b.Hidden||0,dt:0,name:t.SheetNames[_]},n)),w+=r[_].length}var T=v.end();if(y!=T.length)throw new Error("BS8 "+y+" != "+T.length);var k=[];return h.length&&k.push(h),T.length&&k.push(T),g.length&&k.push(g),bconcat(k)}function write_biff8_buf(t,r){var n=r||{},s=[];t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),n.revssf=evert_num(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,fix_write_opts(n),n.cellXfs=[],get_cell_style(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)s[s.length]=write_ws_biff8(a,n,t);return s.unshift(write_biff8_global(t,s,n)),bconcat(s)}function write_biff_buf(t,r){for(var n=0;n<=t.SheetNames.length;++n){var s=t.Sheets[t.SheetNames[n]];if(!(!s||!s["!ref"])){var a=decode_range(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return write_biff8_buf(t,r);case 4:case 3:case 2:return write_biff2_buf(t,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function html_to_sheet(t,r){var n=r||{},s=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=a.index,c=i&&i.index||t.length,f=split_regex(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<f.length;++o){var _=f[o].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,n.sheetRows&&n.sheetRows<=d){--d;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var b=_.split(/<\/t[dh]>/i);for(c=0;c<b.length;++c){var T=b[c].trim();if(T.match(/<t[dh]/i)){for(var k=T,C=0;k.charAt(0)=="<"&&(C=k.indexOf(">"))>-1;)k=k.slice(C+1);for(var L=0;L<y.length;++L){var D=y[L];D.s.c==h&&D.s.r<d&&d<=D.e.r&&(h=D.e.c+1,L=-1)}var N=parsexmltag(T.slice(0,T.indexOf(">")));g=N.colspan?+N.colspan:1,((m=+N.rowspan)>1||g>1)&&y.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+g-1}});var U=N.t||N["data-t"]||"";if(!k.length){h+=g;continue}if(k=htmldecode(k),v.s.r>d&&(v.s.r=d),v.e.r<d&&(v.e.r=d),v.s.c>h&&(v.s.c=h),v.e.c<h&&(v.e.c=h),!k.length){h+=g;continue}var M={t:"s",v:k};n.raw||!k.trim().length||U=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(fuzzynum(k))?isNaN(fuzzydate(k).getDate())||(M={t:"d",v:parseDate(k)},n.cellDates||(M={t:"n",v:datenum(M.v)}),M.z=n.dateNF||table_fmt[14]):M={t:"n",v:fuzzynum(k)}),n.dense?(s[d]||(s[d]=[]),s[d][h]=M):s[encode_cell({r:d,c:h})]=M,h+=g}}}}return s["!ref"]=encode_range(v),y.length&&(s["!merges"]=y),s}function make_html_row(t,r,n,s){for(var a=t["!merges"]||[],i=[],o=r.s.c;o<=r.e.c;++o){for(var c=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>n||a[d].s.c>o)&&!(a[d].e.r<n||a[d].e.c<o)){if(a[d].s.r<n||a[d].s.c<o){c=-1;break}c=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var h=encode_cell({r:n,c:o}),m=s.dense?(t[n]||[])[o]:t[h],g=m&&m.v!=null&&(m.h||escapehtml(m.w||(format_cell(m),m.w)||""))||"",v={};c>1&&(v.rowspan=c),f>1&&(v.colspan=f),s.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(s.id||"sjs")+"-"+h,i.push(writextag("td",g,v))}}var y="<tr>";return y+i.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(t,r){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return sheet_to_workbook(html_to_sheet(n[0],r),r);var s=book_new();return n.forEach(function(a,i){book_append_sheet(s,html_to_sheet(a,r),"Sheet"+(i+1))}),s}function make_html_preamble(t,r,n){var s=[];return s.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function sheet_to_html(t,r){var n=r||{},s=n.header!=null?n.header:HTML_BEGIN,a=n.footer!=null?n.footer:HTML_END,i=[s],o=decode_range(t["!ref"]);n.dense=Array.isArray(t),i.push(make_html_preamble(t,o,n));for(var c=o.s.r;c<=o.e.r;++c)i.push(make_html_row(t,o,c,n));return i.push("</table>"+a),i.join("")}function sheet_add_dom(t,r,n){var s=n||{},a=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var o=typeof s.origin=="string"?decode_cell(s.origin):s.origin;a=o.r,i=o.c}var c=r.getElementsByTagName("tr"),f=Math.min(s.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var h=decode_range(t["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var m=[],g=0,v=t["!rows"]||(t["!rows"]=[]),y=0,_=0,w=0,b=0,T=0,k=0;for(t["!cols"]||(t["!cols"]=[]);y<c.length&&_<f;++y){var C=c[y];if(is_dom_element_hidden(C)){if(s.display)continue;v[_]={hidden:!0}}var L=C.children;for(w=b=0;w<L.length;++w){var D=L[w];if(!(s.display&&is_dom_element_hidden(D))){var N=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):htmldecode(D.innerHTML),U=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<m.length;++g){var M=m[g];M.s.c==b+i&&M.s.r<_+a&&_+a<=M.e.r&&(b=M.e.c+1-i,g=-1)}k=+D.getAttribute("colspan")||1,((T=+D.getAttribute("rowspan")||1)>1||k>1)&&m.push({s:{r:_+a,c:b+i},e:{r:_+a+(T||1)-1,c:b+i+(k||1)-1}});var j={t:"s",v:N},K=D.getAttribute("data-t")||D.getAttribute("t")||"";N!=null&&(N.length==0?j.t=K||"z":s.raw||N.trim().length==0||K=="s"||(N==="TRUE"?j={t:"b",v:!0}:N==="FALSE"?j={t:"b",v:!1}:isNaN(fuzzynum(N))?isNaN(fuzzydate(N).getDate())||(j={t:"d",v:parseDate(N)},s.cellDates||(j={t:"n",v:datenum(j.v)}),j.z=s.dateNF||table_fmt[14]):j={t:"n",v:fuzzynum(N)})),j.z===void 0&&U!=null&&(j.z=U);var I="",te=D.getElementsByTagName("A");if(te&&te.length)for(var _e=0;_e<te.length&&!(te[_e].hasAttribute("href")&&(I=te[_e].getAttribute("href"),I.charAt(0)!="#"));++_e);I&&I.charAt(0)!="#"&&(j.l={Target:I}),s.dense?(t[_+a]||(t[_+a]=[]),t[_+a][b+i]=j):t[encode_cell({c:b+i,r:_+a})]=j,d.e.c<b+i&&(d.e.c=b+i),b+=k}}++_}return m.length&&(t["!merges"]=(t["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,_-1+a),t["!ref"]=encode_range(d),_>=f&&(t["!fullref"]=encode_range((d.e.r=c.length-y+_-1+a,d))),t}function parse_dom_table(t,r){var n=r||{},s=n.dense?[]:{};return sheet_add_dom(s,t,r)}function table_to_book(t,r){return sheet_to_workbook(parse_dom_table(t,r),r)}function is_dom_element_hidden(t){var r="",n=get_get_computed_style_function(t);return n&&(r=n(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function get_get_computed_style_function(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=unescapexml(r.replace(/<[^>]*>/g,""));return[n]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(t,r){var n=r||{},s=xlml_normalize(t),a=[],i,o,c={name:""},f="",d=0,h,m,g={},v=[],y=n.dense?[]:{},_,w,b={value:""},T="",k=0,C=[],L=-1,D=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,M={},j=[],K={},I=0,te=0,_e=[],ne=1,me=1,le=[],he={Names:[]},J={},fe=["",""],G=[],A={},q="",P=0,V=!1,ee=!1,ge=0;for(xlmlregex.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=xlmlregex.exec(s);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"工作表":_[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?y["!ref"]=encode_range(N):y["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=N.e.r&&(y["!fullref"]=y["!ref"],N.e.r=n.sheetRows-1,y["!ref"]=encode_range(N)),j.length&&(y["!merges"]=j),_e.length&&(y["!rows"]=_e),h.name=h.名称||h.name,typeof JSON<"u"&&JSON.stringify(h),v.push(h.name),g[h.name]=y,ee=!1):_[0].charAt(_[0].length-2)!=="/"&&(h=parsexmltag(_[0],!1),L=D=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,y=n.dense?[]:{},j=[],_e=[],ee=!0);break;case"table-row-group":_[1]==="/"?--U:++U;break;case"table-row":case"行":if(_[1]==="/"){L+=ne,ne=1;break}if(m=parsexmltag(_[0],!1),m.行号?L=m.行号-1:L==-1&&(L=0),ne=+m["number-rows-repeated"]||1,ne<10)for(ge=0;ge<ne;++ge)U>0&&(_e[L+ge]={level:U});D=-1;break;case"covered-table-cell":_[1]!=="/"&&++D,n.sheetStubs&&(n.dense?(y[L]||(y[L]=[]),y[L][D]={t:"z"}):y[encode_cell({r:L,c:D})]={t:"z"}),T="",C=[];break;case"table-cell":case"数据":if(_[0].charAt(_[0].length-2)==="/")++D,b=parsexmltag(_[0],!1),me=parseInt(b["number-columns-repeated"]||"1",10),w={t:"z",v:null},b.formula&&n.cellFormula!=!1&&(w.f=ods_to_csf_formula(unescapexml(b.formula))),(b.数据类型||b["value-type"])=="string"&&(w.t="s",w.v=unescapexml(b["string-value"]||""),n.dense?(y[L]||(y[L]=[]),y[L][D]=w):y[encode_cell({r:L,c:D})]=w),D+=me-1;else if(_[1]!=="/"){++D,T="",k=0,C=[],me=1;var xe=ne?L+ne-1:L;if(D>N.e.c&&(N.e.c=D),D<N.s.c&&(N.s.c=D),L<N.s.r&&(N.s.r=L),xe>N.e.r&&(N.e.r=xe),b=parsexmltag(_[0],!1),G=[],A={},w={t:b.数据类型||b["value-type"],v:null},n.cellFormula)if(b.formula&&(b.formula=unescapexml(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(I=parseInt(b["number-matrix-rows-spanned"],10)||0,te=parseInt(b["number-matrix-columns-spanned"],10)||0,K={s:{r:L,c:D},e:{r:L+I-1,c:D+te-1}},w.F=encode_range(K),le.push([K,w.F])),b.formula)w.f=ods_to_csf_formula(b.formula);else for(ge=0;ge<le.length;++ge)L>=le[ge][0].s.r&&L<=le[ge][0].e.r&&D>=le[ge][0].s.c&&D<=le[ge][0].e.c&&(w.F=le[ge][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(I=parseInt(b["number-rows-spanned"],10)||0,te=parseInt(b["number-columns-spanned"],10)||0,K={s:{r:L,c:D},e:{r:L+I-1,c:D+te-1}},j.push(K)),b["number-columns-repeated"]&&(me=parseInt(b["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=parsexmlbool(b["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(b.value);break;case"percentage":w.t="n",w.v=parseFloat(b.value);break;case"currency":w.t="n",w.v=parseFloat(b.value);break;case"date":w.t="d",w.v=parseDate(b["date-value"]),n.cellDates||(w.t="n",w.v=datenum(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=parse_isodur(b["time-value"])/86400,n.cellDates&&(w.t="d",w.v=numdate(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(b.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",b["string-value"]!=null&&(T=unescapexml(b["string-value"]),C=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(V=!1,w.t==="s"&&(w.v=T||"",C.length&&(w.R=C),V=k==0),J.Target&&(w.l=J),G.length>0&&(w.c=G,G=[]),T&&n.cellText!==!1&&(w.w=T),V&&(w.t="z",delete w.v),(!V||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=L))for(var de=0;de<ne;++de){if(me=parseInt(b["number-columns-repeated"]||"1",10),n.dense)for(y[L+de]||(y[L+de]=[]),y[L+de][D]=de==0?w:dup(w);--me>0;)y[L+de][D+me]=dup(w);else for(y[encode_cell({r:L+de,c:D})]=w;--me>0;)y[encode_cell({r:L+de,c:D+me})]=dup(w);N.e.c<=D&&(N.e.c=D)}me=parseInt(b["number-columns-repeated"]||"1",10),D+=me-1,me=0,w={},T="",C=[]}J={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i;A.t=T,C.length&&(A.R=C),A.a=q,G.push(A)}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);q="",P=0,T="",k=0,C=[];break;case"creator":_[1]==="/"?q=s.slice(P,_.index):P=_.index+_[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);T="",k=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(M[c.name]=f,(i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&(f="",c=parsexmltag(_[0],!1),a.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=parsexmltag(_[0],!1),f+=number_formats_ods[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=parsexmltag(_[0],!1),f+=number_formats_ods[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=s.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":o=parsexmltag(_[0],!1),fe=ods_to_csf_3D(o["cell-range-address"]);var ve={Name:o.name,Ref:fe[0]+"!"+fe[1]};ee&&(ve.Sheet=v.length),he.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(_[1]==="/"&&(!b||!b["string-value"])){var je=parse_text_p(s.slice(k,_.index));T=(T.length>0?T+`
`:"")+je[0]}else parsexmltag(_[0],!1),k=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{fe=ods_to_csf_3D(parsexmltag(_[0])["target-range-address"]),g[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(J=parsexmltag(_[0],!1),!J.href)break;J.Target=unescapexml(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(fe=ods_to_csf_3D(J.Target.slice(1)),J.Target="#"+fe[0]+"!"+fe[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(_)}}var Y={Sheets:g,SheetNames:v,Workbook:he};return n.bookSheets&&delete Y.Sheets,Y}function parse_ods(t,r){r=r||{},safegetzipfile(t,"META-INF/manifest.xml")&&parse_manifest(getzipdata(t,"META-INF/manifest.xml"),r);var n=getzipstr(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var s=parse_content_xml(utf8read(n),r);return safegetzipfile(t,"meta.xml")&&(s.Props=parse_core_props(getzipdata(t,"meta.xml"))),s}function parse_fods(t,r){return parse_content_xml(t,r)}var write_styles_ods=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return XML_HEADER+r}}(),write_content_ods=function(){var t=function(i){return escapexml(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,s=function(i,o,c){var f=[];f.push('      <table:table table:name="'+escapexml(o.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,h=0,m=decode_range(i["!ref"]||"A1"),g=i["!merges"]||[],v=0,y=Array.isArray(i);if(i["!cols"])for(h=0;h<=m.e.c;++h)f.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var _="",w=i["!rows"]||[];for(d=0;d<m.s.r;++d)_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`></table:table-row>
`);for(;d<=m.e.r;++d){for(_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`>
`),h=0;h<m.s.c;++h)f.push(r);for(;h<=m.e.c;++h){var b=!1,T={},k="";for(v=0;v!=g.length;++v)if(!(g[v].s.c>h)&&!(g[v].s.r>d)&&!(g[v].e.c<h)&&!(g[v].e.r<d)){(g[v].s.c!=h||g[v].s.r!=d)&&(b=!0),T["table:number-columns-spanned"]=g[v].e.c-g[v].s.c+1,T["table:number-rows-spanned"]=g[v].e.r-g[v].s.r+1;break}if(b){f.push(n);continue}var C=encode_cell({r:d,c:h}),L=y?(i[d]||[])[h]:i[C];if(L&&L.f&&(T["table:formula"]=escapexml(csf_to_ods_formula(L.f)),L.F&&L.F.slice(0,C.length)==C)){var D=decode_range(L.F);T["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,T["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!L){f.push(r);continue}switch(L.t){case"b":k=L.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=L.v?"true":"false";break;case"n":k=L.w||String(L.v||0),T["office:value-type"]="float",T["office:value"]=L.v||0;break;case"s":case"str":k=L.v==null?"":L.v,T["office:value-type"]="string";break;case"d":k=L.w||parseDate(L.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=parseDate(L.v).toISOString(),T["table:style-name"]="ce1";break;default:f.push(r);continue}var N=t(k);if(L.l&&L.l.Target){var U=L.l.Target;U=U.charAt(0)=="#"?"#"+csf_to_ods_3D(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),N=writextag("text:a",N,{"xlink:href":U.replace(/&/g,"&amp;")})}f.push("          "+writextag("table:table-cell",writextag("text:p",N,{}),T)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var m=d["!cols"][h];if(m.width==null&&m.wpx==null&&m.wch==null)continue;process_col(m),m.ods=c;var g=d["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),i.push(`  </style:style>
`),++c}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=f;var m=d["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var f=[XML_HEADER],d=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+h+`>
`),f.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)f.push(s(o.Sheets[o.SheetNames[m]],o,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function write_ods(t,r){if(r.bookType=="fods")return write_content_ods(t,r);var n=zip_new(),s="",a=[],i=[];return s="mimetype",zip_add_file(n,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",zip_add_file(n,s,write_content_ods(t,r)),a.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",zip_add_file(n,s,write_styles_ods(t,r)),a.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",zip_add_file(n,s,XML_HEADER+write_meta_ods()),a.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",zip_add_file(n,s,write_rdf(i)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",zip_add_file(n,s,write_manifest(a)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function u8str(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):utf8read(a2s(t))}function stru8(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):s2a(utf8write(t))}function u8contains(t,r){e:for(var n=0;n<=t.length-r.length;++n){for(var s=0;s<r.length;++s)if(t[n+s]!=r[s])continue e;return!0}return!1}function u8concat(t){var r=t.reduce(function(a,i){return a+i.length},0),n=new Uint8Array(r),s=0;return t.forEach(function(a){n.set(a,s),s+=a.length}),n}function popcnt(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function readDecimal128LE(t,r){for(var n=(t[r+15]&127)<<7|t[r+14]>>1,s=t[r+14]&1,a=r+13;a>=r;--a)s=s*256+t[a];return(t[r+15]&128?-s:s)*Math.pow(10,n-6176)}function writeDecimal128LE(t,r,n){var s=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,s-6176);t[r+15]|=s>>7,t[r+14]|=(s&127)<<1;for(var i=0;a>=1;++i,a/=256)t[r+i]=a&255;t[r+15]|=n>=0?0:128}function parse_varint49(t,r){var n=r?r[0]:0,s=t[n]&127;e:if(t[n++]>=128&&(s|=(t[n]&127)<<7,t[n++]<128||(s|=(t[n]&127)<<14,t[n++]<128)||(s|=(t[n]&127)<<21,t[n++]<128)||(s+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(s+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(s+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return r&&(r[0]=n),s}function write_varint49(t){var r=new Uint8Array(7);r[0]=t&127;var n=1;e:if(t>127){if(r[n-1]|=128,r[n]=t>>7&127,++n,t<=16383||(r[n-1]|=128,r[n]=t>>14&127,++n,t<=2097151)||(r[n-1]|=128,r[n]=t>>21&127,++n,t<=268435455)||(r[n-1]|=128,r[n]=t/256>>>21&127,++n,t<=34359738367)||(r[n-1]|=128,r[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;r[n-1]|=128,r[n]=t/16777216>>>21&127,++n}return r.slice(0,n)}function varint_to_i32(t){var r=0,n=t[r]&127;e:if(t[r++]>=128){if(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128))break e;n|=(t[r]&127)<<28}return n}function parse_shallow(t){for(var r=[],n=[0];n[0]<t.length;){var s=n[0],a=parse_varint49(t,n),i=a&7;a=Math.floor(a/8);var o=0,c;if(a==0)break;switch(i){case 0:{for(var f=n[0];t[n[0]++]>=128;);c=t.slice(f,n[0])}break;case 5:o=4,c=t.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,c=t.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=parse_varint49(t,n),c=t.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(s))}var d={data:c,type:i};r[a]==null?r[a]=[d]:r[a].push(d)}return r}function write_shallow(t){var r=[];return t.forEach(function(n,s){n.forEach(function(a){a.data&&(r.push(write_varint49(s*8+a.type)),a.type==2&&r.push(write_varint49(a.data.length)),r.push(a.data))})}),u8concat(r)}function mappa(t,r){return(t==null?void 0:t.map(function(n){return r(n.data)}))||[]}function parse_iwa_file(t){for(var r,n=[],s=[0];s[0]<t.length;){var a=parse_varint49(t,s),i=parse_shallow(t.slice(s[0],s[0]+a));s[0]+=a;var o={id:varint_to_i32(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=parse_shallow(c.data),d=varint_to_i32(f[3][0].data);o.messages.push({meta:f,data:t.slice(s[0],s[0]+d)}),s[0]+=d}),(r=i[3])!=null&&r[0]&&(o.merge=varint_to_i32(i[3][0].data)>>>0>0),n.push(o)}return n}function write_iwa_file(t){var r=[];return t.forEach(function(n){var s=[];s[1]=[{data:write_varint49(n.id),type:0}],s[2]=[],n.merge!=null&&(s[3]=[{data:write_varint49(+!!n.merge),type:0}]);var a=[];n.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:write_varint49(o.data.length)}],s[2].push({data:write_shallow(o.meta),type:2})});var i=write_shallow(s);r.push(write_varint49(i.length)),r.push(i),a.forEach(function(o){return r.push(o)})}),u8concat(r)}function parse_snappy_chunk(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],s=parse_varint49(r,n),a=[];n[0]<r.length;){var i=r[n[0]]&3;if(i==0){var o=r[n[0]++]>>2;if(o<60)++o;else{var c=o-59;o=r[n[0]],c>1&&(o|=r[n[0]+1]<<8),c>2&&(o|=r[n[0]+2]<<16),c>3&&(o|=r[n[0]+3]<<24),o>>>=0,o++,n[0]+=c}a.push(r.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var f=0,d=0;if(i==1?(d=(r[n[0]]>>2&7)+4,f=(r[n[0]++]&224)<<3,f|=r[n[0]++]):(d=(r[n[0]++]>>2)+1,i==2?(f=r[n[0]]|r[n[0]+1]<<8,n[0]+=2):(f=(r[n[0]]|r[n[0]+1]<<8|r[n[0]+2]<<16|r[n[0]+3]<<24)>>>0,n[0]+=4)),a=[u8concat(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var h=u8concat(a);if(h.length!=s)throw new Error("Unexpected length: ".concat(h.length," != ").concat(s));return h}function decompress_iwa_file(t){for(var r=[],n=0;n<t.length;){var s=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,r.push(parse_snappy_chunk(s,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return u8concat(r)}function compress_iwa_file(t){for(var r=[],n=0;n<t.length;){var s=Math.min(t.length-n,268435455),a=new Uint8Array(4);r.push(a);var i=write_varint49(s),o=i.length;r.push(i),s<=60?(o++,r.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(t.slice(n,n+s)),o+=s,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,n+=s}return u8concat(r)}function parse_old_storage(t,r,n,s){var a=u8_to_dataview(t),i=a.getUint32(4,!0),o=(s>1?12:8)+popcnt(i&(s>1?3470:398))*4,c=-1,f=-1,d=NaN,h=new Date(2001,0,1);i&512&&(c=a.getUint32(o,!0),o+=4),o+=popcnt(i&(s>1?12288:4096))*4,i&16&&(f=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var m;switch(t[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:r[f]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:n[c]};else if(f>-1)m={t:"s",v:r[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return m}function parse_new_storage(t,r,n){var s=u8_to_dataview(t),a=s.getUint32(8,!0),i=12,o=-1,c=-1,f=NaN,d=NaN,h=new Date(2001,0,1);a&1&&(f=readDecimal128LE(t,i),i+=16),a&2&&(d=s.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+s.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=s.getUint32(i,!0),i+=4),a&16&&(o=s.getUint32(i,!0),i+=4);var m;switch(t[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:r[c]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:n[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return m}function write_new_storage(t,r){var n=new Uint8Array(32),s=u8_to_dataview(n),a=12,i=0;switch(n[0]=5,t.t){case"n":n[1]=2,writeDecimal128LE(n,a,t.v),i|=1,a+=16;break;case"b":n[1]=6,s.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,i,!0),n.slice(0,a)}function write_old_storage(t,r){var n=new Uint8Array(32),s=u8_to_dataview(n),a=12,i=0;switch(n[0]=3,t.t){case"n":n[2]=2,s.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":n[2]=6,s.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,i,!0),n.slice(0,a)}function parse_cell_storage(t,r,n){switch(t[0]){case 0:case 1:case 2:case 3:return parse_old_storage(t,r,n,t[0]);case 5:return parse_new_storage(t,r,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function parse_TSP_Reference(t){var r=parse_shallow(t);return parse_varint49(r[1][0].data)}function parse_TST_TableDataList(t,r){var n=parse_shallow(r.data),s=varint_to_i32(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(o){var c=parse_shallow(o.data),f=varint_to_i32(c[1][0].data)>>>0;switch(s){case 1:i[f]=u8str(c[3][0].data);break;case 8:{var d=t[parse_TSP_Reference(c[9][0].data)][0],h=parse_shallow(d.data),m=t[parse_TSP_Reference(h[1][0].data)][0],g=varint_to_i32(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=parse_shallow(m.data);i[f]=v[3].map(function(y){return u8str(y.data)}).join("")}break}}),i}function parse_TST_TileRowInfo(t,r){var n,s,a,i,o,c,f,d,h,m,g,v,y,_,w=parse_shallow(t),b=varint_to_i32(w[1][0].data)>>>0,T=varint_to_i32(w[2][0].data)>>>0,k=((s=(n=w[8])==null?void 0:n[0])==null?void 0:s.data)&&varint_to_i32(w[8][0].data)>0||!1,C,L;if((i=(a=w[7])==null?void 0:a[0])!=null&&i.data&&r!=0)C=(c=(o=w[7])==null?void 0:o[0])==null?void 0:c.data,L=(d=(f=w[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(h=w[4])==null?void 0:h[0])!=null&&m.data&&r!=1)C=(v=(g=w[4])==null?void 0:g[0])==null?void 0:v.data,L=(_=(y=w[3])==null?void 0:y[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var D=k?4:1,N=u8_to_dataview(C),U=[],M=0;M<C.length/2;++M){var j=N.getUint16(M*2,!0);j<65535&&U.push([M,j])}if(U.length!=T)throw"Expected ".concat(T," cells, found ").concat(U.length);var K=[];for(M=0;M<U.length-1;++M)K[U[M][0]]=L.subarray(U[M][1]*D,U[M+1][1]*D);return U.length>=1&&(K[U[U.length-1][0]]=L.subarray(U[U.length-1][1]*D)),{R:b,cells:K}}function parse_TST_Tile(t,r){var n,s=parse_shallow(r.data),a=(n=s==null?void 0:s[7])!=null&&n[0]?varint_to_i32(s[7][0].data)>>>0>0?1:0:-1,i=mappa(s[5],function(o){return parse_TST_TileRowInfo(o,a)});return{nrows:varint_to_i32(s[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(f,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=f}),o},[])}}function parse_TST_TableModelArchive(t,r,n){var s,a=parse_shallow(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(varint_to_i32(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(varint_to_i32(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=encode_range(i);var o=parse_shallow(a[4][0].data),c=parse_TST_TableDataList(t,t[parse_TSP_Reference(o[4][0].data)][0]),f=(s=o[17])!=null&&s[0]?parse_TST_TableDataList(t,t[parse_TSP_Reference(o[17][0].data)][0]):[],d=parse_shallow(o[3][0].data),h=0;d[1].forEach(function(m){var g=parse_shallow(m.data),v=t[parse_TSP_Reference(g[2][0].data)][0],y=varint_to_i32(v.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var _=parse_TST_Tile(t,v);_.data.forEach(function(w,b){w.forEach(function(T,k){var C=encode_cell({r:h+b,c:k}),L=parse_cell_storage(T,c,f);L&&(n[C]=L)})}),h+=_.nrows})}function parse_TST_TableInfoArchive(t,r){var n=parse_shallow(r.data),s={"!ref":"A1"},a=t[parse_TSP_Reference(n[2][0].data)],i=varint_to_i32(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return parse_TST_TableModelArchive(t,a[0],s),s}function parse_TN_SheetArchive(t,r){var n,s=parse_shallow(r.data),a={name:(n=s[1])!=null&&n[0]?u8str(s[1][0].data):"",sheets:[]},i=mappa(s[2],parse_TSP_Reference);return i.forEach(function(o){t[o].forEach(function(c){var f=varint_to_i32(c.meta[1][0].data);f==6e3&&a.sheets.push(parse_TST_TableInfoArchive(t,c))})}),a}function parse_TN_DocumentArchive(t,r){var n=book_new(),s=parse_shallow(r.data),a=mappa(s[1],parse_TSP_Reference);if(a.forEach(function(i){t[i].forEach(function(o){var c=varint_to_i32(o.meta[1][0].data);if(c==2){var f=parse_TN_SheetArchive(t,o);f.sheets.forEach(function(d,h){book_append_sheet(n,d,h==0?f.name:f.name+"_"+h,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function parse_numbers_iwa(t){var r,n,s,a,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=decompress_iwa_file(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var h;try{h=parse_iwa_file(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var c=((a=(s=(n=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:n.meta)==null?void 0:s[1])==null?void 0:a[0].data)&&varint_to_i32(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(f){i[f].forEach(function(d){var h=varint_to_i32(d.meta[1][0].data)>>>0;if(h==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(i,c)}function write_tile_row(t,r,n){var s,a,i,o;if(!((s=t[6])!=null&&s[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&varint_to_i32(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=u8_to_dataview(t[7][0].data),h=0,m=[],g=u8_to_dataview(t[4][0].data),v=0,y=[],_=0;_<r.length;++_){if(r[_]==null){d.setUint16(_*2,65535,!0),g.setUint16(_*2,65535);continue}d.setUint16(_*2,h,!0),g.setUint16(_*2,v,!0);var w,b;switch(typeof r[_]){case"string":w=write_new_storage({t:"s",v:r[_]},n),b=write_old_storage({t:"s",v:r[_]},n);break;case"number":w=write_new_storage({t:"n",v:r[_]},n),b=write_old_storage({t:"n",v:r[_]},n);break;case"boolean":w=write_new_storage({t:"b",v:r[_]},n),b=write_old_storage({t:"b",v:r[_]},n);break;default:throw new Error("Unsupported value "+r[_])}m.push(w),h+=w.length,y.push(b),v+=b.length,++f}for(t[2][0].data=write_varint49(f);_<t[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),g.setUint16(_*2,65535,!0);return t[6][0].data=u8concat(m),t[3][0].data=u8concat(y),f}function write_numbers_iwa(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=decode_range(n["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(encode_range(s)));var i=sheet_to_json(n,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(q){return q.forEach(function(P){typeof P=="string"&&o.push(P)})});var c={},f=[],d=CFB.read(r.numbers,{type:"base64"});d.FileIndex.map(function(q,P){return[q,d.FullPaths[P]]}).forEach(function(q){var P=q[0],V=q[1];if(P.type==2&&P.name.match(/\.iwa/)){var ee=P.content,ge=decompress_iwa_file(ee),xe=parse_iwa_file(ge);xe.forEach(function(de){f.push(de.id),c[de.id]={deps:[],location:V,type:varint_to_i32(de.messages[0].meta[1][0].data)}})}}),f.sort(function(q,P){return q-P});var h=f.filter(function(q){return q>1}).map(function(q){return[q,write_varint49(q)]});d.FileIndex.map(function(q,P){return[q,d.FullPaths[P]]}).forEach(function(q){var P=q[0];if(q[1],!!P.name.match(/\.iwa/)){var V=parse_iwa_file(decompress_iwa_file(P.content));V.forEach(function(ee){ee.messages.forEach(function(ge){h.forEach(function(xe){ee.messages.some(function(de){return varint_to_i32(de.meta[1][0].data)!=11006&&u8contains(de.data,xe[1])})&&c[xe[0]].deps.push(ee.id)})})})}});for(var m=CFB.find(d,c[1].location),g=parse_iwa_file(decompress_iwa_file(m.content)),v,y=0;y<g.length;++y){var _=g[y];_.id==1&&(v=_)}var w=parse_TSP_Reference(parse_shallow(v.messages[0].data)[1][0].data);for(m=CFB.find(d,c[w].location),g=parse_iwa_file(decompress_iwa_file(m.content)),y=0;y<g.length;++y)_=g[y],_.id==w&&(v=_);for(w=parse_TSP_Reference(parse_shallow(v.messages[0].data)[2][0].data),m=CFB.find(d,c[w].location),g=parse_iwa_file(decompress_iwa_file(m.content)),y=0;y<g.length;++y)_=g[y],_.id==w&&(v=_);for(w=parse_TSP_Reference(parse_shallow(v.messages[0].data)[2][0].data),m=CFB.find(d,c[w].location),g=parse_iwa_file(decompress_iwa_file(m.content)),y=0;y<g.length;++y)_=g[y],_.id==w&&(v=_);var b=parse_shallow(v.messages[0].data);{b[6][0].data=write_varint49(s.e.r+1),b[7][0].data=write_varint49(s.e.c+1);var T=parse_TSP_Reference(b[46][0].data),k=CFB.find(d,c[T].location),C=parse_iwa_file(decompress_iwa_file(k.content));{for(var L=0;L<C.length&&C[L].id!=T;++L);if(C[L].id!=T)throw"Bad ColumnRowUIDMapArchive";var D=parse_shallow(C[L].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var N=0;N<=s.e.c;++N){var U=[];U[1]=U[2]=[{type:0,data:write_varint49(N+420690)}],D[1].push({type:2,data:write_shallow(U)}),D[2].push({type:0,data:write_varint49(N)}),D[3].push({type:0,data:write_varint49(N)})}D[4]=[],D[5]=[],D[6]=[];for(var M=0;M<=s.e.r;++M)U=[],U[1]=U[2]=[{type:0,data:write_varint49(M+726270)}],D[4].push({type:2,data:write_shallow(U)}),D[5].push({type:0,data:write_varint49(M)}),D[6].push({type:0,data:write_varint49(M)});C[L].messages[0].data=write_shallow(D)}k.content=compress_iwa_file(write_iwa_file(C)),k.size=k.content.length,delete b[46];var j=parse_shallow(b[4][0].data);{j[7][0].data=write_varint49(s.e.r+1);var K=parse_shallow(j[1][0].data),I=parse_TSP_Reference(K[2][0].data);k=CFB.find(d,c[I].location),C=parse_iwa_file(decompress_iwa_file(k.content));{if(C[0].id!=I)throw"Bad HeaderStorageBucket";var te=parse_shallow(C[0].messages[0].data);for(M=0;M<i.length;++M){var _e=parse_shallow(te[2][0].data);_e[1][0].data=write_varint49(M),_e[4][0].data=write_varint49(i[M].length),te[2][M]={type:te[2][0].type,data:write_shallow(_e)}}C[0].messages[0].data=write_shallow(te)}k.content=compress_iwa_file(write_iwa_file(C)),k.size=k.content.length;var ne=parse_TSP_Reference(j[2][0].data);k=CFB.find(d,c[ne].location),C=parse_iwa_file(decompress_iwa_file(k.content));{if(C[0].id!=ne)throw"Bad HeaderStorageBucket";for(te=parse_shallow(C[0].messages[0].data),N=0;N<=s.e.c;++N)_e=parse_shallow(te[2][0].data),_e[1][0].data=write_varint49(N),_e[4][0].data=write_varint49(s.e.r+1),te[2][N]={type:te[2][0].type,data:write_shallow(_e)};C[0].messages[0].data=write_shallow(te)}k.content=compress_iwa_file(write_iwa_file(C)),k.size=k.content.length;var me=parse_TSP_Reference(j[4][0].data);(function(){for(var q=CFB.find(d,c[me].location),P=parse_iwa_file(decompress_iwa_file(q.content)),V,ee=0;ee<P.length;++ee){var ge=P[ee];ge.id==me&&(V=ge)}var xe=parse_shallow(V.messages[0].data);{xe[3]=[];var de=[];o.forEach(function(Y,Xe){de[1]=[{type:0,data:write_varint49(Xe)}],de[2]=[{type:0,data:write_varint49(1)}],de[3]=[{type:2,data:stru8(Y)}],xe[3].push({type:2,data:write_shallow(de)})})}V.messages[0].data=write_shallow(xe);var ve=write_iwa_file(P),je=compress_iwa_file(ve);q.content=je,q.size=q.content.length})();var le=parse_shallow(j[3][0].data);{var he=le[1][0];delete le[2];var J=parse_shallow(he.data);{var fe=parse_TSP_Reference(J[2][0].data);(function(){for(var q=CFB.find(d,c[fe].location),P=parse_iwa_file(decompress_iwa_file(q.content)),V,ee=0;ee<P.length;++ee){var ge=P[ee];ge.id==fe&&(V=ge)}var xe=parse_shallow(V.messages[0].data);{delete xe[6],delete le[7];var de=new Uint8Array(xe[5][0].data);xe[5]=[];for(var ve=0,je=0;je<=s.e.r;++je){var Y=parse_shallow(de);ve+=write_tile_row(Y,i[je],o),Y[1][0].data=write_varint49(je),xe[5].push({data:write_shallow(Y),type:2})}xe[1]=[{type:0,data:write_varint49(s.e.c+1)}],xe[2]=[{type:0,data:write_varint49(s.e.r+1)}],xe[3]=[{type:0,data:write_varint49(ve)}],xe[4]=[{type:0,data:write_varint49(s.e.r+1)}]}V.messages[0].data=write_shallow(xe);var Xe=write_iwa_file(P),Ve=compress_iwa_file(Xe);q.content=Ve,q.size=q.content.length})()}he.data=write_shallow(J)}j[3][0].data=write_shallow(le)}b[4][0].data=write_shallow(j)}v.messages[0].data=write_shallow(b);var G=write_iwa_file(g),A=compress_iwa_file(G);return m.content=A,m.size=m.content.length,d}function fix_opts_func(t){return function(n){for(var s=0;s!=t.length;++s){var a=t[s];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function fix_read_opts(t){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function fix_write_opts(t){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function get_sheet_type(t){return RELS.WS.indexOf(t)>-1?"sheet":t==RELS.CS?"chart":t==RELS.DS?"dialog":t==RELS.MS?"macro":t&&t.length?t:"sheet"}function safe_parse_wbrels(t,r){if(!t)return 0;try{t=r.map(function(s){return s.id||(s.id=s.strRelID),[s.name,t["!id"][s.id].Target,get_sheet_type(t["!id"][s.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function safe_parse_sheet(t,r,n,s,a,i,o,c,f,d,h,m){try{i[s]=parse_rels(getzipstr(t,n,!0),r);var g=getzipdata(t,r),v;switch(c){case"sheet":v=parse_ws(g,r,a,f,i[s],d,h,m);break;case"chart":if(v=parse_cs(g,r,a,f,i[s],d,h,m),!v||!v["!drawel"])break;var y=resolve_path(v["!drawel"].Target,r),_=get_rels_path(y),w=parse_drawing(getzipstr(t,y,!0),parse_rels(getzipstr(t,_,!0),y)),b=resolve_path(w,y),T=get_rels_path(b);v=parse_chart(getzipstr(t,b,!0),b,f,parse_rels(getzipstr(t,T,!0),b),d,v);break;case"macro":v=parse_ms(g,r,a,f,i[s],d,h,m);break;case"dialog":v=parse_ds(g,r,a,f,i[s],d,h,m);break;default:throw new Error("Unrecognized sheet type "+c)}o[s]=v;var k=[];i&&i[s]&&keys(i[s]).forEach(function(C){var L="";if(i[s][C].Type==RELS.CMNT){L=resolve_path(i[s][C].Target,r);var D=parse_cmnt(getzipdata(t,L,!0),L,f);if(!D||!D.length)return;sheet_insert_comments(v,D,!1)}i[s][C].Type==RELS.TCMNT&&(L=resolve_path(i[s][C].Target,r),k=k.concat(parse_tcmnt_xml(getzipdata(t,L,!0),f)))}),k&&k.length&&sheet_insert_comments(v,k,!0,f.people||[])}catch(C){if(f.WTF)throw C}}function strip_front_slash(t){return t.charAt(0)=="/"?t.slice(1):t}function parse_zip(t,r){if(make_ssf(),r=r||{},fix_read_opts(r),safegetzipfile(t,"META-INF/manifest.xml")||safegetzipfile(t,"objectdata.xml"))return parse_ods(t,r);if(safegetzipfile(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(t.FileIndex)return parse_numbers_iwa(t);var n=CFB.utils.cfb_new();return zipentries(t).forEach(function(_e){zip_add_file(n,_e,getzipbin(t,_e))}),parse_numbers_iwa(n)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(t,"[Content_Types].xml"))throw safegetzipfile(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=zipentries(t),a=parse_ct(getzipstr(t,"[Content_Types].xml")),i=!1,o,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",getzipdata(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!getzipdata(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!r.bookSheets&&!r.bookProps){if(strs=[],a.sst)try{strs=parse_sst(getzipdata(t,strip_front_slash(a.sst)),a.sst,r)}catch(_e){if(r.WTF)throw _e}r.cellStyles&&a.themes.length&&(f=parse_theme(getzipstr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(d=parse_sty(getzipdata(t,strip_front_slash(a.style)),a.style,f,r))}a.links.map(function(_e){try{var ne=parse_rels(getzipstr(t,get_rels_path(strip_front_slash(_e))),_e);return parse_xlink(getzipdata(t,strip_front_slash(_e)),ne,_e,r)}catch{}});var h=parse_wb(getzipdata(t,strip_front_slash(a.workbooks[0])),a.workbooks[0],r),m={},g="";a.coreprops.length&&(g=getzipdata(t,strip_front_slash(a.coreprops[0]),!0),g&&(m=parse_core_props(g)),a.extprops.length!==0&&(g=getzipdata(t,strip_front_slash(a.extprops[0]),!0),g&&parse_ext_props(g,m,r)));var v={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(g=getzipstr(t,strip_front_slash(a.custprops[0]),!0),g&&(v=parse_cust_props(g,r)));var y={};if((r.bookSheets||r.bookProps)&&(h.Sheets?o=h.Sheets.map(function(ne){return ne.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),r.bookProps&&(y.Props=m,y.Custprops=v),r.bookSheets&&typeof o<"u"&&(y.SheetNames=o),r.bookSheets?y.SheetNames:r.bookProps))return y;o={};var _={};r.bookDeps&&a.calcchain&&(_=parse_cc(getzipdata(t,strip_front_slash(a.calcchain)),a.calcchain));var w=0,b={},T,k;{var C=h.Sheets;m.Worksheets=C.length,m.SheetNames=[];for(var L=0;L!=C.length;++L)m.SheetNames[L]=C[L].name}var D=i?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),U=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");safegetzipfile(t,U)||(U="xl/_rels/workbook."+D+".rels");var M=parse_rels(getzipstr(t,U,!0),U.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=parse_xlmeta(getzipdata(t,strip_front_slash(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=parse_people_xml(getzipdata(t,strip_front_slash(a.people[0])),r)),M&&(M=safe_parse_wbrels(M,h.Sheets));var j=getzipdata(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=m.Worksheets;++w){var K="sheet";if(M&&M[w]?(T="xl/"+M[w][1].replace(/[\/]?xl\//,""),safegetzipfile(t,T)||(T=M[w][1]),safegetzipfile(t,T)||(T=U.replace(/_rels\/.*$/,"")+M[w][1]),K=M[w][2]):(T="xl/worksheets/sheet"+(w+1-j)+"."+D,T=T.replace(/sheet0\./,"sheet.")),k=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(w!=r.sheets)continue e;break;case"string":if(m.SheetNames[w].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var I=!1,te=0;te!=r.sheets.length;++te)typeof r.sheets[te]=="number"&&r.sheets[te]==w&&(I=1),typeof r.sheets[te]=="string"&&r.sheets[te].toLowerCase()==m.SheetNames[w].toLowerCase()&&(I=1);if(!I)continue e}}safe_parse_sheet(t,T,k,m.SheetNames[w],w,b,o,K,r,h,f,d)}return y={Directory:a,Workbook:h,Props:m,Custprops:v,Deps:_,Sheets:o,SheetNames:m.SheetNames,Strings:strs,Styles:d,Themes:f,SSF:dup(table_fmt)},r&&r.bookFiles&&(t.files?(y.keys=s,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(_e,ne){_e=_e.replace(/^Root Entry[\/]/,""),y.keys.push(_e),y.files[_e]=t.FileIndex[ne]}))),r&&r.bookVBA&&(a.vba.length>0?y.vbaraw=getzipdata(t,strip_front_slash(a.vba[0]),!0):a.defaults&&a.defaults.bin===CT_VBA&&(y.vbaraw=getzipdata(t,"xl/vbaProject.bin",!0))),y}function parse_xlsxcfb(t,r){var n=r||{},s="Workbook",a=CFB.find(t,s);try{if(s="/!DataSpaces/Version",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(parse_DataSpaceVersionInfo(a.content),s="/!DataSpaces/DataSpaceMap",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=parse_DataSpaceMap(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=parse_DataSpaceDefinition(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);parse_Primary(a.content)}catch{}if(s="/EncryptionInfo",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=parse_EncryptionInfo(a.content);if(s="/EncryptedPackage",a=CFB.find(t,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function write_zip(t,r){return r.bookType=="ods"?write_ods(t,r):r.bookType=="numbers"?write_numbers_iwa(t,r):r.bookType=="xlsb"?write_zip_xlsxb(t,r):write_zip_xlsx(t,r)}function write_zip_xlsxb(t,r){_shapeid=1024,t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),r.revssf=evert_num(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,browser_has_Map?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var n=r.bookType=="xlsb"?"bin":"xml",s=VBAFMTS.indexOf(r.bookType)>-1,a=new_ct();fix_write_opts(r=r||{});var i=zip_new(),o="",c=0;if(r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",zip_add_file(i,o,write_core_props(t.Props,r)),a.coreprops.push(o),add_rels(r.rels,2,o,RELS.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,zip_add_file(i,o,write_ext_props(t.Props)),a.extprops.push(o),add_rels(r.rels,3,o,RELS.EXT_PROPS),t.Custprops!==t.Props&&keys(t.Custprops||{}).length>0&&(o="docProps/custom.xml",zip_add_file(i,o,write_cust_props(t.Custprops)),a.custprops.push(o),add_rels(r.rels,4,o,RELS.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var h={"!id":{}},m=t.Sheets[t.SheetNames[c-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+c+"."+n,zip_add_file(i,o,write_ws(c-1,o,r,t,h)),a.sheets.push(o),add_rels(r.wbrels,-1,"worksheets/sheet"+c+"."+n,RELS.WS[0])}if(m){var v=m["!comments"],y=!1,_="";v&&v.length>0&&(_="xl/comments"+c+"."+n,zip_add_file(i,_,write_cmnt(v,_)),a.comments.push(_),add_rels(h,-1,"../comments"+c+"."+n,RELS.CMNT),y=!0),m["!legacy"]&&y&&zip_add_file(i,"xl/drawings/vmlDrawing"+c+".vml",write_comments_vml(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&zip_add_file(i,get_rels_path(o),write_rels(h))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+n,zip_add_file(i,o,write_sst(r.Strings,o,r)),a.strs.push(o),add_rels(r.wbrels,-1,"sharedStrings."+n,RELS.SST)),o="xl/workbook."+n,zip_add_file(i,o,write_wb(t,o)),a.workbooks.push(o),add_rels(r.rels,1,o,RELS.WB),o="xl/theme/theme1.xml",zip_add_file(i,o,write_theme(t.Themes,r)),a.themes.push(o),add_rels(r.wbrels,-1,"theme/theme1.xml",RELS.THEME),o="xl/styles."+n,zip_add_file(i,o,write_sty(t,o,r)),a.styles.push(o),add_rels(r.wbrels,-1,"styles."+n,RELS.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",zip_add_file(i,o,t.vbaraw),a.vba.push(o),add_rels(r.wbrels,-1,"vbaProject.bin",RELS.VBA)),o="xl/metadata."+n,zip_add_file(i,o,write_xlmeta(o)),a.metadata.push(o),add_rels(r.wbrels,-1,"metadata."+n,RELS.XLMETA),zip_add_file(i,"[Content_Types].xml",write_ct(a,r)),zip_add_file(i,"_rels/.rels",write_rels(r.rels)),zip_add_file(i,"xl/_rels/workbook."+n+".rels",write_rels(r.wbrels)),delete r.revssf,delete r.ssf,i}function write_zip_xlsx(t,r){_shapeid=1024,t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),r.revssf=evert_num(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,browser_has_Map?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var n="xml",s=VBAFMTS.indexOf(r.bookType)>-1,a=new_ct();fix_write_opts(r=r||{});var i=zip_new(),o="",c=0;if(r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",zip_add_file(i,o,write_core_props(t.Props,r)),a.coreprops.push(o),add_rels(r.rels,2,o,RELS.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,zip_add_file(i,o,write_ext_props(t.Props)),a.extprops.push(o),add_rels(r.rels,3,o,RELS.EXT_PROPS),t.Custprops!==t.Props&&keys(t.Custprops||{}).length>0&&(o="docProps/custom.xml",zip_add_file(i,o,write_cust_props(t.Custprops)),a.custprops.push(o),add_rels(r.rels,4,o,RELS.CUST_PROPS));var h=["SheetJ5"];for(r.tcid=0,c=1;c<=t.SheetNames.length;++c){var m={"!id":{}},g=t.Sheets[t.SheetNames[c-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+n,zip_add_file(i,o,write_ws_xml(c-1,r,t,m)),a.sheets.push(o),add_rels(r.wbrels,-1,"worksheets/sheet"+c+"."+n,RELS.WS[0])}if(g){var y=g["!comments"],_=!1,w="";if(y&&y.length>0){var b=!1;y.forEach(function(T){T[1].forEach(function(k){k.T==!0&&(b=!0)})}),b&&(w="xl/threadedComments/threadedComment"+c+"."+n,zip_add_file(i,w,write_tcmnt_xml(y,h,r)),a.threadedcomments.push(w),add_rels(m,-1,"../threadedComments/threadedComment"+c+"."+n,RELS.TCMNT)),w="xl/comments"+c+"."+n,zip_add_file(i,w,write_comments_xml(y)),a.comments.push(w),add_rels(m,-1,"../comments"+c+"."+n,RELS.CMNT),_=!0}g["!legacy"]&&_&&zip_add_file(i,"xl/drawings/vmlDrawing"+c+".vml",write_comments_vml(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&zip_add_file(i,get_rels_path(o),write_rels(m))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+n,zip_add_file(i,o,write_sst_xml(r.Strings,r)),a.strs.push(o),add_rels(r.wbrels,-1,"sharedStrings."+n,RELS.SST)),o="xl/workbook."+n,zip_add_file(i,o,write_wb_xml(t)),a.workbooks.push(o),add_rels(r.rels,1,o,RELS.WB),o="xl/theme/theme1.xml",zip_add_file(i,o,write_theme(t.Themes,r)),a.themes.push(o),add_rels(r.wbrels,-1,"theme/theme1.xml",RELS.THEME),o="xl/styles."+n,zip_add_file(i,o,write_sty_xml(t,r)),a.styles.push(o),add_rels(r.wbrels,-1,"styles."+n,RELS.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",zip_add_file(i,o,t.vbaraw),a.vba.push(o),add_rels(r.wbrels,-1,"vbaProject.bin",RELS.VBA)),o="xl/metadata."+n,zip_add_file(i,o,write_xlmeta_xml()),a.metadata.push(o),add_rels(r.wbrels,-1,"metadata."+n,RELS.XLMETA),h.length>1&&(o="xl/persons/person.xml",zip_add_file(i,o,write_people_xml(h)),a.people.push(o),add_rels(r.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(i,"[Content_Types].xml",write_ct(a,r)),zip_add_file(i,"_rels/.rels",write_rels(r.rels)),zip_add_file(i,"xl/_rels/workbook."+n+".rels",write_rels(r.wbrels)),delete r.revssf,delete r.ssf,i}function firstbyte(t,r){var n="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Base64_decode(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function read_cfb(t,r){return CFB.find(t,"EncryptedPackage")?parse_xlsxcfb(t,r):parse_xlscfb(t,r)}function read_zip(t,r){var n,s=t,a=r||{};return a.type||(a.type=has_buf&&Buffer.isBuffer(t)?"buffer":"base64"),n=zip_read(s,a),parse_zip(n,a)}function read_plaintext(t,r){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return parse_xlml(t.slice(n),r);default:break e}return PRN.to_workbook(t,r)}function read_plaintext_raw(t,r){var n="",s=firstbyte(t,r);switch(r.type){case"base64":n=Base64_decode(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=cc2str(t);break;default:throw new Error("Unrecognized type "+r.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(n=utf8read(n)),r.type="binary",read_plaintext(n,r)}function read_utf16(t,r){var n=t;return r.type=="base64"&&(n=Base64_decode(n)),n=$cptable.utils.decode(1200,n.slice(2),"str"),r.type="binary",read_plaintext(n,r)}function bstrify(t){return t.match(/[^\x00-\x7F]/)?utf8write(t):t}function read_prn(t,r,n,s){return s?(n.type="string",PRN.to_workbook(t,n)):PRN.to_workbook(r,n)}function readSync(t,r){reset_cp();var n=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return readSync(new Uint8Array(t),(n=dup(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var s=t,a=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),_ssfopts={},n.dateNF&&(_ssfopts.dateNF=n.dateNF),n.type||(n.type=has_buf&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=has_buf?"buffer":"binary",s=read_binary(t),typeof Uint8Array<"u"&&!has_buf&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,s=bstrify(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return n=dup(n),n.type="array",readSync(ab2a(s),n)}switch((a=firstbyte(s,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return read_cfb(CFB.read(s,n),n);break;case 9:if(a[1]<=8)return parse_xlscfb(s,n);break;case 60:return parse_xlml(s,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return read_wb_ID(s,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return DIF.to_workbook(s,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?read_zip(s,n):read_prn(t,s,n,i);case 239:return a[3]===60?parse_xlml(s,n):read_prn(t,s,n,i);case 255:if(a[1]===254)return read_utf16(s,n);if(a[1]===0&&a[2]===2&&a[3]===0)return WK_.to_workbook(s,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return WK_.to_workbook(s,n);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(s,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return RTF.to_workbook(s,n);break;case 10:case 13:case 32:return read_plaintext_raw(s,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?DBF.to_workbook(s,n):read_prn(t,s,n,i)}function write_cfb_ctr(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return write_dl(r.file,CFB.write(t,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return CFB.write(t,r)}function write_zip_type(t,r){var n=dup(r||{}),s=write_zip(t,n);return write_zip_denouement(s,n)}function write_zip_denouement(t,r){var n={},s=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(n.compression="DEFLATE"),r.password)n.type=s;else switch(r.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":n.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var a=t.FullPaths?CFB.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!r.compression}):t.generate(n);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(s2ab(a))}return r.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(a,r.password),r):r.type==="file"?write_dl(r.file,a):r.type=="string"?utf8read(a):a}function write_cfb_type(t,r){var n=r||{},s=write_xlscfb(t,n);return write_cfb_ctr(s,n)}function write_string_type(t,r,n){n||(n="");var s=n+t;switch(r.type){case"base64":return Base64_encode(utf8write(s));case"binary":return utf8write(s);case"string":return t;case"file":return write_dl(r.file,s,"utf8");case"buffer":return has_buf?Buffer_from(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):write_string_type(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function write_stxt_type(t,r){switch(r.type){case"base64":return Base64_encode(t);case"binary":return t;case"string":return t;case"file":return write_dl(r.file,t,"binary");case"buffer":return has_buf?Buffer_from(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function write_binary_type(t,r){switch(r.type){case"string":case"base64":case"binary":for(var n="",s=0;s<t.length;++s)n+=String.fromCharCode(t[s]);return r.type=="base64"?Base64_encode(n):r.type=="string"?utf8read(n):n;case"file":return write_dl(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function writeSync(t,r){reset_cp(),check_wb(t);var n=dup(r||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var s=writeSync(t,n);return n.type="array",s2ab(s)}var a=0;if(n.sheet&&(typeof n.sheet=="number"?a=n.sheet:a=t.SheetNames.indexOf(n.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(t,n),n);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"htm":case"html":return write_string_type(sheet_to_html(t.Sheets[t.SheetNames[a]],n),n);case"txt":return write_stxt_type(sheet_to_txt(t.Sheets[t.SheetNames[a]],n),n);case"csv":return write_string_type(sheet_to_csv(t.Sheets[t.SheetNames[a]],n),n,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"dbf":return write_binary_type(DBF.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"prn":return write_string_type(PRN.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"rtf":return write_string_type(RTF.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"eth":return write_string_type(ETH.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"fods":return write_string_type(write_ods(t,n),n);case"wk1":return write_binary_type(WK_.sheet_to_wk1(t.Sheets[t.SheetNames[a]],n),n);case"wk3":return write_binary_type(WK_.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),write_binary_type(write_biff_buf(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),write_cfb_type(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function resolve_book_type(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function writeFileSync(t,r,n){var s={};return s.type="file",s.file=r,resolve_book_type(s),writeSync(t,s)}function make_json_row(t,r,n,s,a,i,o,c){var f=encode_row(n),d=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:n,enumerable:!1})}catch{g.__rowNum__=n}else g.__rowNum__=n;if(!o||t[n])for(var v=r.s.c;v<=r.e.c;++v){var y=o?t[n][v]:t[s[v]+f];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[v]!=null&&(g[i[v]]=d);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[v]!=null){if(_==null)if(y.t=="e"&&_===null)g[i[v]]=null;else if(d!==void 0)g[i[v]]=d;else if(h&&_===null)g[i[v]]=null;else continue;else g[i[v]]=h&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?_:format_cell(y,_,c);_!=null&&(m=!1)}}return{row:g,isempty:m}}function sheet_to_json(t,r){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},s=0,a=1,i=[],o=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=r||{},h=d.range!=null?d.range:t["!ref"];switch(d.header===1?s=1:d.header==="A"?s=2:Array.isArray(d.header)?s=3:d.header==null&&(s=0),typeof h){case"string":f=safe_decode_range(h);break;case"number":f=safe_decode_range(t["!ref"]),f.s.r=h;break;default:f=h}s>0&&(a=0);var m=encode_row(f.s.r),g=[],v=[],y=0,_=0,w=Array.isArray(t),b=f.s.r,T=0,k={};w&&!t[b]&&(t[b]=[]);var C=d.skipHidden&&t["!cols"]||[],L=d.skipHidden&&t["!rows"]||[];for(T=f.s.c;T<=f.e.c;++T)if(!(C[T]||{}).hidden)switch(g[T]=encode_col(T),n=w?t[b][T]:t[g[T]+m],s){case 1:i[T]=T-f.s.c;break;case 2:i[T]=g[T];break;case 3:i[T]=d.header[T-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=format_cell(n,null,d),_=k[o]||0,!_)k[o]=1;else{do c=o+"_"+_++;while(k[c]);k[o]=_,k[c]=1}i[T]=c}for(b=f.s.r+a;b<=f.e.r;++b)if(!(L[b]||{}).hidden){var D=make_json_row(t,f,b,g,s,i,w,d);(D.isempty===!1||(s===1?d.blankrows!==!1:d.blankrows))&&(v[y++]=D.row)}return v.length=y,v}var qreg=/"/g;function make_csv_row(t,r,n,s,a,i,o,c){for(var f=!0,d=[],h="",m=encode_row(n),g=r.s.c;g<=r.e.c;++g)if(s[g]){var v=c.dense?(t[n]||[])[g]:t[s[g]+m];if(v==null)h="";else if(v.v!=null){f=!1,h=""+(c.rawNumbers&&v.t=="n"?v.v:format_cell(v,null,c));for(var y=0,_=0;y!==h.length;++y)if((_=h.charCodeAt(y))===a||_===i||_===34||c.forceQuotes){h='"'+h.replace(qreg,'""')+'"';break}h=="ID"&&(h='"ID"')}else v.f!=null&&!v.F?(f=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(qreg,'""')+'"')):h="";d.push(h)}return c.blankrows===!1&&f?null:d.join(o)}function sheet_to_csv(t,r){var n=[],s=r??{};if(t==null||t["!ref"]==null)return"";var a=safe_decode_range(t["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),c=s.RS!==void 0?s.RS:`
`,f=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];s.dense=Array.isArray(t);for(var g=s.skipHidden&&t["!cols"]||[],v=s.skipHidden&&t["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(g[y]||{}).hidden||(m[y]=encode_col(y));for(var _=0,w=a.s.r;w<=a.e.r;++w)(v[w]||{}).hidden||(h=make_csv_row(t,a,w,m,o,f,i,s),h!=null&&(s.strip&&(h=h.replace(d,"")),(h||s.blankrows!==!1)&&n.push((_++?c:"")+h)));return delete s.dense,n.join("")}function sheet_to_txt(t,r){r||(r={}),r.FS="	",r.RS=`
`;var n=sheet_to_csv(t,r);return n}function sheet_to_formulae(t){var r="",n,s="";if(t==null||t["!ref"]==null)return[];var a=safe_decode_range(t["!ref"]),i="",o=[],c,f=[],d=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)o[c]=encode_col(c);for(var h=a.s.r;h<=a.e.r;++h)for(i=encode_row(h),c=a.s.c;c<=a.e.c;++c)if(r=o[c]+i,n=d?(t[h]||[])[c]:t[r],s="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;s=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)s=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)s=""+n.v;else if(n.t=="b")s=n.v?"TRUE":"FALSE";else if(n.w!==void 0)s="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?s="'"+n.v:s=""+n.v}}f[f.length]=r+"="+s}return f}function sheet_add_json(t,r,n){var s=n||{},a=+!s.skipHeader,i=t||{},o=0,c=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var f=typeof s.origin=="string"?decode_cell(s.origin):s.origin;o=f.r,c=f.c}var d,h={s:{c:0,r:0},e:{c,r:o+r.length-1+a}};if(i["!ref"]){var m=safe_decode_range(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(o=m.e.r+1,h.e.r=o+r.length-1+a)}else o==-1&&(o=0,h.e.r=r.length-1+a);var g=s.header||[],v=0;r.forEach(function(_,w){keys(_).forEach(function(b){(v=g.indexOf(b))==-1&&(g[v=g.length]=b);var T=_[b],k="z",C="",L=encode_cell({c:c+v,r:o+w+a});d=ws_get_cell_stub(i,L),T&&typeof T=="object"&&!(T instanceof Date)?i[L]=T:(typeof T=="number"?k="n":typeof T=="boolean"?k="b":typeof T=="string"?k="s":T instanceof Date?(k="d",s.cellDates||(k="n",T=datenum(T)),C=s.dateNF||table_fmt[14]):T===null&&s.nullError&&(k="e",T=0),d?(d.t=k,d.v=T,delete d.w,delete d.R,C&&(d.z=C)):i[L]=d={t:k,v:T},C&&(d.z=C))})}),h.e.c=Math.max(h.e.c,c+g.length-1);var y=encode_row(o);if(a)for(v=0;v<g.length;++v)i[encode_col(v+c)+y]={t:"s",v:g[v]};return i["!ref"]=encode_range(h),i}function json_to_sheet(t,r){return sheet_add_json(null,t,r)}function ws_get_cell_stub(t,r,n){if(typeof r=="string"){if(Array.isArray(t)){var s=decode_cell(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?ws_get_cell_stub(t,encode_cell(r)):ws_get_cell_stub(t,encode_cell({r,c:n||0}))}function wb_sheet_idx(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var n=t.SheetNames.indexOf(r);if(n>-1)return n;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(t,r,n,s){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=o+a)!=-1;++a);}if(check_ws_name(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=r,n}function book_set_sheet_visibility(t,r,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=wb_sheet_idx(t,r);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[s].Hidden=n}function cell_set_number_format(t,r){return t.z=r,t}function cell_set_hyperlink(t,r,n){return r?(t.l={Target:r},n&&(t.l.Tooltip=n)):delete t.l,t}function cell_set_internal_link(t,r,n){return cell_set_hyperlink(t,"#"+r,n)}function cell_add_comment(t,r,n){t.c||(t.c=[]),t.c.push({t:r,a:n||"SheetJS"})}function sheet_set_array_formula(t,r,n,s){for(var a=typeof r!="string"?r:safe_decode_range(r),i=typeof r=="string"?r:encode_range(r),o=a.s.r;o<=a.e.r;++o)for(var c=a.s.c;c<=a.e.c;++c){var f=ws_get_cell_stub(t,o,c);f.t="n",f.F=i,delete f.v,o==a.s.r&&c==a.s.c&&(f.f=n,s&&(f.D=!0))}return t}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const SettingsPage=()=>{const{t}=useTranslation(),{settings:r,updateSettings:n,resetData:s,transactions:a,importData:i}=useData(),{theme:o,toggleTheme:c}=useTheme(),[f,d]=React.useState(!1),h=_=>{n({...r,currency:_.target.value})},m=_=>{n({...r,firstDayOfMonth:parseInt(_.target.value)})},g=_=>{n({...r,theme:_.target.value})},v=()=>{n({currency:"USD",firstDayOfMonth:1,theme:"system"}),typeof window<"u"&&window.localStorage&&window.localStorage.removeItem("finance_tracker_data"),typeof i=="function"?i({transactions:[],budgets:[],categories:defaultCategories,settings:{currency:"USD",firstDayOfMonth:1,theme:"system"}}):typeof s=="function"&&s(),d(!1)},y=()=>{const _=a.map(T=>({Date:T.date,Category:T.category,Amount:T.amount,Type:T.type,Notes:T.notes||""})),w=utils.json_to_sheet(_),b=utils.book_new();utils.book_append_sheet(b,w,"Transactions"),writeFileSync(b,"transactions.xlsx")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsx("header",{className:"mb-6",children:jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:t("settings.title")})}),jsxRuntimeExports.jsxs("section",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:t("settings.preferences")}),jsxRuntimeExports.jsxs("div",{className:"card space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"currency",className:"input-label",children:t("settings.currency")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(DollarSign,{size:20,className:"text-gray-500 mr-2"}),jsxRuntimeExports.jsxs("select",{id:"currency",value:r.currency,onChange:h,className:"flex-1",children:[jsxRuntimeExports.jsx("option",{value:"USD",children:t("currency.usd")}),jsxRuntimeExports.jsx("option",{value:"EUR",children:t("currency.eur")}),jsxRuntimeExports.jsx("option",{value:"GBP",children:t("currency.gbp")}),jsxRuntimeExports.jsx("option",{value:"JPY",children:t("currency.jpy")}),jsxRuntimeExports.jsx("option",{value:"CAD",children:t("currency.cad")}),jsxRuntimeExports.jsx("option",{value:"AUD",children:t("currency.aud")}),jsxRuntimeExports.jsx("option",{value:"CHF",children:t("currency.chf")})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"firstDay",className:"input-label",children:t("settings.firstDay")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(Calendar,{size:20,className:"text-gray-500 mr-2"}),jsxRuntimeExports.jsxs("select",{id:"firstDay",value:r.firstDayOfMonth,onChange:m,className:"flex-1",children:[jsxRuntimeExports.jsx("option",{value:"1",children:t("firstDay.1")}),jsxRuntimeExports.jsx("option",{value:"15",children:t("firstDay.15")}),jsxRuntimeExports.jsx("option",{value:"25",children:t("firstDay.25")})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"theme",className:"input-label",children:t("settings.theme")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[o==="dark"?jsxRuntimeExports.jsx(Moon,{size:20,className:"text-gray-500 mr-2"}):jsxRuntimeExports.jsx(Sun,{size:20,className:"text-gray-500 mr-2"}),jsxRuntimeExports.jsxs("select",{id:"theme",value:r.theme,onChange:g,className:"flex-1",children:[jsxRuntimeExports.jsx("option",{value:"light",children:t("theme.light")}),jsxRuntimeExports.jsx("option",{value:"dark",children:t("theme.dark")}),jsxRuntimeExports.jsx("option",{value:"system",children:t("theme.system")})]})]})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:t("settings.dataManagement")}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Link,{to:"/settings/categories",className:"card block hover:shadow-lg transition-shadow",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary-100 dark:bg-primary-900/30 p-2 rounded-lg mr-3",children:jsxRuntimeExports.jsx(Tag,{size:20,className:"text-primary-600 dark:text-primary-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium",children:t("settings.categories")}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("settings.categoriesDescription")})]})]}),jsxRuntimeExports.jsx(ArrowRight,{size:20,className:"text-gray-400"})]})}),jsxRuntimeExports.jsx(Link,{to:"/settings/import-export",className:"card block hover:shadow-lg transition-shadow",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary-100 dark:bg-primary-900/30 p-2 rounded-lg mr-3",children:jsxRuntimeExports.jsx(FileText,{size:20,className:"text-primary-600 dark:text-primary-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium",children:t("settings.importExport")}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("settings.importExportDescription")})]})]}),jsxRuntimeExports.jsx(ArrowRight,{size:20,className:"text-gray-400"})]})}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mb-2",children:t("settings.quickExport")}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>exportData(),className:"btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(Download,{size:18,className:"mr-2"}),t("settings.fullBackup")]}),jsxRuntimeExports.jsxs("button",{onClick:()=>exportCSV("transactions"),className:"btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(Download,{size:18,className:"mr-2"}),t("settings.transactionsCSV")]}),jsxRuntimeExports.jsxs("button",{onClick:()=>y(),className:"btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(Download,{size:18,className:"mr-2"}),t("settings.exportToExcel")]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>d(!0),className:"card block w-full hover:shadow-lg transition-shadow",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 p-2 rounded-lg mr-3",children:jsxRuntimeExports.jsx(Trash,{size:20,className:"text-red-600 dark:text-red-400"})}),jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium",children:t("settings.resetAllData")}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("settings.resetAllDataDescription")})]})]})})]})]}),f&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:t("settings.resetConfirmTitle")}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:t("settings.resetConfirmDescription")}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>d(!1),children:t("settings.cancel")}),jsxRuntimeExports.jsx("button",{className:"btn bg-red-500 hover:bg-red-600 text-white",onClick:v,children:t("settings.reset")})]})]})})]})},CategoriesPage=()=>{const t=useNavigate(),{categories:r,addCategory:n,updateCategory:s,deleteCategory:a}=useData(),[i,o]=reactExports.useState("expense"),[c,f]=reactExports.useState(!1),[d,h]=reactExports.useState(!1),[m,g]=reactExports.useState(!1),[v,y]=reactExports.useState(null),[_,w]=reactExports.useState({name:"",type:"expense",color:"#6B7280"}),T=r.filter(j=>j.type===i||j.type==="both").slice().sort((j,K)=>j.name.localeCompare(K.name)),k=()=>{w({name:"",type:i,color:M()}),f(!0)},C=j=>{y(j),w({name:j.name,type:j.type,color:j.color}),h(!0)},L=j=>{y(j),g(!0)},D=j=>{j.preventDefault(),n({name:_.name,type:_.type,color:_.color}),f(!1)},N=j=>{j.preventDefault(),v&&s({id:v.id,name:_.name,type:_.type,color:_.color}),h(!1)},U=()=>{v&&a(v.id),g(!1)},M=()=>{const j=["#EF4444","#F97316","#F59E0B","#EAB308","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899","#F43F5E"];return j[Math.floor(Math.random()*j.length)]};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>t("/settings"),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Categories"})]}),jsxRuntimeExports.jsxs("div",{className:"flex mb-6 overflow-x-auto",children:[jsxRuntimeExports.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg ${i==="expense"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`,onClick:()=>o("expense"),children:"Expenses"}),jsxRuntimeExports.jsx("button",{className:`px-4 py-2 mr-2 rounded-lg ${i==="income"?"bg-accent-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"}`,onClick:()=>o("income"),children:"Income"})]}),jsxRuntimeExports.jsxs("div",{className:"card mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-lg font-semibold",children:[i==="expense"?"Expense":"Income"," Categories"]}),jsxRuntimeExports.jsxs("button",{onClick:k,className:"btn-primary flex items-center text-sm py-1",children:[jsxRuntimeExports.jsx(Plus,{size:16,className:"mr-1"}),"Add Category"]})]}),jsxRuntimeExports.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:T.length>0?T.map(j=>jsxRuntimeExports.jsxs("div",{className:"py-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:j.color},children:jsxRuntimeExports.jsx("span",{className:"text-white font-bold",children:j.name.charAt(0)})}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:j.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>C(j),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":`Edit ${j.name} category`,children:jsxRuntimeExports.jsx(SquarePen,{size:18})}),jsxRuntimeExports.jsx("button",{onClick:()=>L(j),className:"p-2 text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400","aria-label":`Delete ${j.name} category`,children:jsxRuntimeExports.jsx(Trash,{size:18})})]})]},j.id)):jsxRuntimeExports.jsxs("p",{className:"py-6 text-center text-gray-500 dark:text-gray-400",children:["No ",i," categories found"]})})]}),c&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-md w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add Category"}),jsxRuntimeExports.jsxs("form",{onSubmit:D,children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"input-label",children:"Category Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",value:_.name,onChange:j=>w({..._,name:j.target.value}),className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"type",className:"input-label",children:"Category Type"}),jsxRuntimeExports.jsxs("select",{id:"type",value:_.type,onChange:j=>w({..._,type:j.target.value}),className:"w-full",children:[jsxRuntimeExports.jsx("option",{value:"expense",children:"Expense"}),jsxRuntimeExports.jsx("option",{value:"income",children:"Income"}),jsxRuntimeExports.jsx("option",{value:"both",children:"Both"})]})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"color",className:"input-label",children:"Color"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"color",id:"color",value:_.color,onChange:j=>w({..._,color:j.target.value}),className:"w-10 h-10 p-0 border-0 rounded-full mr-2"}),jsxRuntimeExports.jsx("span",{className:"flex-1 font-medium",children:_.color})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn-outline",onClick:()=>f(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn-primary",children:"Add Category"})]})]})]})}),d&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-md w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Edit Category"}),jsxRuntimeExports.jsxs("form",{onSubmit:N,children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"edit-name",className:"input-label",children:"Category Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"edit-name",value:_.name,onChange:j=>w({..._,name:j.target.value}),className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"edit-type",className:"input-label",children:"Category Type"}),jsxRuntimeExports.jsxs("select",{id:"edit-type",value:_.type,onChange:j=>w({..._,type:j.target.value}),className:"w-full",children:[jsxRuntimeExports.jsx("option",{value:"expense",children:"Expense"}),jsxRuntimeExports.jsx("option",{value:"income",children:"Income"}),jsxRuntimeExports.jsx("option",{value:"both",children:"Both"})]})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"edit-color",className:"input-label",children:"Color"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"color",id:"edit-color",value:_.color,onChange:j=>w({..._,color:j.target.value}),className:"w-10 h-10 p-0 border-0 rounded-full mr-2"}),jsxRuntimeExports.jsx("span",{className:"flex-1 font-medium",children:_.color})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn-outline",onClick:()=>h(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})]})]})}),m&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Delete Category?"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:['Are you sure you want to delete "',v==null?void 0:v.name,'"? This action cannot be undone.']}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>g(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn bg-red-500 hover:bg-red-600 text-white",onClick:U,children:"Delete"})]})]})})]})},ImportExportPage=()=>{const t=useNavigate(),r=reactExports.useRef(null),n=reactExports.useRef(null),{importData:s,transactions:a,categories:i,settings:o,budgets:c}=useData(),[f,d]=reactExports.useState(!1),[h,m]=reactExports.useState(null),g=()=>{r.current&&r.current.click()},v=()=>{n.current&&n.current.click()},y=async b=>{var k;const T=(k=b.target.files)==null?void 0:k[0];if(T){d(!0),m(null);try{const C=await importData(T);s(C),m({type:"success",message:"Data imported successfully!"})}catch(C){m({type:"error",message:C instanceof Error?C.message:"Failed to import data"})}finally{d(!1),b.target&&(b.target.value="")}}},_=async b=>{var k;const T=(k=b.target.files)==null?void 0:k[0];if(T){d(!0),m(null);try{const C=new FileReader;C.onload=L=>{const D=L.target&&L.target.result;if(D&&D instanceof ArrayBuffer){const N=new Uint8Array(D),U=readSync(N,{type:"array"});let M=[];U.SheetNames.includes("Opérations")&&(M=utils.sheet_to_json(U.Sheets.Opérations).map((he,J)=>({id:he.ID||`${Date.now()}_op_${J}`,date:he.Date||"",category:he.Category||"",amount:Number(Math.abs(he.Amount))||0,type:Number(he.Amount)<0?"expense":"income",notes:he.Notes||"",description:he.Description||""})));let j=[];U.SheetNames.includes("Catégories")?j=utils.sheet_to_json(U.Sheets.Catégories):j=defaultCategories;let K;U.SheetNames.includes("Paramètres")?K=utils.sheet_to_json(U.Sheets.Paramètres)[0]:K={currency:"EUR",firstDayOfMonth:1,theme:"system"};let I=[];U.SheetNames.includes("Budgets planifiés")&&(I=utils.sheet_to_json(U.Sheets["Budgets planifiés"]));const te=I.map((le,he)=>({id:le.ID||`${Date.now()}_budget_${he}`,category:le.Category||"",amount:Number(le.Amount)||0,period:le.Period||"monthly",startDate:le.StartDate||new Date().toISOString().split("T")[0],notes:le.Notes||"",isTemplate:!0})),_e=j.map((le,he)=>({id:le.ID||le.id||`${Date.now()}_cat_${he}`,name:le.Name||le.name||"",type:le.Type||le.type||"expense",color:le.Color||le.color||"#6B7280",icon:le.Icon||le.icon||void 0})),ne={currency:K.currency||"EUR",firstDayOfMonth:Number(K.firstDayOfMonth)||1,theme:K.theme||"system"};s({transactions:M,budgets:te,categories:_e,settings:ne}),m({type:"success",message:"Excel data imported successfully!"})}else m({type:"error",message:"Failed to read Excel file."});d(!1),b.target&&(b.target.value="")},C.readAsArrayBuffer(T)}catch(C){m({type:"error",message:C instanceof Error?C.message:"Failed to import Excel data"}),d(!1)}}},w=()=>{const b=a.map(D=>({ID:D.id,Date:D.date,Category:D.category,Amount:D.type==="expense"?-Math.abs(D.amount):Math.abs(D.amount),Description:D.description,Notes:D.notes||""})),T=i.map(D=>({ID:D.id,Name:D.name,Type:D.type,Color:D.color,Icon:D.icon||""})),k=[o],C=c.filter(D=>D.isTemplate).map(D=>({ID:D.id,Category:D.category,Amount:D.amount,Period:D.period,StartDate:D.startDate,Notes:D.notes||""})),L=utils.book_new();utils.book_append_sheet(L,utils.json_to_sheet(b),"Opérations"),utils.book_append_sheet(L,utils.json_to_sheet(T),"Catégories"),utils.book_append_sheet(L,utils.json_to_sheet(k),"Paramètres"),utils.book_append_sheet(L,utils.json_to_sheet(C),"Budgets planifiés"),writeFileSync(L,"finance_tracker_export.xlsx")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>t("/settings"),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Import/Export"})]}),jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Export Data"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Download a backup of all your data, including transactions, budgets, and settings."}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>exportData(),className:"w-full btn-primary flex items-center justify-center",children:[jsxRuntimeExports.jsx(FileDown,{size:20,className:"mr-2"}),"Export All Data (JSON)"]}),jsxRuntimeExports.jsxs("button",{onClick:w,className:"w-full btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(FileDown,{size:20,className:"mr-2"}),"Export Transactions (Excel)"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>exportCSV("transactions"),className:"btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(FileDown,{size:18,className:"mr-2"}),"Transactions (CSV)"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>exportCSV("budgets"),className:"btn-outline flex items-center justify-center",children:[jsxRuntimeExports.jsx(FileDown,{size:18,className:"mr-2"}),"Budgets (CSV)"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Import Data"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Restore data from a previously exported JSON backup file."}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("button",{onClick:g,className:"w-full btn-primary flex items-center justify-center",disabled:f,children:[jsxRuntimeExports.jsx(FileUp,{size:20,className:"mr-2"}),f?"Importing...":"Import Data (JSON)"]}),jsxRuntimeExports.jsx("input",{type:"file",ref:r,onChange:y,accept:".json",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:v,className:"w-full btn-outline flex items-center justify-center",disabled:f,children:[jsxRuntimeExports.jsx(FileUp,{size:20,className:"mr-2"}),f?"Importing...":"Import from Excel (.xlsx)"]}),jsxRuntimeExports.jsx("input",{type:"file",ref:n,onChange:_,accept:".xlsx, .xls",className:"hidden"}),h&&jsxRuntimeExports.jsxs("div",{className:`p-4 rounded-lg flex items-start ${h.type==="success"?"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-200"}`,children:[h.type==="success"?jsxRuntimeExports.jsx(CheckCircle,{size:20,className:"mr-2 flex-shrink-0"}):jsxRuntimeExports.jsx(AlertCircle,{size:20,className:"mr-2 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{children:h.message})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"font-medium mb-2",children:"Important Notes:"}),jsxRuntimeExports.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"Importing data will replace all existing data"}),jsxRuntimeExports.jsx("li",{children:"Make sure to backup your current data before importing"}),jsxRuntimeExports.jsx("li",{children:"Only JSON files exported from this app are supported"})]})]})]})]})]})},AddTransactionPage=({type:t})=>{var h;const r=useNavigate(),{addTransaction:n,categories:s,settings:a}=useData(),i=s.filter(m=>m.type===t||m.type==="both").sort((m,g)=>m.name.localeCompare(g.name)),[o,c]=reactExports.useState({amount:"",date:new Date().toISOString().split("T")[0],category:((h=i[0])==null?void 0:h.name)||"",description:"",notes:"",type:t}),f=m=>{const{name:g,value:v}=m.target;c({...o,[g]:v})},d=m=>{m.preventDefault(),!(!o.amount||!o.date||!o.category||!o.description)&&(n({...o,amount:parseFloat(o.amount)}),r(`/${t}s`))};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r(-1),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:t==="expense"?"Add Expense":"Add Income"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:d,className:"animate-fade-in",children:[jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"amount",className:"input-label",children:["Amount (",a.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"number",id:"amount",name:"amount",placeholder:"0.00",step:"0.01",min:"0",value:o.amount,onChange:f,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"date",className:"input-label",children:"Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"date",name:"date",value:o.date,onChange:f,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"category",className:"input-label",children:"Category"}),jsxRuntimeExports.jsxs("select",{id:"category",name:"category",value:o.category,onChange:f,className:"w-full",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a category"}),i.map(m=>jsxRuntimeExports.jsx("option",{value:m.name,children:m.name},m.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",className:"input-label",children:"Description"}),jsxRuntimeExports.jsx("input",{type:"text",id:"description",name:"description",placeholder:t==="expense"?"e.g., Grocery shopping":"e.g., Monthly salary",value:o.description,onChange:f,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group mb-0",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"notes",name:"notes",placeholder:"Add any additional details",value:o.notes,onChange:f,className:"w-full",rows:3})]})]}),jsxRuntimeExports.jsxs("button",{type:"submit",className:`w-full ${t==="expense"?"btn-primary":"btn-secondary"} flex items-center justify-center text-lg`,children:[jsxRuntimeExports.jsx(Save,{size:20,className:"mr-2"}),"Save ",t==="expense"?"Expense":"Income"]})]})]})},getCategoryBadgeColor=t=>t?t.length===7?t+"30":t:"#6B728030",CategoryBadge=({color:t,label:r,className:n=""})=>jsxRuntimeExports.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center mr-2 ${n}`,style:{backgroundColor:getCategoryBadgeColor(t)},children:jsxRuntimeExports.jsx("span",{style:{color:t},children:r.charAt(0)})}),ConfirmDialog=({open:t,title:r,message:n,onCancel:s,onConfirm:a,confirmLabel:i="Delete",cancelLabel:o="Cancel",confirmClassName:c="btn bg-red-500 hover:bg-red-600 text-white"})=>t?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:r}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:n}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:s,children:o}),jsxRuntimeExports.jsx("button",{className:c,onClick:a,children:i})]})]})}):null,TransactionDetailPage=({type:t})=>{const{id:r}=useParams(),n=useNavigate(),{transactions:s,categories:a,settings:i,deleteTransaction:o}=useData(),[c,f]=reactExports.useState(!1),d=s.find(g=>g.id===r),h=a.find(g=>g.name===(d==null?void 0:d.category));if(!d||d.type!==t)return jsxRuntimeExports.jsx("div",{className:"page-container",children:jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(AlertTriangle,{size:48,className:"text-warning-500 mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"Transaction Not Found"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["The ",t," you are looking for does not exist."]}),jsxRuntimeExports.jsxs(Link,{to:`/${t}s`,className:"btn-primary",children:["Back to ",t==="expense"?"Expenses":"Income"]})]})});const m=()=>{o(d.id),n(`/${t}s`)};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>n(t==="expense"?"/expenses":"/incomes"),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:t==="expense"?"Expense Details":"Income Details"})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsxs(Link,{to:`/${t}s/${r}/edit`,className:"btn-outline flex items-center mr-2",children:[jsxRuntimeExports.jsx(SquarePen,{size:18,className:"mr-1"}),"Edit"]}),jsxRuntimeExports.jsxs("button",{className:"btn-outline text-red-500 dark:text-red-400 border-red-500 dark:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center",onClick:()=>f(!0),children:[jsxRuntimeExports.jsx(Trash,{size:18,className:"mr-1"}),"Delete"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"card mb-6 relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 rounded-bl-full opacity-10",style:{backgroundColor:(h==null?void 0:h.color)||"#6B7280"}}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:d.description}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(CategoryBadge,{color:h==null?void 0:h.color,label:d.category}),jsxRuntimeExports.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:d.category})]})]}),jsxRuntimeExports.jsxs("div",{className:`text-2xl font-bold ${t==="expense"?"text-red-500 dark:text-red-400":"text-green-500 dark:text-green-400"}`,children:[t==="expense"?"−":"+",formatCurrency(d.amount,i.currency)]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-800 pt-4 grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Date"}),jsxRuntimeExports.jsx("p",{children:formatDate(d.date)})]}),d.notes&&jsxRuntimeExports.jsxs("div",{className:"col-span-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Notes"}),jsxRuntimeExports.jsx("p",{className:"whitespace-pre-line",children:d.notes})]})]})]}),jsxRuntimeExports.jsx(ConfirmDialog,{open:c,title:"Delete Transaction?",message:`Are you sure you want to delete this ${t}? This action cannot be undone.`,onCancel:()=>f(!1),onConfirm:m})]})},BudgetDetailPage=()=>{var b;const{id:t}=useParams(),r=useNavigate(),{budgets:n,transactions:s,categories:a,settings:i,deleteBudget:o}=useData(),[c,f]=reactExports.useState(!1),d=n.find(T=>T.id===t);if(!d)return jsxRuntimeExports.jsx("div",{className:"page-container",children:jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(AlertTriangle,{size:48,className:"text-warning-500 mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"Budget Not Found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"The budget you are looking for does not exist."}),jsxRuntimeExports.jsx(Link,{to:"/budgets",className:"btn-primary",children:"Back to Budgets"})]})});const h=(d.categories&&Array.isArray(d.categories)?d.categories:[d.category]).filter(T=>typeof T=="string"),m=s.filter(T=>T.type==="expense"&&h.includes(T.category)).reduce((T,k)=>T+k.amount,0),g=d.amount-m,v=Math.min(m/d.amount*100,100),y=v>=100,_=s.filter(T=>T.type==="expense"&&h.includes(T.category)).sort((T,k)=>new Date(k.date).getTime()-new Date(T.date).getTime()),w=()=>{o(d.id),r("/budgets")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r(-1),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Budget Details"})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsxs(Link,{to:`/budgets/${t}/edit`,className:"btn-outline flex items-center mr-2",children:[jsxRuntimeExports.jsx(SquarePen,{size:18,className:"mr-1"}),"Edit"]}),jsxRuntimeExports.jsxs("button",{className:"btn-outline text-red-500 dark:text-red-400 border-red-500 dark:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center",onClick:()=>f(!0),children:[jsxRuntimeExports.jsx(Trash,{size:18,className:"mr-1"}),"Delete"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"card mb-6 relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 rounded-bl-full opacity-10",style:{backgroundColor:((b=a.find(T=>T.name===h[0]))==null?void 0:b.color)||"#6B7280"}}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:d.name||h.join(", ")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[h.slice(0,3).map(T=>{const k=a.find(C=>C.name===T);return k?jsxRuntimeExports.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center mr-2",style:{backgroundColor:k.color+"30"},title:T,children:jsxRuntimeExports.jsx("span",{style:{color:k.color},children:T.charAt(0)})},T):null}),h.length>3&&jsxRuntimeExports.jsxs("div",{className:"w-6 h-6 rounded-full flex items-center justify-center mr-2 bg-gray-300 text-gray-700 text-xs cursor-pointer",title:h.slice(3).join(", "),children:["+",h.length-3]}),jsxRuntimeExports.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:[d.period==="monthly"?"Monthly":"Yearly"," budget"]})]})]}),jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:formatCurrency(d.amount,i.currency)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["Spent: ",formatCurrency(m,i.currency)]}),jsxRuntimeExports.jsxs("span",{className:`font-medium ${y?"text-warning-500":"text-green-500"}`,children:[y?"Over by ":"Left: ",formatCurrency(y?-g:g,i.currency)]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-1",children:jsxRuntimeExports.jsx("div",{className:`h-4 rounded-full ${y?"bg-warning-500":"bg-primary-600"}`,style:{width:`${Math.min(v,100)}%`}})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsxs("span",{children:[formatCurrency(m,i.currency)," of ",formatCurrency(d.amount,i.currency)]}),jsxRuntimeExports.jsxs("span",{children:[Math.round(v),"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-800 pt-4 grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Start Date"}),jsxRuntimeExports.jsx("p",{children:formatDate(d.startDate)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Period"}),jsxRuntimeExports.jsx("p",{className:"capitalize",children:d.period})]}),d.notes&&jsxRuntimeExports.jsxs("div",{className:"col-span-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Notes"}),jsxRuntimeExports.jsx("p",{className:"whitespace-pre-line",children:d.notes})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Related Transactions"}),_.length>0?jsxRuntimeExports.jsx(TransactionList,{transactions:_}):jsxRuntimeExports.jsx("div",{className:"card p-6 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No related transactions found"})})]}),c&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Delete Budget?"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Are you sure you want to delete this budget? This action cannot be undone."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>f(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn bg-red-500 hover:bg-red-600 text-white",onClick:w,children:"Delete"})]})]})})]})},PlannedBudgetPage=()=>{const t=useNavigate(),{categories:r,settings:n,budgets:s,addBudget:a,updateBudget:i,deleteBudget:o}=useData(),[c,f]=reactExports.useState(!1),[d,h]=reactExports.useState(!1),[m,g]=reactExports.useState(!1),[v,y]=reactExports.useState(null),[_,w]=reactExports.useState({name:"",categories:[],amount:"",notes:""}),b=s.filter(j=>j.isTemplate),T=r.filter(j=>j.type==="expense"||j.type==="both"),k=()=>{w({name:"",categories:[],amount:"",notes:""}),f(!0)},C=j=>{y(j),w({name:j.name||"",categories:(j.categories||[j.category]).filter(K=>typeof K=="string"),amount:j.amount.toString(),notes:j.notes||""}),h(!0)},L=j=>{y(j),g(!0)},D=j=>{w(K=>{const I=K.categories.includes(j);return{...K,categories:I?K.categories.filter(te=>te!==j):[...K.categories,j]}})},N=j=>{j.preventDefault(),a({name:_.name,categories:_.categories,amount:parseFloat(_.amount),period:"monthly",startDate:new Date().toISOString().split("T")[0],notes:_.notes,isTemplate:!0}),f(!1)},U=j=>{j.preventDefault(),v&&i({...v,name:_.name,categories:_.categories,amount:parseFloat(_.amount),notes:_.notes}),h(!1)},M=()=>{v&&o(v.id),g(!1)};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>t("/budgets"),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Planned Budgets"})]}),jsxRuntimeExports.jsxs("button",{onClick:k,className:"btn-primary flex items-center",children:[jsxRuntimeExports.jsx(Plus,{size:20,className:"mr-2"}),"Add Budget"]})]}),jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:jsxRuntimeExports.jsx("p",{children:"Planned budgets serve as a template for your monthly budgets. They will be automatically applied at the start of each month."})}),b.length>0?jsxRuntimeExports.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:b.map(j=>{const K=(j.categories&&Array.isArray(j.categories)?j.categories:[j.category]).filter(ne=>typeof ne=="string"),I=K.slice(0,3).map(ne=>{const me=r.find(le=>le.name===ne);return me?jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full mr-1 flex items-center justify-center",style:{backgroundColor:me.color+"30"},title:ne,children:jsxRuntimeExports.jsx("span",{style:{color:me.color,fontSize:16},children:ne.charAt(0)})},ne):null}),te=K.length-3;let _e=null;if(te>0){const ne=K.slice(3).join(", ");_e=jsxRuntimeExports.jsxs("div",{className:"w-8 h-8 rounded-full mr-1 flex items-center justify-center bg-gray-300 text-gray-700 text-xs cursor-pointer",title:ne,children:["+",te]})}return jsxRuntimeExports.jsxs("div",{className:"py-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-row mr-3",children:[I,_e]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:j.name||K.join(", ")}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Monthly budget: ",formatCurrency(j.amount,n.currency)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>C(j),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(SquarePen,{size:18})}),jsxRuntimeExports.jsx("button",{onClick:()=>L(j),className:"p-2 text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400",children:jsxRuntimeExports.jsx(Trash,{size:18})})]})]},j.id)})}):jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(AlertTriangle,{size:48,className:"mx-auto text-warning-500 mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-2",children:"No planned budgets"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Start by creating a planned budget that will be used as a template each month."}),jsxRuntimeExports.jsxs("button",{onClick:k,className:"btn-primary flex items-center mx-auto",children:[jsxRuntimeExports.jsx(Plus,{size:18,className:"mr-2"}),"Add Planned Budget"]})]})]}),c&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-md w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add Planned Budget"}),jsxRuntimeExports.jsxs("form",{onSubmit:N,children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"budget-name",className:"input-label",children:"Budget Name"}),jsxRuntimeExports.jsx("input",{id:"budget-name",type:"text",value:_.name,onChange:j=>w({..._,name:j.target.value}),className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(j=>jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:_.categories.includes(j.name),onChange:()=>D(j.name)}),j.name]},j.id))})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"amount",className:"input-label",children:["Monthly Amount (",n.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"number",id:"amount",value:_.amount,onChange:j=>w({..._,amount:j.target.value}),className:"w-full",min:"0",step:"0.01",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"notes",value:_.notes,onChange:j=>w({..._,notes:j.target.value}),className:"w-full",rows:3})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn-outline",onClick:()=>f(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn-primary",children:"Add Budget"})]})]})]})}),d&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-md w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Edit Planned Budget"}),jsxRuntimeExports.jsxs("form",{onSubmit:U,children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"edit-budget-name",className:"input-label",children:"Budget Name"}),jsxRuntimeExports.jsx("input",{id:"edit-budget-name",type:"text",value:_.name,onChange:j=>w({..._,name:j.target.value}),className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(j=>jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:_.categories.includes(j.name),onChange:()=>D(j.name)}),j.name]},j.id))})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"edit-amount",className:"input-label",children:["Monthly Amount (",n.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"number",id:"edit-amount",value:_.amount,onChange:j=>w({..._,amount:j.target.value}),className:"w-full",min:"0",step:"0.01",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"edit-notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"edit-notes",value:_.notes,onChange:j=>w({..._,notes:j.target.value}),className:"w-full",rows:3})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn-outline",onClick:()=>h(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})]})]})}),m&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"card max-w-sm w-full animate-fade-in",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold mb-4",children:"Delete Planned Budget?"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Are you sure you want to delete this planned budget? This will not affect existing monthly budgets."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"btn-outline",onClick:()=>g(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn bg-red-500 hover:bg-red-600 text-white",onClick:M,children:"Delete"})]})]})})]})},EditTransactionPage=()=>{const{id:t}=useParams(),r=useNavigate(),{transactions:n,categories:s,settings:a,updateTransaction:i}=useData(),o=n.find(v=>v.id===t),c=(o==null?void 0:o.type)||"expense",f=s.filter(v=>v.type===c||v.type==="both"),[d,h]=reactExports.useState({amount:"",date:"",category:"",description:"",notes:"",type:c});reactExports.useEffect(()=>{o&&h({amount:o.amount.toString(),date:o.date,category:o.category,description:o.description,notes:o.notes||"",type:o.type})},[o]);const m=v=>{const{name:y,value:_}=v.target;h({...d,[y]:_})},g=v=>{v.preventDefault(),!(!d.amount||!d.date||!d.category||!d.description)&&(i({id:t,...d,amount:parseFloat(d.amount)}),r(`/${c}s/${t}`))};return o?jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r(-1),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsxs("h1",{className:"text-2xl font-bold",children:["Edit ",c==="expense"?"Expense":"Income"]})]}),jsxRuntimeExports.jsxs("form",{onSubmit:g,className:"animate-fade-in",children:[jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"amount",className:"input-label",children:["Amount (",a.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"number",id:"amount",name:"amount",placeholder:"0.00",step:"0.01",min:"0",value:d.amount,onChange:m,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"date",className:"input-label",children:"Date"}),jsxRuntimeExports.jsx("input",{type:"date",id:"date",name:"date",value:d.date,onChange:m,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"category",className:"input-label",children:"Category"}),jsxRuntimeExports.jsxs("select",{id:"category",name:"category",value:d.category,onChange:m,className:"w-full",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a category"}),f.map(v=>jsxRuntimeExports.jsx("option",{value:v.name,children:v.name},v.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",className:"input-label",children:"Description"}),jsxRuntimeExports.jsx("input",{type:"text",id:"description",name:"description",placeholder:c==="expense"?"e.g., Grocery shopping":"e.g., Monthly salary",value:d.description,onChange:m,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group mb-0",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"notes",name:"notes",placeholder:"Add any additional details",value:d.notes,onChange:m,className:"w-full",rows:3})]})]}),jsxRuntimeExports.jsxs("button",{type:"submit",className:`w-full ${c==="expense"?"btn-primary":"btn-secondary"} flex items-center justify-center text-lg`,children:[jsxRuntimeExports.jsx(Save,{size:20,className:"mr-2"}),"Save Changes"]})]})]}):jsxRuntimeExports.jsx("div",{className:"page-container",children:jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"Transaction Not Found"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:()=>r(-1),children:"Back"})]})})},EditBudgetPage=()=>{const{id}=useParams(),navigate=useNavigate(),{budgets,categories,settings,updateBudget}=useData(),budget=budgets.find(t=>t.id===id),[formData,setFormData]=reactExports.useState({name:"",categories:[],amount:"",notes:""});reactExports.useEffect(()=>{budget&&setFormData({name:budget.name||(budget.categories&&Array.isArray(budget.categories)?budget.categories:[budget.category]).filter(t=>typeof t=="string").join(", "),categories:(budget.categories&&Array.isArray(budget.categories)?budget.categories:[budget.category]).filter(t=>typeof t=="string"),amount:budget.amount.toString(),notes:budget.notes||""})},[budget]);const handleChange=t=>{const{name:r,value:n}=t.target;setFormData(s=>({...s,[r]:n}))},handleCategoryToggle=t=>{setFormData(r=>{const n=r.categories.includes(t);return{...r,categories:n?r.categories.filter(s=>s!==t):[...r.categories,t]}})},handleSubmit=e=>{if(e.preventDefault(),!budget)return;let amount=0;try{const expr=formData.amount.replace(/,/g,".").replace(/[^-+*/.\d()]/g,"");amount=eval(expr),(typeof amount!="number"||isNaN(amount))&&(amount=0)}catch{amount=0}updateBudget({...budget,name:formData.name,categories:formData.categories,amount,notes:formData.notes}),navigate("/budgets")};if(!budget)return jsxRuntimeExports.jsx("div",{className:"page-container",children:jsxRuntimeExports.jsxs("div",{className:"card flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"Budget Not Found"}),jsxRuntimeExports.jsx("button",{className:"btn-primary",onClick:()=>navigate(-1),children:"Back"})]})});const expenseCategories=categories.filter(t=>t.type==="expense"||t.type==="both");return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>navigate(-1),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Edit Budget"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"animate-fade-in",children:[jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"input-label",children:"Budget Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:formData.name,onChange:handleChange,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:expenseCategories.map(t=>jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:formData.categories.includes(t.name),onChange:()=>handleCategoryToggle(t.name)}),t.name]},t.id))})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"amount",className:"input-label",children:["Amount (",settings.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"amount",name:"amount",value:formData.amount,onChange:handleChange,className:"w-full",required:!0,onFocus:t=>{const r=document.createElement("div");r.id="amount-tooltip",r.textContent="Ici, vous pouvez saisir un calcul (ex: 200+150-50)",r.style.position="absolute",r.style.background="#333",r.style.color="#fff",r.style.padding="6px 12px",r.style.borderRadius="6px",r.style.fontSize="0.9em",r.style.top=t.target.getBoundingClientRect().bottom+window.scrollY+8+"px",r.style.left=t.target.getBoundingClientRect().left+"px",r.style.zIndex="9999",document.body.appendChild(r)},onBlur:()=>{const t=document.getElementById("amount-tooltip");t&&t.remove()}})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"notes",name:"notes",value:formData.notes,onChange:handleChange,className:"w-full",rows:3})]})]}),jsxRuntimeExports.jsxs("button",{type:"submit",className:"w-full btn-primary flex items-center justify-center text-lg",children:[jsxRuntimeExports.jsx(Save,{size:20,className:"mr-2"}),"Save Changes"]})]})]})},AddBudgetPage=()=>{const navigate=useNavigate(),{categories,settings,addBudget}=useData(),[formData,setFormData]=reactExports.useState({name:"",categories:[],amount:"",notes:""});reactExports.useEffect(()=>()=>{const t=document.getElementById("amount-tooltip");t&&t.remove()},[]);const expenseCategories=categories.filter(t=>t.type==="expense"||t.type==="both"),handleChange=t=>{const{name:r,value:n}=t.target;setFormData(s=>({...s,[r]:n}))},handleCategoryToggle=t=>{setFormData(r=>{const n=r.categories.includes(t);return{...r,categories:n?r.categories.filter(s=>s!==t):[...r.categories,t]}})},handleSubmit=e=>{e.preventDefault();let amount=0;try{const expr=formData.amount.replace(/,/g,".").replace(/[^-+*/.\d()]/g,"");amount=eval(expr),(typeof amount!="number"||isNaN(amount))&&(amount=0)}catch{amount=0}addBudget({name:formData.name,categories:formData.categories,amount,period:"monthly",startDate:new Date().toISOString().split("T")[0],notes:formData.notes,isTemplate:!1}),navigate("/budgets")};return jsxRuntimeExports.jsxs("div",{className:"page-container",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>navigate(-1),className:"mr-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Add Budget"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"animate-fade-in",children:[jsxRuntimeExports.jsxs("div",{className:"card mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"input-label",children:"Budget Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:formData.name,onChange:handleChange,className:"w-full",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{className:"input-label",children:"Categories"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:expenseCategories.map(t=>jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:formData.categories.includes(t.name),onChange:()=>handleCategoryToggle(t.name)}),t.name]},t.id))})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"amount",className:"input-label",children:["Amount (",settings.currency,")"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"amount",name:"amount",value:formData.amount,onChange:handleChange,className:"w-full",required:!0,onFocus:t=>{const r=document.createElement("div");r.id="amount-tooltip",r.textContent="Vous pouvez saisir une expression (ex: 200+150-50)",r.style.position="absolute",r.style.background="#333",r.style.color="#fff",r.style.padding="6px 12px",r.style.borderRadius="6px",r.style.fontSize="0.9em",r.style.top=t.target.getBoundingClientRect().bottom+window.scrollY+8+"px",r.style.left=t.target.getBoundingClientRect().left+"px",r.style.zIndex="9999",document.body.appendChild(r)},onBlur:()=>{const t=document.getElementById("amount-tooltip");t&&t.remove()}})]}),jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",className:"input-label",children:"Notes (Optional)"}),jsxRuntimeExports.jsx("textarea",{id:"notes",name:"notes",value:formData.notes,onChange:handleChange,className:"w-full",rows:3})]})]}),jsxRuntimeExports.jsxs("button",{type:"submit",className:"w-full btn-primary flex items-center justify-center text-lg",children:[jsxRuntimeExports.jsx(Save,{size:20,className:"mr-2"}),"Add Budget"]})]})]})};function App(){return useLocation(),jsxRuntimeExports.jsx(Routes,{children:jsxRuntimeExports.jsxs(Route,{path:"/",element:jsxRuntimeExports.jsx(Layout,{}),children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"expenses",element:jsxRuntimeExports.jsx(ExpensesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"expenses/add",element:jsxRuntimeExports.jsx(AddTransactionPage,{type:"expense"})}),jsxRuntimeExports.jsx(Route,{path:"expenses/:id",element:jsxRuntimeExports.jsx(TransactionDetailPage,{type:"expense"})}),jsxRuntimeExports.jsx(Route,{path:"income",element:jsxRuntimeExports.jsx(IncomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"income/add",element:jsxRuntimeExports.jsx(AddTransactionPage,{type:"income"})}),jsxRuntimeExports.jsx(Route,{path:"incomes/:id",element:jsxRuntimeExports.jsx(TransactionDetailPage,{type:"income"})}),jsxRuntimeExports.jsx(Route,{path:"budgets",element:jsxRuntimeExports.jsx(BudgetsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"budgets/planned",element:jsxRuntimeExports.jsx(PlannedBudgetPage,{})}),jsxRuntimeExports.jsx(Route,{path:"budgets/add",element:jsxRuntimeExports.jsx(AddBudgetPage,{})}),jsxRuntimeExports.jsx(Route,{path:"budgets/:id",element:jsxRuntimeExports.jsx(BudgetDetailPage,{})}),jsxRuntimeExports.jsx(Route,{path:"budgets/:id/edit",element:jsxRuntimeExports.jsx(EditBudgetPage,{})}),jsxRuntimeExports.jsx(Route,{path:"reports",element:jsxRuntimeExports.jsx(ReportsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"settings",element:jsxRuntimeExports.jsx(SettingsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"settings/categories",element:jsxRuntimeExports.jsx(CategoriesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"settings/import-export",element:jsxRuntimeExports.jsx(ImportExportPage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"/expenses/:id/edit",element:jsxRuntimeExports.jsx(EditTransactionPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/incomes/:id/edit",element:jsxRuntimeExports.jsx(EditTransactionPage,{})})]})})}const isString=t=>typeof t=="string",defer=()=>{let t,r;const n=new Promise((s,a)=>{t=s,r=a});return n.resolve=t,n.reject=r,n},makeString=t=>t==null?"":""+t,copy=(t,r,n)=>{t.forEach(s=>{r[s]&&(n[s]=r[s])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=t=>t&&t.indexOf("###")>-1?t.replace(lastOfPathSeparatorRegExp,"."):t,canNotTraverseDeeper=t=>!t||isString(t),getLastOfPath=(t,r,n)=>{const s=isString(r)?r.split("."):r;let a=0;for(;a<s.length-1;){if(canNotTraverseDeeper(t))return{};const i=cleanKey(s[a]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++a}return canNotTraverseDeeper(t)?{}:{obj:t,k:cleanKey(s[a])}},setPath=(t,r,n)=>{const{obj:s,k:a}=getLastOfPath(t,r,Object);if(s!==void 0||r.length===1){s[a]=n;return}let i=r[r.length-1],o=r.slice(0,r.length-1),c=getLastOfPath(t,o,Object);for(;c.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),c=getLastOfPath(t,o,Object),c!=null&&c.obj&&typeof c.obj[`${c.k}.${i}`]<"u"&&(c.obj=void 0);c.obj[`${c.k}.${i}`]=n},pushPath=(t,r,n,s)=>{const{obj:a,k:i}=getLastOfPath(t,r,Object);a[i]=a[i]||[],a[i].push(n)},getPath=(t,r)=>{const{obj:n,k:s}=getLastOfPath(t,r);if(n&&Object.prototype.hasOwnProperty.call(n,s))return n[s]},getPathWithDefaults=(t,r,n)=>{const s=getPath(t,n);return s!==void 0?s:getPath(r,n)},deepExtend=(t,r,n)=>{for(const s in r)s!=="__proto__"&&s!=="constructor"&&(s in t?isString(t[s])||t[s]instanceof String||isString(r[s])||r[s]instanceof String?n&&(t[s]=r[s]):deepExtend(t[s],r[s],n):t[s]=r[s]);return t},regexEscape=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape=t=>isString(t)?t.replace(/[&<>"'\/]/g,r=>_entityMap[r]):t;class RegExpCache{constructor(r){this.capacity=r,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(r){const n=this.regExpMap.get(r);if(n!==void 0)return n;const s=new RegExp(r);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(r,s),this.regExpQueue.push(r),s}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(t,r,n)=>{r=r||"",n=n||"";const s=chars.filter(o=>r.indexOf(o)<0&&n.indexOf(o)<0);if(s.length===0)return!0;const a=looksLikeObjectPathRegExpCache.getRegExp(`(${s.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!a.test(t);if(!i){const o=t.indexOf(n);o>0&&!a.test(t.substring(0,o))&&(i=!0)}return i},deepFind=function(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[r])return Object.prototype.hasOwnProperty.call(t,r)?t[r]:void 0;const s=r.split(n);let a=t;for(let i=0;i<s.length;){if(!a||typeof a!="object")return;let o,c="";for(let f=i;f<s.length;++f)if(f!==i&&(c+=n),c+=s[f],o=a[c],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&f<s.length-1)continue;i+=f-i+1;break}a=o}return a},getCleanedCode=t=>t==null?void 0:t.replace("_","-"),consoleLogger={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,r){var n,s;(s=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||s.call(n,console,r)}};class Logger{constructor(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(r,n)}init(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=r||consoleLogger,this.options=n,this.debug=n.debug}log(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return this.forward(n,"log","",!0)}warn(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return this.forward(n,"warn","",!0)}error(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return this.forward(n,"error","")}deprecate(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(r,n,s,a){return a&&!this.debug?null:(isString(r[0])&&(r[0]=`${s}${this.prefix} ${r[0]}`),this.logger[n](r))}create(r){return new Logger(this.logger,{prefix:`${this.prefix}:${r}:`,...this.options})}clone(r){return r=r||this.options,r.prefix=r.prefix||this.prefix,new Logger(this.logger,r)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(r,n){return r.split(" ").forEach(s=>{this.observers[s]||(this.observers[s]=new Map);const a=this.observers[s].get(n)||0;this.observers[s].set(n,a+1)}),this}off(r,n){if(this.observers[r]){if(!n){delete this.observers[r];return}this.observers[r].delete(n)}}emit(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];this.observers[r]&&Array.from(this.observers[r].entries()).forEach(o=>{let[c,f]=o;for(let d=0;d<f;d++)c(...s)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[c,f]=o;for(let d=0;d<f;d++)c.apply(c,[r,...s])})}}class ResourceStore extends EventEmitter{constructor(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=r||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(r){this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}removeNamespaces(r){const n=this.options.ns.indexOf(r);n>-1&&this.options.ns.splice(n,1)}getResource(r,n,s){var d,h;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;r.indexOf(".")>-1?c=r.split("."):(c=[r,n],s&&(Array.isArray(s)?c.push(...s):isString(s)&&i?c.push(...s.split(i)):c.push(s)));const f=getPath(this.data,c);return!f&&!n&&!s&&r.indexOf(".")>-1&&(r=c[0],n=c[1],s=c.slice(2).join(".")),f||!o||!isString(s)?f:deepFind((h=(d=this.data)==null?void 0:d[r])==null?void 0:h[n],s,i)}addResource(r,n,s,a){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let c=[r,n];s&&(c=c.concat(o?s.split(o):s)),r.indexOf(".")>-1&&(c=r.split("."),a=n,n=c[1]),this.addNamespaces(n),setPath(this.data,c,a),i.silent||this.emit("added",r,n,s,a)}addResources(r,n,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in s)(isString(s[i])||Array.isArray(s[i]))&&this.addResource(r,n,i,s[i],{silent:!0});a.silent||this.emit("added",r,n,s)}addResourceBundle(r,n,s,a,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},c=[r,n];r.indexOf(".")>-1&&(c=r.split("."),a=s,s=n,n=c[1]),this.addNamespaces(n);let f=getPath(this.data,c)||{};o.skipCopy||(s=JSON.parse(JSON.stringify(s))),a?deepExtend(f,s,i):f={...f,...s},setPath(this.data,c,f),o.silent||this.emit("added",r,n,s)}removeResourceBundle(r,n){this.hasResourceBundle(r,n)&&delete this.data[r][n],this.removeNamespaces(n),this.emit("removed",r,n)}hasResourceBundle(r,n){return this.getResource(r,n)!==void 0}getResourceBundle(r,n){return n||(n=this.options.defaultNS),this.getResource(r,n)}getDataByLanguage(r){return this.data[r]}hasLanguageSomeTranslations(r){const n=this.getDataByLanguage(r);return!!(n&&Object.keys(n)||[]).find(a=>n[a]&&Object.keys(n[a]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,r,n,s,a){return t.forEach(i=>{var o;r=((o=this.processors[i])==null?void 0:o.process(r,n,s,a))??r}),r}};const checkedLoadedFor={},shouldHandleAsObject=t=>!isString(t)&&typeof t!="boolean"&&typeof t!="number";class Translator extends EventEmitter{constructor(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],r,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(r){r&&(this.language=r)}exists(r){const s={...arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}};if(r==null)return!1;const a=this.resolve(r,s);return(a==null?void 0:a.res)!==void 0}extractFromKey(r,n){let s=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=s&&r.indexOf(s)>-1,c=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!looksLikeObjectPath(r,s,a);if(o&&!c){const f=r.match(this.interpolator.nestingRegexp);if(f&&f.length>0)return{key:r,namespaces:isString(i)?[i]:i};const d=r.split(s);(s!==a||s===a&&this.options.ns.indexOf(d[0])>-1)&&(i=d.shift()),r=d.join(a)}return{key:r,namespaces:isString(i)?[i]:i}}translate(r,n,s){let a=typeof n=="object"?{...n}:n;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(a={...a}),a||(a={}),r==null)return"";Array.isArray(r)||(r=[String(r)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:c,namespaces:f}=this.extractFromKey(r[r.length-1],a),d=f[f.length-1],h=a.lng||this.language,m=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((h==null?void 0:h.toLowerCase())==="cimode"){if(m){const I=a.nsSeparator||this.options.nsSeparator;return i?{res:`${d}${I}${c}`,usedKey:c,exactUsedKey:c,usedLng:h,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:`${d}${I}${c}`}return i?{res:c,usedKey:c,exactUsedKey:c,usedLng:h,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:c}const g=this.resolve(r,a);let v=g==null?void 0:g.res;const y=(g==null?void 0:g.usedKey)||c,_=(g==null?void 0:g.exactUsedKey)||c,w=["[object Number]","[object Function]","[object RegExp]"],b=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,T=!this.i18nFormat||this.i18nFormat.handleAsObject,k=a.count!==void 0&&!isString(a.count),C=Translator.hasDefaultValue(a),L=k?this.pluralResolver.getSuffix(h,a.count,a):"",D=a.ordinal&&k?this.pluralResolver.getSuffix(h,a.count,{ordinal:!1}):"",N=k&&!a.ordinal&&a.count===0,U=N&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${L}`]||a[`defaultValue${D}`]||a.defaultValue;let M=v;T&&!v&&C&&(M=U);const j=shouldHandleAsObject(M),K=Object.prototype.toString.apply(M);if(T&&M&&j&&w.indexOf(K)<0&&!(isString(b)&&Array.isArray(M))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const I=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,M,{...a,ns:f}):`key '${c} (${this.language})' returned an object instead of string.`;return i?(g.res=I,g.usedParams=this.getUsedParamsDetails(a),g):I}if(o){const I=Array.isArray(M),te=I?[]:{},_e=I?_:y;for(const ne in M)if(Object.prototype.hasOwnProperty.call(M,ne)){const me=`${_e}${o}${ne}`;C&&!v?te[ne]=this.translate(me,{...a,defaultValue:shouldHandleAsObject(U)?U[ne]:void 0,joinArrays:!1,ns:f}):te[ne]=this.translate(me,{...a,joinArrays:!1,ns:f}),te[ne]===me&&(te[ne]=M[ne])}v=te}}else if(T&&isString(b)&&Array.isArray(v))v=v.join(b),v&&(v=this.extendTranslation(v,r,a,s));else{let I=!1,te=!1;!this.isValidLookup(v)&&C&&(I=!0,v=U),this.isValidLookup(v)||(te=!0,v=c);const ne=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&te?void 0:v,me=C&&U!==v&&this.options.updateMissing;if(te||I||me){if(this.logger.log(me?"updateKey":"missingKey",h,d,c,me?U:v),o){const fe=this.resolve(c,{...a,keySeparator:!1});fe&&fe.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let le=[];const he=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&he&&he[0])for(let fe=0;fe<he.length;fe++)le.push(he[fe]);else this.options.saveMissingTo==="all"?le=this.languageUtils.toResolveHierarchy(a.lng||this.language):le.push(a.lng||this.language);const J=(fe,G,A)=>{var P;const q=C&&A!==v?A:ne;this.options.missingKeyHandler?this.options.missingKeyHandler(fe,d,G,q,me,a):(P=this.backendConnector)!=null&&P.saveMissing&&this.backendConnector.saveMissing(fe,d,G,q,me,a),this.emit("missingKey",fe,d,G,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&k?le.forEach(fe=>{const G=this.pluralResolver.getSuffixes(fe,a);N&&a[`defaultValue${this.options.pluralSeparator}zero`]&&G.indexOf(`${this.options.pluralSeparator}zero`)<0&&G.push(`${this.options.pluralSeparator}zero`),G.forEach(A=>{J([fe],c+A,a[`defaultValue${A}`]||U)})}):J(le,c,U))}v=this.extendTranslation(v,r,a,g,s),te&&v===c&&this.options.appendNamespaceToMissingKey&&(v=`${d}:${c}`),(te||I)&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}:${c}`:c,I?v:void 0,a))}return i?(g.res=v,g.usedParams=this.getUsedParamsDetails(a),g):v}extendTranslation(r,n,s,a,i){var d,h;var o=this;if((d=this.i18nFormat)!=null&&d.parse)r=this.i18nFormat.parse(r,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const m=isString(r)&&(((h=s==null?void 0:s.interpolation)==null?void 0:h.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let g;if(m){const y=r.match(this.interpolator.nestingRegexp);g=y&&y.length}let v=s.replace&&!isString(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(v={...this.options.interpolation.defaultVariables,...v}),r=this.interpolator.interpolate(r,v,s.lng||this.language||a.usedLng,s),m){const y=r.match(this.interpolator.nestingRegexp),_=y&&y.length;g<_&&(s.nest=!1)}!s.lng&&a&&a.res&&(s.lng=this.language||a.usedLng),s.nest!==!1&&(r=this.interpolator.nest(r,function(){for(var y=arguments.length,_=new Array(y),w=0;w<y;w++)_[w]=arguments[w];return(i==null?void 0:i[0])===_[0]&&!s.context?(o.logger.warn(`It seems you are nesting recursively key: ${_[0]} in key: ${n[0]}`),null):o.translate(..._,n)},s)),s.interpolation&&this.interpolator.reset()}const c=s.postProcess||this.options.postProcess,f=isString(c)?[c]:c;return r!=null&&(f!=null&&f.length)&&s.applyPostProcessor!==!1&&(r=postProcessor.handle(f,r,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),r}resolve(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s,a,i,o,c;return isString(r)&&(r=[r]),r.forEach(f=>{if(this.isValidLookup(s))return;const d=this.extractFromKey(f,n),h=d.key;a=h;let m=d.namespaces;this.options.fallbackNS&&(m=m.concat(this.options.fallbackNS));const g=n.count!==void 0&&!isString(n.count),v=g&&!n.ordinal&&n.count===0,y=n.context!==void 0&&(isString(n.context)||typeof n.context=="number")&&n.context!=="",_=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);m.forEach(w=>{var b,T;this.isValidLookup(s)||(c=w,!checkedLoadedFor[`${_[0]}-${w}`]&&((b=this.utils)!=null&&b.hasLoadedNamespace)&&!((T=this.utils)!=null&&T.hasLoadedNamespace(c))&&(checkedLoadedFor[`${_[0]}-${w}`]=!0,this.logger.warn(`key "${a}" for languages "${_.join(", ")}" won't get resolved as namespace "${c}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),_.forEach(k=>{var D;if(this.isValidLookup(s))return;o=k;const C=[h];if((D=this.i18nFormat)!=null&&D.addLookupKeys)this.i18nFormat.addLookupKeys(C,h,k,w,n);else{let N;g&&(N=this.pluralResolver.getSuffix(k,n.count,n));const U=`${this.options.pluralSeparator}zero`,M=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(g&&(C.push(h+N),n.ordinal&&N.indexOf(M)===0&&C.push(h+N.replace(M,this.options.pluralSeparator)),v&&C.push(h+U)),y){const j=`${h}${this.options.contextSeparator}${n.context}`;C.push(j),g&&(C.push(j+N),n.ordinal&&N.indexOf(M)===0&&C.push(j+N.replace(M,this.options.pluralSeparator)),v&&C.push(j+U))}}let L;for(;L=C.pop();)this.isValidLookup(s)||(i=L,s=this.getResource(k,w,L,n))}))})}),{res:s,usedKey:a,exactUsedKey:i,usedLng:o,usedNS:c}}isValidLookup(r){return r!==void 0&&!(!this.options.returnNull&&r===null)&&!(!this.options.returnEmptyString&&r==="")}getResource(r,n,s){var i;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(r,n,s,a):this.resourceStore.getResource(r,n,s,a)}getUsedParamsDetails(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=r.replace&&!isString(r.replace);let a=s?r.replace:r;if(s&&typeof r.count<"u"&&(a.count=r.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!s){a={...a};for(const i of n)delete a[i]}return a}static hasDefaultValue(r){const n="defaultValue";for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s)&&n===s.substring(0,n.length)&&r[s]!==void 0)return!0;return!1}}class LanguageUtil{constructor(r){this.options=r,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(r){if(r=getCleanedCode(r),!r||r.indexOf("-")<0)return null;const n=r.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(r){if(r=getCleanedCode(r),!r||r.indexOf("-")<0)return r;const n=r.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(r){if(isString(r)&&r.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(r)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?r.toLowerCase():r)}return this.options.cleanCode||this.options.lowerCaseLng?r.toLowerCase():r}isSupportedCode(r){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(r=this.getLanguagePartFromCode(r)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(r)>-1}getBestMatchFromCodes(r){if(!r)return null;let n;return r.forEach(s=>{if(n)return;const a=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(a))&&(n=a)}),!n&&this.options.supportedLngs&&r.forEach(s=>{if(n)return;const a=this.getScriptPartFromCode(s);if(this.isSupportedCode(a))return n=a;const i=this.getLanguagePartFromCode(s);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(r,n){if(!r)return[];if(typeof r=="function"&&(r=r(n)),isString(r)&&(r=[r]),Array.isArray(r))return r;if(!n)return r.default||[];let s=r[n];return s||(s=r[this.getScriptPartFromCode(n)]),s||(s=r[this.formatLanguageCode(n)]),s||(s=r[this.getLanguagePartFromCode(n)]),s||(s=r.default),s||[]}toResolveHierarchy(r,n){const s=this.getFallbackCodes(n||this.options.fallbackLng||[],r),a=[],i=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return isString(r)&&(r.indexOf("-")>-1||r.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(r)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(r)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(r))):isString(r)&&i(this.formatLanguageCode(r)),s.forEach(o=>{a.indexOf(o)<0&&i(this.formatLanguageCode(o))}),a}}const suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},dummyRule={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PluralResolver{constructor(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=r,this.options=n,this.logger=baseLogger.create("pluralResolver"),this.pluralRulesCache={}}addRule(r,n){this.rules[r]=n}clearCache(){this.pluralRulesCache={}}getRule(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=getCleanedCode(r==="dev"?"en":r),a=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:s,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(s,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dummyRule;if(!r.match(/-|_/))return dummyRule;const f=this.languageUtils.getLanguagePartFromCode(r);o=this.getRule(f,n)}return this.pluralRulesCache[i]=o,o}needsPlural(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.getRule(r,n);return s||(s=this.getRule("dev",n)),(s==null?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(r,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(r,s).map(a=>`${n}${a}`)}getSuffixes(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this.getRule(r,n);return s||(s=this.getRule("dev",n)),s?s.resolvedOptions().pluralCategories.sort((a,i)=>suffixesOrder[a]-suffixesOrder[i]).map(a=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(r,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(r,s);return a?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${a.select(n)}`:(this.logger.warn(`no plural rule found for: ${r}`),this.getSuffix("dev",n,s))}}const deepFindWithDefaults=function(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=getPathWithDefaults(t,r,n);return!i&&a&&isString(n)&&(i=deepFind(t,n,s),i===void 0&&(i=deepFind(r,n,s))),i},regexSafe=t=>t.replace(/\$/g,"$$$$");class Interpolator{constructor(){var n;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("interpolator"),this.options=r,this.format=((n=r==null?void 0:r.interpolation)==null?void 0:n.format)||(s=>s),this.init(r)}init(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r.interpolation||(r.interpolation={escapeValue:!0});const{escape:n,escapeValue:s,useRawValueToEscape:a,prefix:i,prefixEscaped:o,suffix:c,suffixEscaped:f,formatSeparator:d,unescapeSuffix:h,unescapePrefix:m,nestingPrefix:g,nestingPrefixEscaped:v,nestingSuffix:y,nestingSuffixEscaped:_,nestingOptionsSeparator:w,maxReplaces:b,alwaysFormat:T}=r.interpolation;this.escape=n!==void 0?n:escape,this.escapeValue=s!==void 0?s:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?regexEscape(i):o||"{{",this.suffix=c?regexEscape(c):f||"}}",this.formatSeparator=d||",",this.unescapePrefix=h?"":m||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=g?regexEscape(g):v||regexEscape("$t("),this.nestingSuffix=y?regexEscape(y):_||regexEscape(")"),this.nestingOptionsSeparator=w||",",this.maxReplaces=b||1e3,this.alwaysFormat=T!==void 0?T:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const r=(n,s)=>(n==null?void 0:n.source)===s?(n.lastIndex=0,n):new RegExp(s,"g");this.regexp=r(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=r(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=r(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(r,n,s,a){var v;let i,o,c;const f=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=y=>{if(y.indexOf(this.formatSeparator)<0){const T=deepFindWithDefaults(n,f,y,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(T,void 0,s,{...a,...n,interpolationkey:y}):T}const _=y.split(this.formatSeparator),w=_.shift().trim(),b=_.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(n,f,w,this.options.keySeparator,this.options.ignoreJSONStructure),b,s,{...a,...n,interpolationkey:w})};this.resetRegExp();const h=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,m=((v=a==null?void 0:a.interpolation)==null?void 0:v.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:y=>regexSafe(y)},{regex:this.regexp,safeValue:y=>this.escapeValue?regexSafe(this.escape(y)):regexSafe(y)}].forEach(y=>{for(c=0;i=y.regex.exec(r);){const _=i[1].trim();if(o=d(_),o===void 0)if(typeof h=="function"){const b=h(r,i,a);o=isString(b)?b:""}else if(a&&Object.prototype.hasOwnProperty.call(a,_))o="";else if(m){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${_} for interpolating ${r}`),o="";else!isString(o)&&!this.useRawValueToEscape&&(o=makeString(o));const w=y.safeValue(o);if(r=r.replace(i[0],w),m?(y.regex.lastIndex+=o.length,y.regex.lastIndex-=i[0].length):y.regex.lastIndex=0,c++,c>=this.maxReplaces)break}}),r}nest(r,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,i,o;const c=(f,d)=>{const h=this.nestingOptionsSeparator;if(f.indexOf(h)<0)return f;const m=f.split(new RegExp(`${h}[ ]*{`));let g=`{${m[1]}`;f=m[0],g=this.interpolate(g,o);const v=g.match(/'/g),y=g.match(/"/g);(((v==null?void 0:v.length)??0)%2===0&&!y||y.length%2!==0)&&(g=g.replace(/'/g,'"'));try{o=JSON.parse(g),d&&(o={...d,...o})}catch(_){return this.logger.warn(`failed parsing options string in nesting for key ${f}`,_),`${f}${h}${g}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,f};for(;a=this.nestingRegexp.exec(r);){let f=[];o={...s},o=o.replace&&!isString(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let d=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const h=a[1].split(this.formatSeparator).map(m=>m.trim());a[1]=h.shift(),f=h,d=!0}if(i=n(c.call(this,a[1].trim(),o),o),i&&a[0]===r&&!isString(i))return i;isString(i)||(i=makeString(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${r}`),i=""),d&&(i=f.reduce((h,m)=>this.format(h,m,s.lng,{...s,interpolationkey:a[1].trim()}),i.trim())),r=r.replace(a[0],i),this.regexp.lastIndex=0}return r}}const parseFormatStr=t=>{let r=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const s=t.split("(");r=s[0].toLowerCase().trim();const a=s[1].substring(0,s[1].length-1);r==="currency"&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):r==="relativetime"&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach(o=>{if(o){const[c,...f]=o.split(":"),d=f.join(":").trim().replace(/^'+|'+$/g,""),h=c.trim();n[h]||(n[h]=d),d==="false"&&(n[h]=!1),d==="true"&&(n[h]=!0),isNaN(d)||(n[h]=parseInt(d,10))}})}return{formatName:r,formatOptions:n}},createCachedFormatter=t=>{const r={};return(n,s,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const o=s+JSON.stringify(i);let c=r[o];return c||(c=t(getCleanedCode(s),a),r[o]=c),c(n)}};class Formatter{constructor(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("formatter"),this.options=r,this.formats={number:createCachedFormatter((n,s)=>{const a=new Intl.NumberFormat(n,{...s});return i=>a.format(i)}),currency:createCachedFormatter((n,s)=>{const a=new Intl.NumberFormat(n,{...s,style:"currency"});return i=>a.format(i)}),datetime:createCachedFormatter((n,s)=>{const a=new Intl.DateTimeFormat(n,{...s});return i=>a.format(i)}),relativetime:createCachedFormatter((n,s)=>{const a=new Intl.RelativeTimeFormat(n,{...s});return i=>a.format(i,s.range||"day")}),list:createCachedFormatter((n,s)=>{const a=new Intl.ListFormat(n,{...s});return i=>a.format(i)})},this.init(r)}init(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(r,n){this.formats[r.toLowerCase().trim()]=n}addCached(r,n){this.formats[r.toLowerCase().trim()]=createCachedFormatter(n)}format(r,n,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(c=>c.indexOf(")")>-1)){const c=i.findIndex(f=>f.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,c)].join(this.formatSeparator)}return i.reduce((c,f)=>{var m;const{formatName:d,formatOptions:h}=parseFormatStr(f);if(this.formats[d]){let g=c;try{const v=((m=a==null?void 0:a.formatParams)==null?void 0:m[a.interpolationkey])||{},y=v.locale||v.lng||a.locale||a.lng||s;g=this.formats[d](c,y,{...h,...a,...v})}catch(v){this.logger.warn(v)}return g}else this.logger.warn(`there was no format function for ${d}`);return c},r)}}const removePending=(t,r)=>{t.pending[r]!==void 0&&(delete t.pending[r],t.pendingCount--)};class Connector extends EventEmitter{constructor(r,n,s){var i,o;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=r,this.store=n,this.services=s,this.languageUtils=s.languageUtils,this.options=a,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,s,a.backend,a)}queueLoad(r,n,s,a){const i={},o={},c={},f={};return r.forEach(d=>{let h=!0;n.forEach(m=>{const g=`${d}|${m}`;!s.reload&&this.store.hasResourceBundle(d,m)?this.state[g]=2:this.state[g]<0||(this.state[g]===1?o[g]===void 0&&(o[g]=!0):(this.state[g]=1,h=!1,o[g]===void 0&&(o[g]=!0),i[g]===void 0&&(i[g]=!0),f[m]===void 0&&(f[m]=!0)))}),h||(c[d]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(c),toLoadNamespaces:Object.keys(f)}}loaded(r,n,s){const a=r.split("|"),i=a[0],o=a[1];n&&this.emit("failedLoading",i,o,n),!n&&s&&this.store.addResourceBundle(i,o,s,void 0,void 0,{skipCopy:!0}),this.state[r]=n?-1:2,n&&s&&(this.state[r]=0);const c={};this.queue.forEach(f=>{pushPath(f.loaded,[i],o),removePending(f,r),n&&f.errors.push(n),f.pendingCount===0&&!f.done&&(Object.keys(f.loaded).forEach(d=>{c[d]||(c[d]={});const h=f.loaded[d];h.length&&h.forEach(m=>{c[d][m]===void 0&&(c[d][m]=!0)})}),f.done=!0,f.errors.length?f.callback(f.errors):f.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(f=>!f.done)}read(r,n,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!r.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:r,ns:n,fcName:s,tried:a,wait:i,callback:o});return}this.readingCalls++;const c=(d,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const m=this.waitingReads.shift();this.read(m.lng,m.ns,m.fcName,m.tried,m.wait,m.callback)}if(d&&h&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,r,n,s,a+1,i*2,o)},i);return}o(d,h)},f=this.backend[s].bind(this.backend);if(f.length===2){try{const d=f(r,n);d&&typeof d.then=="function"?d.then(h=>c(null,h)).catch(c):c(null,d)}catch(d){c(d)}return}return f(r,n,c)}prepareLoading(r,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();isString(r)&&(r=this.languageUtils.toResolveHierarchy(r)),isString(n)&&(n=[n]);const i=this.queueLoad(r,n,s,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(r,n,s){this.prepareLoading(r,n,{},s)}reload(r,n,s){this.prepareLoading(r,n,{reload:!0},s)}loadOne(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const s=r.split("|"),a=s[0],i=s[1];this.read(a,i,"read",void 0,void 0,(o,c)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${a} failed`,o),!o&&c&&this.logger.log(`${n}loaded namespace ${i} for language ${a}`,c),this.loaded(r,o,c)})}saveMissing(r,n,s,a,i){var f,d,h,m,g;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((d=(f=this.services)==null?void 0:f.utils)!=null&&d.hasLoadedNamespace&&!((m=(h=this.services)==null?void 0:h.utils)!=null&&m.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${s}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if((g=this.backend)!=null&&g.create){const v={...o,isUpdate:i},y=this.backend.create.bind(this.backend);if(y.length<6)try{let _;y.length===5?_=y(r,n,s,a,v):_=y(r,n,s,a),_&&typeof _.then=="function"?_.then(w=>c(null,w)).catch(c):c(null,_)}catch(_){c(_)}else y(r,n,s,a,c,v)}!r||!r[0]||this.store.addResource(r[0],n,s,a)}}}const get=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let r={};if(typeof t[1]=="object"&&(r=t[1]),isString(t[1])&&(r.defaultValue=t[1]),isString(t[2])&&(r.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(s=>{r[s]=n[s]})}return r},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),transformOptions=t=>{var r,n;return isString(t.ns)&&(t.ns=[t.ns]),isString(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),isString(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(r=t.supportedLngs)==null?void 0:r.indexOf)==null?void 0:n.call(r,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},noop=()=>{},bindMemberFunctions=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class I18n extends EventEmitter{constructor(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=transformOptions(r),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),n&&!this.isInitialized&&!r.isClone){if(!this.options.initAsync)return this.init(r,n),this;setTimeout(()=>{this.init(r,n)},0)}}init(){var r=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(s=n,n={}),n.defaultNS==null&&n.ns&&(isString(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const a=get();this.options={...a,...this.options,...transformOptions(n)},this.options.interpolation={...a.interpolation,...this.options.interpolation},n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const i=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(i(this.modules.logger),this.options):baseLogger.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:h=Formatter;const m=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const g=this.services;g.logger=baseLogger,g.resourceStore=this.store,g.languageUtils=m,g.pluralResolver=new PluralResolver(m,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),h&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(g.formatter=i(h),g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new Interpolator(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new Connector(i(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",function(v){for(var y=arguments.length,_=new Array(y>1?y-1:0),w=1;w<y;w++)_[w-1]=arguments[w];r.emit(v,..._)}),this.modules.languageDetector&&(g.languageDetector=i(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=i(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(v){for(var y=arguments.length,_=new Array(y>1?y-1:0),w=1;w<y;w++)_[w-1]=arguments[w];r.emit(v,..._)}),this.modules.external.forEach(v=>{v.init&&v.init(this)})}if(this.format=this.options.interpolation.format,s||(s=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=function(){return r.store[h](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=function(){return r.store[h](...arguments),r}});const f=defer(),d=()=>{const h=(m,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),f.resolve(g),s(m,g)};if(this.languages&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),f}loadResources(r){var i,o;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const a=isString(r)?r:this.language;if(typeof r=="function"&&(s=r),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const c=[],f=d=>{if(!d||d==="cimode")return;this.services.languageUtils.toResolveHierarchy(d).forEach(m=>{m!=="cimode"&&c.indexOf(m)<0&&c.push(m)})};a?f(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(h=>f(h)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,d=>f(d)),this.services.backendConnector.load(c,this.options.ns,d=>{!d&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(d)})}else s(null)}reloadResources(r,n,s){const a=defer();return typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=void 0),r||(r=this.languages),n||(n=this.options.ns),s||(s=noop),this.services.backendConnector.reload(r,n,i=>{a.resolve(),s(i)}),a}use(r){if(!r)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!r.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return r.type==="backend"&&(this.modules.backend=r),(r.type==="logger"||r.log&&r.warn&&r.error)&&(this.modules.logger=r),r.type==="languageDetector"&&(this.modules.languageDetector=r),r.type==="i18nFormat"&&(this.modules.i18nFormat=r),r.type==="postProcessor"&&postProcessor.addPostProcessor(r),r.type==="formatter"&&(this.modules.formatter=r),r.type==="3rdParty"&&this.modules.external.push(r),this}setResolvedLanguage(r){if(!(!r||!this.languages)&&!(["cimode","dev"].indexOf(r)>-1)){for(let n=0;n<this.languages.length;n++){const s=this.languages[n];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}!this.resolvedLanguage&&this.languages.indexOf(r)<0&&this.store.hasLanguageSomeTranslations(r)&&(this.resolvedLanguage=r,this.languages.unshift(r))}}changeLanguage(r,n){var s=this;this.isLanguageChangingTo=r;const a=defer();this.emit("languageChanging",r);const i=f=>{this.language=f,this.languages=this.services.languageUtils.toResolveHierarchy(f),this.resolvedLanguage=void 0,this.setResolvedLanguage(f)},o=(f,d)=>{d?this.isLanguageChangingTo===r&&(i(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,a.resolve(function(){return s.t(...arguments)}),n&&n(f,function(){return s.t(...arguments)})},c=f=>{var m,g;!r&&!f&&this.services.languageDetector&&(f=[]);const d=isString(f)?f:f&&f[0],h=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes(isString(f)?[f]:f);h&&(this.language||i(h),this.translator.language||this.translator.changeLanguage(h),(g=(m=this.services.languageDetector)==null?void 0:m.cacheUserLanguage)==null||g.call(m,h)),this.loadResources(h,v=>{o(v,h)})};return!r&&this.services.languageDetector&&!this.services.languageDetector.async?c(this.services.languageDetector.detect()):!r&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(c):this.services.languageDetector.detect(c):c(r),a}getFixedT(r,n,s){var a=this;const i=function(o,c){let f;if(typeof c!="object"){for(var d=arguments.length,h=new Array(d>2?d-2:0),m=2;m<d;m++)h[m-2]=arguments[m];f=a.options.overloadTranslationOptionHandler([o,c].concat(h))}else f={...c};f.lng=f.lng||i.lng,f.lngs=f.lngs||i.lngs,f.ns=f.ns||i.ns,f.keyPrefix!==""&&(f.keyPrefix=f.keyPrefix||s||i.keyPrefix);const g=a.options.keySeparator||".";let v;return f.keyPrefix&&Array.isArray(o)?v=o.map(y=>`${f.keyPrefix}${g}${y}`):v=f.keyPrefix?`${f.keyPrefix}${g}${o}`:o,a.t(v,f)};return isString(r)?i.lng=r:i.lngs=r,i.ns=n,i.keyPrefix=s,i}t(){var a;for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=this.translator)==null?void 0:a.translate(...n)}exists(){var a;for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=this.translator)==null?void 0:a.exists(...n)}setDefaultNamespace(r){this.options.defaultNS=r}hasLoadedNamespace(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=n.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const o=(c,f)=>{const d=this.services.backendConnector.state[`${c}|${f}`];return d===-1||d===0||d===2};if(n.precheck){const c=n.precheck(this,o);if(c!==void 0)return c}return!!(this.hasResourceBundle(s,r)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(s,r)&&(!a||o(i,r)))}loadNamespaces(r,n){const s=defer();return this.options.ns?(isString(r)&&(r=[r]),r.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{s.resolve(),n&&n(a)}),s):(n&&n(),Promise.resolve())}loadLanguages(r,n){const s=defer();isString(r)&&(r=[r]);const a=this.options.preload||[],i=r.filter(o=>a.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=a.concat(i),this.loadResources(o=>{s.resolve(),n&&n(o)}),s):(n&&n(),Promise.resolve())}dir(r){var a,i;if(r||(r=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!r)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=((i=this.services)==null?void 0:i.languageUtils)||new LanguageUtil(get());return n.indexOf(s.getLanguagePartFromCode(r))>-1||r.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new I18n(r,n)}cloneInstance(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const s=r.forkResourceStore;s&&delete r.forkResourceStore;const a={...this.options,...r,isClone:!0},i=new I18n(a);if((r.debug!==void 0||r.prefix!==void 0)&&(i.logger=i.logger.clone(r)),["store","services","language"].forEach(c=>{i[c]=this[c]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},s){const c=Object.keys(this.store.data).reduce((f,d)=>(f[d]={...this.store.data[d]},f[d]=Object.keys(f[d]).reduce((h,m)=>(h[m]={...f[d][m]},h),f[d]),f),{});i.store=new ResourceStore(c,a),i.services.resourceStore=i.store}return i.translator=new Translator(i.services,a),i.translator.on("*",function(c){for(var f=arguments.length,d=new Array(f>1?f-1:0),h=1;h<f;h++)d[h-1]=arguments[h];i.emit(c,...d)}),i.init(a,n),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const resources={en:{translation:{"home.title":"Financial Overview","expenses.title":"Expenses","income.title":"Income","budgets.title":"Budgets","settings.title":"Settings","add.expense":"Add Expense","no.recent.expenses":"No recent expenses","no.recent.income":"No recent income","recent.expenses":"Recent expenses","recent.income":"Recent income","add.income":"Add Income","current.balance":"Current Balance","total.income":"Total Income","total.expenses":"Total Expenses","no.transactions":"No transactions found","view.all":"View All",edit:"Edit",delete:"Delete",cancel:"Cancel",save:"Save",reset:"Reset","reports.title":"Reports","settings.preferences":"Preferences","settings.dataManagement":"Data Management","settings.theme":"Theme","settings.currency":"Currency","settings.firstDayOfMonth":"First Day of Month","settings.importExport":"Import/Export","settings.categories":"Categories","settings.manageCategories":"Manage expense and income categories","settings.backupRestore":"Backup and restore your financial data","income.searchPlaceholder":"Search income...","income.filters":"Filters","income.clearFilters":"Clear all","income.addIncome":"Add Income","transaction.date":"Date","transaction.paymentMethod":"Payment Method","transaction.source":"Source","transaction.notes":"Notes","importExport.exportData":"Export Data","importExport.exportDataDescription":"Download a backup of all your data, including transactions, budgets, and settings.","importExport.transactionsCSV":"Transactions (CSV)","importExport.budgetsCSV":"Budgets (CSV)","importExport.importantNotes":"Important Notes:","importExport.replaceDataWarning":"Importing data will replace all existing data","importExport.backupWarning":"Make sure to backup your current data before importing","importExport.supportedFiles":"Only JSON files exported from this app are supported","currency.usd":"US Dollar","currency.eur":"Euro","currency.gbp":"British Pound","currency.jpy":"Japanese Yen","currency.cad":"Canadian Dollar","currency.aud":"Australian Dollar","currency.chf":"Swiss Franc","firstDay.1":"1st","firstDay.15":"15th","firstDay.25":"25th","theme.light":"Light","theme.dark":"Dark","theme.system":"System","settings.categoriesDescription":"Manage expense and income categories","settings.importExportDescription":"Import or export your financial data","settings.quickExport":"Quick Export","settings.fullBackup":"Full Backup","settings.transactionsCSV":"Transactions CSV","settings.resetAllData":"Reset All Data","settings.resetAllDataDescription":"Erase all your data and start fresh","settings.resetConfirmTitle":"Confirm Reset","settings.resetConfirmDescription":"Are you sure you want to reset all data? This action cannot be undone.","settings.cancel":"Cancel","settings.reset":"Reset","settings.importData":"Import Data","settings.exportToExcel":"Export to Excel","settings.importFromExcel":"Import from Excel"}},fr:{translation:{"home.title":"Vue d'ensemble financière","expenses.title":"Dépenses","income.title":"Revenus","budgets.title":"Budgets","settings.title":"Paramètres","add.expense":"Ajouter une dépense","add.income":"Ajouter un revenu","no.recent.expenses":"Pas de dépenses récentes","no.recent.income":"Pas de revenus récents","recent.expenses":"Dépenses récentes","recent.income":"Revenus récents","current.balance":"Solde actuel","total.income":"Revenus totaux","total.expenses":"Dépenses totales","no.transactions":"Aucune transaction trouvée","view.all":"Voir tout",edit:"Modifier",delete:"Supprimer",cancel:"Annuler",save:"Enregistrer",reset:"Réinitialiser","reports.title":"Rapports","settings.preferences":"Préférences","settings.dataManagement":"Gestion des données","settings.theme":"Thème","settings.currency":"Devise","settings.firstDayOfMonth":"Premier jour du mois","settings.importExport":"Importer/Exporter","settings.categories":"Catégories","settings.manageCategories":"Gérer les catégories de dépenses et de revenus","settings.backupRestore":"Sauvegarder et restaurer vos données financières","income.searchPlaceholder":"Rechercher des revenus...","income.filters":"Filtres","income.clearFilters":"Tout effacer","income.addIncome":"Ajouter un revenu","transaction.date":"Date","transaction.paymentMethod":"Mode de paiement","transaction.source":"Source","transaction.notes":"Notes","importExport.exportData":"Exporter les données","importExport.exportDataDescription":"Téléchargez une sauvegarde de toutes vos données, y compris les transactions, les budgets et les paramètres.","importExport.transactionsCSV":"Transactions (CSV)","importExport.budgetsCSV":"Budgets (CSV)","importExport.importantNotes":"Notes importantes:","importExport.replaceDataWarning":"L'importation de données remplacera toutes les données existantes","importExport.backupWarning":"Assurez-vous de sauvegarder vos données actuelles avant d'importer","importExport.supportedFiles":"Seuls les fichiers JSON exportés depuis cette application sont pris en charge","settings.firstDay":"Premier jour du mois","firstDay.1":"1er du mois","firstDay.15":"15 du mois","firstDay.25":"25 du mois","theme.light":"Clair","theme.dark":"Sombre","theme.system":"Système","settings.categoriesDescription":"Gérez les catégories de dépenses et de revenus","settings.importExportDescription":"Importer ou exporter vos données financières","settings.quickExport":"Exportation rapide","settings.fullBackup":"Sauvegarde complète","settings.transactionsCSV":"Transactions CSV","settings.resetAllData":"Réinitialiser toutes les données","settings.resetAllDataDescription":"Effacez toutes vos données et recommencez à zéro","settings.resetConfirmTitle":"Confirmer la réinitialisation","settings.resetConfirmDescription":"Êtes-vous sûr de vouloir réinitialiser toutes les données ? Cette action est irréversible.","settings.cancel":"Annuler","settings.reset":"Réinitialiser","settings.importData":"Importer des données","settings.exportToExcel":"Exporter vers Excel","settings.importFromExcel":"Importer depuis Excel","currency.usd":"Dollar américain","currency.eur":"Euro","currency.gbp":"Livre sterling","currency.jpy":"Yen japonais","currency.cad":"Dollar canadien","currency.aud":"Dollar australien","currency.chf":"Franc suisse"}}};instance.use(initReactI18next).init({resources,lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(DataProvider,{children:jsxRuntimeExports.jsx(ThemeProvider,{children:jsxRuntimeExports.jsx(App,{})})})})}));
